!function(){"use strict";const e="undefined"!=typeof window&&null!==window;let t=e&&Boolean(window.widget||window.sankore);e&&t&&document.body.classList.add("openboard");const n="undefined"!=typeof window&&window.matchMedia("(max-width: 600px)").matches;let a=n?60:80;let r={prefixeAppli:"seyes",largeur_carreau:a,largeur_marge_secondaire:2.7*a,largeur_page:undefined,largeur_page_impression:1,largeur_marge_impression:1,largeur_margesecondaire_impression:1,largeur_carreau_old:a,largeur_marge:n?60:200,facteur_taille_police:.75,taille_police:60,epaisseur_police:"normal",ligatures_on:!1,coef_marge:.35,coef_marge_windows:.3125,distance_soulignage:.3,police_active:"Belle Allure CE",typeCarreaux:"seyes",regleActive:!1,isDrawing:!1,espacementLettres:0,espacementMots:0,ajouterLaDate:!1,soulignerLaDate:!1,verifierOrthographe:!1,interligneDouble:!1,largeurImpression:3,nombreDeCarreaux:undefined,ecrireAChevalSurLaMarge:!1,langue:"fr",langueChoix:"auto",majDateAuto:!1,isWindows:/Win/i.test(navigator.userAgent),substitutions:[["on","═"],["or","║"],["s ","╝ "],["s\\.","╝."],["s,","╝,"],["s;","╝;"],["s:","╝:"],["s!","╝!"],["s/","╝/"],["s-","╝-"],["s'","╝'"],[" p"," ╰"],[" j"," ╮"],[" s"," ╠"],[" i"," ╱"]],openboard:t,selected:!1,dateDuDoc:!0,afficherMessage:!0,opaciteLignes:1,contenuTexteMarge:"",contenuTexteMargeComplementaire:"",contenuGraphismes:"",contenuImages:"",contenuTextePrincipal:"",couleursJours:{},numeroMessage:8};const o=e=>document.getElementById(e);function i(e){if(!e)return;document.querySelectorAll(".darkbox"),e.classList.remove("hide");const t=document.getElementById("darkbox");t&&t.classList.remove("hide")}function l(e){if(!e)return;e.classList.add("hide");const t=document.getElementById("darkbox");t&&t.classList.add("hide")}const s=document.getElementById("apropos"),c=document.getElementById("entete"),u=document.getElementById("marge-entete"),d=document.getElementById("case2"),g=document.getElementById("case3"),m=document.getElementById("contenu"),p=document.getElementById("marge"),f=document.getElementById("marge1"),h=document.getElementById("texte_marge"),y=document.getElementById("marge2"),v=document.getElementById("texte_marge_complementaire"),b=document.getElementById("page"),_=document.getElementById("graphismes"),w=document.getElementById("images"),D=document.getElementById("texte_principal"),E=document.getElementById("message"),x=document.getElementById("show-warning-next-time"),C=document.getElementById("resultatCodi"),M=document.getElementById("lienCodi"),L=document.getElementById("suiteCodi");let k=document.getElementById("boutonCodi");const T=document.getElementById("bouton_ligatures"),I=document.getElementById("choix_police");let S=document.getElementById("choix-couleur-entete"),A=document.getElementById("inputEspacement"),N=document.getElementById("inputEspacementMots");document.getElementById("inputOpacite");let O=document.getElementById("checkboxAjouterDate"),j=document.getElementById("checkboxSoulignerDate"),F=document.getElementById("checkboxVerifierOrthographe"),B=document.getElementById("checkboxInterligneDouble"),P=document.getElementById("inputLargeurImpression"),H=document.getElementById("inputNombreDeCarreaux"),R=document.getElementById("checkboxMajDateAuto"),Y=document.getElementById("inputEcrireACheval");const W=document.getElementById("confirmation-nouveau"),$=document.getElementById("divCodi"),q=document.getElementById("divIllustration"),z=document.getElementById("darkbox"),J=document.getElementById("zone_menu_copie_lien"),G=document.getElementById("zone_lien"),U=document.getElementById("fullscreen"),V=document.getElementById("barre"),X=document.documentElement,K=document.getElementById("selectLangue");function Z(){Q("texte-principal",D.innerHTML),Q("texte-marge",h.innerHTML),Q("texte-marge-complementaire",v.innerHTML)}function Q(e,t){r.openboard?window.sankore.setPreference(r.prefixeAppli+"-"+e,t):localStorage.setItem(r.prefixeAppli+"-"+e,t)}async function ee(e){let t;if(r.openboard)try{t=await window.sankore.async.preference(`${r.prefixeAppli}-${e}`)}catch(t){console.error(`Erreur lors de la lecture de la clé ${e} depuis Openboard:`,t)}else t=localStorage.getItem(`${r.prefixeAppli}-${e}`);return t}async function te(e,t){return e.get(t)||await ee(t)}const ne=[{fr:"Lundi",oc:"Lo diluns"},{fr:"Mardi",oc:"Lo dimars"},{fr:"Mercredi",oc:"Lo dimècres"},{fr:"Jeudi",oc:"Lo dijòus"},{fr:"Vendredi",oc:"Lo divendres"},{fr:"Samedi",oc:"Lo dissabte"},{fr:"Dimanche",oc:"Lo dimenge"}],ae={lundi:"#ed284c",mardi:"#56f068",mercredi:"#53b8e0",jeudi:"#e69130",vendredi:"#6171ff",samedi:"#85ff5c"};let re={...ae};function oe(e){let t=document.getElementById("select-jours").value;re[t]=e,c.style.backgroundColor=e,S.style.backgroundColor=e,ie(),Q("couleurs-jours",JSON.stringify(re))}function ie(){let e=function(e){return.299*e[0]+.587*e[1]+.114*e[2]}(function(e){let t=0,n=0,a=0;return 4===e.length?(t=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16),a=parseInt(e[3]+e[3],16)):7===e.length&&(t=parseInt(e[1]+e[2],16),n=parseInt(e[3]+e[4],16),a=parseInt(e[5]+e[6],16)),[t,n,a]}(S.value));S.style.borderColor=e<128?"white":"black"}const le=[{fr:"janvier",oc:"de genièr"},{fr:"février",oc:"de febrièr"},{fr:"mars",oc:"de març"},{fr:"avril",oc:"d'abril"},{fr:"mai",oc:"de mai"},{fr:"juin",oc:"de junh"},{fr:"juillet",oc:"de julhet"},{fr:"août",oc:"d'agost"},{fr:"septembre",oc:"de setembre"},{fr:"octobre",oc:"d'octobre"},{fr:"novembre",oc:"de novembre"},{fr:"décembre",oc:"de decembre"}];var se=function(){var e=function(){return e=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,l=o.length;i<l;i++,r++)a[r]=o[i];return a}var n=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],a={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},r={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},o=function(e,t){return void 0===t&&(t=2),("000"+e).slice(-1*t)},i=function(e){return!0===e?1:0};function l(e,t){var n;return function(){var a=this,r=arguments;clearTimeout(n),n=setTimeout(function(){return e.apply(a,r)},t)}}var s=function(e){return e instanceof Array?e:[e]};function c(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function u(e,t,n){var a=window.document.createElement(e);return t=t||"",n=n||"",a.className=t,void 0!==n&&(a.textContent=n),a}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function g(e,t){return t(e)?e:e.parentNode?g(e.parentNode,t):void 0}function m(e,t){var n=u("div","numInputWrapper"),a=u("input","numInput "+e),r=u("span","arrowUp"),o=u("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?a.type="number":(a.type="text",a.pattern="\\d*"),void 0!==t)for(var i in t)a.setAttribute(i,t[i]);return n.appendChild(a),n.appendChild(r),n.appendChild(o),n}function p(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(t){return e.target}}var f=function(){},h=function(e,t,n){return n.months[t?"shorthand":"longhand"][e]},y={D:f,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:function(e,t){e.setHours((e.getHours()>=12?12:0)+parseFloat(t))},H:function(e,t){e.setHours(parseFloat(t))},J:function(e,t){e.setDate(parseFloat(t))},K:function(e,t,n){e.setHours(e.getHours()%12+12*i(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:function(e,t){e.setSeconds(parseFloat(t))},U:function(e,t){return new Date(1e3*parseFloat(t))},W:function(e,t,n){var a=parseInt(t),r=new Date(e.getFullYear(),0,2+7*(a-1),0,0,0,0);return r.setDate(r.getDate()-r.getDay()+n.firstDayOfWeek),r},Y:function(e,t){e.setFullYear(parseFloat(t))},Z:function(e,t){return new Date(t)},d:function(e,t){e.setDate(parseFloat(t))},h:function(e,t){e.setHours((e.getHours()>=12?12:0)+parseFloat(t))},i:function(e,t){e.setMinutes(parseFloat(t))},j:function(e,t){e.setDate(parseFloat(t))},l:f,m:function(e,t){e.setMonth(parseFloat(t)-1)},n:function(e,t){e.setMonth(parseFloat(t)-1)},s:function(e,t){e.setSeconds(parseFloat(t))},u:function(e,t){return new Date(parseFloat(t))},w:f,y:function(e,t){e.setFullYear(2e3+parseFloat(t))}},v={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},b={Z:function(e){return e.toISOString()},D:function(e,t,n){return t.weekdays.shorthand[b.w(e,t,n)]},F:function(e,t,n){return h(b.n(e,t,n)-1,!1,t)},G:function(e,t,n){return o(b.h(e,t,n))},H:function(e){return o(e.getHours())},J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:function(e,t){return t.amPM[i(e.getHours()>11)]},M:function(e,t){return h(e.getMonth(),!0,t)},S:function(e){return o(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,t,n){return n.getWeek(e)},Y:function(e){return o(e.getFullYear(),4)},d:function(e){return o(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return o(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:function(e){return o(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},_=function(e){var t=e.config,n=void 0===t?a:t,o=e.l10n,i=void 0===o?r:o,l=e.isMobile,s=void 0!==l&&l;return function(e,t,a){var r=a||i;return void 0===n.formatDate||s?t.split("").map(function(t,a,o){return b[t]&&"\\"!==o[a-1]?b[t](e,r,n):"\\"!==t?t:""}).join(""):n.formatDate(e,t,r)}},w=function(e){var t=e.config,n=void 0===t?a:t,o=e.l10n,i=void 0===o?r:o;return function(e,t,r,o){if(0===e||e){var l,s=o||i,c=e;if(e instanceof Date)l=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)l=new Date(e);else if("string"==typeof e){var u=t||(n||a).dateFormat,d=String(e).trim();if("today"===d)l=new Date,r=!0;else if(n&&n.parseDate)l=n.parseDate(e,u);else if(/Z$/.test(d)||/GMT$/.test(d))l=new Date(e);else{for(var g=void 0,m=[],p=0,f=0,h="";p<u.length;p++){var b=u[p],_="\\"===b,w="\\"===u[p-1]||_;if(v[b]&&!w){h+=v[b];var D=new RegExp(h).exec(e);D&&(g=!0)&&m["Y"!==b?"push":"unshift"]({fn:y[b],val:D[++f]})}else _||(h+=".")}l=n&&n.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),m.forEach(function(e){var t=e.fn,n=e.val;return l=t(l,n,s)||l}),l=g?l:void 0}}if(l instanceof Date&&!isNaN(l.getTime()))return!0===r&&l.setHours(0,0,0,0),l;n.errorHandler(new Error("Invalid date provided: "+c))}}};function D(e,t,n){return void 0===n&&(n=!0),!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}var E=function(e,t,n){return 3600*e+60*t+n},x=864e5;function C(e){var t=e.defaultHour,n=e.defaultMinute,a=e.defaultSeconds;if(void 0!==e.minDate){var r=e.minDate.getHours(),o=e.minDate.getMinutes(),i=e.minDate.getSeconds();t<r&&(t=r),t===r&&n<o&&(n=o),t===r&&n===o&&a<i&&(a=e.minDate.getSeconds())}if(void 0!==e.maxDate){var l=e.maxDate.getHours(),s=e.maxDate.getMinutes();(t=Math.min(t,l))===l&&(n=Math.min(s,n)),t===l&&n===s&&(a=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:a}}function M(f,y){var b={config:e(e({},a),k.defaultConfig),l10n:r};function M(){var e;return(null===(e=b.calendarContainer)||void 0===e?void 0:e.getRootNode()).activeElement||document.activeElement}function L(e){return e.bind(b)}function T(){var e=b.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame(function(){if(void 0!==b.calendarContainer&&(b.calendarContainer.style.visibility="hidden",b.calendarContainer.style.display="block"),void 0!==b.daysContainer){var t=(b.days.offsetWidth+1)*e.showMonths;b.daysContainer.style.width=t+"px",b.calendarContainer.style.width=t+(void 0!==b.weekWrapper?b.weekWrapper.offsetWidth:0)+"px",b.calendarContainer.style.removeProperty("visibility"),b.calendarContainer.style.removeProperty("display")}})}function I(e){if(0===b.selectedDates.length){var t=void 0===b.config.minDate||D(new Date,b.config.minDate)>=0?new Date:new Date(b.config.minDate.getTime()),n=C(b.config);t.setHours(n.hours,n.minutes,n.seconds,t.getMilliseconds()),b.selectedDates=[t],b.latestSelectedDateObj=t}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();var t="keydown"===e.type,n=p(e),a=n;void 0!==b.amPM&&n===b.amPM&&(b.amPM.textContent=b.l10n.amPM[i(b.amPM.textContent===b.l10n.amPM[0])]);var r=parseFloat(a.getAttribute("min")),l=parseFloat(a.getAttribute("max")),s=parseFloat(a.getAttribute("step")),c=parseInt(a.value,10),u=e.delta||(t?38===e.which?1:-1:0),d=c+s*u;if(void 0!==a.value&&2===a.value.length){var g=a===b.hourElement,m=a===b.minuteElement;d<r?(d=l+d+i(!g)+(i(g)&&i(!b.amPM)),m&&H(void 0,-1,b.hourElement)):d>l&&(d=a===b.hourElement?d-l-i(!b.amPM):r,m&&H(void 0,1,b.hourElement)),b.amPM&&g&&(1===s?d+c===23:Math.abs(d-c)>s)&&(b.amPM.textContent=b.l10n.amPM[i(b.amPM.textContent===b.l10n.amPM[0])]),a.value=o(d)}}(e);var a=b._input.value;S(),Ee(),b._input.value!==a&&b._debouncedChange()}function S(){if(void 0!==b.hourElement&&void 0!==b.minuteElement){var e,t,n=(parseInt(b.hourElement.value.slice(-2),10)||0)%24,a=(parseInt(b.minuteElement.value,10)||0)%60,r=void 0!==b.secondElement?(parseInt(b.secondElement.value,10)||0)%60:0;void 0!==b.amPM&&(e=n,t=b.amPM.textContent,n=e%12+12*i(t===b.l10n.amPM[1]));var o=void 0!==b.config.minTime||b.config.minDate&&b.minDateHasTime&&b.latestSelectedDateObj&&0===D(b.latestSelectedDateObj,b.config.minDate,!0),l=void 0!==b.config.maxTime||b.config.maxDate&&b.maxDateHasTime&&b.latestSelectedDateObj&&0===D(b.latestSelectedDateObj,b.config.maxDate,!0);if(void 0!==b.config.maxTime&&void 0!==b.config.minTime&&b.config.minTime>b.config.maxTime){var s=E(b.config.minTime.getHours(),b.config.minTime.getMinutes(),b.config.minTime.getSeconds()),c=E(b.config.maxTime.getHours(),b.config.maxTime.getMinutes(),b.config.maxTime.getSeconds()),u=E(n,a,r);if(u>c&&u<s){var d=function(e){var t=Math.floor(e/3600),n=(e-3600*t)/60;return[t,n,e-3600*t-60*n]}(s);n=d[0],a=d[1],r=d[2]}}else{if(l){var g=void 0!==b.config.maxTime?b.config.maxTime:b.config.maxDate;(n=Math.min(n,g.getHours()))===g.getHours()&&(a=Math.min(a,g.getMinutes())),a===g.getMinutes()&&(r=Math.min(r,g.getSeconds()))}if(o){var m=void 0!==b.config.minTime?b.config.minTime:b.config.minDate;(n=Math.max(n,m.getHours()))===m.getHours()&&a<m.getMinutes()&&(a=m.getMinutes()),a===m.getMinutes()&&(r=Math.max(r,m.getSeconds()))}}N(n,a,r)}}function A(e){var t=e||b.latestSelectedDateObj;t&&t instanceof Date&&N(t.getHours(),t.getMinutes(),t.getSeconds())}function N(e,t,n){void 0!==b.latestSelectedDateObj&&b.latestSelectedDateObj.setHours(e%24,t,n||0,0),b.hourElement&&b.minuteElement&&!b.isMobile&&(b.hourElement.value=o(b.config.time_24hr?e:(12+e)%12+12*i(e%12==0)),b.minuteElement.value=o(t),void 0!==b.amPM&&(b.amPM.textContent=b.l10n.amPM[i(e>=12)]),void 0!==b.secondElement&&(b.secondElement.value=o(n)))}function O(e){var t=p(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&ee(n)}function j(e,t,n,a){return t instanceof Array?t.forEach(function(t){return j(e,t,n,a)}):e instanceof Array?e.forEach(function(e){return j(e,t,n,a)}):(e.addEventListener(t,n,a),void b._handlers.push({remove:function(){return e.removeEventListener(t,n,a)}}))}function F(){ve("onChange")}function B(e,t){var n=void 0!==e?b.parseDate(e):b.latestSelectedDateObj||(b.config.minDate&&b.config.minDate>b.now?b.config.minDate:b.config.maxDate&&b.config.maxDate<b.now?b.config.maxDate:b.now),a=b.currentYear,r=b.currentMonth;try{void 0!==n&&(b.currentYear=n.getFullYear(),b.currentMonth=n.getMonth())}catch(e){e.message="Invalid date supplied: "+n,b.config.errorHandler(e)}t&&b.currentYear!==a&&(ve("onYearChange"),J()),!t||b.currentYear===a&&b.currentMonth===r||ve("onMonthChange"),b.redraw()}function P(e){var t=p(e);~t.className.indexOf("arrow")&&H(e,t.classList.contains("arrowUp")?1:-1)}function H(e,t,n){var a=e&&p(e),r=n||a&&a.parentNode&&a.parentNode.firstChild,o=be("increment");o.delta=t,r&&r.dispatchEvent(o)}function R(e,t,n,a){var r=te(t,!0),o=u("span",e,t.getDate().toString());return o.dateObj=t,o.$i=a,o.setAttribute("aria-label",b.formatDate(t,b.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===D(t,b.now)&&(b.todayDateElem=o,o.classList.add("today"),o.setAttribute("aria-current","date")),r?(o.tabIndex=-1,_e(t)&&(o.classList.add("selected"),b.selectedDateElem=o,"range"===b.config.mode&&(c(o,"startRange",b.selectedDates[0]&&0===D(t,b.selectedDates[0],!0)),c(o,"endRange",b.selectedDates[1]&&0===D(t,b.selectedDates[1],!0)),"nextMonthDay"===e&&o.classList.add("inRange")))):o.classList.add("flatpickr-disabled"),"range"===b.config.mode&&function(e){return!("range"!==b.config.mode||b.selectedDates.length<2)&&(D(e,b.selectedDates[0])>=0&&D(e,b.selectedDates[1])<=0)}(t)&&!_e(t)&&o.classList.add("inRange"),b.weekNumbers&&1===b.config.showMonths&&"prevMonthDay"!==e&&a%7==6&&b.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+b.config.getWeek(t)+"</span>"),ve("onDayCreate",o),o}function Y(e){e.focus(),"range"===b.config.mode&&oe(e)}function W(e){for(var t=e>0?0:b.config.showMonths-1,n=e>0?b.config.showMonths:-1,a=t;a!=n;a+=e)for(var r=b.daysContainer.children[a],o=e>0?0:r.children.length-1,i=e>0?r.children.length:-1,l=o;l!=i;l+=e){var s=r.children[l];if(-1===s.className.indexOf("hidden")&&te(s.dateObj))return s}}function $(e,t){var n=M(),a=ne(n||document.body),r=void 0!==e?e:a?n:void 0!==b.selectedDateElem&&ne(b.selectedDateElem)?b.selectedDateElem:void 0!==b.todayDateElem&&ne(b.todayDateElem)?b.todayDateElem:W(t>0?1:-1);void 0===r?b._input.focus():a?function(e,t){for(var n=-1===e.className.indexOf("Month")?e.dateObj.getMonth():b.currentMonth,a=t>0?b.config.showMonths:-1,r=t>0?1:-1,o=n-b.currentMonth;o!=a;o+=r)for(var i=b.daysContainer.children[o],l=n-b.currentMonth===o?e.$i+t:t<0?i.children.length-1:0,s=i.children.length,c=l;c>=0&&c<s&&c!=(t>0?s:-1);c+=r){var u=i.children[c];if(-1===u.className.indexOf("hidden")&&te(u.dateObj)&&Math.abs(e.$i-c)>=Math.abs(t))return Y(u)}b.changeMonth(r),$(W(r),0)}(r,t):Y(r)}function q(e,t){for(var n=(new Date(e,t,1).getDay()-b.l10n.firstDayOfWeek+7)%7,a=b.utils.getDaysInMonth((t-1+12)%12,e),r=b.utils.getDaysInMonth(t,e),o=window.document.createDocumentFragment(),i=b.config.showMonths>1,l=i?"prevMonthDay hidden":"prevMonthDay",s=i?"nextMonthDay hidden":"nextMonthDay",c=a+1-n,d=0;c<=a;c++,d++)o.appendChild(R("flatpickr-day "+l,new Date(e,t-1,c),0,d));for(c=1;c<=r;c++,d++)o.appendChild(R("flatpickr-day",new Date(e,t,c),0,d));for(var g=r+1;g<=42-n&&(1===b.config.showMonths||d%7!=0);g++,d++)o.appendChild(R("flatpickr-day "+s,new Date(e,t+1,g%r),0,d));var m=u("div","dayContainer");return m.appendChild(o),m}function z(){if(void 0!==b.daysContainer){d(b.daysContainer),b.weekNumbers&&d(b.weekNumbers);for(var e=document.createDocumentFragment(),t=0;t<b.config.showMonths;t++){var n=new Date(b.currentYear,b.currentMonth,1);n.setMonth(b.currentMonth+t),e.appendChild(q(n.getFullYear(),n.getMonth()))}b.daysContainer.appendChild(e),b.days=b.daysContainer.firstChild,"range"===b.config.mode&&1===b.selectedDates.length&&oe()}}function J(){if(!(b.config.showMonths>1||"dropdown"!==b.config.monthSelectorType)){var e=function(e){return!(void 0!==b.config.minDate&&b.currentYear===b.config.minDate.getFullYear()&&e<b.config.minDate.getMonth())&&!(void 0!==b.config.maxDate&&b.currentYear===b.config.maxDate.getFullYear()&&e>b.config.maxDate.getMonth())};b.monthsDropdownContainer.tabIndex=-1,b.monthsDropdownContainer.innerHTML="";for(var t=0;t<12;t++)if(e(t)){var n=u("option","flatpickr-monthDropdown-month");n.value=new Date(b.currentYear,t).getMonth().toString(),n.textContent=h(t,b.config.shorthandCurrentMonth,b.l10n),n.tabIndex=-1,b.currentMonth===t&&(n.selected=!0),b.monthsDropdownContainer.appendChild(n)}}}function G(){var e,t=u("div","flatpickr-month"),n=window.document.createDocumentFragment();b.config.showMonths>1||"static"===b.config.monthSelectorType?e=u("span","cur-month"):(b.monthsDropdownContainer=u("select","flatpickr-monthDropdown-months"),b.monthsDropdownContainer.setAttribute("aria-label",b.l10n.monthAriaLabel),j(b.monthsDropdownContainer,"change",function(e){var t=p(e),n=parseInt(t.value,10);b.changeMonth(n-b.currentMonth),ve("onMonthChange")}),J(),e=b.monthsDropdownContainer);var a=m("cur-year",{tabindex:"-1"}),r=a.getElementsByTagName("input")[0];r.setAttribute("aria-label",b.l10n.yearAriaLabel),b.config.minDate&&r.setAttribute("min",b.config.minDate.getFullYear().toString()),b.config.maxDate&&(r.setAttribute("max",b.config.maxDate.getFullYear().toString()),r.disabled=!!b.config.minDate&&b.config.minDate.getFullYear()===b.config.maxDate.getFullYear());var o=u("div","flatpickr-current-month");return o.appendChild(e),o.appendChild(a),n.appendChild(o),t.appendChild(n),{container:t,yearElement:r,monthElement:e}}function U(){d(b.monthNav),b.monthNav.appendChild(b.prevMonthNav),b.config.showMonths&&(b.yearElements=[],b.monthElements=[]);for(var e=b.config.showMonths;e--;){var t=G();b.yearElements.push(t.yearElement),b.monthElements.push(t.monthElement),b.monthNav.appendChild(t.container)}b.monthNav.appendChild(b.nextMonthNav)}function V(){b.weekdayContainer?d(b.weekdayContainer):b.weekdayContainer=u("div","flatpickr-weekdays");for(var e=b.config.showMonths;e--;){var t=u("div","flatpickr-weekdaycontainer");b.weekdayContainer.appendChild(t)}return X(),b.weekdayContainer}function X(){if(b.weekdayContainer){var e=b.l10n.firstDayOfWeek,n=t(b.l10n.weekdays.shorthand);e>0&&e<n.length&&(n=t(n.splice(e,n.length),n.splice(0,e)));for(var a=b.config.showMonths;a--;)b.weekdayContainer.children[a].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+n.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function K(e,t){void 0===t&&(t=!0);var n=t?e:e-b.currentMonth;n<0&&!0===b._hidePrevMonthArrow||n>0&&!0===b._hideNextMonthArrow||(b.currentMonth+=n,(b.currentMonth<0||b.currentMonth>11)&&(b.currentYear+=b.currentMonth>11?1:-1,b.currentMonth=(b.currentMonth+12)%12,ve("onYearChange"),J()),z(),ve("onMonthChange"),we())}function Z(e){return b.calendarContainer.contains(e)}function Q(e){if(b.isOpen&&!b.config.inline){var t=p(e),n=Z(t),a=!(t===b.input||t===b.altInput||b.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(b.input)||~e.path.indexOf(b.altInput)))&&!n&&!Z(e.relatedTarget),r=!b.config.ignoredFocusElements.some(function(e){return e.contains(t)});a&&r&&(b.config.allowInput&&b.setDate(b._input.value,!1,b.config.altInput?b.config.altFormat:b.config.dateFormat),void 0!==b.timeContainer&&void 0!==b.minuteElement&&void 0!==b.hourElement&&""!==b.input.value&&void 0!==b.input.value&&I(),b.close(),b.config&&"range"===b.config.mode&&1===b.selectedDates.length&&b.clear(!1))}}function ee(e){if(!(!e||b.config.minDate&&e<b.config.minDate.getFullYear()||b.config.maxDate&&e>b.config.maxDate.getFullYear())){var t=e,n=b.currentYear!==t;b.currentYear=t||b.currentYear,b.config.maxDate&&b.currentYear===b.config.maxDate.getFullYear()?b.currentMonth=Math.min(b.config.maxDate.getMonth(),b.currentMonth):b.config.minDate&&b.currentYear===b.config.minDate.getFullYear()&&(b.currentMonth=Math.max(b.config.minDate.getMonth(),b.currentMonth)),n&&(b.redraw(),ve("onYearChange"),J())}}function te(e,t){var n;void 0===t&&(t=!0);var a=b.parseDate(e,void 0,t);if(b.config.minDate&&a&&D(a,b.config.minDate,void 0!==t?t:!b.minDateHasTime)<0||b.config.maxDate&&a&&D(a,b.config.maxDate,void 0!==t?t:!b.maxDateHasTime)>0)return!1;if(!b.config.enable&&0===b.config.disable.length)return!0;if(void 0===a)return!1;for(var r=!!b.config.enable,o=null!==(n=b.config.enable)&&void 0!==n?n:b.config.disable,i=0,l=void 0;i<o.length;i++){if("function"==typeof(l=o[i])&&l(a))return r;if(l instanceof Date&&void 0!==a&&l.getTime()===a.getTime())return r;if("string"==typeof l){var s=b.parseDate(l,void 0,!0);return s&&s.getTime()===a.getTime()?r:!r}if("object"==typeof l&&void 0!==a&&l.from&&l.to&&a.getTime()>=l.from.getTime()&&a.getTime()<=l.to.getTime())return r}return!r}function ne(e){return void 0!==b.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&b.daysContainer.contains(e))}function ae(e){var t=e.target===b._input,n=b._input.value.trimEnd()!==De();!t||!n||e.relatedTarget&&Z(e.relatedTarget)||b.setDate(b._input.value,!0,e.target===b.altInput?b.config.altFormat:b.config.dateFormat)}function re(e){var t=p(e),n=b.config.wrap?f.contains(t):t===b._input,a=b.config.allowInput,r=b.isOpen&&(!a||!n),o=b.config.inline&&n&&!a;if(13===e.keyCode&&n){if(a)return b.setDate(b._input.value,!0,t===b.altInput?b.config.altFormat:b.config.dateFormat),b.close(),t.blur();b.open()}else if(Z(t)||r||o){var i=!!b.timeContainer&&b.timeContainer.contains(t);switch(e.keyCode){case 13:i?(e.preventDefault(),I(),ge()):me(e);break;case 27:e.preventDefault(),ge();break;case 8:case 46:n&&!b.config.allowInput&&(e.preventDefault(),b.clear());break;case 37:case 39:if(i||n)b.hourElement&&b.hourElement.focus();else{e.preventDefault();var l=M();if(void 0!==b.daysContainer&&(!1===a||l&&ne(l))){var s=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),K(s),$(W(1),0)):$(void 0,s)}}break;case 38:case 40:e.preventDefault();var c=40===e.keyCode?1:-1;b.daysContainer&&void 0!==t.$i||t===b.input||t===b.altInput?e.ctrlKey?(e.stopPropagation(),ee(b.currentYear-c),$(W(1),0)):i||$(void 0,7*c):t===b.currentYearElement?ee(b.currentYear-c):b.config.enableTime&&(!i&&b.hourElement&&b.hourElement.focus(),I(e),b._debouncedChange());break;case 9:if(i){var u=[b.hourElement,b.minuteElement,b.secondElement,b.amPM].concat(b.pluginElements).filter(function(e){return e}),d=u.indexOf(t);if(-1!==d){var g=u[d+(e.shiftKey?-1:1)];e.preventDefault(),(g||b._input).focus()}}else!b.config.noCalendar&&b.daysContainer&&b.daysContainer.contains(t)&&e.shiftKey&&(e.preventDefault(),b._input.focus())}}if(void 0!==b.amPM&&t===b.amPM)switch(e.key){case b.l10n.amPM[0].charAt(0):case b.l10n.amPM[0].charAt(0).toLowerCase():b.amPM.textContent=b.l10n.amPM[0],S(),Ee();break;case b.l10n.amPM[1].charAt(0):case b.l10n.amPM[1].charAt(0).toLowerCase():b.amPM.textContent=b.l10n.amPM[1],S(),Ee()}(n||Z(t))&&ve("onKeyDown",e)}function oe(e,t){if(void 0===t&&(t="flatpickr-day"),1===b.selectedDates.length&&(!e||e.classList.contains(t)&&!e.classList.contains("flatpickr-disabled"))){for(var n=e?e.dateObj.getTime():b.days.firstElementChild.dateObj.getTime(),a=b.parseDate(b.selectedDates[0],void 0,!0).getTime(),r=Math.min(n,b.selectedDates[0].getTime()),o=Math.max(n,b.selectedDates[0].getTime()),i=!1,l=0,s=0,c=r;c<o;c+=x)te(new Date(c),!0)||(i=i||c>r&&c<o,c<a&&(!l||c>l)?l=c:c>a&&(!s||c<s)&&(s=c));Array.from(b.rContainer.querySelectorAll("*:nth-child(-n+"+b.config.showMonths+") > ."+t)).forEach(function(t){var r,o,c,u=t.dateObj.getTime(),d=l>0&&u<l||s>0&&u>s;if(d)return t.classList.add("notAllowed"),void["inRange","startRange","endRange"].forEach(function(e){t.classList.remove(e)});i&&!d||(["startRange","inRange","endRange","notAllowed"].forEach(function(e){t.classList.remove(e)}),void 0!==e&&(e.classList.add(n<=b.selectedDates[0].getTime()?"startRange":"endRange"),a<n&&u===a?t.classList.add("startRange"):a>n&&u===a&&t.classList.add("endRange"),u>=l&&(0===s||u<=s)&&(o=a,c=n,(r=u)>Math.min(o,c)&&r<Math.max(o,c))&&t.classList.add("inRange")))})}}function ie(){!b.isOpen||b.config.static||b.config.inline||ue()}function le(e){return function(t){var n=b.config["_"+e+"Date"]=b.parseDate(t,b.config.dateFormat),a=b.config["_"+("min"===e?"max":"min")+"Date"];void 0!==n&&(b["min"===e?"minDateHasTime":"maxDateHasTime"]=n.getHours()>0||n.getMinutes()>0||n.getSeconds()>0),b.selectedDates&&(b.selectedDates=b.selectedDates.filter(function(e){return te(e)}),b.selectedDates.length||"min"!==e||A(n),Ee()),b.daysContainer&&(de(),void 0!==n?b.currentYearElement[e]=n.getFullYear().toString():b.currentYearElement.removeAttribute(e),b.currentYearElement.disabled=!!a&&void 0!==n&&a.getFullYear()===n.getFullYear())}}function se(){return b.config.wrap?f.querySelector("[data-input]"):f}function ce(){"object"!=typeof b.config.locale&&void 0===k.l10ns[b.config.locale]&&b.config.errorHandler(new Error("flatpickr: invalid locale "+b.config.locale)),b.l10n=e(e({},k.l10ns.default),"object"==typeof b.config.locale?b.config.locale:"default"!==b.config.locale?k.l10ns[b.config.locale]:void 0),v.D="("+b.l10n.weekdays.shorthand.join("|")+")",v.l="("+b.l10n.weekdays.longhand.join("|")+")",v.M="("+b.l10n.months.shorthand.join("|")+")",v.F="("+b.l10n.months.longhand.join("|")+")",v.K="("+b.l10n.amPM[0]+"|"+b.l10n.amPM[1]+"|"+b.l10n.amPM[0].toLowerCase()+"|"+b.l10n.amPM[1].toLowerCase()+")",void 0===e(e({},y),JSON.parse(JSON.stringify(f.dataset||{}))).time_24hr&&void 0===k.defaultConfig.time_24hr&&(b.config.time_24hr=b.l10n.time_24hr),b.formatDate=_(b),b.parseDate=w({config:b.config,l10n:b.l10n})}function ue(e){if("function"!=typeof b.config.position){if(void 0!==b.calendarContainer){ve("onPreCalendarPosition");var t=e||b._positionElement,n=Array.prototype.reduce.call(b.calendarContainer.children,function(e,t){return e+t.offsetHeight},0),a=b.calendarContainer.offsetWidth,r=b.config.position.split(" "),o=r[0],i=r.length>1?r[1]:null,l=t.getBoundingClientRect(),s=window.innerHeight-l.bottom,u="above"===o||"below"!==o&&s<n&&l.top>n,d=window.pageYOffset+l.top+(u?-n-2:t.offsetHeight+2);if(c(b.calendarContainer,"arrowTop",!u),c(b.calendarContainer,"arrowBottom",u),!b.config.inline){var g=window.pageXOffset+l.left,m=!1,p=!1;"center"===i?(g-=(a-l.width)/2,m=!0):"right"===i&&(g-=a-l.width,p=!0),c(b.calendarContainer,"arrowLeft",!m&&!p),c(b.calendarContainer,"arrowCenter",m),c(b.calendarContainer,"arrowRight",p);var f=window.document.body.offsetWidth-(window.pageXOffset+l.right),h=g+a>window.document.body.offsetWidth,y=f+a>window.document.body.offsetWidth;if(c(b.calendarContainer,"rightMost",h),!b.config.static)if(b.calendarContainer.style.top=d+"px",h)if(y){var v=function(){for(var e=null,t=0;t<document.styleSheets.length;t++){var n=document.styleSheets[t];if(n.cssRules){try{n.cssRules}catch(e){continue}e=n;break}}return null!=e?e:(a=document.createElement("style"),document.head.appendChild(a),a.sheet);var a}();if(void 0===v)return;var _=window.document.body.offsetWidth,w=Math.max(0,_/2-a/2),D=v.cssRules.length,E="{left:"+l.left+"px;right:auto;}";c(b.calendarContainer,"rightMost",!1),c(b.calendarContainer,"centerMost",!0),v.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+E,D),b.calendarContainer.style.left=w+"px",b.calendarContainer.style.right="auto"}else b.calendarContainer.style.left="auto",b.calendarContainer.style.right=f+"px";else b.calendarContainer.style.left=g+"px",b.calendarContainer.style.right="auto"}}}else b.config.position(b,e)}function de(){b.config.noCalendar||b.isMobile||(J(),we(),z())}function ge(){b._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(b.close,0):b.close()}function me(e){e.preventDefault(),e.stopPropagation();var t=g(p(e),function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")});if(void 0!==t){var n=t,a=b.latestSelectedDateObj=new Date(n.dateObj.getTime()),r=(a.getMonth()<b.currentMonth||a.getMonth()>b.currentMonth+b.config.showMonths-1)&&"range"!==b.config.mode;if(b.selectedDateElem=n,"single"===b.config.mode)b.selectedDates=[a];else if("multiple"===b.config.mode){var o=_e(a);o?b.selectedDates.splice(parseInt(o),1):b.selectedDates.push(a)}else"range"===b.config.mode&&(2===b.selectedDates.length&&b.clear(!1,!1),b.latestSelectedDateObj=a,b.selectedDates.push(a),0!==D(a,b.selectedDates[0],!0)&&b.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()}));if(S(),r){var i=b.currentYear!==a.getFullYear();b.currentYear=a.getFullYear(),b.currentMonth=a.getMonth(),i&&(ve("onYearChange"),J()),ve("onMonthChange")}if(we(),z(),Ee(),r||"range"===b.config.mode||1!==b.config.showMonths?void 0!==b.selectedDateElem&&void 0===b.hourElement&&b.selectedDateElem&&b.selectedDateElem.focus():Y(n),void 0!==b.hourElement&&void 0!==b.hourElement&&b.hourElement.focus(),b.config.closeOnSelect){var l="single"===b.config.mode&&!b.config.enableTime,s="range"===b.config.mode&&2===b.selectedDates.length&&!b.config.enableTime;(l||s)&&ge()}F()}}b.parseDate=w({config:b.config,l10n:b.l10n}),b._handlers=[],b.pluginElements=[],b.loadedPlugins=[],b._bind=j,b._setHoursFromDate=A,b._positionCalendar=ue,b.changeMonth=K,b.changeYear=ee,b.clear=function(e,t){void 0===e&&(e=!0);void 0===t&&(t=!0);b.input.value="",void 0!==b.altInput&&(b.altInput.value="");void 0!==b.mobileInput&&(b.mobileInput.value="");b.selectedDates=[],b.latestSelectedDateObj=void 0,!0===t&&(b.currentYear=b._initialDate.getFullYear(),b.currentMonth=b._initialDate.getMonth());if(!0===b.config.enableTime){var n=C(b.config);N(n.hours,n.minutes,n.seconds)}b.redraw(),e&&ve("onChange")},b.close=function(){b.isOpen=!1,b.isMobile||(void 0!==b.calendarContainer&&b.calendarContainer.classList.remove("open"),void 0!==b._input&&b._input.classList.remove("active"));ve("onClose")},b.onMouseOver=oe,b._createElement=u,b.createDay=R,b.destroy=function(){void 0!==b.config&&ve("onDestroy");for(var e=b._handlers.length;e--;)b._handlers[e].remove();if(b._handlers=[],b.mobileInput)b.mobileInput.parentNode&&b.mobileInput.parentNode.removeChild(b.mobileInput),b.mobileInput=void 0;else if(b.calendarContainer&&b.calendarContainer.parentNode)if(b.config.static&&b.calendarContainer.parentNode){var t=b.calendarContainer.parentNode;if(t.lastChild&&t.removeChild(t.lastChild),t.parentNode){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}}else b.calendarContainer.parentNode.removeChild(b.calendarContainer);b.altInput&&(b.input.type="text",b.altInput.parentNode&&b.altInput.parentNode.removeChild(b.altInput),delete b.altInput);b.input&&(b.input.type=b.input._type,b.input.classList.remove("flatpickr-input"),b.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(e){try{delete b[e]}catch(e){}})},b.isEnabled=te,b.jumpToDate=B,b.updateValue=Ee,b.open=function(e,t){void 0===t&&(t=b._positionElement);if(!0===b.isMobile){if(e){e.preventDefault();var n=p(e);n&&n.blur()}return void 0!==b.mobileInput&&(b.mobileInput.focus(),b.mobileInput.click()),void ve("onOpen")}if(b._input.disabled||b.config.inline)return;var a=b.isOpen;b.isOpen=!0,a||(b.calendarContainer.classList.add("open"),b._input.classList.add("active"),ve("onOpen"),ue(t));!0===b.config.enableTime&&!0===b.config.noCalendar&&(!1!==b.config.allowInput||void 0!==e&&b.timeContainer.contains(e.relatedTarget)||setTimeout(function(){return b.hourElement.select()},50))},b.redraw=de,b.set=function(e,t){if(null!==e&&"object"==typeof e)for(var a in Object.assign(b.config,e),e)void 0!==pe[a]&&pe[a].forEach(function(e){return e()});else b.config[e]=t,void 0!==pe[e]?pe[e].forEach(function(e){return e()}):n.indexOf(e)>-1&&(b.config[e]=s(t));b.redraw(),Ee(!0)},b.setDate=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=b.config.dateFormat);if(0!==e&&!e||e instanceof Array&&0===e.length)return b.clear(t);fe(e,n),b.latestSelectedDateObj=b.selectedDates[b.selectedDates.length-1],b.redraw(),B(void 0,t),A(),0===b.selectedDates.length&&b.clear(!1);Ee(t),t&&ve("onChange")},b.toggle=function(e){if(!0===b.isOpen)return b.close();b.open(e)};var pe={locale:[ce,X],showMonths:[U,T,V],minDate:[B],maxDate:[B],positionElement:[ye],clickOpens:[function(){!0===b.config.clickOpens?(j(b._input,"focus",b.open),j(b._input,"click",b.open)):(b._input.removeEventListener("focus",b.open),b._input.removeEventListener("click",b.open))}]};function fe(e,t){var n=[];if(e instanceof Array)n=e.map(function(e){return b.parseDate(e,t)});else if(e instanceof Date||"number"==typeof e)n=[b.parseDate(e,t)];else if("string"==typeof e)switch(b.config.mode){case"single":case"time":n=[b.parseDate(e,t)];break;case"multiple":n=e.split(b.config.conjunction).map(function(e){return b.parseDate(e,t)});break;case"range":n=e.split(b.l10n.rangeSeparator).map(function(e){return b.parseDate(e,t)})}else b.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));b.selectedDates=b.config.allowInvalidPreload?n:n.filter(function(e){return e instanceof Date&&te(e,!1)}),"range"===b.config.mode&&b.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()})}function he(e){return e.slice().map(function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?b.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:b.parseDate(e.from,void 0),to:b.parseDate(e.to,void 0)}:e}).filter(function(e){return e})}function ye(){b._positionElement=b.config.positionElement||b._input}function ve(e,t){if(void 0!==b.config){var n=b.config[e];if(void 0!==n&&n.length>0)for(var a=0;n[a]&&a<n.length;a++)n[a](b.selectedDates,b.input.value,b,t);"onChange"===e&&(b.input.dispatchEvent(be("change")),b.input.dispatchEvent(be("input")))}}function be(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function _e(e){for(var t=0;t<b.selectedDates.length;t++){var n=b.selectedDates[t];if(n instanceof Date&&0===D(n,e))return""+t}return!1}function we(){b.config.noCalendar||b.isMobile||!b.monthNav||(b.yearElements.forEach(function(e,t){var n=new Date(b.currentYear,b.currentMonth,1);n.setMonth(b.currentMonth+t),b.config.showMonths>1||"static"===b.config.monthSelectorType?b.monthElements[t].textContent=h(n.getMonth(),b.config.shorthandCurrentMonth,b.l10n)+" ":b.monthsDropdownContainer.value=n.getMonth().toString(),e.value=n.getFullYear().toString()}),b._hidePrevMonthArrow=void 0!==b.config.minDate&&(b.currentYear===b.config.minDate.getFullYear()?b.currentMonth<=b.config.minDate.getMonth():b.currentYear<b.config.minDate.getFullYear()),b._hideNextMonthArrow=void 0!==b.config.maxDate&&(b.currentYear===b.config.maxDate.getFullYear()?b.currentMonth+1>b.config.maxDate.getMonth():b.currentYear>b.config.maxDate.getFullYear()))}function De(e){var t=e||(b.config.altInput?b.config.altFormat:b.config.dateFormat);return b.selectedDates.map(function(e){return b.formatDate(e,t)}).filter(function(e,t,n){return"range"!==b.config.mode||b.config.enableTime||n.indexOf(e)===t}).join("range"!==b.config.mode?b.config.conjunction:b.l10n.rangeSeparator)}function Ee(e){void 0===e&&(e=!0),void 0!==b.mobileInput&&b.mobileFormatStr&&(b.mobileInput.value=void 0!==b.latestSelectedDateObj?b.formatDate(b.latestSelectedDateObj,b.mobileFormatStr):""),b.input.value=De(b.config.dateFormat),void 0!==b.altInput&&(b.altInput.value=De(b.config.altFormat)),!1!==e&&ve("onValueUpdate")}function xe(e){var t=p(e),n=b.prevMonthNav.contains(t),a=b.nextMonthNav.contains(t);n||a?K(n?-1:1):b.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?b.changeYear(b.currentYear+1):t.classList.contains("arrowDown")&&b.changeYear(b.currentYear-1)}return function(){b.element=b.input=f,b.isOpen=!1,function(){var t=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],r=e(e({},JSON.parse(JSON.stringify(f.dataset||{}))),y),o={};b.config.parseDate=r.parseDate,b.config.formatDate=r.formatDate,Object.defineProperty(b.config,"enable",{get:function(){return b.config._enable},set:function(e){b.config._enable=he(e)}}),Object.defineProperty(b.config,"disable",{get:function(){return b.config._disable},set:function(e){b.config._disable=he(e)}});var i="time"===r.mode;if(!r.dateFormat&&(r.enableTime||i)){var l=k.defaultConfig.dateFormat||a.dateFormat;o.dateFormat=r.noCalendar||i?"H:i"+(r.enableSeconds?":S":""):l+" H:i"+(r.enableSeconds?":S":"")}if(r.altInput&&(r.enableTime||i)&&!r.altFormat){var c=k.defaultConfig.altFormat||a.altFormat;o.altFormat=r.noCalendar||i?"h:i"+(r.enableSeconds?":S K":" K"):c+" h:i"+(r.enableSeconds?":S":"")+" K"}Object.defineProperty(b.config,"minDate",{get:function(){return b.config._minDate},set:le("min")}),Object.defineProperty(b.config,"maxDate",{get:function(){return b.config._maxDate},set:le("max")});var u=function(e){return function(t){b.config["min"===e?"_minTime":"_maxTime"]=b.parseDate(t,"H:i:S")}};Object.defineProperty(b.config,"minTime",{get:function(){return b.config._minTime},set:u("min")}),Object.defineProperty(b.config,"maxTime",{get:function(){return b.config._maxTime},set:u("max")}),"time"===r.mode&&(b.config.noCalendar=!0,b.config.enableTime=!0);Object.assign(b.config,o,r);for(var d=0;d<t.length;d++)b.config[t[d]]=!0===b.config[t[d]]||"true"===b.config[t[d]];n.filter(function(e){return void 0!==b.config[e]}).forEach(function(e){b.config[e]=s(b.config[e]||[]).map(L)}),b.isMobile=!b.config.disableMobile&&!b.config.inline&&"single"===b.config.mode&&!b.config.disable.length&&!b.config.enable&&!b.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(d=0;d<b.config.plugins.length;d++){var g=b.config.plugins[d](b)||{};for(var m in g)n.indexOf(m)>-1?b.config[m]=s(g[m]).map(L).concat(b.config[m]):void 0===r[m]&&(b.config[m]=g[m])}r.altInputClass||(b.config.altInputClass=se().className+" "+b.config.altInputClass);ve("onParseConfig")}(),ce(),function(){if(b.input=se(),!b.input)return void b.config.errorHandler(new Error("Invalid input element specified"));b.input._type=b.input.type,b.input.type="text",b.input.classList.add("flatpickr-input"),b._input=b.input,b.config.altInput&&(b.altInput=u(b.input.nodeName,b.config.altInputClass),b._input=b.altInput,b.altInput.placeholder=b.input.placeholder,b.altInput.disabled=b.input.disabled,b.altInput.required=b.input.required,b.altInput.tabIndex=b.input.tabIndex,b.altInput.type="text",b.input.setAttribute("type","hidden"),!b.config.static&&b.input.parentNode&&b.input.parentNode.insertBefore(b.altInput,b.input.nextSibling));b.config.allowInput||b._input.setAttribute("readonly","readonly");ye()}(),function(){b.selectedDates=[],b.now=b.parseDate(b.config.now)||new Date;var e=b.config.defaultDate||("INPUT"!==b.input.nodeName&&"TEXTAREA"!==b.input.nodeName||!b.input.placeholder||b.input.value!==b.input.placeholder?b.input.value:null);e&&fe(e,b.config.dateFormat);b._initialDate=b.selectedDates.length>0?b.selectedDates[0]:b.config.minDate&&b.config.minDate.getTime()>b.now.getTime()?b.config.minDate:b.config.maxDate&&b.config.maxDate.getTime()<b.now.getTime()?b.config.maxDate:b.now,b.currentYear=b._initialDate.getFullYear(),b.currentMonth=b._initialDate.getMonth(),b.selectedDates.length>0&&(b.latestSelectedDateObj=b.selectedDates[0]);void 0!==b.config.minTime&&(b.config.minTime=b.parseDate(b.config.minTime,"H:i"));void 0!==b.config.maxTime&&(b.config.maxTime=b.parseDate(b.config.maxTime,"H:i"));b.minDateHasTime=!!b.config.minDate&&(b.config.minDate.getHours()>0||b.config.minDate.getMinutes()>0||b.config.minDate.getSeconds()>0),b.maxDateHasTime=!!b.config.maxDate&&(b.config.maxDate.getHours()>0||b.config.maxDate.getMinutes()>0||b.config.maxDate.getSeconds()>0)}(),b.utils={getDaysInMonth:function(e,t){return void 0===e&&(e=b.currentMonth),void 0===t&&(t=b.currentYear),1===e&&(t%4==0&&t%100!=0||t%400==0)?29:b.l10n.daysInMonth[e]}},b.isMobile||function(){var e=window.document.createDocumentFragment();if(b.calendarContainer=u("div","flatpickr-calendar"),b.calendarContainer.tabIndex=-1,!b.config.noCalendar){if(e.appendChild((b.monthNav=u("div","flatpickr-months"),b.yearElements=[],b.monthElements=[],b.prevMonthNav=u("span","flatpickr-prev-month"),b.prevMonthNav.innerHTML=b.config.prevArrow,b.nextMonthNav=u("span","flatpickr-next-month"),b.nextMonthNav.innerHTML=b.config.nextArrow,U(),Object.defineProperty(b,"_hidePrevMonthArrow",{get:function(){return b.__hidePrevMonthArrow},set:function(e){b.__hidePrevMonthArrow!==e&&(c(b.prevMonthNav,"flatpickr-disabled",e),b.__hidePrevMonthArrow=e)}}),Object.defineProperty(b,"_hideNextMonthArrow",{get:function(){return b.__hideNextMonthArrow},set:function(e){b.__hideNextMonthArrow!==e&&(c(b.nextMonthNav,"flatpickr-disabled",e),b.__hideNextMonthArrow=e)}}),b.currentYearElement=b.yearElements[0],we(),b.monthNav)),b.innerContainer=u("div","flatpickr-innerContainer"),b.config.weekNumbers){var t=function(){b.calendarContainer.classList.add("hasWeeks");var e=u("div","flatpickr-weekwrapper");e.appendChild(u("span","flatpickr-weekday",b.l10n.weekAbbreviation));var t=u("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}(),n=t.weekWrapper,a=t.weekNumbers;b.innerContainer.appendChild(n),b.weekNumbers=a,b.weekWrapper=n}b.rContainer=u("div","flatpickr-rContainer"),b.rContainer.appendChild(V()),b.daysContainer||(b.daysContainer=u("div","flatpickr-days"),b.daysContainer.tabIndex=-1),z(),b.rContainer.appendChild(b.daysContainer),b.innerContainer.appendChild(b.rContainer),e.appendChild(b.innerContainer)}b.config.enableTime&&e.appendChild(function(){b.calendarContainer.classList.add("hasTime"),b.config.noCalendar&&b.calendarContainer.classList.add("noCalendar");var e=C(b.config);b.timeContainer=u("div","flatpickr-time"),b.timeContainer.tabIndex=-1;var t=u("span","flatpickr-time-separator",":"),n=m("flatpickr-hour",{"aria-label":b.l10n.hourAriaLabel});b.hourElement=n.getElementsByTagName("input")[0];var a=m("flatpickr-minute",{"aria-label":b.l10n.minuteAriaLabel});b.minuteElement=a.getElementsByTagName("input")[0],b.hourElement.tabIndex=b.minuteElement.tabIndex=-1,b.hourElement.value=o(b.latestSelectedDateObj?b.latestSelectedDateObj.getHours():b.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),b.minuteElement.value=o(b.latestSelectedDateObj?b.latestSelectedDateObj.getMinutes():e.minutes),b.hourElement.setAttribute("step",b.config.hourIncrement.toString()),b.minuteElement.setAttribute("step",b.config.minuteIncrement.toString()),b.hourElement.setAttribute("min",b.config.time_24hr?"0":"1"),b.hourElement.setAttribute("max",b.config.time_24hr?"23":"12"),b.hourElement.setAttribute("maxlength","2"),b.minuteElement.setAttribute("min","0"),b.minuteElement.setAttribute("max","59"),b.minuteElement.setAttribute("maxlength","2"),b.timeContainer.appendChild(n),b.timeContainer.appendChild(t),b.timeContainer.appendChild(a),b.config.time_24hr&&b.timeContainer.classList.add("time24hr");if(b.config.enableSeconds){b.timeContainer.classList.add("hasSeconds");var r=m("flatpickr-second");b.secondElement=r.getElementsByTagName("input")[0],b.secondElement.value=o(b.latestSelectedDateObj?b.latestSelectedDateObj.getSeconds():e.seconds),b.secondElement.setAttribute("step",b.minuteElement.getAttribute("step")),b.secondElement.setAttribute("min","0"),b.secondElement.setAttribute("max","59"),b.secondElement.setAttribute("maxlength","2"),b.timeContainer.appendChild(u("span","flatpickr-time-separator",":")),b.timeContainer.appendChild(r)}b.config.time_24hr||(b.amPM=u("span","flatpickr-am-pm",b.l10n.amPM[i((b.latestSelectedDateObj?b.hourElement.value:b.config.defaultHour)>11)]),b.amPM.title=b.l10n.toggleTitle,b.amPM.tabIndex=-1,b.timeContainer.appendChild(b.amPM));return b.timeContainer}());c(b.calendarContainer,"rangeMode","range"===b.config.mode),c(b.calendarContainer,"animate",!0===b.config.animate),c(b.calendarContainer,"multiMonth",b.config.showMonths>1),b.calendarContainer.appendChild(e);var r=void 0!==b.config.appendTo&&void 0!==b.config.appendTo.nodeType;if((b.config.inline||b.config.static)&&(b.calendarContainer.classList.add(b.config.inline?"inline":"static"),b.config.inline&&(!r&&b.element.parentNode?b.element.parentNode.insertBefore(b.calendarContainer,b._input.nextSibling):void 0!==b.config.appendTo&&b.config.appendTo.appendChild(b.calendarContainer)),b.config.static)){var l=u("div","flatpickr-wrapper");b.element.parentNode&&b.element.parentNode.insertBefore(l,b.element),l.appendChild(b.element),b.altInput&&l.appendChild(b.altInput),l.appendChild(b.calendarContainer)}b.config.static||b.config.inline||(void 0!==b.config.appendTo?b.config.appendTo:window.document.body).appendChild(b.calendarContainer)}(),function(){b.config.wrap&&["open","close","toggle","clear"].forEach(function(e){Array.prototype.forEach.call(b.element.querySelectorAll("[data-"+e+"]"),function(t){return j(t,"click",b[e])})});if(b.isMobile)return void function(){var e=b.config.enableTime?b.config.noCalendar?"time":"datetime-local":"date";b.mobileInput=u("input",b.input.className+" flatpickr-mobile"),b.mobileInput.tabIndex=1,b.mobileInput.type=e,b.mobileInput.disabled=b.input.disabled,b.mobileInput.required=b.input.required,b.mobileInput.placeholder=b.input.placeholder,b.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",b.selectedDates.length>0&&(b.mobileInput.defaultValue=b.mobileInput.value=b.formatDate(b.selectedDates[0],b.mobileFormatStr));b.config.minDate&&(b.mobileInput.min=b.formatDate(b.config.minDate,"Y-m-d"));b.config.maxDate&&(b.mobileInput.max=b.formatDate(b.config.maxDate,"Y-m-d"));b.input.getAttribute("step")&&(b.mobileInput.step=String(b.input.getAttribute("step")));b.input.type="hidden",void 0!==b.altInput&&(b.altInput.type="hidden");try{b.input.parentNode&&b.input.parentNode.insertBefore(b.mobileInput,b.input.nextSibling)}catch(e){}j(b.mobileInput,"change",function(e){b.setDate(p(e).value,!1,b.mobileFormatStr),ve("onChange"),ve("onClose")})}();var e=l(ie,50);b._debouncedChange=l(F,300),b.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&j(b.daysContainer,"mouseover",function(e){"range"===b.config.mode&&oe(p(e))});j(b._input,"keydown",re),void 0!==b.calendarContainer&&j(b.calendarContainer,"keydown",re);b.config.inline||b.config.static||j(window,"resize",e);void 0!==window.ontouchstart?j(window.document,"touchstart",Q):j(window.document,"mousedown",Q);j(window.document,"focus",Q,{capture:!0}),!0===b.config.clickOpens&&(j(b._input,"focus",b.open),j(b._input,"click",b.open));void 0!==b.daysContainer&&(j(b.monthNav,"click",xe),j(b.monthNav,["keyup","increment"],O),j(b.daysContainer,"click",me));if(void 0!==b.timeContainer&&void 0!==b.minuteElement&&void 0!==b.hourElement){var t=function(e){return p(e).select()};j(b.timeContainer,["increment"],I),j(b.timeContainer,"blur",I,{capture:!0}),j(b.timeContainer,"click",P),j([b.hourElement,b.minuteElement],["focus","click"],t),void 0!==b.secondElement&&j(b.secondElement,"focus",function(){return b.secondElement&&b.secondElement.select()}),void 0!==b.amPM&&j(b.amPM,"click",function(e){I(e)})}b.config.allowInput&&j(b._input,"blur",ae)}(),(b.selectedDates.length||b.config.noCalendar)&&(b.config.enableTime&&A(b.config.noCalendar?b.latestSelectedDateObj:void 0),Ee(!1)),T();var t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!b.isMobile&&t&&ue(),ve("onReady")}(),b}function L(e,t){for(var n=Array.prototype.slice.call(e).filter(function(e){return e instanceof HTMLElement}),a=[],r=0;r<n.length;r++){var o=n[r];try{if(null!==o.getAttribute("data-fp-omit"))continue;void 0!==o._flatpickr&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=M(o,t||{}),a.push(o._flatpickr)}catch(e){console.error(e)}}return 1===a.length?a[0]:a}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return L(this,e)},HTMLElement.prototype.flatpickr=function(e){return L([this],e)});var k=function(e,t){return"string"==typeof e?L(window.document.querySelectorAll(e),t):e instanceof Node?L([e],t):L(e,t)};return k.defaultConfig={},k.l10ns={en:e({},r),default:e({},r)},k.localize=function(t){k.l10ns.default=e(e({},k.l10ns.default),t)},k.setDefaults=function(t){k.defaultConfig=e(e({},k.defaultConfig),t)},k.parseDate=w({}),k.formatDate=_({}),k.compareDates=D,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return L(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=k),k}.call(void 0);const ce={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","févr","mars","avr","mai","juin","juil","août","sept","oct","nov","déc"],longhand:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ordinal:function(e){return e>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Défiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0},ue={weekdays:{shorthand:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],longhand:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},months:{shorthand:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],longhand:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},firstDayOfWeek:1,ordinal:function(){return"°"},rangeSeparator:" al ",weekAbbreviation:"Se",scrollTitle:"Scorri per aumentare",toggleTitle:"Clicca per cambiare",time_24hr:!0},de={firstDayOfWeek:1,weekdays:{shorthand:["dim","dl","dma","dme","dj","dv","ds"],longhand:["dimenge","diluns","dimars","dimècres","dijòus","divendres","dissabte"]},months:{shorthand:["gen","febr","març","abr","mai","jun","jul","ag","set","oct","nov","dec"],longhand:["genièr","febrièr","març","abril","mai","junh","julhet","agost","setembre","octobre","novembre","decembre"]},ordinal:function(e){return e>1?"":"èr"},rangeSeparator:" a ",weekAbbreviation:"Sem",scrollTitle:"Desfilar per aumentar",toggleTitle:"Clicar per bascular",time_24hr:!0};function ge(e="complet",t=null){const n=e=>{let t=e?e instanceof Date?e:new Date(e):new Date;return t instanceof Date&&!isNaN(t.getTime())||(t=new Date),t};let a;switch(e){case"complet":default:a={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"sansJour":a={year:"numeric",month:"long",day:"numeric"};break;case"sansAnnee":a={weekday:"long",month:"long",day:"numeric"};break;case"court":{const e=n(t);return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`}}let o=n(t).toLocaleDateString(r.langue,a);o=o.replace(/\b1\b/,'1<span class="exposant">er</span>');let i=o.charAt(0).toUpperCase()+o.slice(1);return"oc"===r.langue&&(i=function(e){for(let t of ne){const n=new RegExp(`\\b${t.fr}\\b`,"g");e=e.replace(n,t.oc)}for(let t of le){const n=new RegExp(`\\b${t.fr}\\b`,"g");e=e.replace(n,t.oc)}return e}(i)),i}function me(){const e=document.createElement("span");e.innerHTML=ge();const t=document.createElement("div");t.id="divDate",t.appendChild(e),r.soulignerLaDate&&(e.style.textDecoration="underline red"),D.prepend(t);const n=document.createElement("br");D.insertBefore(n,t.nextSibling)}let pe=null,fe="";async function he(){const e=document.getElementById("datepicker"),t=document.getElementById("date-input");if(!e||!t)return;let n=document.getElementById("date").getBoundingClientRect().left;e.classList.remove("hide");const a=document.querySelector(".flatpickr-calendar");if(a&&(a.style.left=n+"px",a.classList.remove("hide")),t.focus(),!pe){const e=document.createElement("link");e.rel="stylesheet",e.href="./js/lib/flatpickr.min.css",document.head.appendChild(e),await new Promise((t,n)=>{e.onload=t,e.onerror=n})}if(!pe||fe!==r.langue){let a;switch(fe=r.langue,r.langue){case"fr":a=ce;break;case"it":a=ue;break;case"oc":a=de}pe=se(t,{inline:!0,dateFormat:"Y-m-d",locale:a,onChange:function(t){ye&&ye(t[0]),e.classList.add("hide");const n=document.querySelector(".flatpickr-calendar");n&&n.classList.add("hide")}});const o=document.querySelector(".flatpickr-calendar");o&&(o.style.left=n+"px",o.classList.remove("hide"))}}function ye(e=null){let t=null;t=e?ge("complet",e):ge();const n=document.getElementById("divDate");if(!n)return void me();const a=document.createElement("span");a.innerHTML=t,r.soulignerLaDate&&(a.style.textDecoration="underline red"),r.dateDuDoc=t,n.innerHTML="",n.appendChild(a)}function ve(e){let t=re[e];c.style.backgroundColor=t,S.value=S.style.backgroundColor=t,ie()}function be(){r.ajouterLaDate=O.checked,r.soulignerLaDate=j.checked,Q("ajouter-date",r.ajouterLaDate),Q("souligner-date",r.soulignerLaDate);const e=document.getElementById("divDate");e&&(r.soulignerLaDate?e.querySelector("span").style.textDecoration="underline red":e.querySelector("span").style.textDecoration=null)}function _e(){r.majDateAuto=R.checked,Q("maj-date-auto",r.majDateAuto),r.majDateAuto&&ye()}function we(e){e&&e.stopPropagation();const t=document.getElementById("couleur-texte")?document.getElementById("couleur-texte").getBoundingClientRect():null;if(!t)return;let n=t.left;const a=document.getElementById("boutons-couleur-texte");a&&(a.style.left=n+"px",a.classList.toggle("hide"))}function De(){const e=document.getElementById("panneauOptions");e&&e.classList.toggle("hide")}function Ee(e){const t=document.getElementById("inputOpacite"),n=document.getElementById("voile_page"),a=document.getElementById("voile_marge"),r=document.getElementById("voile_marge2");"string"==typeof e&&(e=parseFloat(e)),t&&(t.value=e),n&&(n.style.backgroundColor="rgba(255,255,255,"+(1-e)+")"),a&&(a.style.backgroundColor="rgba(255,255,255,"+(1-e)+")"),r&&(r.style.backgroundColor="rgba(255,255,255,"+(1-e)+")");try{localStorage.setItem("opacite-lignes",e)}catch(e){console.error(e)}}function xe(e){if(!e)return;e.nodeType===Node.TEXT_NODE&&(e=e.parentElement);let t=e;for(;t&&t.nodeType===Node.ELEMENT_NODE&&!t.hasAttribute("contenteditable");)t=t.parentElement;t||(t=e);Array.from(t.querySelectorAll("span")).forEach(e=>{if(!e.classList.contains("entoure")&&e.textContent.length>1){const t=Array.from(e.classList),n=e.parentNode,a=document.createDocumentFragment();for(let n=0;n<e.textContent.length;n++){const r=document.createElement("span");r.textContent=e.textContent[n],t.forEach(e=>r.classList.add(e)),a.appendChild(r)}n.insertBefore(a,e),e.remove()}})}function Ce(e){if(!e)return;e.nodeType===Node.TEXT_NODE&&(e=e.parentElement);let t=e;for(;t&&t.nodeType===Node.ELEMENT_NODE&&!t.hasAttribute("contenteditable");)t=t.parentElement;if(!t)return;let n=!0;for(;n;){n=!1;const e=t.querySelectorAll("span");for(let t=0;t<e.length;t++){const a=e[t],r=a.nextSibling;if(r&&"SPAN"===r.tagName){if(Array.from(a.classList).sort().join(",")===Array.from(r.classList).sort().join(",")){a.textContent+=r.textContent,r.remove(),n=!0;break}}}}t.querySelectorAll("span").forEach(e=>{""===e.textContent&&e.remove()})}function Me(e){const t=[];function n(e,a=[]){if(e.nodeType===Node.TEXT_NODE){const n=e.textContent;for(let e=0;e<n.length;e++)t.push({texte:n[e],classes:[...a]})}else if(e.nodeType===Node.ELEMENT_NODE){if(e.classList&&e.classList.contains("entoure"))return void t.push({texte:null,noeud:e.cloneNode(!0),isEntoure:!0});const r=e.classList?Array.from(e.classList):[],o=[...a,...r];e.childNodes.forEach(e=>{n(e,o)})}}return e.childNodes.forEach(e=>n(e)),t}function Le(e){const t=window.getSelection();if(!t.rangeCount)return;const n=t.getRangeAt(0);if(n.collapsed)return;let a=n.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const r=n.cloneRange();r.selectNodeContents(a),r.setEnd(n.startContainer,n.startOffset);const o=r.toString().length,i=o+n.toString().length;xe(a);let l=0,s=null,c=0,u=null,d=0;const g=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let m;for(;m=g.nextNode();){const e=m.textContent.length;if(!s&&l+e>o&&(s=m,c=o-l),!u&&l+e>=i){u=m,d=i-l;break}l+=e}if(!s||!u)return;try{const e=document.createRange();e.setStart(s,c),e.setEnd(u,d),t.removeAllRanges(),t.addRange(e)}catch(e){return void console.warn("Impossible de restaurer la sélection",e)}const p=t.getRangeAt(0),f=p.startContainer;if(f===p.endContainer&&f.nodeType===Node.TEXT_NODE&&f.parentElement&&"SPAN"===f.parentElement.tagName&&0===p.startOffset&&p.endOffset===f.textContent.length){const t=f.parentElement;return["souligne-red","souligne-blue","souligne-green","souligne-yellow","souligne-pink","souligne-black","souligne-purple","souligne-orange"].forEach(e=>t.classList.remove(e)),void("transparent"!==e&&"white"!==e&&t.classList.add(`souligne-${e}`))}const h=Me(p.cloneContents());if(0===h.length)return;const y=document.createDocumentFragment(),v=["souligne-red","souligne-blue","souligne-green","souligne-yellow","souligne-pink","souligne-black","souligne-purple","souligne-orange"];h.forEach(t=>{if(t.isEntoure)return void y.appendChild(t.noeud);const n=document.createElement("span");n.textContent=t.texte,t.classes.forEach(e=>{v.includes(e)||n.classList.add(e)}),"transparent"!==e&&"white"!==e&&n.classList.add(`souligne-${e}`),y.appendChild(n)}),p.deleteContents(),p.insertNode(y),p.collapse(!1),t.removeAllRanges(),t.addRange(p),document.getElementById("souligne").style.textDecorationColor=e,document.getElementById("souligne").value=e,Ce(a)}let ke=!0;function Te(e){ke&&(document.querySelectorAll("#boutons_soulignement .deroule-souligne, .deroule-souligne").forEach(e=>{e.addEventListener("click",e=>{Le(e.currentTarget.value)})}),ke=!1),e&&e.stopPropagation();const t=document.getElementById("souligne")?document.getElementById("souligne").getBoundingClientRect():null;if(!t)return;let n=t.left;const a=document.getElementById("boutons_soulignement");a&&(a.style.left=n+"px",a.classList.toggle("hide"))}function Ie(){const e=Se();r.nombreDeCarreaux=Math.round(e/r.largeur_carreau),H.value=r.nombreDeCarreaux}function Se(){const e=D.offsetWidth,t=getComputedStyle(D);return e+parseFloat(t.marginLeft)+parseFloat(t.marginRight)}const Ae={Arial:{facteur_taille_police:.6,epaisseur_police:"normal",coef_marge:.28,coef_marge_windows:.25,distance_soulignage:.3,ligatures:[1,0],bouton_ligatures_display:"none"},"AA Cursive":{facteur_taille_police:.75,epaisseur_police:"normal",coef_marge:.35,coef_marge_windows:.3125,distance_soulignage:.3,ligatures:[0,1],bouton_ligatures_display:null},"Open Dyslexic":{facteur_taille_police:.45,epaisseur_police:"normal",coef_marge:.35,coef_marge_windows:.35,distance_soulignage:.5,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure CE":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure CM":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure GS":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure script":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},Acceseditionscursive:{facteur_taille_police:.674,epaisseur_police:"normal",coef_marge:.272,coef_marge_windows:.242857143,distance_soulignage:.379,ligatures:[1,0],bouton_ligatures_display:"none"},Luciole:{facteur_taille_police:.65,epaisseur_police:"normal",coef_marge:.29,coef_marge_windows:.258928572,distance_soulignage:.379,ligatures:[1,0],bouton_ligatures_display:"none"},Romain:{facteur_taille_police:.8,epaisseur_police:"bold",coef_marge:.3,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"}};function Ne(){window.print()}function Oe(){r.largeur_page=b.offsetWidth,r.largeur_marge=p.offsetWidth,r.largeur_marge_secondaire=y.offsetWidth,r.largeur_page_impression=r.largeur_page/r.largeur_carreau*r.largeurImpression*4,r.largeur_marge_impression=r.largeur_marge/r.largeur_carreau*r.largeurImpression*4,r.largeur_marge_secondaire_impression=r.largeur_marge_secondaire/r.largeur_carreau*r.largeurImpression*4,document.documentElement.style.setProperty("--largeur-page-impression",r.largeur_page_impression+"mm"),document.documentElement.style.setProperty("--largeur-marge-impression",r.largeur_marge_impression+"mm"),document.documentElement.style.setProperty("--largeur-marge2-impression",r.largeur_margesecondaire_impression+"mm")}let je;function Fe(e,t,n){r.largeur_carreau_old=r.largeur_carreau,e?r.largeur_carreau=r.largeur_carreau+e:t&&(r.largeur_carreau=t);let a=r.largeur_carreau/r.largeur_carreau_old;e&&function(e){let t=D.scrollHeight,n=m.clientHeight,a=m.scrollTop;if(t*e<=n)return void(m.scrollTop=0);let r=t*e,o=(a+n/2)/t*r-n/2;o*=Math.pow(e,1.2),o=Math.max(0,Math.min(o,r-n)),m.scrollTop=o}(a);let o=4*r.largeurImpression;r.taille_police=r.largeur_carreau*r.facteur_taille_police;let i,l=o*r.facteur_taille_police;D.style.fontWeight=r.epaisseur_police,h.style.fontWeight=r.epaisseur_police,v.style.fontWeight=r.epaisseur_police,r.isWindows?(je=r.largeur_carreau*r.coef_marge_windows,i=o*r.coef_marge_windows):(je=r.largeur_carreau*r.coef_marge,i=o*r.coef_marge),"Open Dyslexic"===n&&(je*=.9),b.style.backgroundSize=r.largeur_carreau+"px",f.style.backgroundSize=r.largeur_carreau+"px",y.style.backgroundSize=r.largeur_carreau+"px",document.documentElement.style.setProperty("--largeur-carreau-impression",`${o}mm`),D.style.fontSize=r.taille_police+"px",document.documentElement.style.setProperty("--taille-police-impression",`${l}mm`),D.style.marginLeft=r.largeur_carreau/5+"px",D.style.marginRight=r.largeur_carreau/5+"px",h.style.fontSize=v.style.fontSize=r.taille_police+"px",h.style.marginTop=v.style.marginTop=je+"px",h.style.marginLeft=v.style.marginLeft=r.largeur_carreau/5+"px",h.style.marginRight=v.style.marginRight=r.largeur_carreau/5+"px",document.documentElement.style.setProperty("--marge-impression",o/5+"mm"),"terre"===r.typeCarreaux||"bleuviolet"===r.typeCarreaux||"trois_couleurs"===r.typeCarreaux||"quatre_couleurs"===r.typeCarreaux||r.interligneDouble?(h.style.lineHeight=2*r.largeur_carreau+"px",D.style.lineHeight=2*r.largeur_carreau+"px",document.documentElement.style.setProperty("--hauteur-ligne-impression",2*o+"mm"),D.style.marginTop=-je/3+"px",document.documentElement.style.setProperty("--marge-top-impression",-i/3+"mm")):(v.style.lineHeight=h.style.lineHeight=r.largeur_carreau+"px",D.style.lineHeight=r.largeur_carreau+"px",document.documentElement.style.setProperty("--hauteur-ligne-impression",`${o}mm`),D.style.marginTop=je+"px",document.documentElement.style.setProperty("--marge-top-impression",`${i}mm`)),document.documentElement.style.setProperty("--largeur-marge-secondaire",2.7*r.largeur_carreau+"px");document.querySelectorAll(".customfont").forEach(e=>{let t=getComputedStyle(e).fontFamily.trim(),n=Ae[t]?Ae[t].facteur_taille_police:null;n?e.style.fontSize=e.style.lineHeight=r.largeur_carreau*n+"px":console.warn(`La police ${t} n'a pas été trouvée dans l'objet typesPolices.`)});_.querySelectorAll(".trait").forEach(e=>{e.style.transition="none ";let t=window.getComputedStyle(e),n=parseInt(parseFloat(t.getPropertyValue("left"))/r.largeur_carreau_old),a=parseInt(parseFloat(t.getPropertyValue("top"))/r.largeur_carreau_old),o=parseInt(parseFloat(t.getPropertyValue("width"))/r.largeur_carreau_old),i=parseInt(parseFloat(t.getPropertyValue("height"))/r.largeur_carreau_old);isNaN(n)&&(n=0),isNaN(a)&&(a=0),isNaN(o)&&(o=0),isNaN(i)&&(i=0);let l=n*r.largeur_carreau,s=a*r.largeur_carreau;if(e.style.left=`${l}px`,e.style.top=`${s}px`,e.classList.contains("horizontal")){let t=o*r.largeur_carreau+.02117171*r.largeur_carreau;e.style.width=`${t}px`}if(e.classList.contains("vertical")){let t=i*r.largeur_carreau+.02117171*r.largeur_carreau;e.style.height=`${t}px`}e.style.transition=""}),Oe(),document.documentElement.style.setProperty("--decalage-depart",.02117171*-r.largeur_carreau+"px"),document.documentElement.style.setProperty("--decalage-position",-2-.02117171*r.largeur_carreau+"px"),Ie(),Q("largeur-carreau",r.largeur_carreau)}function Be(e=0){r.largeur_marge=r.largeur_carreau*e,b.style.width=g.style.width="calc(100% - "+r.largeur_marge+"px)",p.style.width=r.largeur_marge-3+"px",document.documentElement.style.setProperty("--largeur-marge-impression",r.largeur_marge-3+"mm"),u.style.width=r.largeur_marge+"px",document.documentElement.style.setProperty("--largeur-marge-secondaire",2.7*r.largeur_carreau+"px"),document.documentElement.style.setProperty("--largeur-marge2-impression",2.7*r.largeur_carreau+"mm")}function Pe(e){let t=r.typeCarreaux;r.typeCarreaux=e,r.typeCarreaux&&(f.style.backgroundImage="url('./images/carreau_marge_"+r.typeCarreaux+".svg",y.style.backgroundImage="url('./images/carreau_marge_"+r.typeCarreaux+".svg",b.style.backgroundImage="url('./images/carreau_"+r.typeCarreaux+".svg",document.getElementById("carreaux").style.backgroundImage=`url(./images/carreau_${e}.svg`),b.style.borderLeft="terre"===e?"none":null,"cahier_de_textes"===e?(y.style.display="block",Be(7),p.style.borderRightColor="#000000",c.style.display="flex"):(y.style.display=null,c.style.display="none","cahier_de_textes"===t&&Be(4),p.style.borderRightColor=null),Fe(0,!1,r.police_active),Q("type-carreaux",r.typeCarreaux)}function He(){document.querySelectorAll("#boutons_soulignement button").forEach(e=>{const t=`./images/${e.id}.svg`;e.style.backgroundImage=`url('${t}')`}),document.querySelectorAll("#boutons_carreaux button:not(.bouton-fermer)").forEach(e=>{let t=`./images/${e.id}.svg`;"./images/carreau_cahier_de_textes.svg"===t&&(t="./images/cahier_de_textes.svg"),e.style.backgroundImage=`url('${t}')`});const e={carreau_seyes:"seyes",carreau_seyes_noir:"seyes_noir",carreau_seyes_gris:"seyes_gris",carreau_ligne_base:"ligne_base",carreau_simple_ligne:"simple_ligne",carreau_double_ligne:"double_ligne",carreau_petit:"petit",carreau_terre:"terre",carreau_trois_couleurs:"trois_couleurs",carreau_quatre_couleurs:"quatre_couleurs",carreau_bleuviolet:"bleuviolet",carreau_cahier_de_textes:"cahier_de_textes"};Object.keys(e).forEach(t=>{const n=o(t);n&&n.addEventListener("click",()=>{Pe(e[t])})});const t=document.querySelector("#boutons_carreaux .bouton-fermer");t&&t.addEventListener("click",()=>{const e=document.getElementById("boutons_carreaux");e&&e.classList.add("hide")})}let Re=!0;function Ye(){Re&&(He(),Re=!1);let e=document.getElementById("carreaux").getBoundingClientRect().left;document.getElementById("boutons_carreaux").style.left=e+"px",document.getElementById("boutons_carreaux").classList,document.getElementById("boutons_carreaux").classList.toggle("hide")}function We(e){let t=e.target,n=new Image;if(t.files&&t.files[0]){var a=new FileReader;a.onload=function(e){n.onload=function(){n.naturalWidth/n.naturalHeight>1?n.style.width="400px":n.style.height="400px"},n.src=e.target.result},a.readAsDataURL(t.files[0])}let r=document.createElement("div");r.addEventListener("click",function(){r.classList.add("selectionne")}),r.style.top=`${m.scrollTop+document.body.clientHeight/2}px`,r.classList.add("draggable","conteneur-image"),n.classList.add("image"),r.appendChild(n);let o=document.createElement("button");o.title="Supprimer",o.classList.add("bouton-supprimer-image"),o.addEventListener("click",function(){r.remove()}),r.appendChild(o);let i=document.createElement("button");i.title="Bordure",i.classList.add("bouton-cadre-image"),i.addEventListener("click",function(){r.classList.toggle("encadre")}),r.appendChild(i);let l=document.createElement("div");l.classList.add("poignee","nw");let s=document.createElement("div");s.classList.add("poignee","ne");let c=document.createElement("div");c.classList.add("poignee","sw");let u=document.createElement("div");u.classList.add("poignee","se"),r.appendChild(l),r.appendChild(s),r.appendChild(c),r.appendChild(u),w.appendChild(r)}function $e(){const e=document.getElementById("images"),t=document.getElementById("contenu"),n=document.body;let a=document.createElement("iframe");a.src="https://educajou.forge.apps.education.fr/tuxtimer/";let r=document.createElement("div");r.addEventListener("click",function(){r.classList.add("selectionne")}),r.style.top=`${t.scrollTop+n.clientHeight/2}px`,r.classList.add("draggable","conteneur-image"),a.classList.add("timer"),r.appendChild(a);let o=document.createElement("button");o.title="Supprimer",o.classList.add("bouton-supprimer-image"),o.addEventListener("click",function(){r.remove()}),r.appendChild(o);let i=document.createElement("button");i.title="Bordure",i.classList.add("bouton-cadre-image"),i.addEventListener("click",function(){r.classList.toggle("encadre")}),r.appendChild(i),["nw","ne","sw","se"].forEach(e=>{let t=document.createElement("div");t.classList.add("poignee",e),r.appendChild(t)}),e&&e.appendChild(r)}function qe(){r.regleActive=!r.regleActive,b.classList.toggle("trace"),V.classList.toggle("trace"),document.getElementById("regle").classList.toggle("trace"),r.regleActive||(b.style.cursor=null)}function ze(e){r.selected?(r.selected.style.backgroundColor=e,r.selected.classList.remove("select"),r.selected=null):alert("Aucun trait n'est sélectionné.")}const Je={"souligne-red":"§r","souligne-blue":"§b","souligne-green":"§g","souligne-yellow":"§y","souligne-pink":"§p","souligne-black":"§k","souligne-purple":"§u","souligne-orange":"§o","couleur-red":"¤r","couleur-coral":"¤cr","couleur-salmon":"¤s","couleur-orange":"¤o","couleur-gold":"¤gd","couleur-yellow":"¤y","couleur-lime":"¤l","couleur-green":"¤g","couleur-olive":"¤ol","couleur-teal":"¤t","couleur-cyan":"¤c","couleur-blue":"¤b","couleur-navy":"¤n","couleur-indigo":"¤i","couleur-purple":"¤p","couleur-magenta":"¤m","couleur-pink":"¤pk","couleur-beige":"¤be","couleur-brown":"¤br","couleur-gray":"¤gr","couleur-silver":"¤sv","couleur-black":"¤bk","couleur-white":"¤w",entoure:"◆"},Ge=Object.fromEntries(Object.entries(Je).map(([e,t])=>[t,e]));function Ue(e){let t=e;return t=t.replace(/<span class="([^"]*)">([^<]*)<\/span>/g,(e,t,n)=>`$${t.split(" ").filter(e=>e).map(e=>Je[e]||e).join("!")}!${n}$`),t=t.replace(/<span class="entoure">([^]*?)<\/span>/g,(e,t)=>`◆${Ue(t)}◆`),t}function Ve(e){let t=e;return t=t.replace(/\$([^$]*)\$/g,(e,t)=>{const n=t.split("!"),a=n[n.length-1],r=n.slice(0,-1).map(e=>Ge[e]||e).filter(e=>e).join(" ");return r?`<span class="${r}">${a}</span>`:a}),t=t.replace(/◆([^]*?)◆/g,(e,t)=>`<span class="entoure">${Ve(t)}</span>`),t}let Xe=!0;function Ke(){Xe&&(!function(){const e=document.getElementById("ferme_menu_copie_lien");e&&e.addEventListener("click",()=>{if(J)l(J);else{const e=document.getElementById("zone_menu_copie_lien");e&&e.classList.add("hide")}})}(),Xe=!1),function(){let e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?";window.widget&&(e="https://educajou.forge.apps.education.fr/seyes?");const t=new URLSearchParams({marge:h?h.innerHTML:"","marge-secondaire":v?v.innerHTML:"",police:r.police_active||"","largeur-carreau":r.largeur_carreau||"","type-carreaux":r.typeCarreaux||"","opacite-lignes":r.opaciteLignes||"","largeur-marge":r.largeur_marge||0,"largeur-marge-secondaire":r.largeur_marge_secondaire||0,"interligne-double":r.interligneDouble||"","verifier-orthographe":r.verifierOrthographe||!1,"ecrire-a-cheval":r.ecrireAChevalSurLaMarge||!1,lang:r.langueChoix,"maj-date-auto":r.majDateAuto});Ce(D);const n=encodeURIComponent(Ue(D.innerHTML))+"|_|"+encodeURIComponent(Ue(_.innerHTML)),a=e+t.toString()+"#"+n;G.innerText=a}(),J.classList.toggle("hide"),J.classList.contains("hide")||z.classList.remove("hide")}function Ze(){const e=document.getElementById("zone_lien").innerText;navigator.clipboard.writeText(e).then(()=>{const e=document.createElement("div");e.innerHTML="Lien copié",e.style.position="fixed",e.style.backgroundColor="black",e.style.color="white",e.style.fontSize="12px",e.style.padding="5px 10px",e.style.borderRadius="5px",e.style.zIndex="2000",e.style.opacity="0",e.style.transition="opacity 0.3s";const t=document.getElementById("copier").getBoundingClientRect();e.style.left=t.left+window.scrollX+"px",e.style.top=t.top+window.scrollY-30+"px",m.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{m.removeChild(e)},300)},2e3)}).catch(e=>{console.error("Erreur lors de la copie : ",e)})}let Qe=!1;function et(){Qe?(U.style.backgroundPosition=null,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()):(U.style.backgroundPosition="0% 0%",X.requestFullscreen?X.requestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen?X.webkitRequestFullscreen():X.msRequestFullscreen&&X.msRequestFullscreen()),Qe=!Qe}function tt(e){const t=document.getSelection();if(t.rangeCount>0){let n=t.anchorNode;for(;n&&"DIV"!==n.tagName;)n=n.parentNode;n?n.style.textAlign=e:console.warn("Aucun élément de type DIV trouvé")}else console.warn("Aucune sélection trouvée")}function nt(){const e=window.getSelection();if(!e.rangeCount)return;const t=e.getRangeAt(0);if(t.collapsed)return;const n=t.toString();let a=t.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const r=t.cloneRange();r.selectNodeContents(a),r.setEnd(t.startContainer,t.startOffset);const o=r.toString().length,i=o+n.length,l=t.cloneRange().cloneContents(),s=document.createElement("div");s.appendChild(l);const c=s.querySelectorAll(".entoure");if(1===c.length&&c[0].textContent===n){const e=Array.from(a.querySelectorAll(".entoure")).find(e=>e.textContent===n&&t.intersectsNode(e)&&e.textContent.trim()===n.trim());if(e){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return void e.remove()}}const u=Array.from(a.querySelectorAll(".entoure")),d=[];u.forEach(e=>{t.intersectsNode(e)&&d.push(e)}),d.forEach(e=>{const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);e.remove()});let g=0,m=null,p=0,f=null,h=0;const y=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let v;for(;v=y.nextNode();){const e=v.textContent.length;if(!m&&g+e>o&&(m=v,p=o-g),!f&&g+e>=i){f=v,h=i-g;break}g+=e}if(!m||!f)return void console.warn("Impossible de recréer la sélection");const b=document.createRange();try{b.setStart(m,p),b.setEnd(f,h)}catch(e){return void console.warn("Erreur setStart/setEnd:",e)}const _=document.createElement("span");_.classList.add("entoure");try{const t=b.extractContents();_.appendChild(t),b.insertNode(_),b.collapse(!1),e.removeAllRanges(),e.addRange(b)}catch(e){console.warn("Erreur lors de la création du span entoure:",e)}}function at(e){const t=window.getSelection();if(!t.rangeCount)return;const n=t.getRangeAt(0);if(n.collapsed)return;let a=n.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const r=n.cloneRange();r.selectNodeContents(a),r.setEnd(n.startContainer,n.startOffset);const o=r.toString().length,i=o+n.toString().length;xe(a);let l=0,s=null,c=0,u=null,d=0;const g=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let m;for(;m=g.nextNode();){const e=m.textContent.length;if(!s&&l+e>o&&(s=m,c=o-l),!u&&l+e>=i){u=m,d=i-l;break}l+=e}if(!s||!u)return;try{const e=document.createRange();e.setStart(s,c),e.setEnd(u,d),t.removeAllRanges(),t.addRange(e)}catch(e){return void console.warn("Impossible de restaurer la sélection",e)}const p=t.getRangeAt(0),f=p.startContainer;if(f===p.endContainer&&f.nodeType===Node.TEXT_NODE&&f.parentElement&&"SPAN"===f.parentElement.tagName&&0===p.startOffset&&p.endOffset===f.textContent.length){const t=f.parentElement;return["couleur-red","couleur-coral","couleur-salmon","couleur-orange","couleur-gold","couleur-yellow","couleur-lime","couleur-green","couleur-olive","couleur-teal","couleur-cyan","couleur-blue","couleur-navy","couleur-indigo","couleur-purple","couleur-magenta","couleur-pink","couleur-beige","couleur-brown","couleur-gray","couleur-silver","couleur-black","couleur-white"].forEach(e=>t.classList.remove(e)),void t.classList.add(`couleur-${e}`)}const h=Me(p.cloneContents());if(0===h.length)return;const y=document.createDocumentFragment(),v=["couleur-red","couleur-coral","couleur-salmon","couleur-orange","couleur-gold","couleur-yellow","couleur-lime","couleur-green","couleur-olive","couleur-teal","couleur-cyan","couleur-blue","couleur-navy","couleur-indigo","couleur-purple","couleur-magenta","couleur-pink","couleur-beige","couleur-brown","couleur-gray","couleur-silver","couleur-black","couleur-white","couleur-transparent"];h.forEach(t=>{if(t.isEntoure)return void y.appendChild(t.noeud);const n=document.createElement("span");n.textContent=t.texte,t.classes.forEach(e=>{v.includes(e)||n.classList.add(e)}),n.classList.add(`couleur-${e}`),y.appendChild(n)}),p.deleteContents(),p.insertNode(y),p.collapse(!1),t.removeAllRanges(),t.addRange(p),document.getElementById("couleur-texte").style.color=e,document.getElementById("couleur-texte").value=e,document.getElementById("couleur-texte").style.webkitTextStroke="white"===e||"transparent"===e?"1px #000000":"0px",Ce(a)}function rt(){r.ecrireAChevalSurLaMarge=Y.checked,r.ecrireAChevalSurLaMarge?p.style.whiteSpace="nowrap":p.style.whiteSpace=null,Q("ecrire-a-cheval",r.ecrireAChevalSurLaMarge)}function ot(){r.verifierOrthographe=F.checked,Q("verifier-orthographe",r.verifierOrthographe),[h,v,D].forEach(e=>{e.spellcheck=r.verifierOrthographe,e.focus()})}function it(){r.interligneDouble=B.checked,Q("double-interligne",r.interligneDouble),Fe()}function lt(){let e=P.value;r.largeurImpression=parseFloat(e),Q("largeur-impression",r.largeurImpression),Fe()}function st(e){r.espacementLettres=parseFloat(e),Q("espacement-lettres",r.espacementLettres),D.style.letterSpacing=e/100+"em",0===r.espacementLettres?document.documentElement.style.setProperty("--ligatures",'"calt" 1',"important"):document.documentElement.style.setProperty("--ligatures",'"calt" 0',"important")}function ct(e){r.espacementMots=parseFloat(e),Q("espacement-mots",r.espacementMots),0===r.espacementMots?(D.style.wordSpacing="normal",h.style.wordSpacing="normal",v.style.wordSpacing="normal"):(D.style.wordSpacing=e+"em",h.style.wordSpacing=e+"em",v.style.wordSpacing=e+"em")}let ut=window.sens||[1,0];function dt(e,t){r.ligatures_on?("auto"!=e&&(T.style.backgroundPosition=null,r.ligatures_on=!1,D.spellcheck=!0,h.spellcheck=!0,v.spellcheck=!0),ut=[1,0]):("auto"!=e&&(T.style.backgroundPosition="0% 0%",r.ligatures_on=!0,D.spellcheck=!1,h.spellcheck=!1,v.spellcheck=!1),ut=[0,1]),t&&(ut=t);let n=D.innerHTML;for(let e=0;e<r.substitutions.length;e++){let t=r.substitutions[e][ut[0]],a=r.substitutions[e][ut[1]];n=n.replace(new RegExp(t,"g"),a)}D.innerHTML=n,n=h.innerHTML;for(let e=0;e<r.substitutions.length;e++){let t=r.substitutions[e][ut[0]],a=r.substitutions[e][ut[1]];n=n.replace(new RegExp(t,"g"),a)}h.innerHTML=n}function gt(e){if(D.style.fontFamily=e,h.style.fontFamily=e,v.style.fontFamily=e,r.police_active=e,window.widget||localStorage.setItem("seyes-police",e),Ae[e]){let t=Ae[e];r.coef_marge=t.coef_marge,r.coef_marge_windows=t.coef_marge_windows,r.facteur_taille_police=t.facteur_taille_police,r.epaisseur_police=t.epaisseur_police,r.distance_soulignage=t.distance_soulignage,T.style.display=t.bouton_ligatures_display,dt("auto",t.ligatures)}Fe(0,!1,r.police_active),function(e){const t=document.getElementById("texte_principal"),n=document.getElementById("texte_marge"),a=document.getElementById("texte_marge_complementaire");t&&(t.style.textUnderlineOffset=e+"em"),n&&(n.style.textUnderlineOffset=e+"em"),a&&(a.style.textUnderlineOffset=e+"em")}(r.distance_soulignage),document.documentElement.style.setProperty("--distance-soulignement-exposant",6*r.distance_soulignage+"em")}let mt,pt=!0;async function ft(e){if("fr"!==e||!pt){pt=!1;const t=await fetch(`./js/_locales/${e}.json`),n=await t.json();document.querySelectorAll("[i18_title]").forEach(e=>{const t=e.getAttribute("i18_title");e.title=n[t]||e.title});document.querySelectorAll("[i18_content]").forEach(e=>{const t=e.getAttribute("i18_content");e.textContent=n[t]||e.textContent})}}function ht(){let e=window.location.search;return new URLSearchParams(e).get("lang")||"fr"}function yt(e){const t=e;if("auto"===e){const e=navigator.language||navigator.userLanguage;r.langue=e.split("-")[0]}else r.langue=e;ft(r.langue),document.lang=r.langue,Q("lang",t);null!=document.getElementById("divDate")&&ye()}async function vt(e){if(0!=e.length){let t=ht();const n=await fetch(`./js/_locales/${t}.json`),a=await n.json(),r=a.codiOK_content||"Texte correctement récupéré",o=a.codiPasOK_content||"Erreur. Lien invalide ?",i=await bt("#"+e);L.classList.add("hide"),i?(C.classList.add("correct"),C.classList.remove("incorrect"),C.innerHTML=r,M.innerHTML=mt=window.location.origin+"#"+e,L.classList.remove("hide")):(C.classList.add("incorrect"),C.classList.remove("correct"),C.innerHTML=o)}}async function bt(e){let t=function(e){""!==e&&(e.startsWith("https://github.com")&&(e=(e=e.replace("https://github.com","https://raw.githubusercontent.com")).replace("/blob/","/")),(e.startsWith("https://codimd")||e.includes("hedgedoc")||e.includes("digipage"))&&(e=-1===(e=e.replace("?edit","").replace("?both","").replace("?view","").replace(/#$/,"").replace(/\/$/,"")).indexOf("download")?e+"/download":e),e.includes("framapad")&&!e.endsWith("/export/txt")&&(e=e.replace(/\?.*/,"")+"/export/txt"));return e}(e.substring(1));try{let e=await async function(e){try{let t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok "+t.statusText);return await t.text()}catch(e){throw console.error("There has been a problem with your fetch operation:",e),e}}(t);return function(e){const t=e.split("---");let n="",a="";t.length>=3?(n=t[1].trim(),a=t.slice(2).join("---").replace(/^\s*\n/,"").trim()):a=e.trim();const o=n.split("\n");let i,l,s="",c="",u=!1;function d(e){const t=e.split(":");if(t.length<2)return;const n=t.slice(1).join(":").trim();return""===n?void 0:n}o.forEach(e=>{if(e.startsWith("police:"))s=d(e);else if(e.startsWith("lang:")||e.startsWith("langue:")){const t=d(e);t&&(r.langue=t.toLowerCase().replace(/\s+/g,"_"),ft(r.langue),function(e,t){const n=new URL(window.location);n.searchParams.set(e,t),window.history.replaceState({},"",n)}("lang",r.langue))}else if(e.startsWith("lignage:")){const t=d(e);t&&(c=t.toLowerCase().replace(/\s+/g,"_"))}else if(e.startsWith("autodate:")){const t=d(e);u=t&&"true"===t.toLowerCase()}else if(e.startsWith("souligner-date:")){const t=d(e);r.soulignerLaDate=t&&"true"===t.toLowerCase(),j.checked=r.soulignerLaDate}else if(e.startsWith("couleur:")){const t=d(e);t&&(l=t.toLowerCase())}else if(e.startsWith("opacite-lignage:")){let t=d(e);t&&t.includes("%")?(t=t.replace("%","").trim(),t=parseFloat(t)/100):t&&(t=t.replace(",",".").trim(),t=parseFloat(t)),!isNaN(t)&&t>=0&&t<=1?i=t:void 0!==t&&console.warn("La valeur de l'opacité est invalide. Elle doit être entre 0 et 1.")}}),i&&Ee(i);s&&(gt(s),I.value=s);c&&Pe(c);l&&(l=function(e){const t={noir:"Black",bleu:"Blue",marron:"Brown",cyan:"Cyan",gris:"Gray",vert:"Green",magenta:"Magenta",bordeaux:"Maroon",marine:"Navy",olive:"Olive",violet:"Purple",rouge:"Red",argent:"Silver",sarcelle:"Teal",blanc:"White",jaune:"Yellow",vertolive:"OliveDrab",bleuciel:"SkyBlue",bleuroi:"RoyalBlue",bleumarine:"Navy",vertforet:"ForestGreen",vertcitron:"LimeGreen",vertmer:"SeaGreen",rosefonce:"DeepPink",bleunuit:"MidnightBlue","vert olive":"OliveDrab","vert-olive":"OliveDrab","bleu ciel":"SkyBlue","bleu-ciel":"SkyBlue","bleu roi":"RoyalBlue","bleu-roi":"RoyalBlue","bleu marine":"Navy","bleu-marine":"Navy","vert foret":"ForestGreen","vert-foret":"ForestGreen","vert citron":"LimeGreen","vert-citron":"LimeGreen","vert mer":"SeaGreen","vert-mer":"SeaGreen","rose fonce":"DeepPink","rose-fonce":"DeepPink","bleu nuit":"MidnightBlue","bleu-nuit":"MidnightBlue"};if(e=e.toLowerCase().trim(),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e))return e;if(t[e])return t[e];const n=e.replace(/\s+/g,"");if(t[n])return t[n];const a=e.replace(/-/g," ");if(t[a])return t[a];const r=[/^(.*?)\s+clair$/,/^(.*?)-clair$/,/^(.*?)\s+fonce$/,/^(.*?)-fonce$/,/^(.*?)\s+foncé$/,/^(.*?)-foncé$/];for(let n of r){const a=e.match(n);if(a){const e=t[a[1]];if(e)return n.source.includes("clair")?`Light${e}`:`Dark${e}`}}return e}(l),document.documentElement.style.setProperty("--couleur-texte",l));const g=a.split("\n").map(e=>`<div>${e.trim()||"<br>"}</div>`).join("");D&&(D.innerHTML=Ve(g));u&&ye()}(e),!0}catch(e){return console.error("Erreur lors de la récupération du texte:",e),!1}}function _t(){D.innerHTML="",_.innerHTML="",w.innerHTML="",h.innerHTML=v.innerHTML="",r.ajouterLaDate&&me(),D.focus();const e=document.createRange(),t=window.getSelection(),n=D.getElementsByTagName("br");if(n.length>0){const a=n[n.length-1];e.setStartAfter(a),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}}function wt(){if(x.checked=r.afficherMessage,r.afficherMessage?E.style.opacity="1":l(E),r.couleursJours)try{for(let e in JSON.parse(r.couleursJours))re[e]=JSON.parse(r.couleursJours)[e]}catch(e){console.error("Valeur non parsable :",e);for(let e in ae)re[e]=ae[e]}else for(let e in ae)re[e]=ae[e];const e=document.getElementById("select-jours").value;var t;c.style.backgroundColor=re[e],S.value=S.style.backgroundColor=re[e],A.value=r.espacementLettres,N.value=r.espacementMots,Y.checked=r.ecrireAChevalSurLaMarge,R.checked=r.majDateAuto,rt(),ie(),t=r.largeur_marge,r.largeur_marge=t,b.style.width=g.style.width=`calc(100% - ${t}px)`,p.style.width=t-3+"px",u.style.width=`${t}px`,Q("largeur-marge",r.largeur_marge),Oe(),function(e){e>=3&&(r.largeur_marge_secondaire=e,r.margeSecondaire.style.width=d.style.width=e-3+"px",Q("largeur-marge-secondaire",r.largeur_marge_secondaire),Oe())}(r.largeur_marge_secondaire),I.value=r.police_active,gt(r.police_active),Pe(r.typeCarreaux),Ee(r.opaciteLignes),Fe(!1,r.largeur_carreau,r.police_active),be(),_t();const n=function(e,t){let n=window.location.search;if(n.includes("&amp;")&&(n=n.replace(/&amp;/g,"&")),window.location.hash)if(window.location.hash.startsWith("#http"))bt(window.location.hash);else{const n=decodeURIComponent(window.location.hash.substring(1)).split("|_|");2===n.length?(e=n[0],t=n[1]):e=n[0];const a=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,a)}return{contenuTextePrincipal:e,contenuGraphismes:t}}(r.contenuTextePrincipal,r.contenuGraphismes);r.contenuTextePrincipal=n.contenuTextePrincipal,r.contenuGraphismes=n.contenuGraphismes,st(r.espacementLettres),ct(r.espacementMots),Ee(r.opaciteLignes),F.checked=r.verifierOrthographe,ot(),it(),P.value=r.largeurImpression,lt(),'""'!=r.contenuTextePrincipal&&null!=r.contenuTextePrincipal&&(D.innerHTML=Ve(r.contenuTextePrincipal)),'""'!=r.contenuTexteMarge&&(h.innerHTML=Ve(r.contenuTexteMarge)),'""'!=r.contenuTexteMargeComplementaire&&(v.innerHTML=r.contenuTexteMargeComplementaire),'""'!=r.contenuGraphismes&&(_.innerHTML=r.contenuGraphismes),'""'!=r.contenuImages&&(w.innerHTML=r.contenuImages),function(){const e=document.getElementById("images");if(!e)return;e.querySelectorAll(".conteneur-image").forEach(e=>{let t=e.querySelector(".bouton-supprimer-image"),n=e.querySelector(".bouton-cadre-image");e.addEventListener("click",function(){e.classList.add("selectionne")}),t&&t.addEventListener("click",function(){e.remove()}),n&&n.addEventListener("click",function(){e.classList.toggle("encadre")})})}(),Ie(),K.value=r.langueChoix,"fr"!==r.langue&&yt(r.langueChoix),r.majDateAuto&&ye(),ft(r.langue)}async function Dt(){const e=window.location.search,t=new URLSearchParams(e),n=!e.startsWith("http");window.location.href.includes("seyes-dev")&&document.body.classList.add("dev");let a=await ee(`afficher-message${r.numeroMessage}`);"true"===a?r.afficherMessage=!0:"false"===a&&(r.afficherMessage=!1);t.get("primtuxmenu")&&(document.body.classList.add("primtux"),r.afficherMessage=!1),r.langueChoix=await te(t,"lang")||"auto",r.couleursJours=await te(t,"couleurs-jours"),r.police_active=await te(t,"police")||r.police_active,r.largeur_marge=await te(t,"largeur-marge")||r.largeur_marge,r.largeur_marge_secondaire=await parseFloat(te(t,"largeur-marge-secondaire"))||r.largeur_marge_secondaire,r.contenuGraphismes=await te(t,"graphismes")||"",r.contenuImages=await te(t,"images")||"";const o=await te(t,"texte-principal")||"";r.contenuTextePrincipal=""!=o&&"undefined"!=o&&null!=o?o:await async function(e){let t,n=ge(),a=ht();if(e||"fr"===a||!a)t="Modifiez-moi";else{const e=await fetch(`./js/_locales/${a}.json`);t=(await e.json()).modifiezMoi_content||"Modifiez-moi..."}return`\n\t\t  <div id="divDate"><span>${n}</span></div>\n\t\t  <br>\n\t\t  ${t}    \n\t `}(n),r.contenuTexteMarge=await te(t,"texte-marge")||"",r.contenuTexteMargeComplementaire=await te(t,"texte-marge-complementaire")||"",r.typeCarreaux=await te(t,"type-carreaux")||r.typeCarreaux,r.opaciteLignes=parseFloat(await te(t,"opacite-lignes"))||1,r.largeur_carreau=parseInt(await te(t,"largeur-carreau"))||r.largeur_carreau,r.espacementLettres=parseInt(await te(t,"espacement-lettres"))||r.espacementLettres,r.espacementMots=parseInt(await te(t,"espacement-mots"))||r.espacementMots,r.ajouterLaDate="true"===await te(t,"ajouter-date")||r.ajouterLaDate,r.soulignerLaDate="true"===await te(t,"souligner-date")||r.soulignerLaDate,r.verifierOrthographe="true"===await te(t,"verifier-orthographe")||r.verifierOrthographe,r.interligneDouble="true"===await te(t,"double-interligne")||r.interligneDouble,r.ecrireAChevalSurLaMarge="true"===await te(t,"ecrire-a-cheval")||r.ecrireAChevalSurLaMarge,r.largeurImpression=parseInt(await te(t,"largeur-impression"))||r.largeurImpression,r.majDateAuto="true"===await te(t,"maj-date-auto")||r.majDateAuto}function Et(){const e=document.createElement("input");e.type="file",e.accept=".json, .sey, .txt, .doc, .docx",e.addEventListener("change",xt),e.click()}async function xt(e){const t=e.target.files[0];if(!t)return void alert("Aucun fichier sélectionné.");const n=[".json",".sey",".odt",".doc",".docx",".txt"];if(n.some(e=>t.name.endsWith(e)))try{if((t.name.endsWith(".doc")||t.name.endsWith(".docx")||t.name.endsWith(".odt"))&&void 0===window.mammoth){const e=document.createElement("script");e.src="./js/lib/mammoth.browser.min.js",document.head.appendChild(e),await new Promise((t,n)=>{e.onload=t,e.onerror=n})}if(t.name.endsWith(".doc")||t.name.endsWith(".docx")){const e=await async function(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=e=>{const a=e.target.result;window.mammoth?window.mammoth.convertToHtml({arrayBuffer:a}).then(e=>t(e.value)).catch(e=>n(e)):n(new Error("mammoth.js is not loaded"))},a.onerror=()=>n(new Error("Impossible de lire le fichier DOC/DOCX.")),a.readAsArrayBuffer(e)})}(t);Ct(e)}else if(t.name.endsWith(".odt")){const e=await async function(e){return new Promise((t,n)=>{if(void 0===window.ODF)return void n(new Error("La bibliothèque odf.js n'est pas chargée."));const a=new FileReader;a.onload=async e=>{try{const n=e.target.result,a=new Uint8Array(n),r=await window.ODF.load(a),o=await r.getText();t(o)}catch(e){n(new Error("Impossible de lire le fichier ODT : "+e.message))}},a.onerror=()=>n(new Error("Erreur lors de la lecture du fichier ODT.")),a.readAsArrayBuffer(e)})}(t);Ct(e)}else{r.nomDuFichierOuvert=t.name.split(".").slice(0,-1).join(".")||t.name;const e=await function(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=e=>t(e.target.result),a.onerror=()=>n(new Error("Échec de la lecture du fichier.")),a.readAsText(e)})}(t);t.name.endsWith(".json")||t.name.endsWith(".sey")?async function(e){try{const t=JSON.parse(e);for(const[e,n]of Object.entries(t)){const t="object"==typeof n?JSON.stringify(n):n;localStorage.setItem(e,t)}await Dt(),wt()}catch(e){alert("Erreur : le contenu du fichier JSON est invalide."),console.error(e)}}(e):Ct(e)}}catch(e){alert("Erreur lors du traitement du fichier : "+e.message),console.error(e)}else alert("Erreur : fichier non valide. Extensions acceptées : "+n.join(", "))}function Ct(e){_t(),D.innerHTML=e}async function Mt(){await Z();let e="texte";r.dateDuDoc&&(e=`${e}-${r.dateDuDoc}`),r.nomDuFichierOuvert&&(e=r.nomDuFichierOuvert),window.showSaveFilePicker?async function(e,t="seyes"){const n={};for(let e=0;e<localStorage.length;e++){const a=localStorage.key(e);if(a.startsWith(t+"-")){const e=localStorage.getItem(a);if("seyes-texte-principal"===a)n[a]=e;else try{n[a]=JSON.parse(e)}catch(t){console.error(t),n[a]=e}}}const a=JSON.stringify(n,null,2);try{const t=await window.showSaveFilePicker({suggestedName:e,types:[{description:"Fichier JSON",accept:{"application/json":[".json"]}}]}),n=await t.createWritable();await n.write(a),await n.close(),alert("Fichier enregistré avec succès !")}catch(e){"AbortError"!==e.name&&(console.error("Erreur lors de l'enregistrement :",e),alert("Une erreur est survenue lors de l'enregistrement."))}}(`${e}.sey`):function(e){const t={};for(let e=0;e<localStorage.length;e++){const n=localStorage.key(e);if(n.startsWith(r.prefixeAppli+"-")){const e=localStorage.getItem(n);if("seyes-texte-principal"===n)t[n]=e;else try{t[n]=JSON.parse(e)}catch(a){console.error(a),t[n]=e}}}const n=JSON.stringify(t,null,2),a=new Blob([n],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=e,o.click()}(`${e}.sey`)}function Lt(){let e=parseInt(H.value);(isNaN(e)||0===e)&&(e=5),r.nombreDeCarreaux=e,H.value=r.nombreDeCarreaux;Fe(!1,Se()/r.nombreDeCarreaux,r.police_active)}function kt(){i(W)}function Tt(){const e=document.getElementById("boutonFermeCodi");k&&k.addEventListener("click",()=>{navigator.clipboard.writeText(mt).then(()=>{const e=document.createElement("div");e.innerHTML="Lien copié",e.style.position="fixed",e.style.backgroundColor="black",e.style.color="white",e.style.fontSize="12px",e.style.padding="5px 10px",e.style.borderRadius="5px",e.style.zIndex="10000",e.style.opacity="0",e.style.transition="opacity 0.3s";const t=k.getBoundingClientRect();e.style.left=t.left+window.scrollX+"px",e.style.top=t.top+window.scrollY-30+"px",m.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{m.removeChild(e)},300)},2e3)}).catch(e=>{console.error("Erreur lors de la copie : ",e)})}),e&&e.addEventListener("click",()=>{$?l($):$&&$.classList.add("hide")})}let It=!0;function St(){It&&(Tt(),It=!1);$&&i($);const e=document.getElementById("inputCodi");e&&e.focus()}function At(){try{l(W),_t()}catch(e){console.error(e)}}function Nt(){try{l(W)}catch(e){console.error(e)}}let Ot=!1;function jt(){if(!Ot){s.querySelector(".contenu-lightbox").innerHTML='<ul>\n          <span i18_content="apropos_message_part1">Seyes est une application sous licence libre GNU GPL, de la </span>\n          <a class="cartouche" style="background-image: url(./images/educajou.png);" href="https://educajou.forge.apps.education.fr/" i18_content="apropos_message_link">suite Éducajou</a>\n          <span i18_content="apropos_message_part2">, écrite par Arnaud Champollion.</span>\n        </ul>\n        <br>\n        <h2>Documentation</h2>\n        <br>\n        <span id="spanCeditNum40">Illustration explicative réalisée par <a target="_blank" href="https://blogacabdx.ac-bordeaux.fr/numerique40/2023/11/22/application-seyes-deducajou/">l\'Équipe numérique 40</a> sous licence Creative Commons BY SA</span>\n        <br><br>\n        <h2 i18_content="apropos_polices_title">Polices utilisées</h2>\n        <br>\n        <span i18_content="apropos_police_aa_cursive">AA Cursive, par A. Renaudin, sous licence libre OFL.</span>\n        <br>\n        <span i18_content="apropos_police_open_dyslexic">Open Dyslexic, par Abelardo Gonzalez, sous licence libre.</span>\n        <br>\n        <span i18_content="apropos_police_luciole">Luciole par Laurent Bourcellier & Jonathan Perez, sous licence libre Creative Commons BY.</span>\n        <br>\n        <span i18_content="apropos_police_belle_allure">Belle Allure par Jean Boyault, avec son aimable autorisation.</span>\n        <br>\n        <span i18_content="apropos_police_arial_acces">Arial & Acces ne sont pas présentes sur cette application, néanmoins si elles sont installées sur votre ordinateur, Seyes pourra les utiliser.</span>\n        <br><br>\n        <h2 i18_content="apropos_bibliotheques_title">Bibliothèques</h2>\n        <span i18_content="apropos_bibliotheque_flatpickr_part1">La fonction de calendrier s\'appuie sur la bibliothèque </span>\n        <a target="_blank" href="https://github.com/flatpickr/flatpickr" i18_content="apropos_bibliotheque_flatpickr_link">flatpickr</a>\n        <span i18_content="apropos_bibliotheque_flatpickr_part2"> sous licence MIT.</span>\n        <br>\n        <span i18_content="apropos_bibliotheque_mammoth_part1">La fonction d\'import de fichier docx s\'appuie sur </span>\n        <a target="_blank" href="https://github.com/mwilliamson/mammoth.js" i18_content="apropos_bibliotheque_mammoth_link">Mammoth</a>\n        <span i18_content="apropos_bibliotheque_mammoth_part2"> sous licence BSD.</span>\n        <br><br>\n        <h2 i18_content="apropos_utiliser_hors_ligne_title">Utiliser hors-ligne</h2>\n        <br>\n        <ul>\n          <span i18_content="apropos_utiliser_hors_ligne_message_part1">Télécharger l\'application </span>\n          <a class="cartouche" style="background-image: url(./images/zip.png);" href="https://forge.apps.education.fr/educajou/seyes/-/archive/main/seyes-main.zip?path=web" i18_content="apropos_utiliser_hors_ligne_message_link">seyes-main.zip</a>\n        </ul>\n        <ul i18_content="apropos_extraire_zip_message">Extraire le ZIP</ul>\n        <ul i18_content="apropos_ouvrir_fichier_message">Ouvrir le fichier index.html</ul>\n        <br>\n        <h2 i18_content="apropos_en_savoir_plus_title">En savoir plus et accéder aux sources</h2>\n        <br>\n        <ul>\n          <span i18_content="apropos_en_savoir_plus_message_part1">Voir </span>\n          <a class="cartouche" style="background-image: url(./images/forge.png);" href="https://forge.apps.education.fr/educajou/seyes" i18_content="apropos_en_savoir_plus_message_link">la page du projet</a>\n          <span i18_content="apropos_en_savoir_plus_message_part2"> sur la Forge des Communs Numériques Éducatifs.</span>\n        </ul>\n        <br>\n        <h2 i18_content="apropos_contact_title">Contactez-moi</h2>\n        <br>\n        <p>\n          <span i18_content="apropos_contact_message_part1">Vous pouvez </span>\n          <a target="_blank" href="https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=bug" i18_content="apropos_contact_message_link1">signaler un bug</a>\n          <span i18_content="apropos_contact_message_part2"> ou </span>\n          <a target="_blank" href="https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=suggestion" i18_content="apropos_contact_message_link2">suggérer une fonctionnalité</a>\n        </p>\n        <p i18_content="apropos_contact_message_2">Il vous sera demandé de vous connecter avec votre compte Apps Éducation. Vous recevrez les notifications de réponses sur votre boîte email académique.</p>',Ot=!0}i(s)}let Ft,Bt,Pt=null,Ht=0,Rt=0,Yt=0,Wt=0,$t=0,qt=0,zt=0,Jt=0,Gt=0,Ut=0,Vt=!1,Xt=null,Kt=!1,Zt=null,Qt=null,en=Zt=Kt=Qt=!1;function tn(e,t=r.largeur_carreau){return Math.round(e/t)*t}function nn(e){return function(e){return e&&e.targetTouches&&e.targetTouches[0]&&e.targetTouches[0].clientX}(e)||e&&e.clientX}function an(e){return function(e){return e&&e.targetTouches&&e.targetTouches[0]&&e.targetTouches[0].clientY}(e)||e&&e.clientY}function rn(e){const t=b.getBoundingClientRect(),n=nn(e)-t.left,a=an(e)-t.top;if(r.regleActive){const e=tn(n),t=tn(a);Math.abs(n-e)<r.largeur_carreau/8&&Math.abs(a-t)<r.largeur_carreau/8?b.style.cursor="url(./images/crayonrouge.png) 0 30, auto":r.isDrawing||(b.style.cursor="url(./images/crayon.png) 0 30, auto ")}}function on(e){if(Z(),e.target.classList.contains("gestion-texte")&&e.preventDefault(),!e.target.closest(".selectionne")){w.querySelectorAll(".selectionne").forEach(e=>{e.classList.remove("selectionne")})}const t=document.getElementById("boutons_soulignement"),n=document.getElementById("boutons_carreaux"),a=document.getElementById("boutons-couleur-texte"),o=document.getElementById("datepicker"),i=document.querySelector(".flatpickr-calendar");(function(e,t){if(e===t)return!0;let n=e.parentNode;for(;n;){if(n===t)return!0;n=n.parentNode}return!1})(e.target,i)||e.target.classList.contains("deroule-couleur")||e.target.classList.contains("deroule-souligne")||e.target.classList.contains("deroule_carreaux")||e.target.classList.contains("flatpickr-calendar")||(t.classList.add("hide"),n.classList.add("hide"),a.classList.add("hide"),o.classList.add("hide"),i&&i.classList.add("hide")),e.target.classList.contains("bouton-supprimer-trait")&&!r.regleActive&&r.selected&&(r.selected.remove(),r.selected=null),e.target.classList.contains("bouton-couleur-trait")&&!r.regleActive&&r.selected&&document.getElementById("inputCouleurTrait").click(),e.target.classList.contains("trait")&&!r.regleActive?(r.selected&&r.selected.classList.remove("select"),e.target.classList.add("select"),r.selected=e.target):r.selected&&!e.target.classList.contains("bouton-couleur-trait")&&(r.selected.classList.remove("select"),r.selected=null);const l=b.getBoundingClientRect(),s=y.getBoundingClientRect();Ht=nn(e),Rt=an(e);const c=Ht-l.left,u=Rt-l.top,d=Ht-s.left;let g=!1;if(e.target.classList.contains("draggable_item")&&(g=!0),e.target.classList.contains("poignee")){en=e.target.classList[1],document.body.style.cursor=en+"-resize",Yt=Ht,Wt=Rt;let t=e.target.closest(".conteneur-image"),n=t.querySelector(".image")||t.querySelector(".timer");Kt=n;let a=n.clientWidth,r=n.clientHeight;Zt=r>a?"height":"width",Qt=Math.max(a,r)}else if(e.target.classList.contains("draggable")||g)e.preventDefault(),Pt=g?e.target.parentNode:e.target,zt=Ht-Pt.offsetLeft,Jt=Rt-Pt.offsetTop,Pt.classList.add("dragged");else if(c<=10&&c>-10)Vt=b,document.body.style.cursor="ew-resize",Yt=Ht,r.largeur_page=b.offsetWidth,r.largeur_marge=p.offsetWidth;else if(d<=10&&d>-10)Vt=y,document.body.style.cursor="ew-resize",Yt=Ht,r.largeur_marge_secondaire=y.offsetWidth;else if(r.regleActive){const e=tn(c),t=tn(u);if(Math.abs(c-e)<r.largeur_carreau/8&&Math.abs(u-t)<r.largeur_carreau/8){r.isDrawing=!0,Ft=e,Bt=t,Xt=document.createElement("div"),Xt.classList.add("trait"),Xt.classList.add("horizontal"),Xt.classList.add("draggable"),Xt.style.position="absolute",Xt.style.backgroundColor="red",Xt.style.width="6px",Xt.style.height="6px",Xt.style.left=Ft+"px",Xt.style.top=Bt+"px";let n=document.createElement("button");n.classList.add("bouton-supprimer-trait"),Xt.appendChild(n);let a=document.createElement("button");a.classList.add("bouton-couleur-trait"),Xt.appendChild(a),_.appendChild(Xt)}}}function ln(e){$t=nn(e),qt=an(e);const t=b.getBoundingClientRect(),n=$t-t.left,a=qt-t.top;if(en){Gt=$t-Yt,Ut=qt-Wt,en.includes("w")&&(Gt=-Gt),en.includes("n")&&(Ut=-Ut);let e=Gt+Ut;Kt.classList.contains("timer")?Kt.style.width=Kt.style.height=`${Qt+e}px`:Kt.style[Zt]=`${Qt+e}px`}else Vt===b?(Gt=$t-Yt,r.largeur_marge+Gt>=60?(b.style.width=g.style.width=r.largeur_page-Gt+"px",p.style.width=r.largeur_marge+Gt-3+"px",u.style.width=r.largeur_marge+Gt+"px"):(b.style.width=g.style.width="calc(100% - 60px)",p.style.width=u.style.width="57px",u.style.width=u.style.width="60px"),Ie()):Vt===y&&(Gt=$t-Yt,r.largeur_marge_secondaire-Gt>=2.7*r.largeur_carreau?(y.style.width=r.largeur_marge_secondaire-Gt+"px",d.style.width=r.largeur_marge_secondaire-Gt+"px"):(y.style.width=2.7*r.largeur_carreau+"px",d.style.width=2.7*r.largeur_carreau+"px"),Ie());if(Pt){Pt.style.right=null,Pt.style.bottom=null,e.preventDefault();const t=nn(e)||0,n=an(e)||0;Pt.style.left=t-zt+"px",Pt.style.top=n-Jt+"px"}else if(r.isDrawing&&Xt){const e=tn(n),t=tn(a),o=e-Ft,i=t-Bt;if(Math.abs(o)>Math.abs(i)){let t=Math.abs(o);Xt.style.width=t+.02117171*r.largeur_carreau+"px",Xt.style.height="6px",Xt.style.top=Bt+"px",Xt.style.left=Ft+"px",Xt.classList.remove("vertical"),Xt.classList.add("horizontal"),o<0&&(Xt.style.left=e+"px")}else Xt.style.height=Math.abs(i)+.02117171*r.largeur_carreau+"px",Xt.style.width="6px",Xt.classList.remove("horizontal"),Xt.classList.add("vertical"),i<0&&(Xt.style.top=t+"px")}}function sn(){if(Vt=!1,document.body.style.cursor=null,r.largeur_page=b.offsetWidth,r.largeur_marge=p.offsetWidth,r.largeur_marge_secondaire=y.offsetWidth,Oe(),Q("largeur-marge",r.largeur_marge),Q("largeur-marge-secondaire",r.largeur_marge_secondaire),Q("graphismes",_.innerHTML),Q("images",w.innerHTML),en&&(en=!1),Pt){if(Pt.classList.remove("dragged"),Pt.classList.contains("trait")){let e=parseInt(Pt.style.left,10),t=parseInt(Pt.style.top,10),n=Math.round(e/r.largeur_carreau)*r.largeur_carreau,a=Math.round(t/r.largeur_carreau)*r.largeur_carreau;Pt.style.left=`${n}px`,Pt.style.top=`${a}px`}Pt=null}r.isDrawing&&(r.isDrawing=!1,Xt=null,qe())}!async function(){document.querySelectorAll("#show-warning-next-time").forEach(e=>{e.addEventListener("change",e=>{Q(`afficher-message${r.numeroMessage}`,e.currentTarget.checked)})}),T.style.display="none";const e=document.getElementById("select-jours").value,t=re[e];S.value=t,c.style.backgroundColor=t,S.style.backgroundColor=t,ie(),I.value=r.police_active,await Dt(),wt()}(),function(){const e={nouveau:kt,enregistrer:Mt,ouvrir:Et,imprimer:Ne,codi:St,copielien:Ke,copier:Ze,date:ye,bouton_deroule_date:he,zoom_out:()=>{Fe(-10)},zoom_in:()=>{Fe(10)},carreaux:Ye,bouton_ligatures:dt,left:()=>{tt("left")},center:()=>{tt("center")},right:()=>{tt("right")},"couleur-texte":e=>{at(e.currentTarget.value)},bouton_deroule_couleurs:we,souligne:e=>{Le(e.currentTarget.value)},bouton_deroule_souligne:Te,bouton_entoure:nt,regle:qe,a_propos:jt,aide:()=>{i(q)},fullscreen:et,timer:$e,options:De,panneauOptions_close_button:De,oui:At,non:Nt};Object.keys(e).forEach(t=>{const n=o(t);n&&n.addEventListener("click",e[t])});const t={choix_police:gt,inputEcrireACheval:rt,inputOpacite:Ee,checkboxInterligneDouble:it,checkboxAjouterDate:be,checkboxMajDateAuto:_e,checkboxSoulignerDate:be,checkboxVerifierOrthographe:ot,inputLargeurImpression:lt,selectLangue:yt,inputNombreDeCarreaux:Lt};Object.keys(t).forEach(e=>{const n=o(e);n&&n.addEventListener("change",n=>{t[e](n.currentTarget.value)})});const n={inputEspacement:st,inputEspacementMots:ct,inputOpacite:Ee,inputCodi:vt,inputCouleurTrait:ze,"choix-couleur-entete":oe,selectJours:ve,inputFichier:We};Object.keys(n).forEach(e=>{const t=o(e);t&&t.addEventListener("input",t=>{"inputFichier"==e?n[e](t):n[e](t.currentTarget.value)})}),document.querySelectorAll(".bouton-fermer").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.closest(".lightbox");t&&t.classList.add("hide");const n=document.getElementById("darkbox");n&&n.classList.add("hide")})}),document.querySelectorAll("#boutons-couleur-texte .bouton-couleur, #boutons_couleur-texte .bouton-couleur, #boutons-couleur-texte .deroule-couleur, .deroule-couleur.bouton-couleur").forEach(e=>{e.addEventListener("click",e=>{at(e.currentTarget.value)})})}(),document.addEventListener("mousemove",rn),document.addEventListener("touchstart",on),document.addEventListener("touchmove",ln),document.addEventListener("touchend",sn),document.addEventListener("mousedown",on),document.addEventListener("mousemove",ln),document.addEventListener("mouseup",sn),document.addEventListener("paste",function(e){e.preventDefault();let t=e.clipboardData||e.originalEvent.clipboardData,n=t.getData("text/plain");n&&(n=n.replace(/<[^>]*>/g,""),document.execCommand("insertText",!1,n));let a=t.items;for(let e of a)if(-1!==e.type.indexOf("image")){let t=e.getAsFile(),n=new FileReader;n.onload=function(e){let t=document.createElement("img");t.src=e.target.result,t.style.maxWidth="100%",document.execCommand("insertHTML",!1,t.outerHTML)},n.readAsDataURL(t)}}),window.addEventListener("resize",()=>{Ie(),Oe()}),D.addEventListener("focusout",Z),h.addEventListener("focusout",Z),v.addEventListener("focusout",Z),window.addEventListener("keydown",function(e){"Delete"===e.key&&r.selected&&(r.selected.remove(),r.selected=!1)}),w.addEventListener("click",()=>{D.focus();const e=document.createRange();e.selectNodeContents(D),e.collapse(!1);const t=window.getSelection();t.removeAllRanges(),t.addRange(e)})}();
//# sourceMappingURL=script.min.js.map
