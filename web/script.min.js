!function(){"use strict";const e="undefined"!=typeof window&&null!==window;let t=e&&Boolean(window.widget||window.sankore);e&&t&&document.body.classList.add("openboard");const n="undefined"!=typeof window&&window.matchMedia("(max-width: 600px)").matches;let a=n?60:80;let o={prefixeAppli:"seyes",largeur_carreau:a,largeur_marge_secondaire:2.7*a,largeur_page:undefined,largeur_page_impression:1,largeur_marge_impression:1,largeur_margesecondaire_impression:1,largeur_carreau_old:a,largeur_marge:n?60:200,facteur_taille_police:.75,taille_police:60,epaisseur_police:"normal",ligatures_on:!1,coef_marge:.35,coef_marge_windows:.3125,distance_soulignage:.3,police_active:"Belle Allure CE",typeCarreaux:"seyes",regleActive:!1,isDrawing:!1,espacementLettres:0,espacementMots:0,ajouterLaDate:!1,soulignerLaDate:!1,verifierOrthographe:!1,interligneDouble:!1,largeurImpression:3,nombreDeCarreaux:undefined,ecrireAChevalSurLaMarge:!1,langue:"fr",langueChoix:"auto",majDateAuto:!1,isWindows:/Win/i.test(navigator.userAgent),substitutions:[["on","═"],["or","║"],["s ","╝ "],["s\\.","╝."],["s,","╝,"],["s;","╝;"],["s:","╝:"],["s!","╝!"],["s/","╝/"],["s-","╝-"],["s'","╝'"],[" p"," ╰"],[" j"," ╮"],[" s"," ╠"],[" i"," ╱"]],openboard:t,selected:!1,dateDuDoc:!0,afficherMessage:!0,opaciteLignes:1,contenuTexteMarge:"",contenuTexteMargeComplementaire:"",contenuGraphismes:"",contenuImages:"",contenuTextePrincipal:"",couleursJours:{},numeroMessage:8,sharedURL:"https://www.forestier.xyz/ggpp/php/ggpp.php?client_id=educajou",sharedUDI:""};const r=e=>document.getElementById(e);function i(e){if(!e)return;document.querySelectorAll(".darkbox"),e.classList.remove("hide");const t=document.getElementById("darkbox");t&&t.classList.remove("hide")}function l(e){if(!e)return;e.classList.add("hide");const t=document.getElementById("darkbox");t&&t.classList.add("hide")}const s=document.getElementById("apropos"),c=document.getElementById("entete"),u=document.getElementById("marge-entete"),d=document.getElementById("case2"),g=document.getElementById("case3"),m=document.getElementById("contenu"),p=document.getElementById("marge"),f=document.getElementById("marge1"),h=document.getElementById("texte_marge"),v=document.getElementById("marge2"),y=document.getElementById("texte_marge_complementaire"),_=document.getElementById("page"),b=document.getElementById("graphismes"),w=document.getElementById("images"),C=document.getElementById("texte_principal"),D=document.getElementById("message"),x=document.getElementById("show-warning-next-time"),E=document.getElementById("resultatCodi"),M=document.getElementById("lienCodi"),L=document.getElementById("suiteCodi");let k=document.getElementById("boutonCodi");const T=document.getElementById("bouton_ligatures"),I=document.getElementById("choix_police");let S=document.getElementById("choix-couleur-entete"),A=document.getElementById("inputEspacement"),N=document.getElementById("inputEspacementMots");document.getElementById("inputOpacite");let O=document.getElementById("checkboxAjouterDate"),j=document.getElementById("checkboxSoulignerDate"),F=document.getElementById("checkboxVerifierOrthographe"),P=document.getElementById("checkboxInterligneDouble"),B=document.getElementById("inputLargeurImpression"),H=document.getElementById("inputNombreDeCarreaux"),R=document.getElementById("checkboxMajDateAuto"),Y=document.getElementById("inputEcrireACheval");const W=document.getElementById("confirmation-nouveau"),$=document.getElementById("divCodi"),q=document.getElementById("divIllustration"),U=document.getElementById("darkbox"),z=document.getElementById("zone_menu_copie_lien"),G=document.getElementById("zone_lien"),J=document.getElementById("fullscreen"),V=document.getElementById("barre"),K=document.documentElement,X=document.getElementById("selectLangue");function Z(){Q("texte-principal",C.innerHTML),Q("texte-marge",h.innerHTML),Q("texte-marge-complementaire",y.innerHTML)}function Q(e,t){o.openboard?window.sankore.setPreference(o.prefixeAppli+"-"+e,t):localStorage.setItem(o.prefixeAppli+"-"+e,t)}async function ee(e){let t;if(o.openboard)try{t=await window.sankore.async.preference(`${o.prefixeAppli}-${e}`)}catch(t){console.error(`Erreur lors de la lecture de la clé ${e} depuis Openboard:`,t)}else t=localStorage.getItem(`${o.prefixeAppli}-${e}`);return t}async function te(e,t){return e.get(t)||await ee(t)}const ne=[{fr:"Lundi",oc:"Lo diluns"},{fr:"Mardi",oc:"Lo dimars"},{fr:"Mercredi",oc:"Lo dimècres"},{fr:"Jeudi",oc:"Lo dijòus"},{fr:"Vendredi",oc:"Lo divendres"},{fr:"Samedi",oc:"Lo dissabte"},{fr:"Dimanche",oc:"Lo dimenge"}],ae={lundi:"#ed284c",mardi:"#56f068",mercredi:"#53b8e0",jeudi:"#e69130",vendredi:"#6171ff",samedi:"#85ff5c"};let oe={...ae};function re(e){let t=document.getElementById("select-jours").value;oe[t]=e,c.style.backgroundColor=e,S.style.backgroundColor=e,ie(),Q("couleurs-jours",JSON.stringify(oe))}function ie(){let e=function(e){return.299*e[0]+.587*e[1]+.114*e[2]}(function(e){let t=0,n=0,a=0;return 4===e.length?(t=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16),a=parseInt(e[3]+e[3],16)):7===e.length&&(t=parseInt(e[1]+e[2],16),n=parseInt(e[3]+e[4],16),a=parseInt(e[5]+e[6],16)),[t,n,a]}(S.value));S.style.borderColor=e<128?"white":"black"}const le=[{fr:"janvier",oc:"de genièr"},{fr:"février",oc:"de febrièr"},{fr:"mars",oc:"de març"},{fr:"avril",oc:"d'abril"},{fr:"mai",oc:"de mai"},{fr:"juin",oc:"de junh"},{fr:"juillet",oc:"de julhet"},{fr:"août",oc:"d'agost"},{fr:"septembre",oc:"de setembre"},{fr:"octobre",oc:"d'octobre"},{fr:"novembre",oc:"de novembre"},{fr:"décembre",oc:"de decembre"}];var se=function(){var e=function(){return e=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};function t(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<n;t++)for(var r=arguments[t],i=0,l=r.length;i<l;i++,o++)a[o]=r[i];return a}var n=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],a={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},o={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},r=function(e,t){return void 0===t&&(t=2),("000"+e).slice(-1*t)},i=function(e){return!0===e?1:0};function l(e,t){var n;return function(){var a=this,o=arguments;clearTimeout(n),n=setTimeout(function(){return e.apply(a,o)},t)}}var s=function(e){return e instanceof Array?e:[e]};function c(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function u(e,t,n){var a=window.document.createElement(e);return t=t||"",n=n||"",a.className=t,void 0!==n&&(a.textContent=n),a}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function g(e,t){return t(e)?e:e.parentNode?g(e.parentNode,t):void 0}function m(e,t){var n=u("div","numInputWrapper"),a=u("input","numInput "+e),o=u("span","arrowUp"),r=u("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?a.type="number":(a.type="text",a.pattern="\\d*"),void 0!==t)for(var i in t)a.setAttribute(i,t[i]);return n.appendChild(a),n.appendChild(o),n.appendChild(r),n}function p(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(t){return e.target}}var f=function(){},h=function(e,t,n){return n.months[t?"shorthand":"longhand"][e]},v={D:f,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:function(e,t){e.setHours((e.getHours()>=12?12:0)+parseFloat(t))},H:function(e,t){e.setHours(parseFloat(t))},J:function(e,t){e.setDate(parseFloat(t))},K:function(e,t,n){e.setHours(e.getHours()%12+12*i(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:function(e,t){e.setSeconds(parseFloat(t))},U:function(e,t){return new Date(1e3*parseFloat(t))},W:function(e,t,n){var a=parseInt(t),o=new Date(e.getFullYear(),0,2+7*(a-1),0,0,0,0);return o.setDate(o.getDate()-o.getDay()+n.firstDayOfWeek),o},Y:function(e,t){e.setFullYear(parseFloat(t))},Z:function(e,t){return new Date(t)},d:function(e,t){e.setDate(parseFloat(t))},h:function(e,t){e.setHours((e.getHours()>=12?12:0)+parseFloat(t))},i:function(e,t){e.setMinutes(parseFloat(t))},j:function(e,t){e.setDate(parseFloat(t))},l:f,m:function(e,t){e.setMonth(parseFloat(t)-1)},n:function(e,t){e.setMonth(parseFloat(t)-1)},s:function(e,t){e.setSeconds(parseFloat(t))},u:function(e,t){return new Date(parseFloat(t))},w:f,y:function(e,t){e.setFullYear(2e3+parseFloat(t))}},y={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},_={Z:function(e){return e.toISOString()},D:function(e,t,n){return t.weekdays.shorthand[_.w(e,t,n)]},F:function(e,t,n){return h(_.n(e,t,n)-1,!1,t)},G:function(e,t,n){return r(_.h(e,t,n))},H:function(e){return r(e.getHours())},J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:function(e,t){return t.amPM[i(e.getHours()>11)]},M:function(e,t){return h(e.getMonth(),!0,t)},S:function(e){return r(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,t,n){return n.getWeek(e)},Y:function(e){return r(e.getFullYear(),4)},d:function(e){return r(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return r(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:function(e){return r(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},b=function(e){var t=e.config,n=void 0===t?a:t,r=e.l10n,i=void 0===r?o:r,l=e.isMobile,s=void 0!==l&&l;return function(e,t,a){var o=a||i;return void 0===n.formatDate||s?t.split("").map(function(t,a,r){return _[t]&&"\\"!==r[a-1]?_[t](e,o,n):"\\"!==t?t:""}).join(""):n.formatDate(e,t,o)}},w=function(e){var t=e.config,n=void 0===t?a:t,r=e.l10n,i=void 0===r?o:r;return function(e,t,o,r){if(0===e||e){var l,s=r||i,c=e;if(e instanceof Date)l=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)l=new Date(e);else if("string"==typeof e){var u=t||(n||a).dateFormat,d=String(e).trim();if("today"===d)l=new Date,o=!0;else if(n&&n.parseDate)l=n.parseDate(e,u);else if(/Z$/.test(d)||/GMT$/.test(d))l=new Date(e);else{for(var g=void 0,m=[],p=0,f=0,h="";p<u.length;p++){var _=u[p],b="\\"===_,w="\\"===u[p-1]||b;if(y[_]&&!w){h+=y[_];var C=new RegExp(h).exec(e);C&&(g=!0)&&m["Y"!==_?"push":"unshift"]({fn:v[_],val:C[++f]})}else b||(h+=".")}l=n&&n.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),m.forEach(function(e){var t=e.fn,n=e.val;return l=t(l,n,s)||l}),l=g?l:void 0}}if(l instanceof Date&&!isNaN(l.getTime()))return!0===o&&l.setHours(0,0,0,0),l;n.errorHandler(new Error("Invalid date provided: "+c))}}};function C(e,t,n){return void 0===n&&(n=!0),!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}var D=function(e,t,n){return 3600*e+60*t+n},x=864e5;function E(e){var t=e.defaultHour,n=e.defaultMinute,a=e.defaultSeconds;if(void 0!==e.minDate){var o=e.minDate.getHours(),r=e.minDate.getMinutes(),i=e.minDate.getSeconds();t<o&&(t=o),t===o&&n<r&&(n=r),t===o&&n===r&&a<i&&(a=e.minDate.getSeconds())}if(void 0!==e.maxDate){var l=e.maxDate.getHours(),s=e.maxDate.getMinutes();(t=Math.min(t,l))===l&&(n=Math.min(s,n)),t===l&&n===s&&(a=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:a}}function M(f,v){var _={config:e(e({},a),k.defaultConfig),l10n:o};function M(){var e;return(null===(e=_.calendarContainer)||void 0===e?void 0:e.getRootNode()).activeElement||document.activeElement}function L(e){return e.bind(_)}function T(){var e=_.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame(function(){if(void 0!==_.calendarContainer&&(_.calendarContainer.style.visibility="hidden",_.calendarContainer.style.display="block"),void 0!==_.daysContainer){var t=(_.days.offsetWidth+1)*e.showMonths;_.daysContainer.style.width=t+"px",_.calendarContainer.style.width=t+(void 0!==_.weekWrapper?_.weekWrapper.offsetWidth:0)+"px",_.calendarContainer.style.removeProperty("visibility"),_.calendarContainer.style.removeProperty("display")}})}function I(e){if(0===_.selectedDates.length){var t=void 0===_.config.minDate||C(new Date,_.config.minDate)>=0?new Date:new Date(_.config.minDate.getTime()),n=E(_.config);t.setHours(n.hours,n.minutes,n.seconds,t.getMilliseconds()),_.selectedDates=[t],_.latestSelectedDateObj=t}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();var t="keydown"===e.type,n=p(e),a=n;void 0!==_.amPM&&n===_.amPM&&(_.amPM.textContent=_.l10n.amPM[i(_.amPM.textContent===_.l10n.amPM[0])]);var o=parseFloat(a.getAttribute("min")),l=parseFloat(a.getAttribute("max")),s=parseFloat(a.getAttribute("step")),c=parseInt(a.value,10),u=e.delta||(t?38===e.which?1:-1:0),d=c+s*u;if(void 0!==a.value&&2===a.value.length){var g=a===_.hourElement,m=a===_.minuteElement;d<o?(d=l+d+i(!g)+(i(g)&&i(!_.amPM)),m&&H(void 0,-1,_.hourElement)):d>l&&(d=a===_.hourElement?d-l-i(!_.amPM):o,m&&H(void 0,1,_.hourElement)),_.amPM&&g&&(1===s?d+c===23:Math.abs(d-c)>s)&&(_.amPM.textContent=_.l10n.amPM[i(_.amPM.textContent===_.l10n.amPM[0])]),a.value=r(d)}}(e);var a=_._input.value;S(),De(),_._input.value!==a&&_._debouncedChange()}function S(){if(void 0!==_.hourElement&&void 0!==_.minuteElement){var e,t,n=(parseInt(_.hourElement.value.slice(-2),10)||0)%24,a=(parseInt(_.minuteElement.value,10)||0)%60,o=void 0!==_.secondElement?(parseInt(_.secondElement.value,10)||0)%60:0;void 0!==_.amPM&&(e=n,t=_.amPM.textContent,n=e%12+12*i(t===_.l10n.amPM[1]));var r=void 0!==_.config.minTime||_.config.minDate&&_.minDateHasTime&&_.latestSelectedDateObj&&0===C(_.latestSelectedDateObj,_.config.minDate,!0),l=void 0!==_.config.maxTime||_.config.maxDate&&_.maxDateHasTime&&_.latestSelectedDateObj&&0===C(_.latestSelectedDateObj,_.config.maxDate,!0);if(void 0!==_.config.maxTime&&void 0!==_.config.minTime&&_.config.minTime>_.config.maxTime){var s=D(_.config.minTime.getHours(),_.config.minTime.getMinutes(),_.config.minTime.getSeconds()),c=D(_.config.maxTime.getHours(),_.config.maxTime.getMinutes(),_.config.maxTime.getSeconds()),u=D(n,a,o);if(u>c&&u<s){var d=function(e){var t=Math.floor(e/3600),n=(e-3600*t)/60;return[t,n,e-3600*t-60*n]}(s);n=d[0],a=d[1],o=d[2]}}else{if(l){var g=void 0!==_.config.maxTime?_.config.maxTime:_.config.maxDate;(n=Math.min(n,g.getHours()))===g.getHours()&&(a=Math.min(a,g.getMinutes())),a===g.getMinutes()&&(o=Math.min(o,g.getSeconds()))}if(r){var m=void 0!==_.config.minTime?_.config.minTime:_.config.minDate;(n=Math.max(n,m.getHours()))===m.getHours()&&a<m.getMinutes()&&(a=m.getMinutes()),a===m.getMinutes()&&(o=Math.max(o,m.getSeconds()))}}N(n,a,o)}}function A(e){var t=e||_.latestSelectedDateObj;t&&t instanceof Date&&N(t.getHours(),t.getMinutes(),t.getSeconds())}function N(e,t,n){void 0!==_.latestSelectedDateObj&&_.latestSelectedDateObj.setHours(e%24,t,n||0,0),_.hourElement&&_.minuteElement&&!_.isMobile&&(_.hourElement.value=r(_.config.time_24hr?e:(12+e)%12+12*i(e%12==0)),_.minuteElement.value=r(t),void 0!==_.amPM&&(_.amPM.textContent=_.l10n.amPM[i(e>=12)]),void 0!==_.secondElement&&(_.secondElement.value=r(n)))}function O(e){var t=p(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&ee(n)}function j(e,t,n,a){return t instanceof Array?t.forEach(function(t){return j(e,t,n,a)}):e instanceof Array?e.forEach(function(e){return j(e,t,n,a)}):(e.addEventListener(t,n,a),void _._handlers.push({remove:function(){return e.removeEventListener(t,n,a)}}))}function F(){ye("onChange")}function P(e,t){var n=void 0!==e?_.parseDate(e):_.latestSelectedDateObj||(_.config.minDate&&_.config.minDate>_.now?_.config.minDate:_.config.maxDate&&_.config.maxDate<_.now?_.config.maxDate:_.now),a=_.currentYear,o=_.currentMonth;try{void 0!==n&&(_.currentYear=n.getFullYear(),_.currentMonth=n.getMonth())}catch(e){e.message="Invalid date supplied: "+n,_.config.errorHandler(e)}t&&_.currentYear!==a&&(ye("onYearChange"),z()),!t||_.currentYear===a&&_.currentMonth===o||ye("onMonthChange"),_.redraw()}function B(e){var t=p(e);~t.className.indexOf("arrow")&&H(e,t.classList.contains("arrowUp")?1:-1)}function H(e,t,n){var a=e&&p(e),o=n||a&&a.parentNode&&a.parentNode.firstChild,r=_e("increment");r.delta=t,o&&o.dispatchEvent(r)}function R(e,t,n,a){var o=te(t,!0),r=u("span",e,t.getDate().toString());return r.dateObj=t,r.$i=a,r.setAttribute("aria-label",_.formatDate(t,_.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===C(t,_.now)&&(_.todayDateElem=r,r.classList.add("today"),r.setAttribute("aria-current","date")),o?(r.tabIndex=-1,be(t)&&(r.classList.add("selected"),_.selectedDateElem=r,"range"===_.config.mode&&(c(r,"startRange",_.selectedDates[0]&&0===C(t,_.selectedDates[0],!0)),c(r,"endRange",_.selectedDates[1]&&0===C(t,_.selectedDates[1],!0)),"nextMonthDay"===e&&r.classList.add("inRange")))):r.classList.add("flatpickr-disabled"),"range"===_.config.mode&&function(e){return!("range"!==_.config.mode||_.selectedDates.length<2)&&(C(e,_.selectedDates[0])>=0&&C(e,_.selectedDates[1])<=0)}(t)&&!be(t)&&r.classList.add("inRange"),_.weekNumbers&&1===_.config.showMonths&&"prevMonthDay"!==e&&a%7==6&&_.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+_.config.getWeek(t)+"</span>"),ye("onDayCreate",r),r}function Y(e){e.focus(),"range"===_.config.mode&&re(e)}function W(e){for(var t=e>0?0:_.config.showMonths-1,n=e>0?_.config.showMonths:-1,a=t;a!=n;a+=e)for(var o=_.daysContainer.children[a],r=e>0?0:o.children.length-1,i=e>0?o.children.length:-1,l=r;l!=i;l+=e){var s=o.children[l];if(-1===s.className.indexOf("hidden")&&te(s.dateObj))return s}}function $(e,t){var n=M(),a=ne(n||document.body),o=void 0!==e?e:a?n:void 0!==_.selectedDateElem&&ne(_.selectedDateElem)?_.selectedDateElem:void 0!==_.todayDateElem&&ne(_.todayDateElem)?_.todayDateElem:W(t>0?1:-1);void 0===o?_._input.focus():a?function(e,t){for(var n=-1===e.className.indexOf("Month")?e.dateObj.getMonth():_.currentMonth,a=t>0?_.config.showMonths:-1,o=t>0?1:-1,r=n-_.currentMonth;r!=a;r+=o)for(var i=_.daysContainer.children[r],l=n-_.currentMonth===r?e.$i+t:t<0?i.children.length-1:0,s=i.children.length,c=l;c>=0&&c<s&&c!=(t>0?s:-1);c+=o){var u=i.children[c];if(-1===u.className.indexOf("hidden")&&te(u.dateObj)&&Math.abs(e.$i-c)>=Math.abs(t))return Y(u)}_.changeMonth(o),$(W(o),0)}(o,t):Y(o)}function q(e,t){for(var n=(new Date(e,t,1).getDay()-_.l10n.firstDayOfWeek+7)%7,a=_.utils.getDaysInMonth((t-1+12)%12,e),o=_.utils.getDaysInMonth(t,e),r=window.document.createDocumentFragment(),i=_.config.showMonths>1,l=i?"prevMonthDay hidden":"prevMonthDay",s=i?"nextMonthDay hidden":"nextMonthDay",c=a+1-n,d=0;c<=a;c++,d++)r.appendChild(R("flatpickr-day "+l,new Date(e,t-1,c),0,d));for(c=1;c<=o;c++,d++)r.appendChild(R("flatpickr-day",new Date(e,t,c),0,d));for(var g=o+1;g<=42-n&&(1===_.config.showMonths||d%7!=0);g++,d++)r.appendChild(R("flatpickr-day "+s,new Date(e,t+1,g%o),0,d));var m=u("div","dayContainer");return m.appendChild(r),m}function U(){if(void 0!==_.daysContainer){d(_.daysContainer),_.weekNumbers&&d(_.weekNumbers);for(var e=document.createDocumentFragment(),t=0;t<_.config.showMonths;t++){var n=new Date(_.currentYear,_.currentMonth,1);n.setMonth(_.currentMonth+t),e.appendChild(q(n.getFullYear(),n.getMonth()))}_.daysContainer.appendChild(e),_.days=_.daysContainer.firstChild,"range"===_.config.mode&&1===_.selectedDates.length&&re()}}function z(){if(!(_.config.showMonths>1||"dropdown"!==_.config.monthSelectorType)){var e=function(e){return!(void 0!==_.config.minDate&&_.currentYear===_.config.minDate.getFullYear()&&e<_.config.minDate.getMonth())&&!(void 0!==_.config.maxDate&&_.currentYear===_.config.maxDate.getFullYear()&&e>_.config.maxDate.getMonth())};_.monthsDropdownContainer.tabIndex=-1,_.monthsDropdownContainer.innerHTML="";for(var t=0;t<12;t++)if(e(t)){var n=u("option","flatpickr-monthDropdown-month");n.value=new Date(_.currentYear,t).getMonth().toString(),n.textContent=h(t,_.config.shorthandCurrentMonth,_.l10n),n.tabIndex=-1,_.currentMonth===t&&(n.selected=!0),_.monthsDropdownContainer.appendChild(n)}}}function G(){var e,t=u("div","flatpickr-month"),n=window.document.createDocumentFragment();_.config.showMonths>1||"static"===_.config.monthSelectorType?e=u("span","cur-month"):(_.monthsDropdownContainer=u("select","flatpickr-monthDropdown-months"),_.monthsDropdownContainer.setAttribute("aria-label",_.l10n.monthAriaLabel),j(_.monthsDropdownContainer,"change",function(e){var t=p(e),n=parseInt(t.value,10);_.changeMonth(n-_.currentMonth),ye("onMonthChange")}),z(),e=_.monthsDropdownContainer);var a=m("cur-year",{tabindex:"-1"}),o=a.getElementsByTagName("input")[0];o.setAttribute("aria-label",_.l10n.yearAriaLabel),_.config.minDate&&o.setAttribute("min",_.config.minDate.getFullYear().toString()),_.config.maxDate&&(o.setAttribute("max",_.config.maxDate.getFullYear().toString()),o.disabled=!!_.config.minDate&&_.config.minDate.getFullYear()===_.config.maxDate.getFullYear());var r=u("div","flatpickr-current-month");return r.appendChild(e),r.appendChild(a),n.appendChild(r),t.appendChild(n),{container:t,yearElement:o,monthElement:e}}function J(){d(_.monthNav),_.monthNav.appendChild(_.prevMonthNav),_.config.showMonths&&(_.yearElements=[],_.monthElements=[]);for(var e=_.config.showMonths;e--;){var t=G();_.yearElements.push(t.yearElement),_.monthElements.push(t.monthElement),_.monthNav.appendChild(t.container)}_.monthNav.appendChild(_.nextMonthNav)}function V(){_.weekdayContainer?d(_.weekdayContainer):_.weekdayContainer=u("div","flatpickr-weekdays");for(var e=_.config.showMonths;e--;){var t=u("div","flatpickr-weekdaycontainer");_.weekdayContainer.appendChild(t)}return K(),_.weekdayContainer}function K(){if(_.weekdayContainer){var e=_.l10n.firstDayOfWeek,n=t(_.l10n.weekdays.shorthand);e>0&&e<n.length&&(n=t(n.splice(e,n.length),n.splice(0,e)));for(var a=_.config.showMonths;a--;)_.weekdayContainer.children[a].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+n.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function X(e,t){void 0===t&&(t=!0);var n=t?e:e-_.currentMonth;n<0&&!0===_._hidePrevMonthArrow||n>0&&!0===_._hideNextMonthArrow||(_.currentMonth+=n,(_.currentMonth<0||_.currentMonth>11)&&(_.currentYear+=_.currentMonth>11?1:-1,_.currentMonth=(_.currentMonth+12)%12,ye("onYearChange"),z()),U(),ye("onMonthChange"),we())}function Z(e){return _.calendarContainer.contains(e)}function Q(e){if(_.isOpen&&!_.config.inline){var t=p(e),n=Z(t),a=!(t===_.input||t===_.altInput||_.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(_.input)||~e.path.indexOf(_.altInput)))&&!n&&!Z(e.relatedTarget),o=!_.config.ignoredFocusElements.some(function(e){return e.contains(t)});a&&o&&(_.config.allowInput&&_.setDate(_._input.value,!1,_.config.altInput?_.config.altFormat:_.config.dateFormat),void 0!==_.timeContainer&&void 0!==_.minuteElement&&void 0!==_.hourElement&&""!==_.input.value&&void 0!==_.input.value&&I(),_.close(),_.config&&"range"===_.config.mode&&1===_.selectedDates.length&&_.clear(!1))}}function ee(e){if(!(!e||_.config.minDate&&e<_.config.minDate.getFullYear()||_.config.maxDate&&e>_.config.maxDate.getFullYear())){var t=e,n=_.currentYear!==t;_.currentYear=t||_.currentYear,_.config.maxDate&&_.currentYear===_.config.maxDate.getFullYear()?_.currentMonth=Math.min(_.config.maxDate.getMonth(),_.currentMonth):_.config.minDate&&_.currentYear===_.config.minDate.getFullYear()&&(_.currentMonth=Math.max(_.config.minDate.getMonth(),_.currentMonth)),n&&(_.redraw(),ye("onYearChange"),z())}}function te(e,t){var n;void 0===t&&(t=!0);var a=_.parseDate(e,void 0,t);if(_.config.minDate&&a&&C(a,_.config.minDate,void 0!==t?t:!_.minDateHasTime)<0||_.config.maxDate&&a&&C(a,_.config.maxDate,void 0!==t?t:!_.maxDateHasTime)>0)return!1;if(!_.config.enable&&0===_.config.disable.length)return!0;if(void 0===a)return!1;for(var o=!!_.config.enable,r=null!==(n=_.config.enable)&&void 0!==n?n:_.config.disable,i=0,l=void 0;i<r.length;i++){if("function"==typeof(l=r[i])&&l(a))return o;if(l instanceof Date&&void 0!==a&&l.getTime()===a.getTime())return o;if("string"==typeof l){var s=_.parseDate(l,void 0,!0);return s&&s.getTime()===a.getTime()?o:!o}if("object"==typeof l&&void 0!==a&&l.from&&l.to&&a.getTime()>=l.from.getTime()&&a.getTime()<=l.to.getTime())return o}return!o}function ne(e){return void 0!==_.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&_.daysContainer.contains(e))}function ae(e){var t=e.target===_._input,n=_._input.value.trimEnd()!==Ce();!t||!n||e.relatedTarget&&Z(e.relatedTarget)||_.setDate(_._input.value,!0,e.target===_.altInput?_.config.altFormat:_.config.dateFormat)}function oe(e){var t=p(e),n=_.config.wrap?f.contains(t):t===_._input,a=_.config.allowInput,o=_.isOpen&&(!a||!n),r=_.config.inline&&n&&!a;if(13===e.keyCode&&n){if(a)return _.setDate(_._input.value,!0,t===_.altInput?_.config.altFormat:_.config.dateFormat),_.close(),t.blur();_.open()}else if(Z(t)||o||r){var i=!!_.timeContainer&&_.timeContainer.contains(t);switch(e.keyCode){case 13:i?(e.preventDefault(),I(),ge()):me(e);break;case 27:e.preventDefault(),ge();break;case 8:case 46:n&&!_.config.allowInput&&(e.preventDefault(),_.clear());break;case 37:case 39:if(i||n)_.hourElement&&_.hourElement.focus();else{e.preventDefault();var l=M();if(void 0!==_.daysContainer&&(!1===a||l&&ne(l))){var s=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),X(s),$(W(1),0)):$(void 0,s)}}break;case 38:case 40:e.preventDefault();var c=40===e.keyCode?1:-1;_.daysContainer&&void 0!==t.$i||t===_.input||t===_.altInput?e.ctrlKey?(e.stopPropagation(),ee(_.currentYear-c),$(W(1),0)):i||$(void 0,7*c):t===_.currentYearElement?ee(_.currentYear-c):_.config.enableTime&&(!i&&_.hourElement&&_.hourElement.focus(),I(e),_._debouncedChange());break;case 9:if(i){var u=[_.hourElement,_.minuteElement,_.secondElement,_.amPM].concat(_.pluginElements).filter(function(e){return e}),d=u.indexOf(t);if(-1!==d){var g=u[d+(e.shiftKey?-1:1)];e.preventDefault(),(g||_._input).focus()}}else!_.config.noCalendar&&_.daysContainer&&_.daysContainer.contains(t)&&e.shiftKey&&(e.preventDefault(),_._input.focus())}}if(void 0!==_.amPM&&t===_.amPM)switch(e.key){case _.l10n.amPM[0].charAt(0):case _.l10n.amPM[0].charAt(0).toLowerCase():_.amPM.textContent=_.l10n.amPM[0],S(),De();break;case _.l10n.amPM[1].charAt(0):case _.l10n.amPM[1].charAt(0).toLowerCase():_.amPM.textContent=_.l10n.amPM[1],S(),De()}(n||Z(t))&&ye("onKeyDown",e)}function re(e,t){if(void 0===t&&(t="flatpickr-day"),1===_.selectedDates.length&&(!e||e.classList.contains(t)&&!e.classList.contains("flatpickr-disabled"))){for(var n=e?e.dateObj.getTime():_.days.firstElementChild.dateObj.getTime(),a=_.parseDate(_.selectedDates[0],void 0,!0).getTime(),o=Math.min(n,_.selectedDates[0].getTime()),r=Math.max(n,_.selectedDates[0].getTime()),i=!1,l=0,s=0,c=o;c<r;c+=x)te(new Date(c),!0)||(i=i||c>o&&c<r,c<a&&(!l||c>l)?l=c:c>a&&(!s||c<s)&&(s=c));Array.from(_.rContainer.querySelectorAll("*:nth-child(-n+"+_.config.showMonths+") > ."+t)).forEach(function(t){var o,r,c,u=t.dateObj.getTime(),d=l>0&&u<l||s>0&&u>s;if(d)return t.classList.add("notAllowed"),void["inRange","startRange","endRange"].forEach(function(e){t.classList.remove(e)});i&&!d||(["startRange","inRange","endRange","notAllowed"].forEach(function(e){t.classList.remove(e)}),void 0!==e&&(e.classList.add(n<=_.selectedDates[0].getTime()?"startRange":"endRange"),a<n&&u===a?t.classList.add("startRange"):a>n&&u===a&&t.classList.add("endRange"),u>=l&&(0===s||u<=s)&&(r=a,c=n,(o=u)>Math.min(r,c)&&o<Math.max(r,c))&&t.classList.add("inRange")))})}}function ie(){!_.isOpen||_.config.static||_.config.inline||ue()}function le(e){return function(t){var n=_.config["_"+e+"Date"]=_.parseDate(t,_.config.dateFormat),a=_.config["_"+("min"===e?"max":"min")+"Date"];void 0!==n&&(_["min"===e?"minDateHasTime":"maxDateHasTime"]=n.getHours()>0||n.getMinutes()>0||n.getSeconds()>0),_.selectedDates&&(_.selectedDates=_.selectedDates.filter(function(e){return te(e)}),_.selectedDates.length||"min"!==e||A(n),De()),_.daysContainer&&(de(),void 0!==n?_.currentYearElement[e]=n.getFullYear().toString():_.currentYearElement.removeAttribute(e),_.currentYearElement.disabled=!!a&&void 0!==n&&a.getFullYear()===n.getFullYear())}}function se(){return _.config.wrap?f.querySelector("[data-input]"):f}function ce(){"object"!=typeof _.config.locale&&void 0===k.l10ns[_.config.locale]&&_.config.errorHandler(new Error("flatpickr: invalid locale "+_.config.locale)),_.l10n=e(e({},k.l10ns.default),"object"==typeof _.config.locale?_.config.locale:"default"!==_.config.locale?k.l10ns[_.config.locale]:void 0),y.D="("+_.l10n.weekdays.shorthand.join("|")+")",y.l="("+_.l10n.weekdays.longhand.join("|")+")",y.M="("+_.l10n.months.shorthand.join("|")+")",y.F="("+_.l10n.months.longhand.join("|")+")",y.K="("+_.l10n.amPM[0]+"|"+_.l10n.amPM[1]+"|"+_.l10n.amPM[0].toLowerCase()+"|"+_.l10n.amPM[1].toLowerCase()+")",void 0===e(e({},v),JSON.parse(JSON.stringify(f.dataset||{}))).time_24hr&&void 0===k.defaultConfig.time_24hr&&(_.config.time_24hr=_.l10n.time_24hr),_.formatDate=b(_),_.parseDate=w({config:_.config,l10n:_.l10n})}function ue(e){if("function"!=typeof _.config.position){if(void 0!==_.calendarContainer){ye("onPreCalendarPosition");var t=e||_._positionElement,n=Array.prototype.reduce.call(_.calendarContainer.children,function(e,t){return e+t.offsetHeight},0),a=_.calendarContainer.offsetWidth,o=_.config.position.split(" "),r=o[0],i=o.length>1?o[1]:null,l=t.getBoundingClientRect(),s=window.innerHeight-l.bottom,u="above"===r||"below"!==r&&s<n&&l.top>n,d=window.pageYOffset+l.top+(u?-n-2:t.offsetHeight+2);if(c(_.calendarContainer,"arrowTop",!u),c(_.calendarContainer,"arrowBottom",u),!_.config.inline){var g=window.pageXOffset+l.left,m=!1,p=!1;"center"===i?(g-=(a-l.width)/2,m=!0):"right"===i&&(g-=a-l.width,p=!0),c(_.calendarContainer,"arrowLeft",!m&&!p),c(_.calendarContainer,"arrowCenter",m),c(_.calendarContainer,"arrowRight",p);var f=window.document.body.offsetWidth-(window.pageXOffset+l.right),h=g+a>window.document.body.offsetWidth,v=f+a>window.document.body.offsetWidth;if(c(_.calendarContainer,"rightMost",h),!_.config.static)if(_.calendarContainer.style.top=d+"px",h)if(v){var y=function(){for(var e=null,t=0;t<document.styleSheets.length;t++){var n=document.styleSheets[t];if(n.cssRules){try{n.cssRules}catch(e){continue}e=n;break}}return null!=e?e:(a=document.createElement("style"),document.head.appendChild(a),a.sheet);var a}();if(void 0===y)return;var b=window.document.body.offsetWidth,w=Math.max(0,b/2-a/2),C=y.cssRules.length,D="{left:"+l.left+"px;right:auto;}";c(_.calendarContainer,"rightMost",!1),c(_.calendarContainer,"centerMost",!0),y.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+D,C),_.calendarContainer.style.left=w+"px",_.calendarContainer.style.right="auto"}else _.calendarContainer.style.left="auto",_.calendarContainer.style.right=f+"px";else _.calendarContainer.style.left=g+"px",_.calendarContainer.style.right="auto"}}}else _.config.position(_,e)}function de(){_.config.noCalendar||_.isMobile||(z(),we(),U())}function ge(){_._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(_.close,0):_.close()}function me(e){e.preventDefault(),e.stopPropagation();var t=g(p(e),function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")});if(void 0!==t){var n=t,a=_.latestSelectedDateObj=new Date(n.dateObj.getTime()),o=(a.getMonth()<_.currentMonth||a.getMonth()>_.currentMonth+_.config.showMonths-1)&&"range"!==_.config.mode;if(_.selectedDateElem=n,"single"===_.config.mode)_.selectedDates=[a];else if("multiple"===_.config.mode){var r=be(a);r?_.selectedDates.splice(parseInt(r),1):_.selectedDates.push(a)}else"range"===_.config.mode&&(2===_.selectedDates.length&&_.clear(!1,!1),_.latestSelectedDateObj=a,_.selectedDates.push(a),0!==C(a,_.selectedDates[0],!0)&&_.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()}));if(S(),o){var i=_.currentYear!==a.getFullYear();_.currentYear=a.getFullYear(),_.currentMonth=a.getMonth(),i&&(ye("onYearChange"),z()),ye("onMonthChange")}if(we(),U(),De(),o||"range"===_.config.mode||1!==_.config.showMonths?void 0!==_.selectedDateElem&&void 0===_.hourElement&&_.selectedDateElem&&_.selectedDateElem.focus():Y(n),void 0!==_.hourElement&&void 0!==_.hourElement&&_.hourElement.focus(),_.config.closeOnSelect){var l="single"===_.config.mode&&!_.config.enableTime,s="range"===_.config.mode&&2===_.selectedDates.length&&!_.config.enableTime;(l||s)&&ge()}F()}}_.parseDate=w({config:_.config,l10n:_.l10n}),_._handlers=[],_.pluginElements=[],_.loadedPlugins=[],_._bind=j,_._setHoursFromDate=A,_._positionCalendar=ue,_.changeMonth=X,_.changeYear=ee,_.clear=function(e,t){void 0===e&&(e=!0);void 0===t&&(t=!0);_.input.value="",void 0!==_.altInput&&(_.altInput.value="");void 0!==_.mobileInput&&(_.mobileInput.value="");_.selectedDates=[],_.latestSelectedDateObj=void 0,!0===t&&(_.currentYear=_._initialDate.getFullYear(),_.currentMonth=_._initialDate.getMonth());if(!0===_.config.enableTime){var n=E(_.config);N(n.hours,n.minutes,n.seconds)}_.redraw(),e&&ye("onChange")},_.close=function(){_.isOpen=!1,_.isMobile||(void 0!==_.calendarContainer&&_.calendarContainer.classList.remove("open"),void 0!==_._input&&_._input.classList.remove("active"));ye("onClose")},_.onMouseOver=re,_._createElement=u,_.createDay=R,_.destroy=function(){void 0!==_.config&&ye("onDestroy");for(var e=_._handlers.length;e--;)_._handlers[e].remove();if(_._handlers=[],_.mobileInput)_.mobileInput.parentNode&&_.mobileInput.parentNode.removeChild(_.mobileInput),_.mobileInput=void 0;else if(_.calendarContainer&&_.calendarContainer.parentNode)if(_.config.static&&_.calendarContainer.parentNode){var t=_.calendarContainer.parentNode;if(t.lastChild&&t.removeChild(t.lastChild),t.parentNode){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}}else _.calendarContainer.parentNode.removeChild(_.calendarContainer);_.altInput&&(_.input.type="text",_.altInput.parentNode&&_.altInput.parentNode.removeChild(_.altInput),delete _.altInput);_.input&&(_.input.type=_.input._type,_.input.classList.remove("flatpickr-input"),_.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(e){try{delete _[e]}catch(e){}})},_.isEnabled=te,_.jumpToDate=P,_.updateValue=De,_.open=function(e,t){void 0===t&&(t=_._positionElement);if(!0===_.isMobile){if(e){e.preventDefault();var n=p(e);n&&n.blur()}return void 0!==_.mobileInput&&(_.mobileInput.focus(),_.mobileInput.click()),void ye("onOpen")}if(_._input.disabled||_.config.inline)return;var a=_.isOpen;_.isOpen=!0,a||(_.calendarContainer.classList.add("open"),_._input.classList.add("active"),ye("onOpen"),ue(t));!0===_.config.enableTime&&!0===_.config.noCalendar&&(!1!==_.config.allowInput||void 0!==e&&_.timeContainer.contains(e.relatedTarget)||setTimeout(function(){return _.hourElement.select()},50))},_.redraw=de,_.set=function(e,t){if(null!==e&&"object"==typeof e)for(var a in Object.assign(_.config,e),e)void 0!==pe[a]&&pe[a].forEach(function(e){return e()});else _.config[e]=t,void 0!==pe[e]?pe[e].forEach(function(e){return e()}):n.indexOf(e)>-1&&(_.config[e]=s(t));_.redraw(),De(!0)},_.setDate=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=_.config.dateFormat);if(0!==e&&!e||e instanceof Array&&0===e.length)return _.clear(t);fe(e,n),_.latestSelectedDateObj=_.selectedDates[_.selectedDates.length-1],_.redraw(),P(void 0,t),A(),0===_.selectedDates.length&&_.clear(!1);De(t),t&&ye("onChange")},_.toggle=function(e){if(!0===_.isOpen)return _.close();_.open(e)};var pe={locale:[ce,K],showMonths:[J,T,V],minDate:[P],maxDate:[P],positionElement:[ve],clickOpens:[function(){!0===_.config.clickOpens?(j(_._input,"focus",_.open),j(_._input,"click",_.open)):(_._input.removeEventListener("focus",_.open),_._input.removeEventListener("click",_.open))}]};function fe(e,t){var n=[];if(e instanceof Array)n=e.map(function(e){return _.parseDate(e,t)});else if(e instanceof Date||"number"==typeof e)n=[_.parseDate(e,t)];else if("string"==typeof e)switch(_.config.mode){case"single":case"time":n=[_.parseDate(e,t)];break;case"multiple":n=e.split(_.config.conjunction).map(function(e){return _.parseDate(e,t)});break;case"range":n=e.split(_.l10n.rangeSeparator).map(function(e){return _.parseDate(e,t)})}else _.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));_.selectedDates=_.config.allowInvalidPreload?n:n.filter(function(e){return e instanceof Date&&te(e,!1)}),"range"===_.config.mode&&_.selectedDates.sort(function(e,t){return e.getTime()-t.getTime()})}function he(e){return e.slice().map(function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?_.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:_.parseDate(e.from,void 0),to:_.parseDate(e.to,void 0)}:e}).filter(function(e){return e})}function ve(){_._positionElement=_.config.positionElement||_._input}function ye(e,t){if(void 0!==_.config){var n=_.config[e];if(void 0!==n&&n.length>0)for(var a=0;n[a]&&a<n.length;a++)n[a](_.selectedDates,_.input.value,_,t);"onChange"===e&&(_.input.dispatchEvent(_e("change")),_.input.dispatchEvent(_e("input")))}}function _e(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function be(e){for(var t=0;t<_.selectedDates.length;t++){var n=_.selectedDates[t];if(n instanceof Date&&0===C(n,e))return""+t}return!1}function we(){_.config.noCalendar||_.isMobile||!_.monthNav||(_.yearElements.forEach(function(e,t){var n=new Date(_.currentYear,_.currentMonth,1);n.setMonth(_.currentMonth+t),_.config.showMonths>1||"static"===_.config.monthSelectorType?_.monthElements[t].textContent=h(n.getMonth(),_.config.shorthandCurrentMonth,_.l10n)+" ":_.monthsDropdownContainer.value=n.getMonth().toString(),e.value=n.getFullYear().toString()}),_._hidePrevMonthArrow=void 0!==_.config.minDate&&(_.currentYear===_.config.minDate.getFullYear()?_.currentMonth<=_.config.minDate.getMonth():_.currentYear<_.config.minDate.getFullYear()),_._hideNextMonthArrow=void 0!==_.config.maxDate&&(_.currentYear===_.config.maxDate.getFullYear()?_.currentMonth+1>_.config.maxDate.getMonth():_.currentYear>_.config.maxDate.getFullYear()))}function Ce(e){var t=e||(_.config.altInput?_.config.altFormat:_.config.dateFormat);return _.selectedDates.map(function(e){return _.formatDate(e,t)}).filter(function(e,t,n){return"range"!==_.config.mode||_.config.enableTime||n.indexOf(e)===t}).join("range"!==_.config.mode?_.config.conjunction:_.l10n.rangeSeparator)}function De(e){void 0===e&&(e=!0),void 0!==_.mobileInput&&_.mobileFormatStr&&(_.mobileInput.value=void 0!==_.latestSelectedDateObj?_.formatDate(_.latestSelectedDateObj,_.mobileFormatStr):""),_.input.value=Ce(_.config.dateFormat),void 0!==_.altInput&&(_.altInput.value=Ce(_.config.altFormat)),!1!==e&&ye("onValueUpdate")}function xe(e){var t=p(e),n=_.prevMonthNav.contains(t),a=_.nextMonthNav.contains(t);n||a?X(n?-1:1):_.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?_.changeYear(_.currentYear+1):t.classList.contains("arrowDown")&&_.changeYear(_.currentYear-1)}return function(){_.element=_.input=f,_.isOpen=!1,function(){var t=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],o=e(e({},JSON.parse(JSON.stringify(f.dataset||{}))),v),r={};_.config.parseDate=o.parseDate,_.config.formatDate=o.formatDate,Object.defineProperty(_.config,"enable",{get:function(){return _.config._enable},set:function(e){_.config._enable=he(e)}}),Object.defineProperty(_.config,"disable",{get:function(){return _.config._disable},set:function(e){_.config._disable=he(e)}});var i="time"===o.mode;if(!o.dateFormat&&(o.enableTime||i)){var l=k.defaultConfig.dateFormat||a.dateFormat;r.dateFormat=o.noCalendar||i?"H:i"+(o.enableSeconds?":S":""):l+" H:i"+(o.enableSeconds?":S":"")}if(o.altInput&&(o.enableTime||i)&&!o.altFormat){var c=k.defaultConfig.altFormat||a.altFormat;r.altFormat=o.noCalendar||i?"h:i"+(o.enableSeconds?":S K":" K"):c+" h:i"+(o.enableSeconds?":S":"")+" K"}Object.defineProperty(_.config,"minDate",{get:function(){return _.config._minDate},set:le("min")}),Object.defineProperty(_.config,"maxDate",{get:function(){return _.config._maxDate},set:le("max")});var u=function(e){return function(t){_.config["min"===e?"_minTime":"_maxTime"]=_.parseDate(t,"H:i:S")}};Object.defineProperty(_.config,"minTime",{get:function(){return _.config._minTime},set:u("min")}),Object.defineProperty(_.config,"maxTime",{get:function(){return _.config._maxTime},set:u("max")}),"time"===o.mode&&(_.config.noCalendar=!0,_.config.enableTime=!0);Object.assign(_.config,r,o);for(var d=0;d<t.length;d++)_.config[t[d]]=!0===_.config[t[d]]||"true"===_.config[t[d]];n.filter(function(e){return void 0!==_.config[e]}).forEach(function(e){_.config[e]=s(_.config[e]||[]).map(L)}),_.isMobile=!_.config.disableMobile&&!_.config.inline&&"single"===_.config.mode&&!_.config.disable.length&&!_.config.enable&&!_.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(d=0;d<_.config.plugins.length;d++){var g=_.config.plugins[d](_)||{};for(var m in g)n.indexOf(m)>-1?_.config[m]=s(g[m]).map(L).concat(_.config[m]):void 0===o[m]&&(_.config[m]=g[m])}o.altInputClass||(_.config.altInputClass=se().className+" "+_.config.altInputClass);ye("onParseConfig")}(),ce(),function(){if(_.input=se(),!_.input)return void _.config.errorHandler(new Error("Invalid input element specified"));_.input._type=_.input.type,_.input.type="text",_.input.classList.add("flatpickr-input"),_._input=_.input,_.config.altInput&&(_.altInput=u(_.input.nodeName,_.config.altInputClass),_._input=_.altInput,_.altInput.placeholder=_.input.placeholder,_.altInput.disabled=_.input.disabled,_.altInput.required=_.input.required,_.altInput.tabIndex=_.input.tabIndex,_.altInput.type="text",_.input.setAttribute("type","hidden"),!_.config.static&&_.input.parentNode&&_.input.parentNode.insertBefore(_.altInput,_.input.nextSibling));_.config.allowInput||_._input.setAttribute("readonly","readonly");ve()}(),function(){_.selectedDates=[],_.now=_.parseDate(_.config.now)||new Date;var e=_.config.defaultDate||("INPUT"!==_.input.nodeName&&"TEXTAREA"!==_.input.nodeName||!_.input.placeholder||_.input.value!==_.input.placeholder?_.input.value:null);e&&fe(e,_.config.dateFormat);_._initialDate=_.selectedDates.length>0?_.selectedDates[0]:_.config.minDate&&_.config.minDate.getTime()>_.now.getTime()?_.config.minDate:_.config.maxDate&&_.config.maxDate.getTime()<_.now.getTime()?_.config.maxDate:_.now,_.currentYear=_._initialDate.getFullYear(),_.currentMonth=_._initialDate.getMonth(),_.selectedDates.length>0&&(_.latestSelectedDateObj=_.selectedDates[0]);void 0!==_.config.minTime&&(_.config.minTime=_.parseDate(_.config.minTime,"H:i"));void 0!==_.config.maxTime&&(_.config.maxTime=_.parseDate(_.config.maxTime,"H:i"));_.minDateHasTime=!!_.config.minDate&&(_.config.minDate.getHours()>0||_.config.minDate.getMinutes()>0||_.config.minDate.getSeconds()>0),_.maxDateHasTime=!!_.config.maxDate&&(_.config.maxDate.getHours()>0||_.config.maxDate.getMinutes()>0||_.config.maxDate.getSeconds()>0)}(),_.utils={getDaysInMonth:function(e,t){return void 0===e&&(e=_.currentMonth),void 0===t&&(t=_.currentYear),1===e&&(t%4==0&&t%100!=0||t%400==0)?29:_.l10n.daysInMonth[e]}},_.isMobile||function(){var e=window.document.createDocumentFragment();if(_.calendarContainer=u("div","flatpickr-calendar"),_.calendarContainer.tabIndex=-1,!_.config.noCalendar){if(e.appendChild((_.monthNav=u("div","flatpickr-months"),_.yearElements=[],_.monthElements=[],_.prevMonthNav=u("span","flatpickr-prev-month"),_.prevMonthNav.innerHTML=_.config.prevArrow,_.nextMonthNav=u("span","flatpickr-next-month"),_.nextMonthNav.innerHTML=_.config.nextArrow,J(),Object.defineProperty(_,"_hidePrevMonthArrow",{get:function(){return _.__hidePrevMonthArrow},set:function(e){_.__hidePrevMonthArrow!==e&&(c(_.prevMonthNav,"flatpickr-disabled",e),_.__hidePrevMonthArrow=e)}}),Object.defineProperty(_,"_hideNextMonthArrow",{get:function(){return _.__hideNextMonthArrow},set:function(e){_.__hideNextMonthArrow!==e&&(c(_.nextMonthNav,"flatpickr-disabled",e),_.__hideNextMonthArrow=e)}}),_.currentYearElement=_.yearElements[0],we(),_.monthNav)),_.innerContainer=u("div","flatpickr-innerContainer"),_.config.weekNumbers){var t=function(){_.calendarContainer.classList.add("hasWeeks");var e=u("div","flatpickr-weekwrapper");e.appendChild(u("span","flatpickr-weekday",_.l10n.weekAbbreviation));var t=u("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}(),n=t.weekWrapper,a=t.weekNumbers;_.innerContainer.appendChild(n),_.weekNumbers=a,_.weekWrapper=n}_.rContainer=u("div","flatpickr-rContainer"),_.rContainer.appendChild(V()),_.daysContainer||(_.daysContainer=u("div","flatpickr-days"),_.daysContainer.tabIndex=-1),U(),_.rContainer.appendChild(_.daysContainer),_.innerContainer.appendChild(_.rContainer),e.appendChild(_.innerContainer)}_.config.enableTime&&e.appendChild(function(){_.calendarContainer.classList.add("hasTime"),_.config.noCalendar&&_.calendarContainer.classList.add("noCalendar");var e=E(_.config);_.timeContainer=u("div","flatpickr-time"),_.timeContainer.tabIndex=-1;var t=u("span","flatpickr-time-separator",":"),n=m("flatpickr-hour",{"aria-label":_.l10n.hourAriaLabel});_.hourElement=n.getElementsByTagName("input")[0];var a=m("flatpickr-minute",{"aria-label":_.l10n.minuteAriaLabel});_.minuteElement=a.getElementsByTagName("input")[0],_.hourElement.tabIndex=_.minuteElement.tabIndex=-1,_.hourElement.value=r(_.latestSelectedDateObj?_.latestSelectedDateObj.getHours():_.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),_.minuteElement.value=r(_.latestSelectedDateObj?_.latestSelectedDateObj.getMinutes():e.minutes),_.hourElement.setAttribute("step",_.config.hourIncrement.toString()),_.minuteElement.setAttribute("step",_.config.minuteIncrement.toString()),_.hourElement.setAttribute("min",_.config.time_24hr?"0":"1"),_.hourElement.setAttribute("max",_.config.time_24hr?"23":"12"),_.hourElement.setAttribute("maxlength","2"),_.minuteElement.setAttribute("min","0"),_.minuteElement.setAttribute("max","59"),_.minuteElement.setAttribute("maxlength","2"),_.timeContainer.appendChild(n),_.timeContainer.appendChild(t),_.timeContainer.appendChild(a),_.config.time_24hr&&_.timeContainer.classList.add("time24hr");if(_.config.enableSeconds){_.timeContainer.classList.add("hasSeconds");var o=m("flatpickr-second");_.secondElement=o.getElementsByTagName("input")[0],_.secondElement.value=r(_.latestSelectedDateObj?_.latestSelectedDateObj.getSeconds():e.seconds),_.secondElement.setAttribute("step",_.minuteElement.getAttribute("step")),_.secondElement.setAttribute("min","0"),_.secondElement.setAttribute("max","59"),_.secondElement.setAttribute("maxlength","2"),_.timeContainer.appendChild(u("span","flatpickr-time-separator",":")),_.timeContainer.appendChild(o)}_.config.time_24hr||(_.amPM=u("span","flatpickr-am-pm",_.l10n.amPM[i((_.latestSelectedDateObj?_.hourElement.value:_.config.defaultHour)>11)]),_.amPM.title=_.l10n.toggleTitle,_.amPM.tabIndex=-1,_.timeContainer.appendChild(_.amPM));return _.timeContainer}());c(_.calendarContainer,"rangeMode","range"===_.config.mode),c(_.calendarContainer,"animate",!0===_.config.animate),c(_.calendarContainer,"multiMonth",_.config.showMonths>1),_.calendarContainer.appendChild(e);var o=void 0!==_.config.appendTo&&void 0!==_.config.appendTo.nodeType;if((_.config.inline||_.config.static)&&(_.calendarContainer.classList.add(_.config.inline?"inline":"static"),_.config.inline&&(!o&&_.element.parentNode?_.element.parentNode.insertBefore(_.calendarContainer,_._input.nextSibling):void 0!==_.config.appendTo&&_.config.appendTo.appendChild(_.calendarContainer)),_.config.static)){var l=u("div","flatpickr-wrapper");_.element.parentNode&&_.element.parentNode.insertBefore(l,_.element),l.appendChild(_.element),_.altInput&&l.appendChild(_.altInput),l.appendChild(_.calendarContainer)}_.config.static||_.config.inline||(void 0!==_.config.appendTo?_.config.appendTo:window.document.body).appendChild(_.calendarContainer)}(),function(){_.config.wrap&&["open","close","toggle","clear"].forEach(function(e){Array.prototype.forEach.call(_.element.querySelectorAll("[data-"+e+"]"),function(t){return j(t,"click",_[e])})});if(_.isMobile)return void function(){var e=_.config.enableTime?_.config.noCalendar?"time":"datetime-local":"date";_.mobileInput=u("input",_.input.className+" flatpickr-mobile"),_.mobileInput.tabIndex=1,_.mobileInput.type=e,_.mobileInput.disabled=_.input.disabled,_.mobileInput.required=_.input.required,_.mobileInput.placeholder=_.input.placeholder,_.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",_.selectedDates.length>0&&(_.mobileInput.defaultValue=_.mobileInput.value=_.formatDate(_.selectedDates[0],_.mobileFormatStr));_.config.minDate&&(_.mobileInput.min=_.formatDate(_.config.minDate,"Y-m-d"));_.config.maxDate&&(_.mobileInput.max=_.formatDate(_.config.maxDate,"Y-m-d"));_.input.getAttribute("step")&&(_.mobileInput.step=String(_.input.getAttribute("step")));_.input.type="hidden",void 0!==_.altInput&&(_.altInput.type="hidden");try{_.input.parentNode&&_.input.parentNode.insertBefore(_.mobileInput,_.input.nextSibling)}catch(e){}j(_.mobileInput,"change",function(e){_.setDate(p(e).value,!1,_.mobileFormatStr),ye("onChange"),ye("onClose")})}();var e=l(ie,50);_._debouncedChange=l(F,300),_.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&j(_.daysContainer,"mouseover",function(e){"range"===_.config.mode&&re(p(e))});j(_._input,"keydown",oe),void 0!==_.calendarContainer&&j(_.calendarContainer,"keydown",oe);_.config.inline||_.config.static||j(window,"resize",e);void 0!==window.ontouchstart?j(window.document,"touchstart",Q):j(window.document,"mousedown",Q);j(window.document,"focus",Q,{capture:!0}),!0===_.config.clickOpens&&(j(_._input,"focus",_.open),j(_._input,"click",_.open));void 0!==_.daysContainer&&(j(_.monthNav,"click",xe),j(_.monthNav,["keyup","increment"],O),j(_.daysContainer,"click",me));if(void 0!==_.timeContainer&&void 0!==_.minuteElement&&void 0!==_.hourElement){var t=function(e){return p(e).select()};j(_.timeContainer,["increment"],I),j(_.timeContainer,"blur",I,{capture:!0}),j(_.timeContainer,"click",B),j([_.hourElement,_.minuteElement],["focus","click"],t),void 0!==_.secondElement&&j(_.secondElement,"focus",function(){return _.secondElement&&_.secondElement.select()}),void 0!==_.amPM&&j(_.amPM,"click",function(e){I(e)})}_.config.allowInput&&j(_._input,"blur",ae)}(),(_.selectedDates.length||_.config.noCalendar)&&(_.config.enableTime&&A(_.config.noCalendar?_.latestSelectedDateObj:void 0),De(!1)),T();var t=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!_.isMobile&&t&&ue(),ye("onReady")}(),_}function L(e,t){for(var n=Array.prototype.slice.call(e).filter(function(e){return e instanceof HTMLElement}),a=[],o=0;o<n.length;o++){var r=n[o];try{if(null!==r.getAttribute("data-fp-omit"))continue;void 0!==r._flatpickr&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=M(r,t||{}),a.push(r._flatpickr)}catch(e){console.error(e)}}return 1===a.length?a[0]:a}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return L(this,e)},HTMLElement.prototype.flatpickr=function(e){return L([this],e)});var k=function(e,t){return"string"==typeof e?L(window.document.querySelectorAll(e),t):e instanceof Node?L([e],t):L(e,t)};return k.defaultConfig={},k.l10ns={en:e({},o),default:e({},o)},k.localize=function(t){k.l10ns.default=e(e({},k.l10ns.default),t)},k.setDefaults=function(t){k.defaultConfig=e(e({},k.defaultConfig),t)},k.parseDate=w({}),k.formatDate=b({}),k.compareDates=C,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return L(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=k),k}.call(void 0);const ce={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","févr","mars","avr","mai","juin","juil","août","sept","oct","nov","déc"],longhand:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ordinal:function(e){return e>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Défiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0},ue={weekdays:{shorthand:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],longhand:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},months:{shorthand:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],longhand:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},firstDayOfWeek:1,ordinal:function(){return"°"},rangeSeparator:" al ",weekAbbreviation:"Se",scrollTitle:"Scorri per aumentare",toggleTitle:"Clicca per cambiare",time_24hr:!0},de={firstDayOfWeek:1,weekdays:{shorthand:["dim","dl","dma","dme","dj","dv","ds"],longhand:["dimenge","diluns","dimars","dimècres","dijòus","divendres","dissabte"]},months:{shorthand:["gen","febr","març","abr","mai","jun","jul","ag","set","oct","nov","dec"],longhand:["genièr","febrièr","març","abril","mai","junh","julhet","agost","setembre","octobre","novembre","decembre"]},ordinal:function(e){return e>1?"":"èr"},rangeSeparator:" a ",weekAbbreviation:"Sem",scrollTitle:"Desfilar per aumentar",toggleTitle:"Clicar per bascular",time_24hr:!0};function ge(e="complet",t=null){const n=e=>{let t=e?e instanceof Date?e:new Date(e):new Date;return t instanceof Date&&!isNaN(t.getTime())||(t=new Date),t};let a;switch(e){case"complet":default:a={weekday:"long",year:"numeric",month:"long",day:"numeric"};break;case"sansJour":a={year:"numeric",month:"long",day:"numeric"};break;case"sansAnnee":a={weekday:"long",month:"long",day:"numeric"};break;case"court":{const e=n(t);return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()}`}}let r=n(t).toLocaleDateString(o.langue,a);r=r.replace(/\b1\b/,'1<span class="exposant">er</span>');let i=r.charAt(0).toUpperCase()+r.slice(1);return"oc"===o.langue&&(i=function(e){for(let t of ne){const n=new RegExp(`\\b${t.fr}\\b`,"g");e=e.replace(n,t.oc)}for(let t of le){const n=new RegExp(`\\b${t.fr}\\b`,"g");e=e.replace(n,t.oc)}return e}(i)),i}function me(){const e=document.createElement("span");e.innerHTML=ge();const t=document.createElement("div");t.id="divDate",t.appendChild(e),o.soulignerLaDate&&(e.style.textDecoration="underline red"),C.prepend(t);const n=document.createElement("br");C.insertBefore(n,t.nextSibling)}let pe=null,fe="";async function he(){const e=document.getElementById("datepicker"),t=document.getElementById("date-input");if(!e||!t)return;let n=document.getElementById("date").getBoundingClientRect().left;e.classList.remove("hide");const a=document.querySelector(".flatpickr-calendar");if(a&&(a.style.left=n+"px",a.classList.remove("hide")),t.focus(),!pe){const e=document.createElement("link");e.rel="stylesheet",e.href="./js/lib/flatpickr.min.css",document.head.appendChild(e),await new Promise((t,n)=>{e.onload=t,e.onerror=n})}if(!pe||fe!==o.langue){let a;switch(fe=o.langue,o.langue){case"fr":a=ce;break;case"it":a=ue;break;case"oc":a=de}pe=se(t,{inline:!0,dateFormat:"Y-m-d",locale:a,onChange:function(t){ve&&ve(t[0]),e.classList.add("hide");const n=document.querySelector(".flatpickr-calendar");n&&n.classList.add("hide")}});const r=document.querySelector(".flatpickr-calendar");r&&(r.style.left=n+"px",r.classList.remove("hide"))}}function ve(e=null){let t=null;t=e?ge("complet",e):ge();const n=document.getElementById("divDate");if(!n)return void me();const a=document.createElement("span");a.innerHTML=t,o.soulignerLaDate&&(a.style.textDecoration="underline red"),o.dateDuDoc=t,n.innerHTML="",n.appendChild(a)}function ye(e){let t=oe[e];c.style.backgroundColor=t,S.value=S.style.backgroundColor=t,ie()}function _e(){o.ajouterLaDate=O.checked,o.soulignerLaDate=j.checked,Q("ajouter-date",o.ajouterLaDate),Q("souligner-date",o.soulignerLaDate);const e=document.getElementById("divDate");e&&(o.soulignerLaDate?e.querySelector("span").style.textDecoration="underline red":e.querySelector("span").style.textDecoration=null)}function be(){o.majDateAuto=R.checked,Q("maj-date-auto",o.majDateAuto),o.majDateAuto&&ve()}function we(e){e&&e.stopPropagation();const t=document.getElementById("couleur-texte")?document.getElementById("couleur-texte").getBoundingClientRect():null;if(!t)return;let n=t.left;const a=document.getElementById("boutons-couleur-texte");a&&(a.style.left=n+"px",a.classList.toggle("hide"))}function Ce(){const e=document.getElementById("panneauOptions");e&&e.classList.toggle("hide")}function De(e){const t=document.getElementById("inputOpacite"),n=document.getElementById("voile_page"),a=document.getElementById("voile_marge"),o=document.getElementById("voile_marge2");"string"==typeof e&&(e=parseFloat(e)),t&&(t.value=e),n&&(n.style.backgroundColor="rgba(255,255,255,"+(1-e)+")"),a&&(a.style.backgroundColor="rgba(255,255,255,"+(1-e)+")"),o&&(o.style.backgroundColor="rgba(255,255,255,"+(1-e)+")");try{localStorage.setItem("opacite-lignes",e)}catch(e){console.error(e)}}function xe(e){if(!e)return;e.nodeType===Node.TEXT_NODE&&(e=e.parentElement);let t=e;for(;t&&t.nodeType===Node.ELEMENT_NODE&&!t.hasAttribute("contenteditable");)t=t.parentElement;t||(t=e);Array.from(t.querySelectorAll("span")).forEach(e=>{if(!e.classList.contains("entoure")&&e.textContent.length>1){const t=Array.from(e.classList),n=e.parentNode,a=document.createDocumentFragment();for(let n=0;n<e.textContent.length;n++){const o=document.createElement("span");o.textContent=e.textContent[n],t.forEach(e=>o.classList.add(e)),a.appendChild(o)}n.insertBefore(a,e),e.remove()}})}function Ee(e){if(!e)return;e.nodeType===Node.TEXT_NODE&&(e=e.parentElement);let t=e;for(;t&&t.nodeType===Node.ELEMENT_NODE&&!t.hasAttribute("contenteditable");)t=t.parentElement;if(!t)return;let n=!0;for(;n;){n=!1;const e=t.querySelectorAll("span");for(let t=0;t<e.length;t++){const a=e[t],o=a.nextSibling;if(o&&"SPAN"===o.tagName){if(Array.from(a.classList).sort().join(",")===Array.from(o.classList).sort().join(",")){a.textContent+=o.textContent,o.remove(),n=!0;break}}}}t.querySelectorAll("span").forEach(e=>{""===e.textContent&&e.remove()})}function Me(e){const t=[];function n(e,a=[]){if(e.nodeType===Node.TEXT_NODE){const n=e.textContent;for(let e=0;e<n.length;e++)t.push({texte:n[e],classes:[...a]})}else if(e.nodeType===Node.ELEMENT_NODE){if(e.classList&&e.classList.contains("entoure"))return void t.push({texte:null,noeud:e.cloneNode(!0),isEntoure:!0});const o=e.classList?Array.from(e.classList):[],r=[...a,...o];e.childNodes.forEach(e=>{n(e,r)})}}return e.childNodes.forEach(e=>n(e)),t}function Le(e){const t=window.getSelection();if(!t.rangeCount)return;const n=t.getRangeAt(0);if(n.collapsed)return;let a=n.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const o=n.cloneRange();o.selectNodeContents(a),o.setEnd(n.startContainer,n.startOffset);const r=o.toString().length,i=r+n.toString().length;xe(a);let l=0,s=null,c=0,u=null,d=0;const g=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let m;for(;m=g.nextNode();){const e=m.textContent.length;if(!s&&l+e>r&&(s=m,c=r-l),!u&&l+e>=i){u=m,d=i-l;break}l+=e}if(!s||!u)return;try{const e=document.createRange();e.setStart(s,c),e.setEnd(u,d),t.removeAllRanges(),t.addRange(e)}catch(e){return void console.warn("Impossible de restaurer la sélection",e)}const p=t.getRangeAt(0),f=p.startContainer;if(f===p.endContainer&&f.nodeType===Node.TEXT_NODE&&f.parentElement&&"SPAN"===f.parentElement.tagName&&0===p.startOffset&&p.endOffset===f.textContent.length){const t=f.parentElement;return["souligne-red","souligne-blue","souligne-green","souligne-yellow","souligne-pink","souligne-black","souligne-purple","souligne-orange"].forEach(e=>t.classList.remove(e)),void("transparent"!==e&&"white"!==e&&t.classList.add(`souligne-${e}`))}const h=Me(p.cloneContents());if(0===h.length)return;const v=document.createDocumentFragment(),y=["souligne-red","souligne-blue","souligne-green","souligne-yellow","souligne-pink","souligne-black","souligne-purple","souligne-orange"];h.forEach(t=>{if(t.isEntoure)return void v.appendChild(t.noeud);const n=document.createElement("span");n.textContent=t.texte,t.classes.forEach(e=>{y.includes(e)||n.classList.add(e)}),"transparent"!==e&&"white"!==e&&n.classList.add(`souligne-${e}`),v.appendChild(n)}),p.deleteContents(),p.insertNode(v),p.collapse(!1),t.removeAllRanges(),t.addRange(p),document.getElementById("souligne").style.textDecorationColor=e,document.getElementById("souligne").value=e,Ee(a)}let ke=!0;function Te(e){ke&&(document.querySelectorAll("#boutons_soulignement .deroule-souligne, .deroule-souligne").forEach(e=>{e.addEventListener("click",e=>{Le(e.currentTarget.value)})}),ke=!1),e&&e.stopPropagation();const t=document.getElementById("souligne")?document.getElementById("souligne").getBoundingClientRect():null;if(!t)return;let n=t.left;const a=document.getElementById("boutons_soulignement");a&&(a.style.left=n+"px",a.classList.toggle("hide"))}function Ie(){const e=Se();o.nombreDeCarreaux=Math.round(e/o.largeur_carreau),H.value=o.nombreDeCarreaux}function Se(){const e=C.offsetWidth,t=getComputedStyle(C);return e+parseFloat(t.marginLeft)+parseFloat(t.marginRight)}const Ae={Arial:{facteur_taille_police:.6,epaisseur_police:"normal",coef_marge:.28,coef_marge_windows:.25,distance_soulignage:.3,ligatures:[1,0],bouton_ligatures_display:"none"},"AA Cursive":{facteur_taille_police:.75,epaisseur_police:"normal",coef_marge:.35,coef_marge_windows:.3125,distance_soulignage:.3,ligatures:[0,1],bouton_ligatures_display:null},"Open Dyslexic":{facteur_taille_police:.45,epaisseur_police:"normal",coef_marge:.35,coef_marge_windows:.35,distance_soulignage:.5,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure CE":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure CM":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure GS":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},"Belle Allure script":{facteur_taille_police:.6,epaisseur_police:"bold",coef_marge:.375,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"},Acceseditionscursive:{facteur_taille_police:.674,epaisseur_police:"normal",coef_marge:.272,coef_marge_windows:.242857143,distance_soulignage:.379,ligatures:[1,0],bouton_ligatures_display:"none"},Luciole:{facteur_taille_police:.65,epaisseur_police:"normal",coef_marge:.29,coef_marge_windows:.258928572,distance_soulignage:.379,ligatures:[1,0],bouton_ligatures_display:"none"},Romain:{facteur_taille_police:.8,epaisseur_police:"bold",coef_marge:.3,coef_marge_windows:.334821429,distance_soulignage:.38,ligatures:[1,0],bouton_ligatures_display:"none"}};function Ne(){window.print()}function Oe(){o.largeur_page=_.offsetWidth,o.largeur_marge=p.offsetWidth,o.largeur_marge_secondaire=v.offsetWidth,o.largeur_page_impression=o.largeur_page/o.largeur_carreau*o.largeurImpression*4,o.largeur_marge_impression=o.largeur_marge/o.largeur_carreau*o.largeurImpression*4,o.largeur_marge_secondaire_impression=o.largeur_marge_secondaire/o.largeur_carreau*o.largeurImpression*4,document.documentElement.style.setProperty("--largeur-page-impression",o.largeur_page_impression+"mm"),document.documentElement.style.setProperty("--largeur-marge-impression",o.largeur_marge_impression+"mm"),document.documentElement.style.setProperty("--largeur-marge2-impression",o.largeur_margesecondaire_impression+"mm")}let je;function Fe(e,t,n){o.largeur_carreau_old=o.largeur_carreau,e?o.largeur_carreau=o.largeur_carreau+e:t&&(o.largeur_carreau=t);let a=o.largeur_carreau/o.largeur_carreau_old;e&&function(e){let t=C.scrollHeight,n=m.clientHeight,a=m.scrollTop;if(t*e<=n)return void(m.scrollTop=0);let o=t*e,r=(a+n/2)/t*o-n/2;r*=Math.pow(e,1.2),r=Math.max(0,Math.min(r,o-n)),m.scrollTop=r}(a);let r=4*o.largeurImpression;o.taille_police=o.largeur_carreau*o.facteur_taille_police;let i,l=r*o.facteur_taille_police;C.style.fontWeight=o.epaisseur_police,h.style.fontWeight=o.epaisseur_police,y.style.fontWeight=o.epaisseur_police,o.isWindows?(je=o.largeur_carreau*o.coef_marge_windows,i=r*o.coef_marge_windows):(je=o.largeur_carreau*o.coef_marge,i=r*o.coef_marge),"Open Dyslexic"===n&&(je*=.9),_.style.backgroundSize=o.largeur_carreau+"px",f.style.backgroundSize=o.largeur_carreau+"px",v.style.backgroundSize=o.largeur_carreau+"px",document.documentElement.style.setProperty("--largeur-carreau-impression",`${r}mm`),C.style.fontSize=o.taille_police+"px",document.documentElement.style.setProperty("--taille-police-impression",`${l}mm`),C.style.marginLeft=o.largeur_carreau/5+"px",C.style.marginRight=o.largeur_carreau/5+"px",h.style.fontSize=y.style.fontSize=o.taille_police+"px",h.style.marginTop=y.style.marginTop=je+"px",h.style.marginLeft=y.style.marginLeft=o.largeur_carreau/5+"px",h.style.marginRight=y.style.marginRight=o.largeur_carreau/5+"px",document.documentElement.style.setProperty("--marge-impression",r/5+"mm"),"terre"===o.typeCarreaux||"bleuviolet"===o.typeCarreaux||"trois_couleurs"===o.typeCarreaux||"quatre_couleurs"===o.typeCarreaux||o.interligneDouble?(h.style.lineHeight=2*o.largeur_carreau+"px",C.style.lineHeight=2*o.largeur_carreau+"px",document.documentElement.style.setProperty("--hauteur-ligne-impression",2*r+"mm"),C.style.marginTop=-je/3+"px",document.documentElement.style.setProperty("--marge-top-impression",-i/3+"mm")):(y.style.lineHeight=h.style.lineHeight=o.largeur_carreau+"px",C.style.lineHeight=o.largeur_carreau+"px",document.documentElement.style.setProperty("--hauteur-ligne-impression",`${r}mm`),C.style.marginTop=je+"px",document.documentElement.style.setProperty("--marge-top-impression",`${i}mm`)),document.documentElement.style.setProperty("--largeur-marge-secondaire",2.7*o.largeur_carreau+"px");document.querySelectorAll(".customfont").forEach(e=>{let t=getComputedStyle(e).fontFamily.trim(),n=Ae[t]?Ae[t].facteur_taille_police:null;n?e.style.fontSize=e.style.lineHeight=o.largeur_carreau*n+"px":console.warn(`La police ${t} n'a pas été trouvée dans l'objet typesPolices.`)});b.querySelectorAll(".trait").forEach(e=>{e.style.transition="none ";let t=window.getComputedStyle(e),n=parseInt(parseFloat(t.getPropertyValue("left"))/o.largeur_carreau_old),a=parseInt(parseFloat(t.getPropertyValue("top"))/o.largeur_carreau_old),r=parseInt(parseFloat(t.getPropertyValue("width"))/o.largeur_carreau_old),i=parseInt(parseFloat(t.getPropertyValue("height"))/o.largeur_carreau_old);isNaN(n)&&(n=0),isNaN(a)&&(a=0),isNaN(r)&&(r=0),isNaN(i)&&(i=0);let l=n*o.largeur_carreau,s=a*o.largeur_carreau;if(e.style.left=`${l}px`,e.style.top=`${s}px`,e.classList.contains("horizontal")){let t=r*o.largeur_carreau+.02117171*o.largeur_carreau;e.style.width=`${t}px`}if(e.classList.contains("vertical")){let t=i*o.largeur_carreau+.02117171*o.largeur_carreau;e.style.height=`${t}px`}e.style.transition=""}),Oe(),document.documentElement.style.setProperty("--decalage-depart",.02117171*-o.largeur_carreau+"px"),document.documentElement.style.setProperty("--decalage-position",-2-.02117171*o.largeur_carreau+"px"),Ie(),Q("largeur-carreau",o.largeur_carreau)}function Pe(e=0){o.largeur_marge=o.largeur_carreau*e,_.style.width=g.style.width="calc(100% - "+o.largeur_marge+"px)",p.style.width=o.largeur_marge-3+"px",document.documentElement.style.setProperty("--largeur-marge-impression",o.largeur_marge-3+"mm"),u.style.width=o.largeur_marge+"px",document.documentElement.style.setProperty("--largeur-marge-secondaire",2.7*o.largeur_carreau+"px"),document.documentElement.style.setProperty("--largeur-marge2-impression",2.7*o.largeur_carreau+"mm")}function Be(e){let t=o.typeCarreaux;o.typeCarreaux=e,o.typeCarreaux&&(f.style.backgroundImage="url('./images/carreau_marge_"+o.typeCarreaux+".svg",v.style.backgroundImage="url('./images/carreau_marge_"+o.typeCarreaux+".svg",_.style.backgroundImage="url('./images/carreau_"+o.typeCarreaux+".svg",document.getElementById("carreaux").style.backgroundImage=`url(./images/carreau_${e}.svg`),_.style.borderLeft="terre"===e?"none":null,"cahier_de_textes"===e?(v.style.display="block",Pe(7),p.style.borderRightColor="#000000",c.style.display="flex"):(v.style.display=null,c.style.display="none","cahier_de_textes"===t&&Pe(4),p.style.borderRightColor=null),Fe(0,!1,o.police_active),Q("type-carreaux",o.typeCarreaux)}function He(){document.querySelectorAll("#boutons_soulignement button").forEach(e=>{const t=`./images/${e.id}.svg`;e.style.backgroundImage=`url('${t}')`}),document.querySelectorAll("#boutons_carreaux button:not(.bouton-fermer)").forEach(e=>{let t=`./images/${e.id}.svg`;"./images/carreau_cahier_de_textes.svg"===t&&(t="./images/cahier_de_textes.svg"),e.style.backgroundImage=`url('${t}')`});const e={carreau_seyes:"seyes",carreau_seyes_noir:"seyes_noir",carreau_seyes_gris:"seyes_gris",carreau_ligne_base:"ligne_base",carreau_simple_ligne:"simple_ligne",carreau_double_ligne:"double_ligne",carreau_petit:"petit",carreau_terre:"terre",carreau_trois_couleurs:"trois_couleurs",carreau_quatre_couleurs:"quatre_couleurs",carreau_bleuviolet:"bleuviolet",carreau_cahier_de_textes:"cahier_de_textes"};Object.keys(e).forEach(t=>{const n=r(t);n&&n.addEventListener("click",()=>{Be(e[t])})});const t=document.querySelector("#boutons_carreaux .bouton-fermer");t&&t.addEventListener("click",()=>{const e=document.getElementById("boutons_carreaux");e&&e.classList.add("hide")})}let Re=!0;function Ye(){Re&&(He(),Re=!1);let e=document.getElementById("carreaux").getBoundingClientRect().left;document.getElementById("boutons_carreaux").style.left=e+"px",document.getElementById("boutons_carreaux").classList,document.getElementById("boutons_carreaux").classList.toggle("hide")}function We(e){let t=e.target,n=new Image;if(t.files&&t.files[0]){var a=new FileReader;a.onload=function(e){n.onload=function(){n.naturalWidth/n.naturalHeight>1?n.style.width="400px":n.style.height="400px"},n.src=e.target.result},a.readAsDataURL(t.files[0])}let o=document.createElement("div");o.addEventListener("click",function(){o.classList.add("selectionne")}),o.style.top=`${m.scrollTop+document.body.clientHeight/2}px`,o.classList.add("draggable","conteneur-image"),n.classList.add("image"),o.appendChild(n);let r=document.createElement("button");r.title="Supprimer",r.classList.add("bouton-supprimer-image"),r.addEventListener("click",function(){o.remove()}),o.appendChild(r);let i=document.createElement("button");i.title="Bordure",i.classList.add("bouton-cadre-image"),i.addEventListener("click",function(){o.classList.toggle("encadre")}),o.appendChild(i);let l=document.createElement("div");l.classList.add("poignee","nw");let s=document.createElement("div");s.classList.add("poignee","ne");let c=document.createElement("div");c.classList.add("poignee","sw");let u=document.createElement("div");u.classList.add("poignee","se"),o.appendChild(l),o.appendChild(s),o.appendChild(c),o.appendChild(u),w.appendChild(o)}function $e(){const e=document.getElementById("images"),t=document.getElementById("contenu"),n=document.body;let a=document.createElement("iframe");a.src="https://educajou.forge.apps.education.fr/tuxtimer/";let o=document.createElement("div");o.addEventListener("click",function(){o.classList.add("selectionne")}),o.style.top=`${t.scrollTop+n.clientHeight/2}px`,o.classList.add("draggable","conteneur-image"),a.classList.add("timer"),o.appendChild(a);let r=document.createElement("button");r.title="Supprimer",r.classList.add("bouton-supprimer-image"),r.addEventListener("click",function(){o.remove()}),o.appendChild(r);let i=document.createElement("button");i.title="Bordure",i.classList.add("bouton-cadre-image"),i.addEventListener("click",function(){o.classList.toggle("encadre")}),o.appendChild(i),["nw","ne","sw","se"].forEach(e=>{let t=document.createElement("div");t.classList.add("poignee",e),o.appendChild(t)}),e&&e.appendChild(o)}function qe(){o.regleActive=!o.regleActive,_.classList.toggle("trace"),V.classList.toggle("trace"),document.getElementById("regle").classList.toggle("trace"),o.regleActive||(_.style.cursor=null)}function Ue(e){o.selected?(o.selected.style.backgroundColor=e,o.selected.classList.remove("select"),o.selected=null):alert("Aucun trait n'est sélectionné.")}const ze={"souligne-red":"§r","souligne-blue":"§b","souligne-green":"§g","souligne-yellow":"§y","souligne-pink":"§p","souligne-black":"§k","souligne-purple":"§u","souligne-orange":"§o","couleur-red":"¤r","couleur-coral":"¤cr","couleur-salmon":"¤s","couleur-orange":"¤o","couleur-gold":"¤gd","couleur-yellow":"¤y","couleur-lime":"¤l","couleur-green":"¤g","couleur-olive":"¤ol","couleur-teal":"¤t","couleur-cyan":"¤c","couleur-blue":"¤b","couleur-navy":"¤n","couleur-indigo":"¤i","couleur-purple":"¤p","couleur-magenta":"¤m","couleur-pink":"¤pk","couleur-beige":"¤be","couleur-brown":"¤br","couleur-gray":"¤gr","couleur-silver":"¤sv","couleur-black":"¤bk","couleur-white":"¤w",entoure:"◆"},Ge=Object.fromEntries(Object.entries(ze).map(([e,t])=>[t,e]));function Je(e){let t=e;return t=t.replace(/<span class="([^"]*)">([^<]*)<\/span>/g,(e,t,n)=>`$${t.split(" ").filter(e=>e).map(e=>ze[e]||e).join("!")}!${n}$`),t=t.replace(/<span class="entoure">([^]*?)<\/span>/g,(e,t)=>`◆${Je(t)}◆`),t}function Ve(e){let t=e;return t=t.replace(/\$([^$]*)\$/g,(e,t)=>{const n=t.split("!"),a=n[n.length-1],o=n.slice(0,-1).map(e=>Ge[e]||e).filter(e=>e).join(" ");return o?`<span class="${o}">${a}</span>`:a}),t=t.replace(/◆([^]*?)◆/g,(e,t)=>`<span class="entoure">${Ve(t)}</span>`),t}let Ke=!0;function Xe(){Ke&&(!function(){const e=document.getElementById("ferme_menu_copie_lien");e&&e.addEventListener("click",()=>{if(z)l(z);else{const e=document.getElementById("zone_menu_copie_lien");e&&e.classList.add("hide")}})}(),Ke=!1),function(){let e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?";window.widget&&(e="https://educajou.forge.apps.education.fr/seyes?");const t=new URLSearchParams({marge:h?h.innerHTML:"","marge-secondaire":y?y.innerHTML:"",police:o.police_active||"","largeur-carreau":o.largeur_carreau||"","type-carreaux":o.typeCarreaux||"","opacite-lignes":o.opaciteLignes||"","largeur-marge":o.largeur_marge||0,"largeur-marge-secondaire":o.largeur_marge_secondaire||0,"interligne-double":o.interligneDouble||"","verifier-orthographe":o.verifierOrthographe||!1,"ecrire-a-cheval":o.ecrireAChevalSurLaMarge||!1,lang:o.langueChoix,"maj-date-auto":o.majDateAuto});Ee(C);const n=encodeURIComponent(Je(C.innerHTML))+"|_|"+encodeURIComponent(Je(b.innerHTML)),a=e+t.toString()+"#"+n;G.innerText=a}(),z.classList.toggle("hide"),z.classList.contains("hide")||U.classList.remove("hide")}function Ze(){const e=document.getElementById("zone_lien").innerText;navigator.clipboard.writeText(e).then(()=>{const e=document.createElement("div");e.innerHTML="Lien copié",e.style.position="fixed",e.style.backgroundColor="black",e.style.color="white",e.style.fontSize="12px",e.style.padding="5px 10px",e.style.borderRadius="5px",e.style.zIndex="2000",e.style.opacity="0",e.style.transition="opacity 0.3s";const t=document.getElementById("copier").getBoundingClientRect();e.style.left=t.left+window.scrollX+"px",e.style.top=t.top+window.scrollY-30+"px",m.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{m.removeChild(e)},300)},2e3)}).catch(e=>{console.error("Erreur lors de la copie : ",e)})}let Qe=!1;function et(){Qe?(J.style.backgroundPosition=null,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()):(J.style.backgroundPosition="0% 0%",K.requestFullscreen?K.requestFullscreen():K.mozRequestFullScreen?K.mozRequestFullScreen():K.webkitRequestFullscreen?K.webkitRequestFullscreen():K.msRequestFullscreen&&K.msRequestFullscreen()),Qe=!Qe}function tt(e){const t=document.getSelection();if(t.rangeCount>0){let n=t.anchorNode;for(;n&&"DIV"!==n.tagName;)n=n.parentNode;n?n.style.textAlign=e:console.warn("Aucun élément de type DIV trouvé")}else console.warn("Aucune sélection trouvée")}function nt(){const e=window.getSelection();if(!e.rangeCount)return;const t=e.getRangeAt(0);if(t.collapsed)return;const n=t.toString();let a=t.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const o=t.cloneRange();o.selectNodeContents(a),o.setEnd(t.startContainer,t.startOffset);const r=o.toString().length,i=r+n.length,l=t.cloneRange().cloneContents(),s=document.createElement("div");s.appendChild(l);const c=s.querySelectorAll(".entoure");if(1===c.length&&c[0].textContent===n){const e=Array.from(a.querySelectorAll(".entoure")).find(e=>e.textContent===n&&t.intersectsNode(e)&&e.textContent.trim()===n.trim());if(e){const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return void e.remove()}}const u=Array.from(a.querySelectorAll(".entoure")),d=[];u.forEach(e=>{t.intersectsNode(e)&&d.push(e)}),d.forEach(e=>{const t=e.parentNode;for(;e.firstChild;)t.insertBefore(e.firstChild,e);e.remove()});let g=0,m=null,p=0,f=null,h=0;const v=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let y;for(;y=v.nextNode();){const e=y.textContent.length;if(!m&&g+e>r&&(m=y,p=r-g),!f&&g+e>=i){f=y,h=i-g;break}g+=e}if(!m||!f)return void console.warn("Impossible de recréer la sélection");const _=document.createRange();try{_.setStart(m,p),_.setEnd(f,h)}catch(e){return void console.warn("Erreur setStart/setEnd:",e)}const b=document.createElement("span");b.classList.add("entoure");try{const t=_.extractContents();b.appendChild(t),_.insertNode(b),_.collapse(!1),e.removeAllRanges(),e.addRange(_)}catch(e){console.warn("Erreur lors de la création du span entoure:",e)}}function at(e){const t=window.getSelection();if(!t.rangeCount)return;const n=t.getRangeAt(0);if(n.collapsed)return;let a=n.commonAncestorContainer;for(a.nodeType===Node.TEXT_NODE&&(a=a.parentElement);a&&a.nodeType===Node.ELEMENT_NODE&&!a.hasAttribute("contenteditable");)a=a.parentElement;const o=n.cloneRange();o.selectNodeContents(a),o.setEnd(n.startContainer,n.startOffset);const r=o.toString().length,i=r+n.toString().length;xe(a);let l=0,s=null,c=0,u=null,d=0;const g=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);let m;for(;m=g.nextNode();){const e=m.textContent.length;if(!s&&l+e>r&&(s=m,c=r-l),!u&&l+e>=i){u=m,d=i-l;break}l+=e}if(!s||!u)return;try{const e=document.createRange();e.setStart(s,c),e.setEnd(u,d),t.removeAllRanges(),t.addRange(e)}catch(e){return void console.warn("Impossible de restaurer la sélection",e)}const p=t.getRangeAt(0),f=p.startContainer;if(f===p.endContainer&&f.nodeType===Node.TEXT_NODE&&f.parentElement&&"SPAN"===f.parentElement.tagName&&0===p.startOffset&&p.endOffset===f.textContent.length){const t=f.parentElement;return["couleur-red","couleur-coral","couleur-salmon","couleur-orange","couleur-gold","couleur-yellow","couleur-lime","couleur-green","couleur-olive","couleur-teal","couleur-cyan","couleur-blue","couleur-navy","couleur-indigo","couleur-purple","couleur-magenta","couleur-pink","couleur-beige","couleur-brown","couleur-gray","couleur-silver","couleur-black","couleur-white"].forEach(e=>t.classList.remove(e)),void t.classList.add(`couleur-${e}`)}const h=Me(p.cloneContents());if(0===h.length)return;const v=document.createDocumentFragment(),y=["couleur-red","couleur-coral","couleur-salmon","couleur-orange","couleur-gold","couleur-yellow","couleur-lime","couleur-green","couleur-olive","couleur-teal","couleur-cyan","couleur-blue","couleur-navy","couleur-indigo","couleur-purple","couleur-magenta","couleur-pink","couleur-beige","couleur-brown","couleur-gray","couleur-silver","couleur-black","couleur-white","couleur-transparent"];h.forEach(t=>{if(t.isEntoure)return void v.appendChild(t.noeud);const n=document.createElement("span");n.textContent=t.texte,t.classes.forEach(e=>{y.includes(e)||n.classList.add(e)}),n.classList.add(`couleur-${e}`),v.appendChild(n)}),p.deleteContents(),p.insertNode(v),p.collapse(!1),t.removeAllRanges(),t.addRange(p),document.getElementById("couleur-texte").style.color=e,document.getElementById("couleur-texte").value=e,document.getElementById("couleur-texte").style.webkitTextStroke="white"===e||"transparent"===e?"1px #000000":"0px",Ee(a)}function ot(){o.ecrireAChevalSurLaMarge=Y.checked,o.ecrireAChevalSurLaMarge?p.style.whiteSpace="nowrap":p.style.whiteSpace=null,Q("ecrire-a-cheval",o.ecrireAChevalSurLaMarge)}function rt(){o.verifierOrthographe=F.checked,Q("verifier-orthographe",o.verifierOrthographe),[h,y,C].forEach(e=>{e.spellcheck=o.verifierOrthographe,e.focus()})}function it(){o.interligneDouble=P.checked,Q("double-interligne",o.interligneDouble),Fe()}function lt(){let e=B.value;o.largeurImpression=parseFloat(e),Q("largeur-impression",o.largeurImpression),Fe()}function st(e){o.espacementLettres=parseFloat(e),Q("espacement-lettres",o.espacementLettres),C.style.letterSpacing=e/100+"em",0===o.espacementLettres?document.documentElement.style.setProperty("--ligatures",'"calt" 1',"important"):document.documentElement.style.setProperty("--ligatures",'"calt" 0',"important")}function ct(e){o.espacementMots=parseFloat(e),Q("espacement-mots",o.espacementMots),0===o.espacementMots?(C.style.wordSpacing="normal",h.style.wordSpacing="normal",y.style.wordSpacing="normal"):(C.style.wordSpacing=e+"em",h.style.wordSpacing=e+"em",y.style.wordSpacing=e+"em")}let ut=window.sens||[1,0];function dt(e,t){o.ligatures_on?("auto"!=e&&(T.style.backgroundPosition=null,o.ligatures_on=!1,C.spellcheck=!0,h.spellcheck=!0,y.spellcheck=!0),ut=[1,0]):("auto"!=e&&(T.style.backgroundPosition="0% 0%",o.ligatures_on=!0,C.spellcheck=!1,h.spellcheck=!1,y.spellcheck=!1),ut=[0,1]),t&&(ut=t);let n=C.innerHTML;for(let e=0;e<o.substitutions.length;e++){let t=o.substitutions[e][ut[0]],a=o.substitutions[e][ut[1]];n=n.replace(new RegExp(t,"g"),a)}C.innerHTML=n,n=h.innerHTML;for(let e=0;e<o.substitutions.length;e++){let t=o.substitutions[e][ut[0]],a=o.substitutions[e][ut[1]];n=n.replace(new RegExp(t,"g"),a)}h.innerHTML=n}function gt(e){if(C.style.fontFamily=e,h.style.fontFamily=e,y.style.fontFamily=e,o.police_active=e,window.widget||localStorage.setItem("seyes-police",e),Ae[e]){let t=Ae[e];o.coef_marge=t.coef_marge,o.coef_marge_windows=t.coef_marge_windows,o.facteur_taille_police=t.facteur_taille_police,o.epaisseur_police=t.epaisseur_police,o.distance_soulignage=t.distance_soulignage,T.style.display=t.bouton_ligatures_display,dt("auto",t.ligatures)}Fe(0,!1,o.police_active),function(e){const t=document.getElementById("texte_principal"),n=document.getElementById("texte_marge"),a=document.getElementById("texte_marge_complementaire");t&&(t.style.textUnderlineOffset=e+"em"),n&&(n.style.textUnderlineOffset=e+"em"),a&&(a.style.textUnderlineOffset=e+"em")}(o.distance_soulignage),document.documentElement.style.setProperty("--distance-soulignement-exposant",6*o.distance_soulignage+"em")}let mt,pt=!0,ft={};function ht(e,t=null){return 0==Object.keys(ft).length&&console.log("Translations not loaded yet!"),""==e?"":ft[e]?ft[e]:(console.log(`Missing translation for key: ${e}`),t||e)}async function vt(e){if("fr"!==e||!pt){pt=!1;const t=await fetch(`./js/_locales/${e}.json`);ft=await t.json();document.querySelectorAll("[i18_title]").forEach(e=>{const t=e.getAttribute("i18_title");e.title=ft[t]||e.title});document.querySelectorAll("[i18_content]").forEach(e=>{const t=e.getAttribute("i18_content");e.textContent=ft[t]||e.textContent})}}function yt(){let e=window.location.search;return new URLSearchParams(e).get("lang")||"fr"}function _t(e){const t=e;if("auto"===e){const e=navigator.language||navigator.userLanguage;o.langue=e.split("-")[0]}else o.langue=e;vt(o.langue),document.lang=o.langue,Q("lang",t);null!=document.getElementById("divDate")&&ve()}async function bt(e){if(0!=e.length){let t=yt();const n=await fetch(`./js/_locales/${t}.json`),a=await n.json(),o=a.codiOK_content||"Texte correctement récupéré",r=a.codiPasOK_content||"Erreur. Lien invalide ?",i=await wt("#"+e);L.classList.add("hide"),i?(E.classList.add("correct"),E.classList.remove("incorrect"),E.innerHTML=o,M.innerHTML=mt=window.location.origin+"#"+e,L.classList.remove("hide")):(E.classList.add("incorrect"),E.classList.remove("correct"),E.innerHTML=r)}}async function wt(e){let t=function(e){""!==e&&(e.startsWith("https://github.com")&&(e=(e=e.replace("https://github.com","https://raw.githubusercontent.com")).replace("/blob/","/")),(e.startsWith("https://codimd")||e.includes("hedgedoc")||e.includes("digipage"))&&(e=-1===(e=e.replace("?edit","").replace("?both","").replace("?view","").replace(/#$/,"").replace(/\/$/,"")).indexOf("download")?e+"/download":e),e.includes("framapad")&&!e.endsWith("/export/txt")&&(e=e.replace(/\?.*/,"")+"/export/txt"));return e}(e.substring(1));try{let e=await async function(e){try{let t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok "+t.statusText);return await t.text()}catch(e){throw console.error("There has been a problem with your fetch operation:",e),e}}(t);return function(e){const t=e.split("---");let n="",a="";t.length>=3?(n=t[1].trim(),a=t.slice(2).join("---").replace(/^\s*\n/,"").trim()):a=e.trim();const r=n.split("\n");let i,l,s="",c="",u=!1;function d(e){const t=e.split(":");if(t.length<2)return;const n=t.slice(1).join(":").trim();return""===n?void 0:n}r.forEach(e=>{if(e.startsWith("police:"))s=d(e);else if(e.startsWith("lang:")||e.startsWith("langue:")){const t=d(e);t&&(o.langue=t.toLowerCase().replace(/\s+/g,"_"),vt(o.langue),function(e,t){const n=new URL(window.location);n.searchParams.set(e,t),window.history.replaceState({},"",n)}("lang",o.langue))}else if(e.startsWith("lignage:")){const t=d(e);t&&(c=t.toLowerCase().replace(/\s+/g,"_"))}else if(e.startsWith("autodate:")){const t=d(e);u=t&&"true"===t.toLowerCase()}else if(e.startsWith("souligner-date:")){const t=d(e);o.soulignerLaDate=t&&"true"===t.toLowerCase(),j.checked=o.soulignerLaDate}else if(e.startsWith("couleur:")){const t=d(e);t&&(l=t.toLowerCase())}else if(e.startsWith("opacite-lignage:")){let t=d(e);t&&t.includes("%")?(t=t.replace("%","").trim(),t=parseFloat(t)/100):t&&(t=t.replace(",",".").trim(),t=parseFloat(t)),!isNaN(t)&&t>=0&&t<=1?i=t:void 0!==t&&console.warn("La valeur de l'opacité est invalide. Elle doit être entre 0 et 1.")}}),i&&De(i);s&&(gt(s),I.value=s);c&&Be(c);l&&(l=function(e){const t={noir:"Black",bleu:"Blue",marron:"Brown",cyan:"Cyan",gris:"Gray",vert:"Green",magenta:"Magenta",bordeaux:"Maroon",marine:"Navy",olive:"Olive",violet:"Purple",rouge:"Red",argent:"Silver",sarcelle:"Teal",blanc:"White",jaune:"Yellow",vertolive:"OliveDrab",bleuciel:"SkyBlue",bleuroi:"RoyalBlue",bleumarine:"Navy",vertforet:"ForestGreen",vertcitron:"LimeGreen",vertmer:"SeaGreen",rosefonce:"DeepPink",bleunuit:"MidnightBlue","vert olive":"OliveDrab","vert-olive":"OliveDrab","bleu ciel":"SkyBlue","bleu-ciel":"SkyBlue","bleu roi":"RoyalBlue","bleu-roi":"RoyalBlue","bleu marine":"Navy","bleu-marine":"Navy","vert foret":"ForestGreen","vert-foret":"ForestGreen","vert citron":"LimeGreen","vert-citron":"LimeGreen","vert mer":"SeaGreen","vert-mer":"SeaGreen","rose fonce":"DeepPink","rose-fonce":"DeepPink","bleu nuit":"MidnightBlue","bleu-nuit":"MidnightBlue"};if(e=e.toLowerCase().trim(),/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e))return e;if(t[e])return t[e];const n=e.replace(/\s+/g,"");if(t[n])return t[n];const a=e.replace(/-/g," ");if(t[a])return t[a];const o=[/^(.*?)\s+clair$/,/^(.*?)-clair$/,/^(.*?)\s+fonce$/,/^(.*?)-fonce$/,/^(.*?)\s+foncé$/,/^(.*?)-foncé$/];for(let n of o){const a=e.match(n);if(a){const e=t[a[1]];if(e)return n.source.includes("clair")?`Light${e}`:`Dark${e}`}}return e}(l),document.documentElement.style.setProperty("--couleur-texte",l));const g=a.split("\n").map(e=>`<div>${e.trim()||"<br>"}</div>`).join("");C&&(C.innerHTML=Ve(g));u&&ve()}(e),!0}catch(e){return console.error("Erreur lors de la récupération du texte:",e),!1}}function Ct(){C.innerHTML="",b.innerHTML="",w.innerHTML="",h.innerHTML=y.innerHTML="",o.ajouterLaDate&&me(),C.focus();const e=document.createRange(),t=window.getSelection(),n=C.getElementsByTagName("br");if(n.length>0){const a=n[n.length-1];e.setStartAfter(a),e.collapse(!0),t.removeAllRanges(),t.addRange(e)}}function Dt(){if(x.checked=o.afficherMessage,o.afficherMessage?D.style.opacity="1":l(D),o.couleursJours)try{for(let e in JSON.parse(o.couleursJours))oe[e]=JSON.parse(o.couleursJours)[e]}catch(e){console.error("Valeur non parsable :",e);for(let e in ae)oe[e]=ae[e]}else for(let e in ae)oe[e]=ae[e];const e=document.getElementById("select-jours").value;var t;c.style.backgroundColor=oe[e],S.value=S.style.backgroundColor=oe[e],A.value=o.espacementLettres,N.value=o.espacementMots,Y.checked=o.ecrireAChevalSurLaMarge,R.checked=o.majDateAuto,ot(),ie(),t=o.largeur_marge,o.largeur_marge=t,_.style.width=g.style.width=`calc(100% - ${t}px)`,p.style.width=t-3+"px",u.style.width=`${t}px`,Q("largeur-marge",o.largeur_marge),Oe(),function(e){e>=3&&(o.largeur_marge_secondaire=e,o.margeSecondaire.style.width=d.style.width=e-3+"px",Q("largeur-marge-secondaire",o.largeur_marge_secondaire),Oe())}(o.largeur_marge_secondaire),I.value=o.police_active,gt(o.police_active),Be(o.typeCarreaux),De(o.opaciteLignes),Fe(!1,o.largeur_carreau,o.police_active),_e(),Ct();const n=function(e,t){let n=window.location.search;if(n.includes("&amp;")&&(n=n.replace(/&amp;/g,"&")),window.location.hash)if(window.location.hash.startsWith("#http"))wt(window.location.hash);else{const n=decodeURIComponent(window.location.hash.substring(1)).split("|_|");2===n.length?(e=n[0],t=n[1]):e=n[0];const a=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.replaceState({},document.title,a)}return{contenuTextePrincipal:e,contenuGraphismes:t}}(o.contenuTextePrincipal,o.contenuGraphismes);o.contenuTextePrincipal=n.contenuTextePrincipal,o.contenuGraphismes=n.contenuGraphismes,st(o.espacementLettres),ct(o.espacementMots),De(o.opaciteLignes),F.checked=o.verifierOrthographe,rt(),it(),B.value=o.largeurImpression,lt(),'""'!=o.contenuTextePrincipal&&null!=o.contenuTextePrincipal&&(C.innerHTML=Ve(o.contenuTextePrincipal)),'""'!=o.contenuTexteMarge&&(h.innerHTML=Ve(o.contenuTexteMarge)),'""'!=o.contenuTexteMargeComplementaire&&(y.innerHTML=o.contenuTexteMargeComplementaire),'""'!=o.contenuGraphismes&&(b.innerHTML=o.contenuGraphismes),'""'!=o.contenuImages&&(w.innerHTML=o.contenuImages),function(){const e=document.getElementById("images");if(!e)return;e.querySelectorAll(".conteneur-image").forEach(e=>{let t=e.querySelector(".bouton-supprimer-image"),n=e.querySelector(".bouton-cadre-image");e.addEventListener("click",function(){e.classList.add("selectionne")}),t&&t.addEventListener("click",function(){e.remove()}),n&&n.addEventListener("click",function(){e.classList.toggle("encadre")})})}(),Ie(),X.value=o.langueChoix,"fr"!==o.langue&&_t(o.langueChoix),o.majDateAuto&&ve(),vt(o.langue)}async function xt(){const e=window.location.search,t=new URLSearchParams(e),n=!e.startsWith("http");window.location.href.includes("seyes-dev")&&document.body.classList.add("dev");let a=await ee(`afficher-message${o.numeroMessage}`);"true"===a?o.afficherMessage=!0:"false"===a&&(o.afficherMessage=!1);t.get("primtuxmenu")&&(document.body.classList.add("primtux"),o.afficherMessage=!1),o.langueChoix=await te(t,"lang")||"auto",o.couleursJours=await te(t,"couleurs-jours"),o.police_active=await te(t,"police")||o.police_active,o.largeur_marge=await te(t,"largeur-marge")||o.largeur_marge,o.largeur_marge_secondaire=await parseFloat(te(t,"largeur-marge-secondaire"))||o.largeur_marge_secondaire,o.contenuGraphismes=await te(t,"graphismes")||"",o.contenuImages=await te(t,"images")||"";const r=await te(t,"texte-principal")||"";o.contenuTextePrincipal=""!=r&&"undefined"!=r&&null!=r?r:await async function(e){let t,n=ge(),a=yt();if(e||"fr"===a||!a)t="Modifiez-moi";else{const e=await fetch(`./js/_locales/${a}.json`);t=(await e.json()).modifiezMoi_content||"Modifiez-moi..."}return`\n\t\t  <div id="divDate"><span>${n}</span></div>\n\t\t  <br>\n\t\t  ${t}    \n\t `}(n),o.contenuTexteMarge=await te(t,"texte-marge")||"",o.contenuTexteMargeComplementaire=await te(t,"texte-marge-complementaire")||"",o.typeCarreaux=await te(t,"type-carreaux")||o.typeCarreaux,o.opaciteLignes=parseFloat(await te(t,"opacite-lignes"))||1,o.largeur_carreau=parseInt(await te(t,"largeur-carreau"))||o.largeur_carreau,o.espacementLettres=parseInt(await te(t,"espacement-lettres"))||o.espacementLettres,o.espacementMots=parseInt(await te(t,"espacement-mots"))||o.espacementMots,o.ajouterLaDate="true"===await te(t,"ajouter-date")||o.ajouterLaDate,o.soulignerLaDate="true"===await te(t,"souligner-date")||o.soulignerLaDate,o.verifierOrthographe="true"===await te(t,"verifier-orthographe")||o.verifierOrthographe,o.interligneDouble="true"===await te(t,"double-interligne")||o.interligneDouble,o.ecrireAChevalSurLaMarge="true"===await te(t,"ecrire-a-cheval")||o.ecrireAChevalSurLaMarge,o.largeurImpression=parseInt(await te(t,"largeur-impression"))||o.largeurImpression,o.majDateAuto="true"===await te(t,"maj-date-auto")||o.majDateAuto,o.sharedURL=await te(t,"shared-url")||o.sharedURL,o.sharedUDI=await te(t,"shared-udi")||o.sharedUDI}function Et(){const e=document.createElement("input");e.type="file",e.accept=".json, .sey, .txt, .doc, .docx",e.addEventListener("change",Mt),e.click()}async function Mt(e){const t=e.target.files[0];if(!t)return void alert("Aucun fichier sélectionné.");const n=[".json",".sey",".odt",".doc",".docx",".txt"];if(n.some(e=>t.name.endsWith(e)))try{if((t.name.endsWith(".doc")||t.name.endsWith(".docx")||t.name.endsWith(".odt"))&&void 0===window.mammoth){const e=document.createElement("script");e.src="./js/lib/mammoth.browser.min.js",document.head.appendChild(e),await new Promise((t,n)=>{e.onload=t,e.onerror=n})}if(t.name.endsWith(".doc")||t.name.endsWith(".docx")){const e=await async function(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=e=>{const a=e.target.result;window.mammoth?window.mammoth.convertToHtml({arrayBuffer:a}).then(e=>t(e.value)).catch(e=>n(e)):n(new Error("mammoth.js is not loaded"))},a.onerror=()=>n(new Error("Impossible de lire le fichier DOC/DOCX.")),a.readAsArrayBuffer(e)})}(t);kt(e)}else if(t.name.endsWith(".odt")){const e=await async function(e){return new Promise((t,n)=>{if(void 0===window.ODF)return void n(new Error("La bibliothèque odf.js n'est pas chargée."));const a=new FileReader;a.onload=async e=>{try{const n=e.target.result,a=new Uint8Array(n),o=await window.ODF.load(a),r=await o.getText();t(r)}catch(e){n(new Error("Impossible de lire le fichier ODT : "+e.message))}},a.onerror=()=>n(new Error("Erreur lors de la lecture du fichier ODT.")),a.readAsArrayBuffer(e)})}(t);kt(e)}else{o.nomDuFichierOuvert=t.name.split(".").slice(0,-1).join(".")||t.name;const e=await function(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=e=>t(e.target.result),a.onerror=()=>n(new Error("Échec de la lecture du fichier.")),a.readAsText(e)})}(t);t.name.endsWith(".json")||t.name.endsWith(".sey")?Lt(e):kt(e)}}catch(e){alert("Erreur lors du traitement du fichier : "+e.message),console.error(e)}else alert("Erreur : fichier non valide. Extensions acceptées : "+n.join(", "))}async function Lt(e){try{const t=JSON.parse(e);for(const[e,n]of Object.entries(t)){const t="object"==typeof n?JSON.stringify(n):n;localStorage.setItem(e,t)}await xt(),Dt()}catch(e){alert("Erreur : le contenu du fichier JSON est invalide."),console.error(e)}}function kt(e){Ct(),C.innerHTML=e}async function Tt(){await Z();let e="texte";o.dateDuDoc&&(e=`${e}-${o.dateDuDoc}`),o.nomDuFichierOuvert&&(e=o.nomDuFichierOuvert),window.showSaveFilePicker?async function(e,t="seyes"){const n={};for(let e=0;e<localStorage.length;e++){const a=localStorage.key(e);if(a.startsWith(t+"-")){const e=localStorage.getItem(a);if("seyes-texte-principal"===a)n[a]=e;else try{n[a]=JSON.parse(e)}catch(t){console.error(t),n[a]=e}}}const a=JSON.stringify(n,null,2);try{const t=await window.showSaveFilePicker({suggestedName:e,types:[{description:"Fichier JSON",accept:{"application/json":[".json"]}}]}),n=await t.createWritable();await n.write(a),await n.close(),alert("Fichier enregistré avec succès !")}catch(e){"AbortError"!==e.name&&(console.error("Erreur lors de l'enregistrement :",e),alert("Une erreur est survenue lors de l'enregistrement."))}}(`${e}.sey`):function(e){const t=It(o.prefixeAppli),n=JSON.stringify(t,null,2),a=new Blob([n],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(a),r.download=e,r.click()}(`${e}.sey`)}function It(e){let t={};for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a.startsWith(e+"-")){const e=localStorage.getItem(a);if("seyes-texte-principal"===a)t[a]=e;else try{t[a]=JSON.parse(e)}catch(n){console.log(`Key ${a} with value ${e} is not JSON, saving as string.`),t[a]=e}}}return t}function St(){let e=parseInt(H.value);(isNaN(e)||0===e)&&(e=5),o.nombreDeCarreaux=e,H.value=o.nombreDeCarreaux;Fe(!1,Se()/o.nombreDeCarreaux,o.police_active)}function At(){i(W)}function Nt(){const e=document.getElementById("boutonFermeCodi");k&&k.addEventListener("click",()=>{navigator.clipboard.writeText(mt).then(()=>{const e=document.createElement("div");e.innerHTML="Lien copié",e.style.position="fixed",e.style.backgroundColor="black",e.style.color="white",e.style.fontSize="12px",e.style.padding="5px 10px",e.style.borderRadius="5px",e.style.zIndex="10000",e.style.opacity="0",e.style.transition="opacity 0.3s";const t=k.getBoundingClientRect();e.style.left=t.left+window.scrollX+"px",e.style.top=t.top+window.scrollY-30+"px",m.appendChild(e),setTimeout(()=>{e.style.opacity="1"},10),setTimeout(()=>{e.style.opacity="0",setTimeout(()=>{m.removeChild(e)},300)},2e3)}).catch(e=>{console.error("Erreur lors de la copie : ",e)})}),e&&e.addEventListener("click",()=>{$?l($):$&&$.classList.add("hide")})}let Ot=!0;function jt(){Ot&&(Nt(),Ot=!1);$&&i($);const e=document.getElementById("inputCodi");e&&e.focus()}function Ft(){try{l(W),Ct()}catch(e){console.error(e)}}function Pt(){try{l(W)}catch(e){console.error(e)}}let Bt=!1;function Ht(){if(!Bt){s.querySelector(".contenu-lightbox").innerHTML='<ul>\n          <span i18_content="apropos_message_part1">Seyes est une application sous licence libre GNU GPL, de la </span>\n          <a class="cartouche" style="background-image: url(./images/educajou.png);" href="https://educajou.forge.apps.education.fr/" i18_content="apropos_message_link">suite Éducajou</a>\n          <span i18_content="apropos_message_part2">, écrite par Arnaud Champollion.</span>\n        </ul>\n        <br>\n        <h2>Documentation</h2>\n        <br>\n        <span id="spanCeditNum40">Illustration explicative réalisée par <a target="_blank" href="https://blogacabdx.ac-bordeaux.fr/numerique40/2023/11/22/application-seyes-deducajou/">l\'Équipe numérique 40</a> sous licence Creative Commons BY SA</span>\n        <br><br>\n        <h2 i18_content="apropos_polices_title">Polices utilisées</h2>\n        <br>\n        <span i18_content="apropos_police_aa_cursive">AA Cursive, par A. Renaudin, sous licence libre OFL.</span>\n        <br>\n        <span i18_content="apropos_police_open_dyslexic">Open Dyslexic, par Abelardo Gonzalez, sous licence libre.</span>\n        <br>\n        <span i18_content="apropos_police_luciole">Luciole par Laurent Bourcellier & Jonathan Perez, sous licence libre Creative Commons BY.</span>\n        <br>\n        <span i18_content="apropos_police_belle_allure">Belle Allure par Jean Boyault, avec son aimable autorisation.</span>\n        <br>\n        <span i18_content="apropos_police_arial_acces">Arial & Acces ne sont pas présentes sur cette application, néanmoins si elles sont installées sur votre ordinateur, Seyes pourra les utiliser.</span>\n        <br><br>\n        <h2 i18_content="apropos_bibliotheques_title">Bibliothèques</h2>\n        <span i18_content="apropos_bibliotheque_flatpickr_part1">La fonction de calendrier s\'appuie sur la bibliothèque </span>\n        <a target="_blank" href="https://github.com/flatpickr/flatpickr" i18_content="apropos_bibliotheque_flatpickr_link">flatpickr</a>\n        <span i18_content="apropos_bibliotheque_flatpickr_part2"> sous licence MIT.</span>\n        <br>\n        <span i18_content="apropos_bibliotheque_mammoth_part1">La fonction d\'import de fichier docx s\'appuie sur </span>\n        <a target="_blank" href="https://github.com/mwilliamson/mammoth.js" i18_content="apropos_bibliotheque_mammoth_link">Mammoth</a>\n        <span i18_content="apropos_bibliotheque_mammoth_part2"> sous licence BSD.</span>\n        <br><br>\n        <h2 i18_content="apropos_utiliser_hors_ligne_title">Utiliser hors-ligne</h2>\n        <br>\n        <ul>\n          <span i18_content="apropos_utiliser_hors_ligne_message_part1">Télécharger l\'application </span>\n          <a class="cartouche" style="background-image: url(./images/zip.png);" href="https://forge.apps.education.fr/educajou/seyes/-/archive/main/seyes-main.zip?path=web" i18_content="apropos_utiliser_hors_ligne_message_link">seyes-main.zip</a>\n        </ul>\n        <ul i18_content="apropos_extraire_zip_message">Extraire le ZIP</ul>\n        <ul i18_content="apropos_ouvrir_fichier_message">Ouvrir le fichier index.html</ul>\n        <br>\n        <h2 i18_content="apropos_en_savoir_plus_title">En savoir plus et accéder aux sources</h2>\n        <br>\n        <ul>\n          <span i18_content="apropos_en_savoir_plus_message_part1">Voir </span>\n          <a class="cartouche" style="background-image: url(./images/forge.png);" href="https://forge.apps.education.fr/educajou/seyes" i18_content="apropos_en_savoir_plus_message_link">la page du projet</a>\n          <span i18_content="apropos_en_savoir_plus_message_part2"> sur la Forge des Communs Numériques Éducatifs.</span>\n        </ul>\n        <br>\n        <h2 i18_content="apropos_contact_title">Contactez-moi</h2>\n        <br>\n        <p>\n          <span i18_content="apropos_contact_message_part1">Vous pouvez </span>\n          <a target="_blank" href="https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=bug" i18_content="apropos_contact_message_link1">signaler un bug</a>\n          <span i18_content="apropos_contact_message_part2"> ou </span>\n          <a target="_blank" href="https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=suggestion" i18_content="apropos_contact_message_link2">suggérer une fonctionnalité</a>\n        </p>\n        <p i18_content="apropos_contact_message_2">Il vous sera demandé de vous connecter avec votre compte Apps Éducation. Vous recevrez les notifications de réponses sur votre boîte email académique.</p>',Bt=!0}i(s)}function Rt(){const e=r("cloud_load"),t=r("cancelCloudLoad"),n=r("confirmation_load"),a=r("inputCloudLoadId"),s=r("okCloudLoad");e.addEventListener("click",()=>{i(r("confirmation_load")),r("inputCloudLoadId").value=o.sharedUDI||"",r("okCloudLoad").disabled=!1,r("cloud_load_status").textContent=""}),t.addEventListener("click",()=>{l(n)}),s.addEventListener("click",()=>{let e=(a.value||"").trim();0!==e.length?function(e){e=e.toUpperCase(),console.log(`Loading document from cloud with UDI: ${e}`),r("cloud_load_status").textContent="...⌛...",r("okCloudLoad").disabled=!0,function(e){const t=new URL(o.sharedURL);t.searchParams.set("udi",e),console.log("Getting document from URL:",t.toString()),fetch(t.toString(),{method:"GET"}).then(e=>e.ok?e.text():e.text().then(t=>{throw new Error(e.status+": "+t)})).then(e=>{console.log("GET data:\n",e),Lt(e),r("cloud_load_status").textContent="",l(r("confirmation_load")),r("okCloudLoad").disabled=!1}).catch(e=>{console.log("GET error:\n",e),r("cloud_load_status").innerHTML=e.message,r("okCloudLoad").disabled=!1})}(e)}(e):r("cloud_load_status").textContent=ht("cloud_load_bad_udi","Veuillez entrer un UDI valide.")})}function Yt(){const e=r("cloud_save"),t=r("confirmation_save"),n=r("okCloudSave"),a=r("cancelCloudSave"),s=r("inputCloudSaveId"),c=r("okCloudSaveDone"),u=r("confirmation_save_success");e.addEventListener("click",()=>{r("okCloudSave").disabled=!1,r("cloud_status_ok").textContent="",r("cloud_status_ko").textContent="",r("inputCloudSaveId").value=o.sharedUDI||"",l(r("confirmation_save")),i(r("confirmation_save"))}),a.addEventListener("click",()=>{l(t)}),n.addEventListener("click",()=>{let e=(s.value||"").trim();e=function(e){let t;e=e.toUpperCase(),console.log(`Saving document to cloud with UDI: ${e}`),r("cloud_status_ok").textContent="...⌛...",r("cloud_status_ko").textContent="",r("okCloudSave").disabled=!0;const n=r("cloud_save_new").checked?"new":"update",a=It(o.prefixeAppli),i=JSON.stringify(a);if(console.log("Document content:",a),"new"===n)t=function(e){const t=o.sharedURL;fetch(t,{method:"PUT",body:e}).then(e=>e.ok?e.text():e.text().then(t=>{throw new Error(e.status+": "+t)})).then(e=>{console.log("PUT data:\n",e);const t=e.match(/^OK:(.+)/);if(t){let e=t[1].trim();return console.log("UDI:",e),Wt(e),e}return console.log("UDI not returned?"),r("cloud_status_ko").textContent="Echec de la sauvegarde, UDI non retourné.",!1}).catch(e=>(r("inputCloudSaveId"),console.log("PUT error:\n",e),r("cloud_status_ko").textContent=e.message,r("cloud_status_ok").textContent="",r("okCloudSave").disabled=!1,!1))}(i);else if("update"===n){if(!e||0===e.length)return alert("Please provide a valid UDI to update an existing document."),!1;t=function(e,t){const n=new URL(o.sharedURL);n.searchParams.set("udi",e),console.log("Updating document at URL:",n.toString()),fetch(n.toString(),{method:"POST",body:t}).then(e=>e.ok?e.text():e.text().then(t=>{throw new Error(e.status+": "+t)})).then(e=>{console.log("PUT data:\n",e);const t=e.match(/^OK:(.+)/);if(t){let e=t[1].trim();return console.log("UDI:",e),Wt(e),e}return console.log("UDI not returned?"),r("cloud_status_ko").textContent="Echec de la sauvegarde, UDI non retourné.",!1}).catch(e=>(r("inputCloudSaveId"),console.log("POST error:\n",e),r("cloud_status_ko").innerHTML=e.message,r("cloud_status_ok").textContent="",r("okCloudSave").disabled=!1,!1))}(e,i)}return t}(e)}),c.addEventListener("click",()=>{l(u)}),s.addEventListener("click",()=>{r("cloud_save_existing").checked=!0})}function Wt(e){l(r("confirmation_save")),i(r("confirmation_save_success")),r("cloud_status_ok").textContent=ht("cloud_save_done","Document sauvegardé."),r("okCloudSave").disabled=!1,r("inputCloudSaveId").value=e,r("inputCloudSaveNewId").value=e,r("inputCloudSaveNewId").focus(),r("inputCloudSaveNewId").select(),r("cloud_save_new").checked=!1,r("cloud_save_existing").checked=!0,Q("shared-udi",e),o.sharedUDI=e}let $t,qt,Ut=null,zt=0,Gt=0,Jt=0,Vt=0,Kt=0,Xt=0,Zt=0,Qt=0,en=0,tn=0,nn=!1,an=null,on=!1,rn=null,ln=null,sn=rn=on=ln=!1;function cn(e,t=o.largeur_carreau){return Math.round(e/t)*t}function un(e){return function(e){return e&&e.targetTouches&&e.targetTouches[0]&&e.targetTouches[0].clientX}(e)||e&&e.clientX}function dn(e){return function(e){return e&&e.targetTouches&&e.targetTouches[0]&&e.targetTouches[0].clientY}(e)||e&&e.clientY}function gn(e){const t=_.getBoundingClientRect(),n=un(e)-t.left,a=dn(e)-t.top;if(o.regleActive){const e=cn(n),t=cn(a);Math.abs(n-e)<o.largeur_carreau/8&&Math.abs(a-t)<o.largeur_carreau/8?_.style.cursor="url(./images/crayonrouge.png) 0 30, auto":o.isDrawing||(_.style.cursor="url(./images/crayon.png) 0 30, auto ")}}function mn(e){if(Z(),e.target.classList.contains("gestion-texte")&&e.preventDefault(),!e.target.closest(".selectionne")){w.querySelectorAll(".selectionne").forEach(e=>{e.classList.remove("selectionne")})}const t=document.getElementById("boutons_soulignement"),n=document.getElementById("boutons_carreaux"),a=document.getElementById("boutons-couleur-texte"),r=document.getElementById("datepicker"),i=document.querySelector(".flatpickr-calendar");(function(e,t){if(e===t)return!0;let n=e.parentNode;for(;n;){if(n===t)return!0;n=n.parentNode}return!1})(e.target,i)||e.target.classList.contains("deroule-couleur")||e.target.classList.contains("deroule-souligne")||e.target.classList.contains("deroule_carreaux")||e.target.classList.contains("flatpickr-calendar")||(t.classList.add("hide"),n.classList.add("hide"),a.classList.add("hide"),r.classList.add("hide"),i&&i.classList.add("hide")),e.target.classList.contains("bouton-supprimer-trait")&&!o.regleActive&&o.selected&&(o.selected.remove(),o.selected=null),e.target.classList.contains("bouton-couleur-trait")&&!o.regleActive&&o.selected&&document.getElementById("inputCouleurTrait").click(),e.target.classList.contains("trait")&&!o.regleActive?(o.selected&&o.selected.classList.remove("select"),e.target.classList.add("select"),o.selected=e.target):o.selected&&!e.target.classList.contains("bouton-couleur-trait")&&(o.selected.classList.remove("select"),o.selected=null);const l=_.getBoundingClientRect(),s=v.getBoundingClientRect();zt=un(e),Gt=dn(e);const c=zt-l.left,u=Gt-l.top,d=zt-s.left;let g=!1;if(e.target.classList.contains("draggable_item")&&(g=!0),e.target.classList.contains("poignee")){sn=e.target.classList[1],document.body.style.cursor=sn+"-resize",Jt=zt,Vt=Gt;let t=e.target.closest(".conteneur-image"),n=t.querySelector(".image")||t.querySelector(".timer");on=n;let a=n.clientWidth,o=n.clientHeight;rn=o>a?"height":"width",ln=Math.max(a,o)}else if(e.target.classList.contains("draggable")||g)e.preventDefault(),Ut=g?e.target.parentNode:e.target,Zt=zt-Ut.offsetLeft,Qt=Gt-Ut.offsetTop,Ut.classList.add("dragged");else if(c<=10&&c>-10)nn=_,document.body.style.cursor="ew-resize",Jt=zt,o.largeur_page=_.offsetWidth,o.largeur_marge=p.offsetWidth;else if(d<=10&&d>-10)nn=v,document.body.style.cursor="ew-resize",Jt=zt,o.largeur_marge_secondaire=v.offsetWidth;else if(o.regleActive){const e=cn(c),t=cn(u);if(Math.abs(c-e)<o.largeur_carreau/8&&Math.abs(u-t)<o.largeur_carreau/8){o.isDrawing=!0,$t=e,qt=t,an=document.createElement("div"),an.classList.add("trait"),an.classList.add("horizontal"),an.classList.add("draggable"),an.style.position="absolute",an.style.backgroundColor="red",an.style.width="6px",an.style.height="6px",an.style.left=$t+"px",an.style.top=qt+"px";let n=document.createElement("button");n.classList.add("bouton-supprimer-trait"),an.appendChild(n);let a=document.createElement("button");a.classList.add("bouton-couleur-trait"),an.appendChild(a),b.appendChild(an)}}}function pn(e){Kt=un(e),Xt=dn(e);const t=_.getBoundingClientRect(),n=Kt-t.left,a=Xt-t.top;if(sn){en=Kt-Jt,tn=Xt-Vt,sn.includes("w")&&(en=-en),sn.includes("n")&&(tn=-tn);let e=en+tn;on.classList.contains("timer")?on.style.width=on.style.height=`${ln+e}px`:on.style[rn]=`${ln+e}px`}else nn===_?(en=Kt-Jt,o.largeur_marge+en>=60?(_.style.width=g.style.width=o.largeur_page-en+"px",p.style.width=o.largeur_marge+en-3+"px",u.style.width=o.largeur_marge+en+"px"):(_.style.width=g.style.width="calc(100% - 60px)",p.style.width=u.style.width="57px",u.style.width=u.style.width="60px"),Ie()):nn===v&&(en=Kt-Jt,o.largeur_marge_secondaire-en>=2.7*o.largeur_carreau?(v.style.width=o.largeur_marge_secondaire-en+"px",d.style.width=o.largeur_marge_secondaire-en+"px"):(v.style.width=2.7*o.largeur_carreau+"px",d.style.width=2.7*o.largeur_carreau+"px"),Ie());if(Ut){Ut.style.right=null,Ut.style.bottom=null,e.preventDefault();const t=un(e)||0,n=dn(e)||0;Ut.style.left=t-Zt+"px",Ut.style.top=n-Qt+"px"}else if(o.isDrawing&&an){const e=cn(n),t=cn(a),r=e-$t,i=t-qt;if(Math.abs(r)>Math.abs(i)){let t=Math.abs(r);an.style.width=t+.02117171*o.largeur_carreau+"px",an.style.height="6px",an.style.top=qt+"px",an.style.left=$t+"px",an.classList.remove("vertical"),an.classList.add("horizontal"),r<0&&(an.style.left=e+"px")}else an.style.height=Math.abs(i)+.02117171*o.largeur_carreau+"px",an.style.width="6px",an.classList.remove("horizontal"),an.classList.add("vertical"),i<0&&(an.style.top=t+"px")}}function fn(){if(nn=!1,document.body.style.cursor=null,o.largeur_page=_.offsetWidth,o.largeur_marge=p.offsetWidth,o.largeur_marge_secondaire=v.offsetWidth,Oe(),Q("largeur-marge",o.largeur_marge),Q("largeur-marge-secondaire",o.largeur_marge_secondaire),Q("graphismes",b.innerHTML),Q("images",w.innerHTML),sn&&(sn=!1),Ut){if(Ut.classList.remove("dragged"),Ut.classList.contains("trait")){let e=parseInt(Ut.style.left,10),t=parseInt(Ut.style.top,10),n=Math.round(e/o.largeur_carreau)*o.largeur_carreau,a=Math.round(t/o.largeur_carreau)*o.largeur_carreau;Ut.style.left=`${n}px`,Ut.style.top=`${a}px`}Ut=null}o.isDrawing&&(o.isDrawing=!1,an=null,qe())}!async function(){document.querySelectorAll("#show-warning-next-time").forEach(e=>{e.addEventListener("change",e=>{Q(`afficher-message${o.numeroMessage}`,e.currentTarget.checked)})}),T.style.display="none";const e=document.getElementById("select-jours").value,t=oe[e];S.value=t,c.style.backgroundColor=t,S.style.backgroundColor=t,ie(),I.value=o.police_active,await xt(),Dt()}(),function(){const e={nouveau:At,enregistrer:Tt,ouvrir:Et,imprimer:Ne,codi:jt,copielien:Xe,copier:Ze,date:ve,bouton_deroule_date:he,zoom_out:()=>{Fe(-10)},zoom_in:()=>{Fe(10)},carreaux:Ye,bouton_ligatures:dt,left:()=>{tt("left")},center:()=>{tt("center")},right:()=>{tt("right")},"couleur-texte":e=>{at(e.currentTarget.value)},bouton_deroule_couleurs:we,souligne:e=>{Le(e.currentTarget.value)},bouton_deroule_souligne:Te,bouton_entoure:nt,regle:qe,a_propos:Ht,aide:()=>{i(q)},fullscreen:et,timer:$e,options:Ce,panneauOptions_close_button:Ce,oui:Ft,non:Pt};Object.keys(e).forEach(t=>{const n=r(t);n&&n.addEventListener("click",e[t])});const t={choix_police:gt,inputEcrireACheval:ot,inputOpacite:De,checkboxInterligneDouble:it,checkboxAjouterDate:_e,checkboxMajDateAuto:be,checkboxSoulignerDate:_e,checkboxVerifierOrthographe:rt,inputLargeurImpression:lt,selectLangue:_t,inputNombreDeCarreaux:St};Object.keys(t).forEach(e=>{const n=r(e);n&&n.addEventListener("change",n=>{t[e](n.currentTarget.value)})});const n={inputEspacement:st,inputEspacementMots:ct,inputOpacite:De,inputCodi:bt,inputCouleurTrait:Ue,"choix-couleur-entete":re,selectJours:ye,inputFichier:We};Object.keys(n).forEach(e=>{const t=r(e);t&&t.addEventListener("input",t=>{"inputFichier"==e?n[e](t):n[e](t.currentTarget.value)})}),document.querySelectorAll(".bouton-fermer").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.closest(".lightbox");t&&t.classList.add("hide");const n=document.getElementById("darkbox");n&&n.classList.add("hide")})}),document.querySelectorAll("#boutons-couleur-texte .bouton-couleur, #boutons_couleur-texte .bouton-couleur, #boutons-couleur-texte .deroule-couleur, .deroule-couleur.bouton-couleur").forEach(e=>{e.addEventListener("click",e=>{at(e.currentTarget.value)})}),Yt(),Rt()}(),document.addEventListener("mousemove",gn),document.addEventListener("touchstart",mn),document.addEventListener("touchmove",pn),document.addEventListener("touchend",fn),document.addEventListener("mousedown",mn),document.addEventListener("mousemove",pn),document.addEventListener("mouseup",fn),document.addEventListener("paste",function(e){e.preventDefault();let t=e.clipboardData||e.originalEvent.clipboardData,n=t.getData("text/plain");n&&(n=n.replace(/<[^>]*>/g,""),document.execCommand("insertText",!1,n));let a=t.items;for(let e of a)if(-1!==e.type.indexOf("image")){let t=e.getAsFile(),n=new FileReader;n.onload=function(e){let t=document.createElement("img");t.src=e.target.result,t.style.maxWidth="100%",document.execCommand("insertHTML",!1,t.outerHTML)},n.readAsDataURL(t)}}),window.addEventListener("resize",()=>{Ie(),Oe()}),C.addEventListener("focusout",Z),h.addEventListener("focusout",Z),y.addEventListener("focusout",Z),window.addEventListener("keydown",function(e){"Delete"===e.key&&o.selected&&(o.selected.remove(),o.selected=!1)}),w.addEventListener("click",()=>{C.focus();const e=document.createRange();e.selectNodeContents(C),e.collapse(!1);const t=window.getSelection();t.removeAllRanges(),t.addRange(e)})}();
//# sourceMappingURL=script.min.js.map
