{"version":3,"file":"script.min.js","sources":["js/core/config.mjs","js/core/utils/dom.mjs","js/core/settings/read-write.mjs","js/_locales/date-days.mjs","js/core/ui/display/ui-colors.mjs","js/_locales/date-months.mjs","js/lib/flatpickr.mjs","js/_locales/flatpickr-fr.mjs","js/_locales/flatpickr-it.mjs","js/_locales/flatpickr-oc.mjs","js/core/date/date.mjs","js/core/menu/buttons/choose-text-color.mjs","js/core/menu/buttons/options-panel.mjs","js/core/text-format/helpers.mjs","js/core/text-format/underline.mjs","js/core/menu/buttons/underline.mjs","js/core/ui/layout/getSize.mjs","js/core/text-format/fonts/font-params.mjs","js/core/ui/display/print.mjs","js/core/ui/zoom/zoom.mjs","js/core/ui/zoom/adjustScroll.mjs","js/core/ui/layout/margin-manager.mjs","js/core/ui/layout/background.mjs","js/core/menu/buttons/tiles.mjs","js/core/menu/buttons/insert-image.mjs","js/core/menu/buttons/insert-timer.mjs","js/core/menu/buttons/ruler.mjs","js/core/save-load/compression.mjs","js/core/save-load/copyLink.mjs","js/core/ui/display/fullScreen.mjs","js/core/text-format/align.mjs","js/core/text-format/highlight.mjs","js/core/text-format/text-color.mjs","js/core/text-format/change-display.mjs","js/core/text-format/fonts/fonts.mjs","js/core/ui/language.mjs","js/core/save-load/import-from-markdown.mjs","js/core/utils/colors.mjs","js/core/ui/content/resetContent.mjs","js/core/settings/applySettings.mjs","js/core/save-load/importFromHash.mjs","js/core/settings/loadSettings.mjs","js/core/ui/content/defaultContent.mjs","js/core/save-load/files.mjs","js/core/save-load/import-from-docx-odt.mjs","js/core/ui/zoom/zoomTiles.mjs","js/core/menu/buttons/newDocument.mjs","js/core/menu/buttons/importMarkdown.mjs","js/core/menu/buttons/yes-no-buttons.mjs","js/core/menu/buttons/about.mjs","js/core/menu/buttons/cloud-loadsave.mjs","js/core/ui/events/mouse-move.mjs","js/core/settings/initSettings.mjs","js/core/settings/initialWarningMessage.mjs","js/main.mjs","js/core/menu/menu.mjs","js/core/menu/buttons/close-buttons.mjs","js/core/menu/buttons/color-buttons.mjs","js/core/ui/events/paste.mjs","js/core/ui/events/resize.mjs","js/core/ui/events/focus.mjs","js/core/ui/events/keyboard.mjs","js/core/ui/events/click.mjs"],"sourcesContent":["let prefixeAppli = \"seyes\";\n\n// Est-on dans Openboard ?\nconst hasWindow = typeof window !== \"undefined\" && window !== null;\nlet openboard = hasWindow && Boolean(window.widget || window.sankore);\nif (hasWindow && openboard) {\n\tdocument.body.classList.add(\"openboard\");\n}\n\nlet afficherMessage = true;\n\nlet contenuTexteMarge = \"\";\nlet contenuTexteMargeComplementaire = \"\";\nlet contenuGraphismes = \"\";\nlet contenuImages = \"\";\nlet contenuTextePrincipal = \"\";\n\n// Pour les ligatures\nlet substitutions = [\n\t[\"on\", \"═\"],\n\t[\"or\", \"║\"],\n\t[\"s \", \"╝ \"],\n\t[\"s\\\\.\", \"╝.\"],\n\t[\"s,\", \"╝,\"],\n\t[\"s;\", \"╝;\"],\n\t[\"s:\", \"╝:\"],\n\t[\"s!\", \"╝!\"],\n\t[\"s/\", \"╝/\"],\n\t[\"s-\", \"╝-\"],\n\t[\"s'\", \"╝'\"],\n\t[\" p\", \" ╰\"],\n\t[\" j\", \" ╮\"],\n\t[\" s\", \" ╠\"],\n\t[\" i\", \" ╱\"],\n];\n\nconst isSmallScreen =\n\ttypeof window !== \"undefined\" &&\n\twindow.matchMedia(\"(max-width: 600px)\").matches;\n\nlet largeur_carreau = isSmallScreen ? 60 : 80;\nlet largeur_marge_secondaire = largeur_carreau * 2.7;\nlet largeur_page;\nlet largeur_page_impression = 1;\nlet largeur_marge_impression = 1;\nlet largeur_margesecondaire_impression = 1;\nlet largeur_carreau_old = largeur_carreau;\nlet largeur_marge = isSmallScreen ? 60 : 200;\nlet facteur_taille_police = 0.75;\nlet taille_police = 60;\nlet epaisseur_police = \"normal\";\n\nlet ligatures_on = false;\n\nlet coef_marge = 0.35;\nlet coef_marge_windows = 0.3125;\nlet distance_soulignage = 0.3;\nlet police_active = \"Belle Allure CE\";\nlet typeCarreaux = \"seyes\";\n\nlet regleActive = false;\nlet isDrawing = false;\n\nlet espacementLettres = 0;\nlet espacementMots = 0;\nlet ajouterLaDate = false;\nlet soulignerLaDate = false;\nlet verifierOrthographe = false;\nlet interligneDouble = false;\nlet largeurImpression = 3;\nlet opaciteLignes = 1;\n\nlet nombreDeCarreaux;\nlet ecrireAChevalSurLaMarge = false;\n\nlet langue = \"fr\";\nlet langueChoix = \"auto\";\n\nlet majDateAuto = false;\n\nlet dateDuDoc = true;\n\nlet selected = false;\n\nconst isWindows = /Win/i.test(navigator.userAgent);\n\nlet couleursJours = {};\n\nlet numeroMessage = 8;\n\nlet sharedURL =\n\t\"https://www.forestier.xyz/ggpp/php/ggpp.php?client_id=educajou\"; // __JFO TODO__: mettre la bonne URL\nlet sharedUDI = \"\";\n\nexport let config = {\n\tprefixeAppli,\n\tlargeur_carreau,\n\tlargeur_marge_secondaire,\n\tlargeur_page,\n\tlargeur_page_impression,\n\tlargeur_marge_impression,\n\tlargeur_margesecondaire_impression,\n\tlargeur_carreau_old,\n\tlargeur_marge,\n\tfacteur_taille_police,\n\ttaille_police,\n\tepaisseur_police,\n\tligatures_on,\n\tcoef_marge,\n\tcoef_marge_windows,\n\tdistance_soulignage,\n\tpolice_active,\n\ttypeCarreaux,\n\tregleActive,\n\tisDrawing,\n\tespacementLettres,\n\tespacementMots,\n\tajouterLaDate,\n\tsoulignerLaDate,\n\tverifierOrthographe,\n\tinterligneDouble,\n\tlargeurImpression,\n\tnombreDeCarreaux,\n\tecrireAChevalSurLaMarge,\n\tlangue,\n\tlangueChoix,\n\tmajDateAuto,\n\tisWindows,\n\tsubstitutions,\n\topenboard,\n\tselected,\n\tdateDuDoc,\n\tafficherMessage,\n\topaciteLignes,\n\tcontenuTexteMarge,\n\tcontenuTexteMargeComplementaire,\n\tcontenuGraphismes,\n\tcontenuImages,\n\tcontenuTextePrincipal,\n\tcouleursJours,\n\tnumeroMessage,\n\tsharedURL,\n\tsharedUDI,\n};\n","// Small DOM utility helpers\nexport const get = (id) => document.getElementById(id);\n\nexport function ouvre(div) {\n\tif (!div) return;\n\tdocument.querySelectorAll(\".darkbox\");\n\tdiv.classList.remove(\"hide\");\n\tconst darkbox = document.getElementById(\"darkbox\");\n\tif (darkbox) darkbox.classList.remove(\"hide\");\n}\n\nexport function ferme(div) {\n\tif (!div) return;\n\tdiv.classList.add(\"hide\");\n\tconst darkbox = document.getElementById(\"darkbox\");\n\tif (darkbox) darkbox.classList.add(\"hide\");\n}\n\n// Constantes - Éléments DOM\n\n// Structure\nexport const body = document.body;\n\nexport const divApropos = document.getElementById(\"apropos\");\n\n// En-tête optionnel (mode cahier de textes)\nexport const divEntete = document.getElementById(\"entete\");\nexport const divMargeEntete = document.getElementById(\"marge-entete\");\n// export const case1 removed (unused)\nexport const case2 = document.getElementById(\"case2\");\nexport const case3 = document.getElementById(\"case3\");\n\n// Contenu général\nexport const divContenu = document.getElementById(\"contenu\");\nexport const divMarge = document.getElementById(\"marge\");\n\nexport const marge = document.getElementById(\"marge1\");\nexport const texte_marge = document.getElementById(\"texte_marge\");\nexport const margeSecondaire = document.getElementById(\"marge2\");\n\nexport const texte_marge_complementaire = document.getElementById(\n\t\"texte_marge_complementaire\"\n);\nexport const page = document.getElementById(\"page\");\n\nexport const graphismes = document.getElementById(\"graphismes\");\nexport const images = document.getElementById(\"images\");\nexport const texte_principal = document.getElementById(\"texte_principal\");\n// export const texte_apropos removed (unused)\n\nexport const divMessage = document.getElementById(\"message\");\nexport const checkboxMessage = document.getElementById(\n\t\"show-warning-next-time\"\n);\nexport const resultatCodi = document.getElementById(\"resultatCodi\");\nexport const lienCodi = document.getElementById(\"lienCodi\");\nexport const suiteCodi = document.getElementById(\"suiteCodi\");\nexport let boutonCodi = document.getElementById(\"boutonCodi\");\n\n// Boutons\n\n// duplicate confirmationNouveau removed (use divConfirmationNouveau)\n\n// export const bouton_a_propos removed (unused)\nexport const bouton_ligatures = document.getElementById(\"bouton_ligatures\");\n// export const bouton_copier removed (unused)\nexport const choix_police = document.getElementById(\"choix_police\");\nexport let choixCouleurEntete = document.getElementById(\"choix-couleur-entete\");\n// export const couleurTexte removed (unused)\nexport let inputEspacement = document.getElementById(\"inputEspacement\");\nexport let inputEspacementMots = document.getElementById(\"inputEspacementMots\");\n\nexport let inputOpacite = document.getElementById(\"inputOpacite\");\nexport let checkboxAjouterDate = document.getElementById(\"checkboxAjouterDate\");\nexport let checkboxSoulignerDate = document.getElementById(\n\t\"checkboxSoulignerDate\"\n);\nexport let checkboxVerifierOrthographe = document.getElementById(\n\t\"checkboxVerifierOrthographe\"\n);\nexport let checkboxInterligneDouble = document.getElementById(\n\t\"checkboxInterligneDouble\"\n);\nexport let inputLargeurImpression = document.getElementById(\n\t\"inputLargeurImpression\"\n);\nexport let inputNombreDeCarreaux = document.getElementById(\n\t\"inputNombreDeCarreaux\"\n);\nexport let checkboxMajDateAuto = document.getElementById(\"checkboxMajDateAuto\");\n\nexport let inputEcrireACheval = document.getElementById(\"inputEcrireACheval\");\n\n// Overlays / dialogs / misc controls\nexport const divConfirmationNouveau = document.getElementById(\n\t\"confirmation-nouveau\"\n);\nexport const divCodi = document.getElementById(\"divCodi\");\nexport const divIllustration = document.getElementById(\"divIllustration\");\nexport const darkbox = document.getElementById(\"darkbox\");\nexport const zone_menu_copie_lien = document.getElementById(\n\t\"zone_menu_copie_lien\"\n);\nexport const zone_lien = document.getElementById(\"zone_lien\");\nexport const fullscreen = document.getElementById(\"fullscreen\");\nexport const barre = document.getElementById(\"barre\");\n\n// Document root / site\nexport const site = document.documentElement;\n\nexport const selectLangue = document.getElementById(\"selectLangue\");\n","import { config } from \"../config.mjs\";\n\nimport {\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../utils/dom.mjs\";\n\nexport function save_texte() {\n\tstocke(\"texte-principal\", texte_principal.innerHTML);\n\tstocke(\"texte-marge\", texte_marge.innerHTML);\n\tstocke(\"texte-marge-complementaire\", texte_marge_complementaire.innerHTML);\n}\n\nexport function stocke(cle, valeur) {\n\tif (config.openboard) {\n\t\twindow.sankore.setPreference(config.prefixeAppli + \"-\" + cle, valeur);\n\t} else {\n\t\tlocalStorage.setItem(config.prefixeAppli + \"-\" + cle, valeur);\n\t}\n}\n\nexport async function litDepuisStockage(cle) {\n\tlet valeurAretourner;\n\tif (config.openboard) {\n\t\t// Récupération pour Openboard\n\t\ttry {\n\t\t\tvaleurAretourner = await window.sankore.async.preference(\n\t\t\t\t`${config.prefixeAppli}-${cle}`,\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tconsole.error(\n\t\t\t\t`Erreur lors de la lecture de la clé ${cle} depuis Openboard:`,\n\t\t\t\terror,\n\t\t\t);\n\t\t}\n\t} else {\n\t\t// Récupération en Web\n\t\tvaleurAretourner = localStorage.getItem(`${config.prefixeAppli}-${cle}`);\n\t}\n\n\treturn valeurAretourner;\n}\n\nexport async function getValueFromUrlOrStorage(urlParams, key) {\n\treturn urlParams.get(key) || (await litDepuisStockage(key));\n}\n","export const nomJours = [\n\t{ fr: \"Lundi\", oc: \"Lo diluns\" },\n\t{ fr: \"Mardi\", oc: \"Lo dimars\" },\n\t{ fr: \"Mercredi\", oc: \"Lo dimècres\" },\n\t{ fr: \"Jeudi\", oc: \"Lo dijòus\" },\n\t{ fr: \"Vendredi\", oc: \"Lo divendres\" },\n\t{ fr: \"Samedi\", oc: \"Lo dissabte\" },\n\t{ fr: \"Dimanche\", oc: \"Lo dimenge\" },\n];\n\nexport const joursRef = {\n\tlundi: \"#ed284c\",\n\tmardi: \"#56f068\",\n\tmercredi: \"#53b8e0\",\n\tjeudi: \"#e69130\",\n\tvendredi: \"#6171ff\",\n\tsamedi: \"#85ff5c\",\n};\n\nexport let jours = { ...joursRef };\n","import { jours } from \"../../../_locales/date-days.mjs\";\nimport { choixCouleurEntete, divEntete } from \"../../utils/dom.mjs\";\nimport { stocke } from \"../../settings/read-write.mjs\";\n\nexport function changeCouleurEntete(couleur) {\n\t// Récupérer le jour sélectionné dans le select\n\tlet jourActif = document.getElementById(\"select-jours\").value;\n\n\t// Mettre à jour la couleur dans l'objet jours pour le jour sélectionné\n\tjours[jourActif] = couleur;\n\n\t// Appliquer la couleur en arrière-plan de divEntete\n\tdivEntete.style.backgroundColor = couleur;\n\tchoixCouleurEntete.style.backgroundColor = couleur;\n\tadapteCouleurBordureChoixCouleur();\n\n\t// Sauvegarder le réglage de couleur des jours\n\tstocke(\"couleurs-jours\", JSON.stringify(jours));\n}\n\nexport function adapteCouleurBordureChoixCouleur() {\n\tlet couleurFond = choixCouleurEntete.value;\n\n\t// Convertir la couleur HEX en RGB\n\tfunction hexToRgb(hex) {\n\t\tlet r = 0,\n\t\t\tg = 0,\n\t\t\tb = 0;\n\n\t\t// Si la couleur est définie en hexadécimal\n\t\tif (hex.length === 4) {\n\t\t\tr = parseInt(hex[1] + hex[1], 16);\n\t\t\tg = parseInt(hex[2] + hex[2], 16);\n\t\t\tb = parseInt(hex[3] + hex[3], 16);\n\t\t} else if (hex.length === 7) {\n\t\t\tr = parseInt(hex[1] + hex[2], 16);\n\t\t\tg = parseInt(hex[3] + hex[4], 16);\n\t\t\tb = parseInt(hex[5] + hex[6], 16);\n\t\t}\n\n\t\treturn [r, g, b];\n\t}\n\n\t// Calculer la luminosité de la couleur\n\tfunction luminosite(rgb) {\n\t\treturn 0.299 * rgb[0] + 0.587 * rgb[1] + 0.114 * rgb[2];\n\t}\n\n\t// Changer la couleur de la bordure selon la luminosité\n\tlet rgb = hexToRgb(couleurFond);\n\tlet lumi = luminosite(rgb);\n\n\t// Si la luminosité est inférieure à un seuil, mettre la bordure en blanc\n\tif (lumi < 128) {\n\t\tchoixCouleurEntete.style.borderColor = \"white\"; // Couleur de bordure blanche\n\t} else {\n\t\tchoixCouleurEntete.style.borderColor = \"black\"; // Couleur de bordure noire\n\t}\n}\n","export const nomMois = [\n\t{ fr: \"janvier\", oc: \"de genièr\" },\n\t{ fr: \"février\", oc: \"de febrièr\" },\n\t{ fr: \"mars\", oc: \"de març\" },\n\t{ fr: \"avril\", oc: \"d'abril\" },\n\t{ fr: \"mai\", oc: \"de mai\" },\n\t{ fr: \"juin\", oc: \"de junh\" },\n\t{ fr: \"juillet\", oc: \"de julhet\" },\n\t{ fr: \"août\", oc: \"d'agost\" },\n\t{ fr: \"septembre\", oc: \"de setembre\" },\n\t{ fr: \"octobre\", oc: \"d'octobre\" },\n\t{ fr: \"novembre\", oc: \"de novembre\" },\n\t{ fr: \"décembre\", oc: \"de decembre\" },\n];\n","var flatpickr = function () {\n\t\"use strict\";\n\tvar __assign = function () {\n\t\t__assign =\n\t\t\tObject.assign ||\n\t\t\tfunction __assign(t) {\n\t\t\t\tfor (var s, i = 1, n = arguments.length; i < n; i++) {\n\t\t\t\t\ts = arguments[i];\n\t\t\t\t\tfor (var p in s)\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t};\n\t\treturn __assign.apply(this, arguments);\n\t};\n\n\tfunction __spreadArrays() {\n\t\tfor (var s = 0, i = 0, il = arguments.length; i < il; i++)\n\t\t\ts += arguments[i].length;\n\t\tfor (var r = Array(s), k = 0, i = 0; i < il; i++)\n\t\t\tfor (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n\t\t\t\tr[k] = a[j];\n\t\treturn r;\n\t}\n\n\tvar HOOKS = [\n\t\t\"onChange\",\n\t\t\"onClose\",\n\t\t\"onDayCreate\",\n\t\t\"onDestroy\",\n\t\t\"onKeyDown\",\n\t\t\"onMonthChange\",\n\t\t\"onOpen\",\n\t\t\"onParseConfig\",\n\t\t\"onReady\",\n\t\t\"onValueUpdate\",\n\t\t\"onYearChange\",\n\t\t\"onPreCalendarPosition\",\n\t];\n\tvar defaults = {\n\t\t_disable: [],\n\t\tallowInput: false,\n\t\tallowInvalidPreload: false,\n\t\taltFormat: \"F j, Y\",\n\t\taltInput: false,\n\t\taltInputClass: \"form-control input\",\n\t\tanimate:\n\t\t\ttypeof window === \"object\" &&\n\t\t\twindow.navigator.userAgent.indexOf(\"MSIE\") === -1,\n\t\tariaDateFormat: \"F j, Y\",\n\t\tautoFillDefaultTime: true,\n\t\tclickOpens: true,\n\t\tcloseOnSelect: true,\n\t\tconjunction: \", \",\n\t\tdateFormat: \"Y-m-d\",\n\t\tdefaultHour: 12,\n\t\tdefaultMinute: 0,\n\t\tdefaultSeconds: 0,\n\t\tdisable: [],\n\t\tdisableMobile: false,\n\t\tenableSeconds: false,\n\t\tenableTime: false,\n\t\terrorHandler: function (err) {\n\t\t\treturn typeof console !== \"undefined\" && console.warn(err);\n\t\t},\n\t\tgetWeek: function (givenDate) {\n\t\t\tvar date = new Date(givenDate.getTime());\n\t\t\tdate.setHours(0, 0, 0, 0);\n\t\t\t// Thursday in current week decides the year.\n\t\t\tdate.setDate(date.getDate() + 3 - ((date.getDay() + 6) % 7));\n\t\t\t// January 4 is always in week 1.\n\t\t\tvar week1 = new Date(date.getFullYear(), 0, 4);\n\t\t\t// Adjust to Thursday in week 1 and count number of weeks from date to week1.\n\t\t\treturn (\n\t\t\t\t1 +\n\t\t\t\tMath.round(\n\t\t\t\t\t((date.getTime() - week1.getTime()) / 86400000 -\n\t\t\t\t\t\t3 +\n\t\t\t\t\t\t((week1.getDay() + 6) % 7)) /\n\t\t\t\t\t\t7\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t\thourIncrement: 1,\n\t\tignoredFocusElements: [],\n\t\tinline: false,\n\t\tlocale: \"default\",\n\t\tminuteIncrement: 5,\n\t\tmode: \"single\",\n\t\tmonthSelectorType: \"dropdown\",\n\t\tnextArrow:\n\t\t\t\"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>\",\n\t\tnoCalendar: false,\n\t\tnow: new Date(),\n\t\tonChange: [],\n\t\tonClose: [],\n\t\tonDayCreate: [],\n\t\tonDestroy: [],\n\t\tonKeyDown: [],\n\t\tonMonthChange: [],\n\t\tonOpen: [],\n\t\tonParseConfig: [],\n\t\tonReady: [],\n\t\tonValueUpdate: [],\n\t\tonYearChange: [],\n\t\tonPreCalendarPosition: [],\n\t\tplugins: [],\n\t\tposition: \"auto\",\n\t\tpositionElement: undefined,\n\t\tprevArrow:\n\t\t\t\"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>\",\n\t\tshorthandCurrentMonth: false,\n\t\tshowMonths: 1,\n\t\tstatic: false,\n\t\ttime_24hr: false,\n\t\tweekNumbers: false,\n\t\twrap: false,\n\t};\n\n\tvar english = {\n\t\tweekdays: {\n\t\t\tshorthand: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n\t\t\tlonghand: [\n\t\t\t\t\"Sunday\",\n\t\t\t\t\"Monday\",\n\t\t\t\t\"Tuesday\",\n\t\t\t\t\"Wednesday\",\n\t\t\t\t\"Thursday\",\n\t\t\t\t\"Friday\",\n\t\t\t\t\"Saturday\",\n\t\t\t],\n\t\t},\n\t\tmonths: {\n\t\t\tshorthand: [\n\t\t\t\t\"Jan\",\n\t\t\t\t\"Feb\",\n\t\t\t\t\"Mar\",\n\t\t\t\t\"Apr\",\n\t\t\t\t\"May\",\n\t\t\t\t\"Jun\",\n\t\t\t\t\"Jul\",\n\t\t\t\t\"Aug\",\n\t\t\t\t\"Sep\",\n\t\t\t\t\"Oct\",\n\t\t\t\t\"Nov\",\n\t\t\t\t\"Dec\",\n\t\t\t],\n\t\t\tlonghand: [\n\t\t\t\t\"January\",\n\t\t\t\t\"February\",\n\t\t\t\t\"March\",\n\t\t\t\t\"April\",\n\t\t\t\t\"May\",\n\t\t\t\t\"June\",\n\t\t\t\t\"July\",\n\t\t\t\t\"August\",\n\t\t\t\t\"September\",\n\t\t\t\t\"October\",\n\t\t\t\t\"November\",\n\t\t\t\t\"December\",\n\t\t\t],\n\t\t},\n\t\tdaysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],\n\t\tfirstDayOfWeek: 0,\n\t\tordinal: function (nth) {\n\t\t\tvar s = nth % 100;\n\t\t\tif (s > 3 && s < 21) return \"th\";\n\t\t\tswitch (s % 10) {\n\t\t\t\tcase 1:\n\t\t\t\t\treturn \"st\";\n\t\t\t\tcase 2:\n\t\t\t\t\treturn \"nd\";\n\t\t\t\tcase 3:\n\t\t\t\t\treturn \"rd\";\n\t\t\t\tdefault:\n\t\t\t\t\treturn \"th\";\n\t\t\t}\n\t\t},\n\t\trangeSeparator: \" to \",\n\t\tweekAbbreviation: \"Wk\",\n\t\tscrollTitle: \"Scroll to increment\",\n\t\ttoggleTitle: \"Click to toggle\",\n\t\tamPM: [\"AM\", \"PM\"],\n\t\tyearAriaLabel: \"Year\",\n\t\tmonthAriaLabel: \"Month\",\n\t\thourAriaLabel: \"Hour\",\n\t\tminuteAriaLabel: \"Minute\",\n\t\ttime_24hr: false,\n\t};\n\n\tvar pad = function (number, length) {\n\t\tif (length === void 0) {\n\t\t\tlength = 2;\n\t\t}\n\t\treturn (\"000\" + number).slice(length * -1);\n\t};\n\tvar int = function (bool) {\n\t\treturn bool === true ? 1 : 0;\n\t};\n\t/* istanbul ignore next */\n\tfunction debounce(fn, wait) {\n\t\tvar t;\n\t\treturn function () {\n\t\t\tvar _this = this;\n\t\t\tvar args = arguments;\n\t\t\tclearTimeout(t);\n\t\t\tt = setTimeout(function () {\n\t\t\t\treturn fn.apply(_this, args);\n\t\t\t}, wait);\n\t\t};\n\t}\n\tvar arrayify = function (obj) {\n\t\treturn obj instanceof Array ? obj : [obj];\n\t};\n\n\tfunction toggleClass(elem, className, bool) {\n\t\tif (bool === true) return elem.classList.add(className);\n\t\telem.classList.remove(className);\n\t}\n\tfunction createElement(tag, className, content) {\n\t\tvar e = window.document.createElement(tag);\n\t\tclassName = className || \"\";\n\t\tcontent = content || \"\";\n\t\te.className = className;\n\t\tif (content !== undefined) e.textContent = content;\n\t\treturn e;\n\t}\n\tfunction clearNode(node) {\n\t\twhile (node.firstChild) node.removeChild(node.firstChild);\n\t}\n\tfunction findParent(node, condition) {\n\t\tif (condition(node)) return node;\n\t\telse if (node.parentNode) return findParent(node.parentNode, condition);\n\t\treturn undefined; // nothing found\n\t}\n\tfunction createNumberInput(inputClassName, opts) {\n\t\tvar wrapper = createElement(\"div\", \"numInputWrapper\"),\n\t\t\tnumInput = createElement(\"input\", \"numInput \" + inputClassName),\n\t\t\tarrowUp = createElement(\"span\", \"arrowUp\"),\n\t\t\tarrowDown = createElement(\"span\", \"arrowDown\");\n\t\tif (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n\t\t\tnumInput.type = \"number\";\n\t\t} else {\n\t\t\tnumInput.type = \"text\";\n\t\t\tnumInput.pattern = \"\\\\d*\";\n\t\t}\n\t\tif (opts !== undefined)\n\t\t\tfor (var key in opts) numInput.setAttribute(key, opts[key]);\n\t\twrapper.appendChild(numInput);\n\t\twrapper.appendChild(arrowUp);\n\t\twrapper.appendChild(arrowDown);\n\t\treturn wrapper;\n\t}\n\tfunction getEventTarget(event) {\n\t\ttry {\n\t\t\tif (typeof event.composedPath === \"function\") {\n\t\t\t\tvar path = event.composedPath();\n\t\t\t\treturn path[0];\n\t\t\t}\n\t\t\treturn event.target;\n\t\t} catch (error) {\n\t\t\treturn event.target;\n\t\t}\n\t}\n\n\tvar doNothing = function () {\n\t\treturn undefined;\n\t};\n\tvar monthToStr = function (monthNumber, shorthand, locale) {\n\t\treturn locale.months[shorthand ? \"shorthand\" : \"longhand\"][monthNumber];\n\t};\n\tvar revFormat = {\n\t\tD: doNothing,\n\t\tF: function (dateObj, monthName, locale) {\n\t\t\tdateObj.setMonth(locale.months.longhand.indexOf(monthName));\n\t\t},\n\t\tG: function (dateObj, hour) {\n\t\t\tdateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n\t\t},\n\t\tH: function (dateObj, hour) {\n\t\t\tdateObj.setHours(parseFloat(hour));\n\t\t},\n\t\tJ: function (dateObj, day) {\n\t\t\tdateObj.setDate(parseFloat(day));\n\t\t},\n\t\tK: function (dateObj, amPM, locale) {\n\t\t\tdateObj.setHours(\n\t\t\t\t(dateObj.getHours() % 12) +\n\t\t\t\t\t12 * int(new RegExp(locale.amPM[1], \"i\").test(amPM))\n\t\t\t);\n\t\t},\n\t\tM: function (dateObj, shortMonth, locale) {\n\t\t\tdateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));\n\t\t},\n\t\tS: function (dateObj, seconds) {\n\t\t\tdateObj.setSeconds(parseFloat(seconds));\n\t\t},\n\t\tU: function (_, unixSeconds) {\n\t\t\treturn new Date(parseFloat(unixSeconds) * 1000);\n\t\t},\n\t\tW: function (dateObj, weekNum, locale) {\n\t\t\tvar weekNumber = parseInt(weekNum);\n\t\t\tvar date = new Date(\n\t\t\t\tdateObj.getFullYear(),\n\t\t\t\t0,\n\t\t\t\t2 + (weekNumber - 1) * 7,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t0\n\t\t\t);\n\t\t\tdate.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);\n\t\t\treturn date;\n\t\t},\n\t\tY: function (dateObj, year) {\n\t\t\tdateObj.setFullYear(parseFloat(year));\n\t\t},\n\t\tZ: function (_, ISODate) {\n\t\t\treturn new Date(ISODate);\n\t\t},\n\t\td: function (dateObj, day) {\n\t\t\tdateObj.setDate(parseFloat(day));\n\t\t},\n\t\th: function (dateObj, hour) {\n\t\t\tdateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));\n\t\t},\n\t\ti: function (dateObj, minutes) {\n\t\t\tdateObj.setMinutes(parseFloat(minutes));\n\t\t},\n\t\tj: function (dateObj, day) {\n\t\t\tdateObj.setDate(parseFloat(day));\n\t\t},\n\t\tl: doNothing,\n\t\tm: function (dateObj, month) {\n\t\t\tdateObj.setMonth(parseFloat(month) - 1);\n\t\t},\n\t\tn: function (dateObj, month) {\n\t\t\tdateObj.setMonth(parseFloat(month) - 1);\n\t\t},\n\t\ts: function (dateObj, seconds) {\n\t\t\tdateObj.setSeconds(parseFloat(seconds));\n\t\t},\n\t\tu: function (_, unixMillSeconds) {\n\t\t\treturn new Date(parseFloat(unixMillSeconds));\n\t\t},\n\t\tw: doNothing,\n\t\ty: function (dateObj, year) {\n\t\t\tdateObj.setFullYear(2000 + parseFloat(year));\n\t\t},\n\t};\n\tvar tokenRegex = {\n\t\tD: \"\",\n\t\tF: \"\",\n\t\tG: \"(\\\\d\\\\d|\\\\d)\",\n\t\tH: \"(\\\\d\\\\d|\\\\d)\",\n\t\tJ: \"(\\\\d\\\\d|\\\\d)\\\\w+\",\n\t\tK: \"\",\n\t\tM: \"\",\n\t\tS: \"(\\\\d\\\\d|\\\\d)\",\n\t\tU: \"(.+)\",\n\t\tW: \"(\\\\d\\\\d|\\\\d)\",\n\t\tY: \"(\\\\d{4})\",\n\t\tZ: \"(.+)\",\n\t\td: \"(\\\\d\\\\d|\\\\d)\",\n\t\th: \"(\\\\d\\\\d|\\\\d)\",\n\t\ti: \"(\\\\d\\\\d|\\\\d)\",\n\t\tj: \"(\\\\d\\\\d|\\\\d)\",\n\t\tl: \"\",\n\t\tm: \"(\\\\d\\\\d|\\\\d)\",\n\t\tn: \"(\\\\d\\\\d|\\\\d)\",\n\t\ts: \"(\\\\d\\\\d|\\\\d)\",\n\t\tu: \"(.+)\",\n\t\tw: \"(\\\\d\\\\d|\\\\d)\",\n\t\ty: \"(\\\\d{2})\",\n\t};\n\tvar formats = {\n\t\t// get the date in UTC\n\t\tZ: function (date) {\n\t\t\treturn date.toISOString();\n\t\t},\n\t\t// weekday name, short, e.g. Thu\n\t\tD: function (date, locale, options) {\n\t\t\treturn locale.weekdays.shorthand[formats.w(date, locale, options)];\n\t\t},\n\t\t// full month name e.g. January\n\t\tF: function (date, locale, options) {\n\t\t\treturn monthToStr(formats.n(date, locale, options) - 1, false, locale);\n\t\t},\n\t\t// padded hour 1-12\n\t\tG: function (date, locale, options) {\n\t\t\treturn pad(formats.h(date, locale, options));\n\t\t},\n\t\t// hours with leading zero e.g. 03\n\t\tH: function (date) {\n\t\t\treturn pad(date.getHours());\n\t\t},\n\t\t// day (1-30) with ordinal suffix e.g. 1st, 2nd\n\t\tJ: function (date, locale) {\n\t\t\treturn locale.ordinal !== undefined\n\t\t\t\t? date.getDate() + locale.ordinal(date.getDate())\n\t\t\t\t: date.getDate();\n\t\t},\n\t\t// AM/PM\n\t\tK: function (date, locale) {\n\t\t\treturn locale.amPM[int(date.getHours() > 11)];\n\t\t},\n\t\t// shorthand month e.g. Jan, Sep, Oct, etc\n\t\tM: function (date, locale) {\n\t\t\treturn monthToStr(date.getMonth(), true, locale);\n\t\t},\n\t\t// seconds 00-59\n\t\tS: function (date) {\n\t\t\treturn pad(date.getSeconds());\n\t\t},\n\t\t// unix timestamp\n\t\tU: function (date) {\n\t\t\treturn date.getTime() / 1000;\n\t\t},\n\t\tW: function (date, _, options) {\n\t\t\treturn options.getWeek(date);\n\t\t},\n\t\t// full year e.g. 2016, padded (0001-9999)\n\t\tY: function (date) {\n\t\t\treturn pad(date.getFullYear(), 4);\n\t\t},\n\t\t// day in month, padded (01-30)\n\t\td: function (date) {\n\t\t\treturn pad(date.getDate());\n\t\t},\n\t\t// hour from 1-12 (am/pm)\n\t\th: function (date) {\n\t\t\treturn date.getHours() % 12 ? date.getHours() % 12 : 12;\n\t\t},\n\t\t// minutes, padded with leading zero e.g. 09\n\t\ti: function (date) {\n\t\t\treturn pad(date.getMinutes());\n\t\t},\n\t\t// day in month (1-30)\n\t\tj: function (date) {\n\t\t\treturn date.getDate();\n\t\t},\n\t\t// weekday name, full, e.g. Thursday\n\t\tl: function (date, locale) {\n\t\t\treturn locale.weekdays.longhand[date.getDay()];\n\t\t},\n\t\t// padded month number (01-12)\n\t\tm: function (date) {\n\t\t\treturn pad(date.getMonth() + 1);\n\t\t},\n\t\t// the month number (1-12)\n\t\tn: function (date) {\n\t\t\treturn date.getMonth() + 1;\n\t\t},\n\t\t// seconds 0-59\n\t\ts: function (date) {\n\t\t\treturn date.getSeconds();\n\t\t},\n\t\t// Unix Milliseconds\n\t\tu: function (date) {\n\t\t\treturn date.getTime();\n\t\t},\n\t\t// number of the day of the week\n\t\tw: function (date) {\n\t\t\treturn date.getDay();\n\t\t},\n\t\t// last two digits of year e.g. 16 for 2016\n\t\ty: function (date) {\n\t\t\treturn String(date.getFullYear()).substring(2);\n\t\t},\n\t};\n\n\tvar createDateFormatter = function (_a) {\n\t\tvar _b = _a.config,\n\t\t\tconfig = _b === void 0 ? defaults : _b,\n\t\t\t_c = _a.l10n,\n\t\t\tl10n = _c === void 0 ? english : _c,\n\t\t\t_d = _a.isMobile,\n\t\t\tisMobile = _d === void 0 ? false : _d;\n\t\treturn function (dateObj, frmt, overrideLocale) {\n\t\t\tvar locale = overrideLocale || l10n;\n\t\t\tif (config.formatDate !== undefined && !isMobile) {\n\t\t\t\treturn config.formatDate(dateObj, frmt, locale);\n\t\t\t}\n\t\t\treturn frmt\n\t\t\t\t.split(\"\")\n\t\t\t\t.map(function (c, i, arr) {\n\t\t\t\t\treturn formats[c] && arr[i - 1] !== \"\\\\\"\n\t\t\t\t\t\t? formats[c](dateObj, locale, config)\n\t\t\t\t\t\t: c !== \"\\\\\"\n\t\t\t\t\t\t? c\n\t\t\t\t\t\t: \"\";\n\t\t\t\t})\n\t\t\t\t.join(\"\");\n\t\t};\n\t};\n\tvar createDateParser = function (_a) {\n\t\tvar _b = _a.config,\n\t\t\tconfig = _b === void 0 ? defaults : _b,\n\t\t\t_c = _a.l10n,\n\t\t\tl10n = _c === void 0 ? english : _c;\n\t\treturn function (date, givenFormat, timeless, customLocale) {\n\t\t\tif (date !== 0 && !date) return undefined;\n\t\t\tvar locale = customLocale || l10n;\n\t\t\tvar parsedDate;\n\t\t\tvar dateOrig = date;\n\t\t\tif (date instanceof Date) parsedDate = new Date(date.getTime());\n\t\t\telse if (\n\t\t\t\ttypeof date !== \"string\" &&\n\t\t\t\tdate.toFixed !== undefined // timestamp\n\t\t\t)\n\t\t\t\t// create a copy\n\t\t\t\tparsedDate = new Date(date);\n\t\t\telse if (typeof date === \"string\") {\n\t\t\t\t// date string\n\t\t\t\tvar format = givenFormat || (config || defaults).dateFormat;\n\t\t\t\tvar datestr = String(date).trim();\n\t\t\t\tif (datestr === \"today\") {\n\t\t\t\t\tparsedDate = new Date();\n\t\t\t\t\ttimeless = true;\n\t\t\t\t} else if (config && config.parseDate) {\n\t\t\t\t\tparsedDate = config.parseDate(date, format);\n\t\t\t\t} else if (\n\t\t\t\t\t/Z$/.test(datestr) ||\n\t\t\t\t\t/GMT$/.test(datestr) // datestrings w/ timezone\n\t\t\t\t) {\n\t\t\t\t\tparsedDate = new Date(date);\n\t\t\t\t} else {\n\t\t\t\t\tvar matched = void 0,\n\t\t\t\t\t\tops = [];\n\t\t\t\t\tfor (\n\t\t\t\t\t\tvar i = 0, matchIndex = 0, regexStr = \"\";\n\t\t\t\t\t\ti < format.length;\n\t\t\t\t\t\ti++\n\t\t\t\t\t) {\n\t\t\t\t\t\tvar token_1 = format[i];\n\t\t\t\t\t\tvar isBackSlash = token_1 === \"\\\\\";\n\t\t\t\t\t\tvar escaped = format[i - 1] === \"\\\\\" || isBackSlash;\n\t\t\t\t\t\tif (tokenRegex[token_1] && !escaped) {\n\t\t\t\t\t\t\tregexStr += tokenRegex[token_1];\n\t\t\t\t\t\t\tvar match = new RegExp(regexStr).exec(date);\n\t\t\t\t\t\t\tif (match && (matched = true)) {\n\t\t\t\t\t\t\t\tops[token_1 !== \"Y\" ? \"push\" : \"unshift\"]({\n\t\t\t\t\t\t\t\t\tfn: revFormat[token_1],\n\t\t\t\t\t\t\t\t\tval: match[++matchIndex],\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!isBackSlash) regexStr += \".\"; // don't really care\n\t\t\t\t\t}\n\t\t\t\t\tparsedDate =\n\t\t\t\t\t\t!config || !config.noCalendar\n\t\t\t\t\t\t\t? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0)\n\t\t\t\t\t\t\t: new Date(new Date().setHours(0, 0, 0, 0));\n\t\t\t\t\tops.forEach(function (_a) {\n\t\t\t\t\t\tvar fn = _a.fn,\n\t\t\t\t\t\t\tval = _a.val;\n\t\t\t\t\t\treturn (parsedDate = fn(parsedDate, val, locale) || parsedDate);\n\t\t\t\t\t});\n\t\t\t\t\tparsedDate = matched ? parsedDate : undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* istanbul ignore next */\n\t\t\tif (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {\n\t\t\t\tconfig.errorHandler(new Error(\"Invalid date provided: \" + dateOrig));\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (timeless === true) parsedDate.setHours(0, 0, 0, 0);\n\t\t\treturn parsedDate;\n\t\t};\n\t};\n\t/**\n\t * Compute the difference in dates, measured in ms\n\t */\n\tfunction compareDates(date1, date2, timeless) {\n\t\tif (timeless === void 0) {\n\t\t\ttimeless = true;\n\t\t}\n\t\tif (timeless !== false) {\n\t\t\treturn (\n\t\t\t\tnew Date(date1.getTime()).setHours(0, 0, 0, 0) -\n\t\t\t\tnew Date(date2.getTime()).setHours(0, 0, 0, 0)\n\t\t\t);\n\t\t}\n\t\treturn date1.getTime() - date2.getTime();\n\t}\n\tvar isBetween = function (ts, ts1, ts2) {\n\t\treturn ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);\n\t};\n\tvar calculateSecondsSinceMidnight = function (hours, minutes, seconds) {\n\t\treturn hours * 3600 + minutes * 60 + seconds;\n\t};\n\tvar parseSeconds = function (secondsSinceMidnight) {\n\t\tvar hours = Math.floor(secondsSinceMidnight / 3600),\n\t\t\tminutes = (secondsSinceMidnight - hours * 3600) / 60;\n\t\treturn [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];\n\t};\n\tvar duration = {\n\t\tDAY: 86400000,\n\t};\n\tfunction getDefaultHours(config) {\n\t\tvar hours = config.defaultHour;\n\t\tvar minutes = config.defaultMinute;\n\t\tvar seconds = config.defaultSeconds;\n\t\tif (config.minDate !== undefined) {\n\t\t\tvar minHour = config.minDate.getHours();\n\t\t\tvar minMinutes = config.minDate.getMinutes();\n\t\t\tvar minSeconds = config.minDate.getSeconds();\n\t\t\tif (hours < minHour) {\n\t\t\t\thours = minHour;\n\t\t\t}\n\t\t\tif (hours === minHour && minutes < minMinutes) {\n\t\t\t\tminutes = minMinutes;\n\t\t\t}\n\t\t\tif (hours === minHour && minutes === minMinutes && seconds < minSeconds)\n\t\t\t\tseconds = config.minDate.getSeconds();\n\t\t}\n\t\tif (config.maxDate !== undefined) {\n\t\t\tvar maxHr = config.maxDate.getHours();\n\t\t\tvar maxMinutes = config.maxDate.getMinutes();\n\t\t\thours = Math.min(hours, maxHr);\n\t\t\tif (hours === maxHr) minutes = Math.min(maxMinutes, minutes);\n\t\t\tif (hours === maxHr && minutes === maxMinutes)\n\t\t\t\tseconds = config.maxDate.getSeconds();\n\t\t}\n\t\treturn { hours: hours, minutes: minutes, seconds: seconds };\n\t}\n\n\t// if (typeof Object.assign !== \"function\") {\n\t// \tObject.assign = function (target) {\n\t// \t\tvar args = [];\n\t// \t\tfor (var _i = 1; _i < arguments.length; _i++) {\n\t// \t\t\targs[_i - 1] = arguments[_i];\n\t// \t\t}\n\t// \t\tif (!target) {\n\t// \t\t\tthrow TypeError(\"Cannot convert undefined or null to object\");\n\t// \t\t}\n\t// \t\tvar _loop_1 = function (source) {\n\t// \t\t\tif (source) {\n\t// \t\t\t\tObject.keys(source).forEach(function (key) {\n\t// \t\t\t\t\treturn (target[key] = source[key]);\n\t// \t\t\t\t});\n\t// \t\t\t}\n\t// \t\t};\n\t// \t\tfor (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n\t// \t\t\tvar source = args_1[_a];\n\t// \t\t\t_loop_1(source);\n\t// \t\t}\n\t// \t\treturn target;\n\t// \t};\n\t// }\n\n\tvar DEBOUNCED_CHANGE_MS = 300;\n\tfunction FlatpickrInstance(element, instanceConfig) {\n\t\tvar self = {\n\t\t\tconfig: __assign(__assign({}, defaults), flatpickr.defaultConfig),\n\t\t\tl10n: english,\n\t\t};\n\t\tself.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n\t\tself._handlers = [];\n\t\tself.pluginElements = [];\n\t\tself.loadedPlugins = [];\n\t\tself._bind = bind;\n\t\tself._setHoursFromDate = setHoursFromDate;\n\t\tself._positionCalendar = positionCalendar;\n\t\tself.changeMonth = changeMonth;\n\t\tself.changeYear = changeYear;\n\t\tself.clear = clear;\n\t\tself.close = close;\n\t\tself.onMouseOver = onMouseOver;\n\t\tself._createElement = createElement;\n\t\tself.createDay = createDay;\n\t\tself.destroy = destroy;\n\t\tself.isEnabled = isEnabled;\n\t\tself.jumpToDate = jumpToDate;\n\t\tself.updateValue = updateValue;\n\t\tself.open = open;\n\t\tself.redraw = redraw;\n\t\tself.set = set;\n\t\tself.setDate = setDate;\n\t\tself.toggle = toggle;\n\t\tfunction setupHelperFunctions() {\n\t\t\tself.utils = {\n\t\t\t\tgetDaysInMonth: function (month, yr) {\n\t\t\t\t\tif (month === void 0) {\n\t\t\t\t\t\tmonth = self.currentMonth;\n\t\t\t\t\t}\n\t\t\t\t\tif (yr === void 0) {\n\t\t\t\t\t\tyr = self.currentYear;\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\tmonth === 1 &&\n\t\t\t\t\t\t((yr % 4 === 0 && yr % 100 !== 0) || yr % 400 === 0)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn 29;\n\t\t\t\t\treturn self.l10n.daysInMonth[month];\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t\tfunction init() {\n\t\t\tself.element = self.input = element;\n\t\t\tself.isOpen = false;\n\t\t\tparseConfig();\n\t\t\tsetupLocale();\n\t\t\tsetupInputs();\n\t\t\tsetupDates();\n\t\t\tsetupHelperFunctions();\n\t\t\tif (!self.isMobile) build();\n\t\t\tbindEvents();\n\t\t\tif (self.selectedDates.length || self.config.noCalendar) {\n\t\t\t\tif (self.config.enableTime) {\n\t\t\t\t\tsetHoursFromDate(\n\t\t\t\t\t\tself.config.noCalendar ? self.latestSelectedDateObj : undefined\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tupdateValue(false);\n\t\t\t}\n\t\t\tsetCalendarWidth();\n\t\t\tvar isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n\t\t\t/* TODO: investigate this further\n        \n              Currently, there is weird positioning behavior in safari causing pages\n              to scroll up. https://github.com/chmln/flatpickr/issues/563\n        \n              However, most browsers are not Safari and positioning is expensive when used\n              in scale. https://github.com/chmln/flatpickr/issues/1096\n            */\n\t\t\tif (!self.isMobile && isSafari) {\n\t\t\t\tpositionCalendar();\n\t\t\t}\n\t\t\ttriggerEvent(\"onReady\");\n\t\t}\n\t\tfunction getClosestActiveElement() {\n\t\t\tvar _a;\n\t\t\treturn (\n\t\t\t\t((_a = self.calendarContainer) === null || _a === void 0\n\t\t\t\t\t? void 0\n\t\t\t\t\t: _a.getRootNode()\n\t\t\t\t).activeElement || document.activeElement\n\t\t\t);\n\t\t}\n\t\tfunction bindToInstance(fn) {\n\t\t\treturn fn.bind(self);\n\t\t}\n\t\tfunction setCalendarWidth() {\n\t\t\tvar config = self.config;\n\t\t\tif (config.weekNumbers === false && config.showMonths === 1) {\n\t\t\t\treturn;\n\t\t\t} else if (config.noCalendar !== true) {\n\t\t\t\twindow.requestAnimationFrame(function () {\n\t\t\t\t\tif (self.calendarContainer !== undefined) {\n\t\t\t\t\t\tself.calendarContainer.style.visibility = \"hidden\";\n\t\t\t\t\t\tself.calendarContainer.style.display = \"block\";\n\t\t\t\t\t}\n\t\t\t\t\tif (self.daysContainer !== undefined) {\n\t\t\t\t\t\tvar daysWidth = (self.days.offsetWidth + 1) * config.showMonths;\n\t\t\t\t\t\tself.daysContainer.style.width = daysWidth + \"px\";\n\t\t\t\t\t\tself.calendarContainer.style.width =\n\t\t\t\t\t\t\tdaysWidth +\n\t\t\t\t\t\t\t(self.weekWrapper !== undefined\n\t\t\t\t\t\t\t\t? self.weekWrapper.offsetWidth\n\t\t\t\t\t\t\t\t: 0) +\n\t\t\t\t\t\t\t\"px\";\n\t\t\t\t\t\tself.calendarContainer.style.removeProperty(\"visibility\");\n\t\t\t\t\t\tself.calendarContainer.style.removeProperty(\"display\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * The handler for all events targeting the time inputs\n\t\t */\n\t\tfunction updateTime(e) {\n\t\t\tif (self.selectedDates.length === 0) {\n\t\t\t\tvar defaultDate =\n\t\t\t\t\tself.config.minDate === undefined ||\n\t\t\t\t\tcompareDates(new Date(), self.config.minDate) >= 0\n\t\t\t\t\t\t? new Date()\n\t\t\t\t\t\t: new Date(self.config.minDate.getTime());\n\t\t\t\tvar defaults = getDefaultHours(self.config);\n\t\t\t\tdefaultDate.setHours(\n\t\t\t\t\tdefaults.hours,\n\t\t\t\t\tdefaults.minutes,\n\t\t\t\t\tdefaults.seconds,\n\t\t\t\t\tdefaultDate.getMilliseconds()\n\t\t\t\t);\n\t\t\t\tself.selectedDates = [defaultDate];\n\t\t\t\tself.latestSelectedDateObj = defaultDate;\n\t\t\t}\n\t\t\tif (e !== undefined && e.type !== \"blur\") {\n\t\t\t\ttimeWrapper(e);\n\t\t\t}\n\t\t\tvar prevValue = self._input.value;\n\t\t\tsetHoursFromInputs();\n\t\t\tupdateValue();\n\t\t\tif (self._input.value !== prevValue) {\n\t\t\t\tself._debouncedChange();\n\t\t\t}\n\t\t}\n\t\tfunction ampm2military(hour, amPM) {\n\t\t\treturn (hour % 12) + 12 * int(amPM === self.l10n.amPM[1]);\n\t\t}\n\t\tfunction military2ampm(hour) {\n\t\t\tswitch (hour % 24) {\n\t\t\t\tcase 0:\n\t\t\t\tcase 12:\n\t\t\t\t\treturn 12;\n\t\t\t\tdefault:\n\t\t\t\t\treturn hour % 12;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Syncs the selected date object time with user's time input\n\t\t */\n\t\tfunction setHoursFromInputs() {\n\t\t\tif (self.hourElement === undefined || self.minuteElement === undefined)\n\t\t\t\treturn;\n\t\t\tvar hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24,\n\t\t\t\tminutes = (parseInt(self.minuteElement.value, 10) || 0) % 60,\n\t\t\t\tseconds =\n\t\t\t\t\tself.secondElement !== undefined\n\t\t\t\t\t\t? (parseInt(self.secondElement.value, 10) || 0) % 60\n\t\t\t\t\t\t: 0;\n\t\t\tif (self.amPM !== undefined) {\n\t\t\t\thours = ampm2military(hours, self.amPM.textContent);\n\t\t\t}\n\t\t\tvar limitMinHours =\n\t\t\t\tself.config.minTime !== undefined ||\n\t\t\t\t(self.config.minDate &&\n\t\t\t\t\tself.minDateHasTime &&\n\t\t\t\t\tself.latestSelectedDateObj &&\n\t\t\t\t\tcompareDates(\n\t\t\t\t\t\tself.latestSelectedDateObj,\n\t\t\t\t\t\tself.config.minDate,\n\t\t\t\t\t\ttrue\n\t\t\t\t\t) === 0);\n\t\t\tvar limitMaxHours =\n\t\t\t\tself.config.maxTime !== undefined ||\n\t\t\t\t(self.config.maxDate &&\n\t\t\t\t\tself.maxDateHasTime &&\n\t\t\t\t\tself.latestSelectedDateObj &&\n\t\t\t\t\tcompareDates(\n\t\t\t\t\t\tself.latestSelectedDateObj,\n\t\t\t\t\t\tself.config.maxDate,\n\t\t\t\t\t\ttrue\n\t\t\t\t\t) === 0);\n\t\t\tif (\n\t\t\t\tself.config.maxTime !== undefined &&\n\t\t\t\tself.config.minTime !== undefined &&\n\t\t\t\tself.config.minTime > self.config.maxTime\n\t\t\t) {\n\t\t\t\tvar minBound = calculateSecondsSinceMidnight(\n\t\t\t\t\tself.config.minTime.getHours(),\n\t\t\t\t\tself.config.minTime.getMinutes(),\n\t\t\t\t\tself.config.minTime.getSeconds()\n\t\t\t\t);\n\t\t\t\tvar maxBound = calculateSecondsSinceMidnight(\n\t\t\t\t\tself.config.maxTime.getHours(),\n\t\t\t\t\tself.config.maxTime.getMinutes(),\n\t\t\t\t\tself.config.maxTime.getSeconds()\n\t\t\t\t);\n\t\t\t\tvar currentTime = calculateSecondsSinceMidnight(\n\t\t\t\t\thours,\n\t\t\t\t\tminutes,\n\t\t\t\t\tseconds\n\t\t\t\t);\n\t\t\t\tif (currentTime > maxBound && currentTime < minBound) {\n\t\t\t\t\tvar result = parseSeconds(minBound);\n\t\t\t\t\thours = result[0];\n\t\t\t\t\tminutes = result[1];\n\t\t\t\t\tseconds = result[2];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (limitMaxHours) {\n\t\t\t\t\tvar maxTime =\n\t\t\t\t\t\tself.config.maxTime !== undefined\n\t\t\t\t\t\t\t? self.config.maxTime\n\t\t\t\t\t\t\t: self.config.maxDate;\n\t\t\t\t\thours = Math.min(hours, maxTime.getHours());\n\t\t\t\t\tif (hours === maxTime.getHours())\n\t\t\t\t\t\tminutes = Math.min(minutes, maxTime.getMinutes());\n\t\t\t\t\tif (minutes === maxTime.getMinutes())\n\t\t\t\t\t\tseconds = Math.min(seconds, maxTime.getSeconds());\n\t\t\t\t}\n\t\t\t\tif (limitMinHours) {\n\t\t\t\t\tvar minTime =\n\t\t\t\t\t\tself.config.minTime !== undefined\n\t\t\t\t\t\t\t? self.config.minTime\n\t\t\t\t\t\t\t: self.config.minDate;\n\t\t\t\t\thours = Math.max(hours, minTime.getHours());\n\t\t\t\t\tif (hours === minTime.getHours() && minutes < minTime.getMinutes())\n\t\t\t\t\t\tminutes = minTime.getMinutes();\n\t\t\t\t\tif (minutes === minTime.getMinutes())\n\t\t\t\t\t\tseconds = Math.max(seconds, minTime.getSeconds());\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetHours(hours, minutes, seconds);\n\t\t}\n\t\t/**\n\t\t * Syncs time input values with a date\n\t\t */\n\t\tfunction setHoursFromDate(dateObj) {\n\t\t\tvar date = dateObj || self.latestSelectedDateObj;\n\t\t\tif (date && date instanceof Date) {\n\t\t\t\tsetHours(date.getHours(), date.getMinutes(), date.getSeconds());\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Sets the hours, minutes, and optionally seconds\n\t\t * of the latest selected date object and the\n\t\t * corresponding time inputs\n\t\t * @param {Number} hours the hour. whether its military\n\t\t *                 or am-pm gets inferred from config\n\t\t * @param {Number} minutes the minutes\n\t\t * @param {Number} seconds the seconds (optional)\n\t\t */\n\t\tfunction setHours(hours, minutes, seconds) {\n\t\t\tif (self.latestSelectedDateObj !== undefined) {\n\t\t\t\tself.latestSelectedDateObj.setHours(\n\t\t\t\t\thours % 24,\n\t\t\t\t\tminutes,\n\t\t\t\t\tseconds || 0,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!self.hourElement || !self.minuteElement || self.isMobile) return;\n\t\t\tself.hourElement.value = pad(\n\t\t\t\t!self.config.time_24hr\n\t\t\t\t\t? ((12 + hours) % 12) + 12 * int(hours % 12 === 0)\n\t\t\t\t\t: hours\n\t\t\t);\n\t\t\tself.minuteElement.value = pad(minutes);\n\t\t\tif (self.amPM !== undefined)\n\t\t\t\tself.amPM.textContent = self.l10n.amPM[int(hours >= 12)];\n\t\t\tif (self.secondElement !== undefined)\n\t\t\t\tself.secondElement.value = pad(seconds);\n\t\t}\n\t\t/**\n\t\t * Handles the year input and incrementing events\n\t\t * @param {Event} event the keyup or increment event\n\t\t */\n\t\tfunction onYearInput(event) {\n\t\t\tvar eventTarget = getEventTarget(event);\n\t\t\tvar year = parseInt(eventTarget.value) + (event.delta || 0);\n\t\t\tif (\n\t\t\t\tyear / 1000 > 1 ||\n\t\t\t\t(event.key === \"Enter\" && !/[^\\d]/.test(year.toString()))\n\t\t\t) {\n\t\t\t\tchangeYear(year);\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Essentially addEventListener + tracking\n\t\t * @param {Element} element the element to addEventListener to\n\t\t * @param {String} event the event name\n\t\t * @param {Function} handler the event handler\n\t\t */\n\t\tfunction bind(element, event, handler, options) {\n\t\t\tif (event instanceof Array)\n\t\t\t\treturn event.forEach(function (ev) {\n\t\t\t\t\treturn bind(element, ev, handler, options);\n\t\t\t\t});\n\t\t\tif (element instanceof Array)\n\t\t\t\treturn element.forEach(function (el) {\n\t\t\t\t\treturn bind(el, event, handler, options);\n\t\t\t\t});\n\t\t\telement.addEventListener(event, handler, options);\n\t\t\tself._handlers.push({\n\t\t\t\tremove: function () {\n\t\t\t\t\treturn element.removeEventListener(event, handler, options);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tfunction triggerChange() {\n\t\t\ttriggerEvent(\"onChange\");\n\t\t}\n\t\t/**\n\t\t * Adds all the necessary event listeners\n\t\t */\n\t\tfunction bindEvents() {\n\t\t\tif (self.config.wrap) {\n\t\t\t\t[\"open\", \"close\", \"toggle\", \"clear\"].forEach(function (evt) {\n\t\t\t\t\tArray.prototype.forEach.call(\n\t\t\t\t\t\tself.element.querySelectorAll(\"[data-\" + evt + \"]\"),\n\t\t\t\t\t\tfunction (el) {\n\t\t\t\t\t\t\treturn bind(el, \"click\", self[evt]);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (self.isMobile) {\n\t\t\t\tsetupMobile();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar debouncedResize = debounce(onResize, 50);\n\t\t\tself._debouncedChange = debounce(triggerChange, DEBOUNCED_CHANGE_MS);\n\t\t\tif (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))\n\t\t\t\tbind(self.daysContainer, \"mouseover\", function (e) {\n\t\t\t\t\tif (self.config.mode === \"range\") onMouseOver(getEventTarget(e));\n\t\t\t\t});\n\t\t\tbind(self._input, \"keydown\", onKeyDown);\n\t\t\tif (self.calendarContainer !== undefined) {\n\t\t\t\tbind(self.calendarContainer, \"keydown\", onKeyDown);\n\t\t\t}\n\t\t\tif (!self.config.inline && !self.config.static)\n\t\t\t\tbind(window, \"resize\", debouncedResize);\n\t\t\tif (window.ontouchstart !== undefined)\n\t\t\t\tbind(window.document, \"touchstart\", documentClick);\n\t\t\telse bind(window.document, \"mousedown\", documentClick);\n\t\t\tbind(window.document, \"focus\", documentClick, { capture: true });\n\t\t\tif (self.config.clickOpens === true) {\n\t\t\t\tbind(self._input, \"focus\", self.open);\n\t\t\t\tbind(self._input, \"click\", self.open);\n\t\t\t}\n\t\t\tif (self.daysContainer !== undefined) {\n\t\t\t\tbind(self.monthNav, \"click\", onMonthNavClick);\n\t\t\t\tbind(self.monthNav, [\"keyup\", \"increment\"], onYearInput);\n\t\t\t\tbind(self.daysContainer, \"click\", selectDate);\n\t\t\t}\n\t\t\tif (\n\t\t\t\tself.timeContainer !== undefined &&\n\t\t\t\tself.minuteElement !== undefined &&\n\t\t\t\tself.hourElement !== undefined\n\t\t\t) {\n\t\t\t\tvar selText = function (e) {\n\t\t\t\t\treturn getEventTarget(e).select();\n\t\t\t\t};\n\t\t\t\tbind(self.timeContainer, [\"increment\"], updateTime);\n\t\t\t\tbind(self.timeContainer, \"blur\", updateTime, { capture: true });\n\t\t\t\tbind(self.timeContainer, \"click\", timeIncrement);\n\t\t\t\tbind(\n\t\t\t\t\t[self.hourElement, self.minuteElement],\n\t\t\t\t\t[\"focus\", \"click\"],\n\t\t\t\t\tselText\n\t\t\t\t);\n\t\t\t\tif (self.secondElement !== undefined)\n\t\t\t\t\tbind(self.secondElement, \"focus\", function () {\n\t\t\t\t\t\treturn self.secondElement && self.secondElement.select();\n\t\t\t\t\t});\n\t\t\t\tif (self.amPM !== undefined) {\n\t\t\t\t\tbind(self.amPM, \"click\", function (e) {\n\t\t\t\t\t\tupdateTime(e);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (self.config.allowInput) {\n\t\t\t\tbind(self._input, \"blur\", onBlur);\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Set the calendar view to a particular date.\n\t\t * @param {Date} jumpDate the date to set the view to\n\t\t * @param {boolean} triggerChange if change events should be triggered\n\t\t */\n\t\tfunction jumpToDate(jumpDate, triggerChange) {\n\t\t\tvar jumpTo =\n\t\t\t\tjumpDate !== undefined\n\t\t\t\t\t? self.parseDate(jumpDate)\n\t\t\t\t\t: self.latestSelectedDateObj ||\n\t\t\t\t\t  (self.config.minDate && self.config.minDate > self.now\n\t\t\t\t\t\t\t? self.config.minDate\n\t\t\t\t\t\t\t: self.config.maxDate && self.config.maxDate < self.now\n\t\t\t\t\t\t\t? self.config.maxDate\n\t\t\t\t\t\t\t: self.now);\n\t\t\tvar oldYear = self.currentYear;\n\t\t\tvar oldMonth = self.currentMonth;\n\t\t\ttry {\n\t\t\t\tif (jumpTo !== undefined) {\n\t\t\t\t\tself.currentYear = jumpTo.getFullYear();\n\t\t\t\t\tself.currentMonth = jumpTo.getMonth();\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t/* istanbul ignore next */\n\t\t\t\te.message = \"Invalid date supplied: \" + jumpTo;\n\t\t\t\tself.config.errorHandler(e);\n\t\t\t}\n\t\t\tif (triggerChange && self.currentYear !== oldYear) {\n\t\t\t\ttriggerEvent(\"onYearChange\");\n\t\t\t\tbuildMonthSwitch();\n\t\t\t}\n\t\t\tif (\n\t\t\t\ttriggerChange &&\n\t\t\t\t(self.currentYear !== oldYear || self.currentMonth !== oldMonth)\n\t\t\t) {\n\t\t\t\ttriggerEvent(\"onMonthChange\");\n\t\t\t}\n\t\t\tself.redraw();\n\t\t}\n\t\t/**\n\t\t * The up/down arrow handler for time inputs\n\t\t * @param {Event} e the click event\n\t\t */\n\t\tfunction timeIncrement(e) {\n\t\t\tvar eventTarget = getEventTarget(e);\n\t\t\tif (~eventTarget.className.indexOf(\"arrow\"))\n\t\t\t\tincrementNumInput(\n\t\t\t\t\te,\n\t\t\t\t\teventTarget.classList.contains(\"arrowUp\") ? 1 : -1\n\t\t\t\t);\n\t\t}\n\t\t/**\n\t\t * Increments/decrements the value of input associ-\n\t\t * ated with the up/down arrow by dispatching an\n\t\t * \"increment\" event on the input.\n\t\t *\n\t\t * @param {Event} e the click event\n\t\t * @param {Number} delta the diff (usually 1 or -1)\n\t\t * @param {Element} inputElem the input element\n\t\t */\n\t\tfunction incrementNumInput(e, delta, inputElem) {\n\t\t\tvar target = e && getEventTarget(e);\n\t\t\tvar input =\n\t\t\t\tinputElem ||\n\t\t\t\t(target && target.parentNode && target.parentNode.firstChild);\n\t\t\tvar event = createEvent(\"increment\");\n\t\t\tevent.delta = delta;\n\t\t\tinput && input.dispatchEvent(event);\n\t\t}\n\t\tfunction build() {\n\t\t\tvar fragment = window.document.createDocumentFragment();\n\t\t\tself.calendarContainer = createElement(\"div\", \"flatpickr-calendar\");\n\t\t\tself.calendarContainer.tabIndex = -1;\n\t\t\tif (!self.config.noCalendar) {\n\t\t\t\tfragment.appendChild(buildMonthNav());\n\t\t\t\tself.innerContainer = createElement(\"div\", \"flatpickr-innerContainer\");\n\t\t\t\tif (self.config.weekNumbers) {\n\t\t\t\t\tvar _a = buildWeeks(),\n\t\t\t\t\t\tweekWrapper = _a.weekWrapper,\n\t\t\t\t\t\tweekNumbers = _a.weekNumbers;\n\t\t\t\t\tself.innerContainer.appendChild(weekWrapper);\n\t\t\t\t\tself.weekNumbers = weekNumbers;\n\t\t\t\t\tself.weekWrapper = weekWrapper;\n\t\t\t\t}\n\t\t\t\tself.rContainer = createElement(\"div\", \"flatpickr-rContainer\");\n\t\t\t\tself.rContainer.appendChild(buildWeekdays());\n\t\t\t\tif (!self.daysContainer) {\n\t\t\t\t\tself.daysContainer = createElement(\"div\", \"flatpickr-days\");\n\t\t\t\t\tself.daysContainer.tabIndex = -1;\n\t\t\t\t}\n\t\t\t\tbuildDays();\n\t\t\t\tself.rContainer.appendChild(self.daysContainer);\n\t\t\t\tself.innerContainer.appendChild(self.rContainer);\n\t\t\t\tfragment.appendChild(self.innerContainer);\n\t\t\t}\n\t\t\tif (self.config.enableTime) {\n\t\t\t\tfragment.appendChild(buildTime());\n\t\t\t}\n\t\t\ttoggleClass(\n\t\t\t\tself.calendarContainer,\n\t\t\t\t\"rangeMode\",\n\t\t\t\tself.config.mode === \"range\"\n\t\t\t);\n\t\t\ttoggleClass(\n\t\t\t\tself.calendarContainer,\n\t\t\t\t\"animate\",\n\t\t\t\tself.config.animate === true\n\t\t\t);\n\t\t\ttoggleClass(\n\t\t\t\tself.calendarContainer,\n\t\t\t\t\"multiMonth\",\n\t\t\t\tself.config.showMonths > 1\n\t\t\t);\n\t\t\tself.calendarContainer.appendChild(fragment);\n\t\t\tvar customAppend =\n\t\t\t\tself.config.appendTo !== undefined &&\n\t\t\t\tself.config.appendTo.nodeType !== undefined;\n\t\t\tif (self.config.inline || self.config.static) {\n\t\t\t\tself.calendarContainer.classList.add(\n\t\t\t\t\tself.config.inline ? \"inline\" : \"static\"\n\t\t\t\t);\n\t\t\t\tif (self.config.inline) {\n\t\t\t\t\tif (!customAppend && self.element.parentNode)\n\t\t\t\t\t\tself.element.parentNode.insertBefore(\n\t\t\t\t\t\t\tself.calendarContainer,\n\t\t\t\t\t\t\tself._input.nextSibling\n\t\t\t\t\t\t);\n\t\t\t\t\telse if (self.config.appendTo !== undefined)\n\t\t\t\t\t\tself.config.appendTo.appendChild(self.calendarContainer);\n\t\t\t\t}\n\t\t\t\tif (self.config.static) {\n\t\t\t\t\tvar wrapper = createElement(\"div\", \"flatpickr-wrapper\");\n\t\t\t\t\tif (self.element.parentNode)\n\t\t\t\t\t\tself.element.parentNode.insertBefore(wrapper, self.element);\n\t\t\t\t\twrapper.appendChild(self.element);\n\t\t\t\t\tif (self.altInput) wrapper.appendChild(self.altInput);\n\t\t\t\t\twrapper.appendChild(self.calendarContainer);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!self.config.static && !self.config.inline)\n\t\t\t\t(self.config.appendTo !== undefined\n\t\t\t\t\t? self.config.appendTo\n\t\t\t\t\t: window.document.body\n\t\t\t\t).appendChild(self.calendarContainer);\n\t\t}\n\t\tfunction createDay(className, date, _dayNumber, i) {\n\t\t\tvar dateIsEnabled = isEnabled(date, true),\n\t\t\t\tdayElement = createElement(\n\t\t\t\t\t\"span\",\n\t\t\t\t\tclassName,\n\t\t\t\t\tdate.getDate().toString()\n\t\t\t\t);\n\t\t\tdayElement.dateObj = date;\n\t\t\tdayElement.$i = i;\n\t\t\tdayElement.setAttribute(\n\t\t\t\t\"aria-label\",\n\t\t\t\tself.formatDate(date, self.config.ariaDateFormat)\n\t\t\t);\n\t\t\tif (\n\t\t\t\tclassName.indexOf(\"hidden\") === -1 &&\n\t\t\t\tcompareDates(date, self.now) === 0\n\t\t\t) {\n\t\t\t\tself.todayDateElem = dayElement;\n\t\t\t\tdayElement.classList.add(\"today\");\n\t\t\t\tdayElement.setAttribute(\"aria-current\", \"date\");\n\t\t\t}\n\t\t\tif (dateIsEnabled) {\n\t\t\t\tdayElement.tabIndex = -1;\n\t\t\t\tif (isDateSelected(date)) {\n\t\t\t\t\tdayElement.classList.add(\"selected\");\n\t\t\t\t\tself.selectedDateElem = dayElement;\n\t\t\t\t\tif (self.config.mode === \"range\") {\n\t\t\t\t\t\ttoggleClass(\n\t\t\t\t\t\t\tdayElement,\n\t\t\t\t\t\t\t\"startRange\",\n\t\t\t\t\t\t\tself.selectedDates[0] &&\n\t\t\t\t\t\t\t\tcompareDates(date, self.selectedDates[0], true) === 0\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttoggleClass(\n\t\t\t\t\t\t\tdayElement,\n\t\t\t\t\t\t\t\"endRange\",\n\t\t\t\t\t\t\tself.selectedDates[1] &&\n\t\t\t\t\t\t\t\tcompareDates(date, self.selectedDates[1], true) === 0\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (className === \"nextMonthDay\")\n\t\t\t\t\t\t\tdayElement.classList.add(\"inRange\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdayElement.classList.add(\"flatpickr-disabled\");\n\t\t\t}\n\t\t\tif (self.config.mode === \"range\") {\n\t\t\t\tif (isDateInRange(date) && !isDateSelected(date))\n\t\t\t\t\tdayElement.classList.add(\"inRange\");\n\t\t\t}\n\t\t\tif (\n\t\t\t\tself.weekNumbers &&\n\t\t\t\tself.config.showMonths === 1 &&\n\t\t\t\tclassName !== \"prevMonthDay\" &&\n\t\t\t\ti % 7 === 6\n\t\t\t) {\n\t\t\t\tself.weekNumbers.insertAdjacentHTML(\n\t\t\t\t\t\"beforeend\",\n\t\t\t\t\t\"<span class='flatpickr-day'>\" + self.config.getWeek(date) + \"</span>\"\n\t\t\t\t);\n\t\t\t}\n\t\t\ttriggerEvent(\"onDayCreate\", dayElement);\n\t\t\treturn dayElement;\n\t\t}\n\t\tfunction focusOnDayElem(targetNode) {\n\t\t\ttargetNode.focus();\n\t\t\tif (self.config.mode === \"range\") onMouseOver(targetNode);\n\t\t}\n\t\tfunction getFirstAvailableDay(delta) {\n\t\t\tvar startMonth = delta > 0 ? 0 : self.config.showMonths - 1;\n\t\t\tvar endMonth = delta > 0 ? self.config.showMonths : -1;\n\t\t\tfor (var m = startMonth; m != endMonth; m += delta) {\n\t\t\t\tvar month = self.daysContainer.children[m];\n\t\t\t\tvar startIndex = delta > 0 ? 0 : month.children.length - 1;\n\t\t\t\tvar endIndex = delta > 0 ? month.children.length : -1;\n\t\t\t\tfor (var i = startIndex; i != endIndex; i += delta) {\n\t\t\t\t\tvar c = month.children[i];\n\t\t\t\t\tif (c.className.indexOf(\"hidden\") === -1 && isEnabled(c.dateObj))\n\t\t\t\t\t\treturn c;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\t\tfunction getNextAvailableDay(current, delta) {\n\t\t\tvar givenMonth =\n\t\t\t\tcurrent.className.indexOf(\"Month\") === -1\n\t\t\t\t\t? current.dateObj.getMonth()\n\t\t\t\t\t: self.currentMonth;\n\t\t\tvar endMonth = delta > 0 ? self.config.showMonths : -1;\n\t\t\tvar loopDelta = delta > 0 ? 1 : -1;\n\t\t\tfor (\n\t\t\t\tvar m = givenMonth - self.currentMonth;\n\t\t\t\tm != endMonth;\n\t\t\t\tm += loopDelta\n\t\t\t) {\n\t\t\t\tvar month = self.daysContainer.children[m];\n\t\t\t\tvar startIndex =\n\t\t\t\t\tgivenMonth - self.currentMonth === m\n\t\t\t\t\t\t? current.$i + delta\n\t\t\t\t\t\t: delta < 0\n\t\t\t\t\t\t? month.children.length - 1\n\t\t\t\t\t\t: 0;\n\t\t\t\tvar numMonthDays = month.children.length;\n\t\t\t\tfor (\n\t\t\t\t\tvar i = startIndex;\n\t\t\t\t\ti >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1);\n\t\t\t\t\ti += loopDelta\n\t\t\t\t) {\n\t\t\t\t\tvar c = month.children[i];\n\t\t\t\t\tif (\n\t\t\t\t\t\tc.className.indexOf(\"hidden\") === -1 &&\n\t\t\t\t\t\tisEnabled(c.dateObj) &&\n\t\t\t\t\t\tMath.abs(current.$i - i) >= Math.abs(delta)\n\t\t\t\t\t)\n\t\t\t\t\t\treturn focusOnDayElem(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.changeMonth(loopDelta);\n\t\t\tfocusOnDay(getFirstAvailableDay(loopDelta), 0);\n\t\t\treturn undefined;\n\t\t}\n\t\tfunction focusOnDay(current, offset) {\n\t\t\tvar activeElement = getClosestActiveElement();\n\t\t\tvar dayFocused = isInView(activeElement || document.body);\n\t\t\tvar startElem =\n\t\t\t\tcurrent !== undefined\n\t\t\t\t\t? current\n\t\t\t\t\t: dayFocused\n\t\t\t\t\t? activeElement\n\t\t\t\t\t: self.selectedDateElem !== undefined &&\n\t\t\t\t\t  isInView(self.selectedDateElem)\n\t\t\t\t\t? self.selectedDateElem\n\t\t\t\t\t: self.todayDateElem !== undefined && isInView(self.todayDateElem)\n\t\t\t\t\t? self.todayDateElem\n\t\t\t\t\t: getFirstAvailableDay(offset > 0 ? 1 : -1);\n\t\t\tif (startElem === undefined) {\n\t\t\t\tself._input.focus();\n\t\t\t} else if (!dayFocused) {\n\t\t\t\tfocusOnDayElem(startElem);\n\t\t\t} else {\n\t\t\t\tgetNextAvailableDay(startElem, offset);\n\t\t\t}\n\t\t}\n\t\tfunction buildMonthDays(year, month) {\n\t\t\tvar firstOfMonth =\n\t\t\t\t(new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;\n\t\t\tvar prevMonthDays = self.utils.getDaysInMonth(\n\t\t\t\t(month - 1 + 12) % 12,\n\t\t\t\tyear\n\t\t\t);\n\t\t\tvar daysInMonth = self.utils.getDaysInMonth(month, year),\n\t\t\t\tdays = window.document.createDocumentFragment(),\n\t\t\t\tisMultiMonth = self.config.showMonths > 1,\n\t\t\t\tprevMonthDayClass = isMultiMonth\n\t\t\t\t\t? \"prevMonthDay hidden\"\n\t\t\t\t\t: \"prevMonthDay\",\n\t\t\t\tnextMonthDayClass = isMultiMonth\n\t\t\t\t\t? \"nextMonthDay hidden\"\n\t\t\t\t\t: \"nextMonthDay\";\n\t\t\tvar dayNumber = prevMonthDays + 1 - firstOfMonth,\n\t\t\t\tdayIndex = 0;\n\t\t\t// prepend days from the ending of previous month\n\t\t\tfor (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {\n\t\t\t\tdays.appendChild(\n\t\t\t\t\tcreateDay(\n\t\t\t\t\t\t\"flatpickr-day \" + prevMonthDayClass,\n\t\t\t\t\t\tnew Date(year, month - 1, dayNumber),\n\t\t\t\t\t\tdayNumber,\n\t\t\t\t\t\tdayIndex\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\t// Start at 1 since there is no 0th day\n\t\t\tfor (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {\n\t\t\t\tdays.appendChild(\n\t\t\t\t\tcreateDay(\n\t\t\t\t\t\t\"flatpickr-day\",\n\t\t\t\t\t\tnew Date(year, month, dayNumber),\n\t\t\t\t\t\tdayNumber,\n\t\t\t\t\t\tdayIndex\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\t// append days from the next month\n\t\t\tfor (\n\t\t\t\tvar dayNum = daysInMonth + 1;\n\t\t\t\tdayNum <= 42 - firstOfMonth &&\n\t\t\t\t(self.config.showMonths === 1 || dayIndex % 7 !== 0);\n\t\t\t\tdayNum++, dayIndex++\n\t\t\t) {\n\t\t\t\tdays.appendChild(\n\t\t\t\t\tcreateDay(\n\t\t\t\t\t\t\"flatpickr-day \" + nextMonthDayClass,\n\t\t\t\t\t\tnew Date(year, month + 1, dayNum % daysInMonth),\n\t\t\t\t\t\tdayNum,\n\t\t\t\t\t\tdayIndex\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t}\n\t\t\t//updateNavigationCurrentMonth();\n\t\t\tvar dayContainer = createElement(\"div\", \"dayContainer\");\n\t\t\tdayContainer.appendChild(days);\n\t\t\treturn dayContainer;\n\t\t}\n\t\tfunction buildDays() {\n\t\t\tif (self.daysContainer === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tclearNode(self.daysContainer);\n\t\t\t// TODO: week numbers for each month\n\t\t\tif (self.weekNumbers) clearNode(self.weekNumbers);\n\t\t\tvar frag = document.createDocumentFragment();\n\t\t\tfor (var i = 0; i < self.config.showMonths; i++) {\n\t\t\t\tvar d = new Date(self.currentYear, self.currentMonth, 1);\n\t\t\t\td.setMonth(self.currentMonth + i);\n\t\t\t\tfrag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));\n\t\t\t}\n\t\t\tself.daysContainer.appendChild(frag);\n\t\t\tself.days = self.daysContainer.firstChild;\n\t\t\tif (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n\t\t\t\tonMouseOver();\n\t\t\t}\n\t\t}\n\t\tfunction buildMonthSwitch() {\n\t\t\tif (\n\t\t\t\tself.config.showMonths > 1 ||\n\t\t\t\tself.config.monthSelectorType !== \"dropdown\"\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tvar shouldBuildMonth = function (month) {\n\t\t\t\tif (\n\t\t\t\t\tself.config.minDate !== undefined &&\n\t\t\t\t\tself.currentYear === self.config.minDate.getFullYear() &&\n\t\t\t\t\tmonth < self.config.minDate.getMonth()\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !(\n\t\t\t\t\tself.config.maxDate !== undefined &&\n\t\t\t\t\tself.currentYear === self.config.maxDate.getFullYear() &&\n\t\t\t\t\tmonth > self.config.maxDate.getMonth()\n\t\t\t\t);\n\t\t\t};\n\t\t\tself.monthsDropdownContainer.tabIndex = -1;\n\t\t\tself.monthsDropdownContainer.innerHTML = \"\";\n\t\t\tfor (var i = 0; i < 12; i++) {\n\t\t\t\tif (!shouldBuildMonth(i)) continue;\n\t\t\t\tvar month = createElement(\"option\", \"flatpickr-monthDropdown-month\");\n\t\t\t\tmonth.value = new Date(self.currentYear, i).getMonth().toString();\n\t\t\t\tmonth.textContent = monthToStr(\n\t\t\t\t\ti,\n\t\t\t\t\tself.config.shorthandCurrentMonth,\n\t\t\t\t\tself.l10n\n\t\t\t\t);\n\t\t\t\tmonth.tabIndex = -1;\n\t\t\t\tif (self.currentMonth === i) {\n\t\t\t\t\tmonth.selected = true;\n\t\t\t\t}\n\t\t\t\tself.monthsDropdownContainer.appendChild(month);\n\t\t\t}\n\t\t}\n\t\tfunction buildMonth() {\n\t\t\tvar container = createElement(\"div\", \"flatpickr-month\");\n\t\t\tvar monthNavFragment = window.document.createDocumentFragment();\n\t\t\tvar monthElement;\n\t\t\tif (\n\t\t\t\tself.config.showMonths > 1 ||\n\t\t\t\tself.config.monthSelectorType === \"static\"\n\t\t\t) {\n\t\t\t\tmonthElement = createElement(\"span\", \"cur-month\");\n\t\t\t} else {\n\t\t\t\tself.monthsDropdownContainer = createElement(\n\t\t\t\t\t\"select\",\n\t\t\t\t\t\"flatpickr-monthDropdown-months\"\n\t\t\t\t);\n\t\t\t\tself.monthsDropdownContainer.setAttribute(\n\t\t\t\t\t\"aria-label\",\n\t\t\t\t\tself.l10n.monthAriaLabel\n\t\t\t\t);\n\t\t\t\tbind(self.monthsDropdownContainer, \"change\", function (e) {\n\t\t\t\t\tvar target = getEventTarget(e);\n\t\t\t\t\tvar selectedMonth = parseInt(target.value, 10);\n\t\t\t\t\tself.changeMonth(selectedMonth - self.currentMonth);\n\t\t\t\t\ttriggerEvent(\"onMonthChange\");\n\t\t\t\t});\n\t\t\t\tbuildMonthSwitch();\n\t\t\t\tmonthElement = self.monthsDropdownContainer;\n\t\t\t}\n\t\t\tvar yearInput = createNumberInput(\"cur-year\", { tabindex: \"-1\" });\n\t\t\tvar yearElement = yearInput.getElementsByTagName(\"input\")[0];\n\t\t\tyearElement.setAttribute(\"aria-label\", self.l10n.yearAriaLabel);\n\t\t\tif (self.config.minDate) {\n\t\t\t\tyearElement.setAttribute(\n\t\t\t\t\t\"min\",\n\t\t\t\t\tself.config.minDate.getFullYear().toString()\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (self.config.maxDate) {\n\t\t\t\tyearElement.setAttribute(\n\t\t\t\t\t\"max\",\n\t\t\t\t\tself.config.maxDate.getFullYear().toString()\n\t\t\t\t);\n\t\t\t\tyearElement.disabled =\n\t\t\t\t\t!!self.config.minDate &&\n\t\t\t\t\tself.config.minDate.getFullYear() ===\n\t\t\t\t\t\tself.config.maxDate.getFullYear();\n\t\t\t}\n\t\t\tvar currentMonth = createElement(\"div\", \"flatpickr-current-month\");\n\t\t\tcurrentMonth.appendChild(monthElement);\n\t\t\tcurrentMonth.appendChild(yearInput);\n\t\t\tmonthNavFragment.appendChild(currentMonth);\n\t\t\tcontainer.appendChild(monthNavFragment);\n\t\t\treturn {\n\t\t\t\tcontainer: container,\n\t\t\t\tyearElement: yearElement,\n\t\t\t\tmonthElement: monthElement,\n\t\t\t};\n\t\t}\n\t\tfunction buildMonths() {\n\t\t\tclearNode(self.monthNav);\n\t\t\tself.monthNav.appendChild(self.prevMonthNav);\n\t\t\tif (self.config.showMonths) {\n\t\t\t\tself.yearElements = [];\n\t\t\t\tself.monthElements = [];\n\t\t\t}\n\t\t\tfor (var m = self.config.showMonths; m--; ) {\n\t\t\t\tvar month = buildMonth();\n\t\t\t\tself.yearElements.push(month.yearElement);\n\t\t\t\tself.monthElements.push(month.monthElement);\n\t\t\t\tself.monthNav.appendChild(month.container);\n\t\t\t}\n\t\t\tself.monthNav.appendChild(self.nextMonthNav);\n\t\t}\n\t\tfunction buildMonthNav() {\n\t\t\tself.monthNav = createElement(\"div\", \"flatpickr-months\");\n\t\t\tself.yearElements = [];\n\t\t\tself.monthElements = [];\n\t\t\tself.prevMonthNav = createElement(\"span\", \"flatpickr-prev-month\");\n\t\t\tself.prevMonthNav.innerHTML = self.config.prevArrow;\n\t\t\tself.nextMonthNav = createElement(\"span\", \"flatpickr-next-month\");\n\t\t\tself.nextMonthNav.innerHTML = self.config.nextArrow;\n\t\t\tbuildMonths();\n\t\t\tObject.defineProperty(self, \"_hidePrevMonthArrow\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.__hidePrevMonthArrow;\n\t\t\t\t},\n\t\t\t\tset: function (bool) {\n\t\t\t\t\tif (self.__hidePrevMonthArrow !== bool) {\n\t\t\t\t\t\ttoggleClass(self.prevMonthNav, \"flatpickr-disabled\", bool);\n\t\t\t\t\t\tself.__hidePrevMonthArrow = bool;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tObject.defineProperty(self, \"_hideNextMonthArrow\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.__hideNextMonthArrow;\n\t\t\t\t},\n\t\t\t\tset: function (bool) {\n\t\t\t\t\tif (self.__hideNextMonthArrow !== bool) {\n\t\t\t\t\t\ttoggleClass(self.nextMonthNav, \"flatpickr-disabled\", bool);\n\t\t\t\t\t\tself.__hideNextMonthArrow = bool;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t\tself.currentYearElement = self.yearElements[0];\n\t\t\tupdateNavigationCurrentMonth();\n\t\t\treturn self.monthNav;\n\t\t}\n\t\tfunction buildTime() {\n\t\t\tself.calendarContainer.classList.add(\"hasTime\");\n\t\t\tif (self.config.noCalendar)\n\t\t\t\tself.calendarContainer.classList.add(\"noCalendar\");\n\t\t\tvar defaults = getDefaultHours(self.config);\n\t\t\tself.timeContainer = createElement(\"div\", \"flatpickr-time\");\n\t\t\tself.timeContainer.tabIndex = -1;\n\t\t\tvar separator = createElement(\"span\", \"flatpickr-time-separator\", \":\");\n\t\t\tvar hourInput = createNumberInput(\"flatpickr-hour\", {\n\t\t\t\t\"aria-label\": self.l10n.hourAriaLabel,\n\t\t\t});\n\t\t\tself.hourElement = hourInput.getElementsByTagName(\"input\")[0];\n\t\t\tvar minuteInput = createNumberInput(\"flatpickr-minute\", {\n\t\t\t\t\"aria-label\": self.l10n.minuteAriaLabel,\n\t\t\t});\n\t\t\tself.minuteElement = minuteInput.getElementsByTagName(\"input\")[0];\n\t\t\tself.hourElement.tabIndex = self.minuteElement.tabIndex = -1;\n\t\t\tself.hourElement.value = pad(\n\t\t\t\tself.latestSelectedDateObj\n\t\t\t\t\t? self.latestSelectedDateObj.getHours()\n\t\t\t\t\t: self.config.time_24hr\n\t\t\t\t\t? defaults.hours\n\t\t\t\t\t: military2ampm(defaults.hours)\n\t\t\t);\n\t\t\tself.minuteElement.value = pad(\n\t\t\t\tself.latestSelectedDateObj\n\t\t\t\t\t? self.latestSelectedDateObj.getMinutes()\n\t\t\t\t\t: defaults.minutes\n\t\t\t);\n\t\t\tself.hourElement.setAttribute(\n\t\t\t\t\"step\",\n\t\t\t\tself.config.hourIncrement.toString()\n\t\t\t);\n\t\t\tself.minuteElement.setAttribute(\n\t\t\t\t\"step\",\n\t\t\t\tself.config.minuteIncrement.toString()\n\t\t\t);\n\t\t\tself.hourElement.setAttribute(\"min\", self.config.time_24hr ? \"0\" : \"1\");\n\t\t\tself.hourElement.setAttribute(\"max\", self.config.time_24hr ? \"23\" : \"12\");\n\t\t\tself.hourElement.setAttribute(\"maxlength\", \"2\");\n\t\t\tself.minuteElement.setAttribute(\"min\", \"0\");\n\t\t\tself.minuteElement.setAttribute(\"max\", \"59\");\n\t\t\tself.minuteElement.setAttribute(\"maxlength\", \"2\");\n\t\t\tself.timeContainer.appendChild(hourInput);\n\t\t\tself.timeContainer.appendChild(separator);\n\t\t\tself.timeContainer.appendChild(minuteInput);\n\t\t\tif (self.config.time_24hr) self.timeContainer.classList.add(\"time24hr\");\n\t\t\tif (self.config.enableSeconds) {\n\t\t\t\tself.timeContainer.classList.add(\"hasSeconds\");\n\t\t\t\tvar secondInput = createNumberInput(\"flatpickr-second\");\n\t\t\t\tself.secondElement = secondInput.getElementsByTagName(\"input\")[0];\n\t\t\t\tself.secondElement.value = pad(\n\t\t\t\t\tself.latestSelectedDateObj\n\t\t\t\t\t\t? self.latestSelectedDateObj.getSeconds()\n\t\t\t\t\t\t: defaults.seconds\n\t\t\t\t);\n\t\t\t\tself.secondElement.setAttribute(\n\t\t\t\t\t\"step\",\n\t\t\t\t\tself.minuteElement.getAttribute(\"step\")\n\t\t\t\t);\n\t\t\t\tself.secondElement.setAttribute(\"min\", \"0\");\n\t\t\t\tself.secondElement.setAttribute(\"max\", \"59\");\n\t\t\t\tself.secondElement.setAttribute(\"maxlength\", \"2\");\n\t\t\t\tself.timeContainer.appendChild(\n\t\t\t\t\tcreateElement(\"span\", \"flatpickr-time-separator\", \":\")\n\t\t\t\t);\n\t\t\t\tself.timeContainer.appendChild(secondInput);\n\t\t\t}\n\t\t\tif (!self.config.time_24hr) {\n\t\t\t\t// add self.amPM if appropriate\n\t\t\t\tself.amPM = createElement(\n\t\t\t\t\t\"span\",\n\t\t\t\t\t\"flatpickr-am-pm\",\n\t\t\t\t\tself.l10n.amPM[\n\t\t\t\t\t\tint(\n\t\t\t\t\t\t\t(self.latestSelectedDateObj\n\t\t\t\t\t\t\t\t? self.hourElement.value\n\t\t\t\t\t\t\t\t: self.config.defaultHour) > 11\n\t\t\t\t\t\t)\n\t\t\t\t\t]\n\t\t\t\t);\n\t\t\t\tself.amPM.title = self.l10n.toggleTitle;\n\t\t\t\tself.amPM.tabIndex = -1;\n\t\t\t\tself.timeContainer.appendChild(self.amPM);\n\t\t\t}\n\t\t\treturn self.timeContainer;\n\t\t}\n\t\tfunction buildWeekdays() {\n\t\t\tif (!self.weekdayContainer)\n\t\t\t\tself.weekdayContainer = createElement(\"div\", \"flatpickr-weekdays\");\n\t\t\telse clearNode(self.weekdayContainer);\n\t\t\tfor (var i = self.config.showMonths; i--; ) {\n\t\t\t\tvar container = createElement(\"div\", \"flatpickr-weekdaycontainer\");\n\t\t\t\tself.weekdayContainer.appendChild(container);\n\t\t\t}\n\t\t\tupdateWeekdays();\n\t\t\treturn self.weekdayContainer;\n\t\t}\n\t\tfunction updateWeekdays() {\n\t\t\tif (!self.weekdayContainer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar firstDayOfWeek = self.l10n.firstDayOfWeek;\n\t\t\tvar weekdays = __spreadArrays(self.l10n.weekdays.shorthand);\n\t\t\tif (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {\n\t\t\t\tweekdays = __spreadArrays(\n\t\t\t\t\tweekdays.splice(firstDayOfWeek, weekdays.length),\n\t\t\t\t\tweekdays.splice(0, firstDayOfWeek)\n\t\t\t\t);\n\t\t\t}\n\t\t\tfor (var i = self.config.showMonths; i--; ) {\n\t\t\t\tself.weekdayContainer.children[i].innerHTML =\n\t\t\t\t\t\"\\n      <span class='flatpickr-weekday'>\\n        \" +\n\t\t\t\t\tweekdays.join(\"</span><span class='flatpickr-weekday'>\") +\n\t\t\t\t\t\"\\n      </span>\\n      \";\n\t\t\t}\n\t\t}\n\t\t/* istanbul ignore next */\n\t\tfunction buildWeeks() {\n\t\t\tself.calendarContainer.classList.add(\"hasWeeks\");\n\t\t\tvar weekWrapper = createElement(\"div\", \"flatpickr-weekwrapper\");\n\t\t\tweekWrapper.appendChild(\n\t\t\t\tcreateElement(\"span\", \"flatpickr-weekday\", self.l10n.weekAbbreviation)\n\t\t\t);\n\t\t\tvar weekNumbers = createElement(\"div\", \"flatpickr-weeks\");\n\t\t\tweekWrapper.appendChild(weekNumbers);\n\t\t\treturn {\n\t\t\t\tweekWrapper: weekWrapper,\n\t\t\t\tweekNumbers: weekNumbers,\n\t\t\t};\n\t\t}\n\t\tfunction changeMonth(value, isOffset) {\n\t\t\tif (isOffset === void 0) {\n\t\t\t\tisOffset = true;\n\t\t\t}\n\t\t\tvar delta = isOffset ? value : value - self.currentMonth;\n\t\t\tif (\n\t\t\t\t(delta < 0 && self._hidePrevMonthArrow === true) ||\n\t\t\t\t(delta > 0 && self._hideNextMonthArrow === true)\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tself.currentMonth += delta;\n\t\t\tif (self.currentMonth < 0 || self.currentMonth > 11) {\n\t\t\t\tself.currentYear += self.currentMonth > 11 ? 1 : -1;\n\t\t\t\tself.currentMonth = (self.currentMonth + 12) % 12;\n\t\t\t\ttriggerEvent(\"onYearChange\");\n\t\t\t\tbuildMonthSwitch();\n\t\t\t}\n\t\t\tbuildDays();\n\t\t\ttriggerEvent(\"onMonthChange\");\n\t\t\tupdateNavigationCurrentMonth();\n\t\t}\n\t\tfunction clear(triggerChangeEvent, toInitial) {\n\t\t\tif (triggerChangeEvent === void 0) {\n\t\t\t\ttriggerChangeEvent = true;\n\t\t\t}\n\t\t\tif (toInitial === void 0) {\n\t\t\t\ttoInitial = true;\n\t\t\t}\n\t\t\tself.input.value = \"\";\n\t\t\tif (self.altInput !== undefined) self.altInput.value = \"\";\n\t\t\tif (self.mobileInput !== undefined) self.mobileInput.value = \"\";\n\t\t\tself.selectedDates = [];\n\t\t\tself.latestSelectedDateObj = undefined;\n\t\t\tif (toInitial === true) {\n\t\t\t\tself.currentYear = self._initialDate.getFullYear();\n\t\t\t\tself.currentMonth = self._initialDate.getMonth();\n\t\t\t}\n\t\t\tif (self.config.enableTime === true) {\n\t\t\t\tvar _a = getDefaultHours(self.config),\n\t\t\t\t\thours = _a.hours,\n\t\t\t\t\tminutes = _a.minutes,\n\t\t\t\t\tseconds = _a.seconds;\n\t\t\t\tsetHours(hours, minutes, seconds);\n\t\t\t}\n\t\t\tself.redraw();\n\t\t\tif (triggerChangeEvent)\n\t\t\t\t// triggerChangeEvent is true (default) or an Event\n\t\t\t\ttriggerEvent(\"onChange\");\n\t\t}\n\t\tfunction close() {\n\t\t\tself.isOpen = false;\n\t\t\tif (!self.isMobile) {\n\t\t\t\tif (self.calendarContainer !== undefined) {\n\t\t\t\t\tself.calendarContainer.classList.remove(\"open\");\n\t\t\t\t}\n\t\t\t\tif (self._input !== undefined) {\n\t\t\t\t\tself._input.classList.remove(\"active\");\n\t\t\t\t}\n\t\t\t}\n\t\t\ttriggerEvent(\"onClose\");\n\t\t}\n\t\tfunction destroy() {\n\t\t\tif (self.config !== undefined) triggerEvent(\"onDestroy\");\n\t\t\tfor (var i = self._handlers.length; i--; ) {\n\t\t\t\tself._handlers[i].remove();\n\t\t\t}\n\t\t\tself._handlers = [];\n\t\t\tif (self.mobileInput) {\n\t\t\t\tif (self.mobileInput.parentNode)\n\t\t\t\t\tself.mobileInput.parentNode.removeChild(self.mobileInput);\n\t\t\t\tself.mobileInput = undefined;\n\t\t\t} else if (self.calendarContainer && self.calendarContainer.parentNode) {\n\t\t\t\tif (self.config.static && self.calendarContainer.parentNode) {\n\t\t\t\t\tvar wrapper = self.calendarContainer.parentNode;\n\t\t\t\t\twrapper.lastChild && wrapper.removeChild(wrapper.lastChild);\n\t\t\t\t\tif (wrapper.parentNode) {\n\t\t\t\t\t\twhile (wrapper.firstChild)\n\t\t\t\t\t\t\twrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);\n\t\t\t\t\t\twrapper.parentNode.removeChild(wrapper);\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t\tself.calendarContainer.parentNode.removeChild(self.calendarContainer);\n\t\t\t}\n\t\t\tif (self.altInput) {\n\t\t\t\tself.input.type = \"text\";\n\t\t\t\tif (self.altInput.parentNode)\n\t\t\t\t\tself.altInput.parentNode.removeChild(self.altInput);\n\t\t\t\tdelete self.altInput;\n\t\t\t}\n\t\t\tif (self.input) {\n\t\t\t\tself.input.type = self.input._type;\n\t\t\t\tself.input.classList.remove(\"flatpickr-input\");\n\t\t\t\tself.input.removeAttribute(\"readonly\");\n\t\t\t}\n\t\t\t[\n\t\t\t\t\"_showTimeInput\",\n\t\t\t\t\"latestSelectedDateObj\",\n\t\t\t\t\"_hideNextMonthArrow\",\n\t\t\t\t\"_hidePrevMonthArrow\",\n\t\t\t\t\"__hideNextMonthArrow\",\n\t\t\t\t\"__hidePrevMonthArrow\",\n\t\t\t\t\"isMobile\",\n\t\t\t\t\"isOpen\",\n\t\t\t\t\"selectedDateElem\",\n\t\t\t\t\"minDateHasTime\",\n\t\t\t\t\"maxDateHasTime\",\n\t\t\t\t\"days\",\n\t\t\t\t\"daysContainer\",\n\t\t\t\t\"_input\",\n\t\t\t\t\"_positionElement\",\n\t\t\t\t\"innerContainer\",\n\t\t\t\t\"rContainer\",\n\t\t\t\t\"monthNav\",\n\t\t\t\t\"todayDateElem\",\n\t\t\t\t\"calendarContainer\",\n\t\t\t\t\"weekdayContainer\",\n\t\t\t\t\"prevMonthNav\",\n\t\t\t\t\"nextMonthNav\",\n\t\t\t\t\"monthsDropdownContainer\",\n\t\t\t\t\"currentMonthElement\",\n\t\t\t\t\"currentYearElement\",\n\t\t\t\t\"navigationCurrentMonth\",\n\t\t\t\t\"selectedDateElem\",\n\t\t\t\t\"config\",\n\t\t\t].forEach(function (k) {\n\t\t\t\ttry {\n\t\t\t\t\tdelete self[k];\n\t\t\t\t} catch (_) {}\n\t\t\t});\n\t\t}\n\t\tfunction isCalendarElem(elem) {\n\t\t\treturn self.calendarContainer.contains(elem);\n\t\t}\n\t\tfunction documentClick(e) {\n\t\t\tif (self.isOpen && !self.config.inline) {\n\t\t\t\tvar eventTarget_1 = getEventTarget(e);\n\t\t\t\tvar isCalendarElement = isCalendarElem(eventTarget_1);\n\t\t\t\tvar isInput =\n\t\t\t\t\teventTarget_1 === self.input ||\n\t\t\t\t\teventTarget_1 === self.altInput ||\n\t\t\t\t\tself.element.contains(eventTarget_1) ||\n\t\t\t\t\t// web components\n\t\t\t\t\t// e.path is not present in all browsers. circumventing typechecks\n\t\t\t\t\t(e.path &&\n\t\t\t\t\t\te.path.indexOf &&\n\t\t\t\t\t\t(~e.path.indexOf(self.input) || ~e.path.indexOf(self.altInput)));\n\t\t\t\tvar lostFocus =\n\t\t\t\t\t!isInput && !isCalendarElement && !isCalendarElem(e.relatedTarget);\n\t\t\t\tvar isIgnored = !self.config.ignoredFocusElements.some(function (elem) {\n\t\t\t\t\treturn elem.contains(eventTarget_1);\n\t\t\t\t});\n\t\t\t\tif (lostFocus && isIgnored) {\n\t\t\t\t\tif (self.config.allowInput) {\n\t\t\t\t\t\tself.setDate(\n\t\t\t\t\t\t\tself._input.value,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tself.config.altInput\n\t\t\t\t\t\t\t\t? self.config.altFormat\n\t\t\t\t\t\t\t\t: self.config.dateFormat\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\tself.timeContainer !== undefined &&\n\t\t\t\t\t\tself.minuteElement !== undefined &&\n\t\t\t\t\t\tself.hourElement !== undefined &&\n\t\t\t\t\t\tself.input.value !== \"\" &&\n\t\t\t\t\t\tself.input.value !== undefined\n\t\t\t\t\t) {\n\t\t\t\t\t\tupdateTime();\n\t\t\t\t\t}\n\t\t\t\t\tself.close();\n\t\t\t\t\tif (\n\t\t\t\t\t\tself.config &&\n\t\t\t\t\t\tself.config.mode === \"range\" &&\n\t\t\t\t\t\tself.selectedDates.length === 1\n\t\t\t\t\t)\n\t\t\t\t\t\tself.clear(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction changeYear(newYear) {\n\t\t\tif (\n\t\t\t\t!newYear ||\n\t\t\t\t(self.config.minDate && newYear < self.config.minDate.getFullYear()) ||\n\t\t\t\t(self.config.maxDate && newYear > self.config.maxDate.getFullYear())\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tvar newYearNum = newYear,\n\t\t\t\tisNewYear = self.currentYear !== newYearNum;\n\t\t\tself.currentYear = newYearNum || self.currentYear;\n\t\t\tif (\n\t\t\t\tself.config.maxDate &&\n\t\t\t\tself.currentYear === self.config.maxDate.getFullYear()\n\t\t\t) {\n\t\t\t\tself.currentMonth = Math.min(\n\t\t\t\t\tself.config.maxDate.getMonth(),\n\t\t\t\t\tself.currentMonth\n\t\t\t\t);\n\t\t\t} else if (\n\t\t\t\tself.config.minDate &&\n\t\t\t\tself.currentYear === self.config.minDate.getFullYear()\n\t\t\t) {\n\t\t\t\tself.currentMonth = Math.max(\n\t\t\t\t\tself.config.minDate.getMonth(),\n\t\t\t\t\tself.currentMonth\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (isNewYear) {\n\t\t\t\tself.redraw();\n\t\t\t\ttriggerEvent(\"onYearChange\");\n\t\t\t\tbuildMonthSwitch();\n\t\t\t}\n\t\t}\n\t\tfunction isEnabled(date, timeless) {\n\t\t\tvar _a;\n\t\t\tif (timeless === void 0) {\n\t\t\t\ttimeless = true;\n\t\t\t}\n\t\t\tvar dateToCheck = self.parseDate(date, undefined, timeless); // timeless\n\t\t\tif (\n\t\t\t\t(self.config.minDate &&\n\t\t\t\t\tdateToCheck &&\n\t\t\t\t\tcompareDates(\n\t\t\t\t\t\tdateToCheck,\n\t\t\t\t\t\tself.config.minDate,\n\t\t\t\t\t\ttimeless !== undefined ? timeless : !self.minDateHasTime\n\t\t\t\t\t) < 0) ||\n\t\t\t\t(self.config.maxDate &&\n\t\t\t\t\tdateToCheck &&\n\t\t\t\t\tcompareDates(\n\t\t\t\t\t\tdateToCheck,\n\t\t\t\t\t\tself.config.maxDate,\n\t\t\t\t\t\ttimeless !== undefined ? timeless : !self.maxDateHasTime\n\t\t\t\t\t) > 0)\n\t\t\t)\n\t\t\t\treturn false;\n\t\t\tif (!self.config.enable && self.config.disable.length === 0) return true;\n\t\t\tif (dateToCheck === undefined) return false;\n\t\t\tvar bool = !!self.config.enable,\n\t\t\t\tarray =\n\t\t\t\t\t(_a = self.config.enable) !== null && _a !== void 0\n\t\t\t\t\t\t? _a\n\t\t\t\t\t\t: self.config.disable;\n\t\t\tfor (var i = 0, d = void 0; i < array.length; i++) {\n\t\t\t\td = array[i];\n\t\t\t\tif (\n\t\t\t\t\ttypeof d === \"function\" &&\n\t\t\t\t\td(dateToCheck) // disabled by function\n\t\t\t\t)\n\t\t\t\t\treturn bool;\n\t\t\t\telse if (\n\t\t\t\t\td instanceof Date &&\n\t\t\t\t\tdateToCheck !== undefined &&\n\t\t\t\t\td.getTime() === dateToCheck.getTime()\n\t\t\t\t)\n\t\t\t\t\t// disabled by date\n\t\t\t\t\treturn bool;\n\t\t\t\telse if (typeof d === \"string\") {\n\t\t\t\t\t// disabled by date string\n\t\t\t\t\tvar parsed = self.parseDate(d, undefined, true);\n\t\t\t\t\treturn parsed && parsed.getTime() === dateToCheck.getTime()\n\t\t\t\t\t\t? bool\n\t\t\t\t\t\t: !bool;\n\t\t\t\t} else if (\n\t\t\t\t\t// disabled by range\n\t\t\t\t\ttypeof d === \"object\" &&\n\t\t\t\t\tdateToCheck !== undefined &&\n\t\t\t\t\td.from &&\n\t\t\t\t\td.to &&\n\t\t\t\t\tdateToCheck.getTime() >= d.from.getTime() &&\n\t\t\t\t\tdateToCheck.getTime() <= d.to.getTime()\n\t\t\t\t)\n\t\t\t\t\treturn bool;\n\t\t\t}\n\t\t\treturn !bool;\n\t\t}\n\t\tfunction isInView(elem) {\n\t\t\tif (self.daysContainer !== undefined)\n\t\t\t\treturn (\n\t\t\t\t\telem.className.indexOf(\"hidden\") === -1 &&\n\t\t\t\t\telem.className.indexOf(\"flatpickr-disabled\") === -1 &&\n\t\t\t\t\tself.daysContainer.contains(elem)\n\t\t\t\t);\n\t\t\treturn false;\n\t\t}\n\t\tfunction onBlur(e) {\n\t\t\tvar isInput = e.target === self._input;\n\t\t\tvar valueChanged = self._input.value.trimEnd() !== getDateStr();\n\t\t\tif (\n\t\t\t\tisInput &&\n\t\t\t\tvalueChanged &&\n\t\t\t\t!(e.relatedTarget && isCalendarElem(e.relatedTarget))\n\t\t\t) {\n\t\t\t\tself.setDate(\n\t\t\t\t\tself._input.value,\n\t\t\t\t\ttrue,\n\t\t\t\t\te.target === self.altInput\n\t\t\t\t\t\t? self.config.altFormat\n\t\t\t\t\t\t: self.config.dateFormat\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tfunction onKeyDown(e) {\n\t\t\t// e.key                      e.keyCode\n\t\t\t// \"Backspace\"                        8\n\t\t\t// \"Tab\"                              9\n\t\t\t// \"Enter\"                           13\n\t\t\t// \"Escape\"     (IE \"Esc\")           27\n\t\t\t// \"ArrowLeft\"  (IE \"Left\")          37\n\t\t\t// \"ArrowUp\"    (IE \"Up\")            38\n\t\t\t// \"ArrowRight\" (IE \"Right\")         39\n\t\t\t// \"ArrowDown\"  (IE \"Down\")          40\n\t\t\t// \"Delete\"     (IE \"Del\")           46\n\t\t\tvar eventTarget = getEventTarget(e);\n\t\t\tvar isInput = self.config.wrap\n\t\t\t\t? element.contains(eventTarget)\n\t\t\t\t: eventTarget === self._input;\n\t\t\tvar allowInput = self.config.allowInput;\n\t\t\tvar allowKeydown = self.isOpen && (!allowInput || !isInput);\n\t\t\tvar allowInlineKeydown = self.config.inline && isInput && !allowInput;\n\t\t\tif (e.keyCode === 13 && isInput) {\n\t\t\t\tif (allowInput) {\n\t\t\t\t\tself.setDate(\n\t\t\t\t\t\tself._input.value,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\teventTarget === self.altInput\n\t\t\t\t\t\t\t? self.config.altFormat\n\t\t\t\t\t\t\t: self.config.dateFormat\n\t\t\t\t\t);\n\t\t\t\t\tself.close();\n\t\t\t\t\treturn eventTarget.blur();\n\t\t\t\t} else {\n\t\t\t\t\tself.open();\n\t\t\t\t}\n\t\t\t} else if (\n\t\t\t\tisCalendarElem(eventTarget) ||\n\t\t\t\tallowKeydown ||\n\t\t\t\tallowInlineKeydown\n\t\t\t) {\n\t\t\t\tvar isTimeObj =\n\t\t\t\t\t!!self.timeContainer && self.timeContainer.contains(eventTarget);\n\t\t\t\tswitch (e.keyCode) {\n\t\t\t\t\tcase 13:\n\t\t\t\t\t\tif (isTimeObj) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tupdateTime();\n\t\t\t\t\t\t\tfocusAndClose();\n\t\t\t\t\t\t} else selectDate(e);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 27: // escape\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tfocusAndClose();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\tcase 46:\n\t\t\t\t\t\tif (isInput && !self.config.allowInput) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tself.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 37:\n\t\t\t\t\tcase 39:\n\t\t\t\t\t\tif (!isTimeObj && !isInput) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tvar activeElement = getClosestActiveElement();\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tself.daysContainer !== undefined &&\n\t\t\t\t\t\t\t\t(allowInput === false ||\n\t\t\t\t\t\t\t\t\t(activeElement && isInView(activeElement)))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tvar delta_1 = e.keyCode === 39 ? 1 : -1;\n\t\t\t\t\t\t\t\tif (!e.ctrlKey) focusOnDay(undefined, delta_1);\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\tchangeMonth(delta_1);\n\t\t\t\t\t\t\t\t\tfocusOnDay(getFirstAvailableDay(1), 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (self.hourElement) self.hourElement.focus();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 38:\n\t\t\t\t\tcase 40:\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tvar delta = e.keyCode === 40 ? 1 : -1;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(self.daysContainer && eventTarget.$i !== undefined) ||\n\t\t\t\t\t\t\teventTarget === self.input ||\n\t\t\t\t\t\t\teventTarget === self.altInput\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tif (e.ctrlKey) {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tchangeYear(self.currentYear - delta);\n\t\t\t\t\t\t\t\tfocusOnDay(getFirstAvailableDay(1), 0);\n\t\t\t\t\t\t\t} else if (!isTimeObj) focusOnDay(undefined, delta * 7);\n\t\t\t\t\t\t} else if (eventTarget === self.currentYearElement) {\n\t\t\t\t\t\t\tchangeYear(self.currentYear - delta);\n\t\t\t\t\t\t} else if (self.config.enableTime) {\n\t\t\t\t\t\t\tif (!isTimeObj && self.hourElement) self.hourElement.focus();\n\t\t\t\t\t\t\tupdateTime(e);\n\t\t\t\t\t\t\tself._debouncedChange();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 9:\n\t\t\t\t\t\tif (isTimeObj) {\n\t\t\t\t\t\t\tvar elems = [\n\t\t\t\t\t\t\t\tself.hourElement,\n\t\t\t\t\t\t\t\tself.minuteElement,\n\t\t\t\t\t\t\t\tself.secondElement,\n\t\t\t\t\t\t\t\tself.amPM,\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t.concat(self.pluginElements)\n\t\t\t\t\t\t\t\t.filter(function (x) {\n\t\t\t\t\t\t\t\t\treturn x;\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tvar i = elems.indexOf(eventTarget);\n\t\t\t\t\t\t\tif (i !== -1) {\n\t\t\t\t\t\t\t\tvar target = elems[i + (e.shiftKey ? -1 : 1)];\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t(target || self._input).focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t!self.config.noCalendar &&\n\t\t\t\t\t\t\tself.daysContainer &&\n\t\t\t\t\t\t\tself.daysContainer.contains(eventTarget) &&\n\t\t\t\t\t\t\te.shiftKey\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tself._input.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (self.amPM !== undefined && eventTarget === self.amPM) {\n\t\t\t\tswitch (e.key) {\n\t\t\t\t\tcase self.l10n.amPM[0].charAt(0):\n\t\t\t\t\tcase self.l10n.amPM[0].charAt(0).toLowerCase():\n\t\t\t\t\t\tself.amPM.textContent = self.l10n.amPM[0];\n\t\t\t\t\t\tsetHoursFromInputs();\n\t\t\t\t\t\tupdateValue();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase self.l10n.amPM[1].charAt(0):\n\t\t\t\t\tcase self.l10n.amPM[1].charAt(0).toLowerCase():\n\t\t\t\t\t\tself.amPM.textContent = self.l10n.amPM[1];\n\t\t\t\t\t\tsetHoursFromInputs();\n\t\t\t\t\t\tupdateValue();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isInput || isCalendarElem(eventTarget)) {\n\t\t\t\ttriggerEvent(\"onKeyDown\", e);\n\t\t\t}\n\t\t}\n\t\tfunction onMouseOver(elem, cellClass) {\n\t\t\tif (cellClass === void 0) {\n\t\t\t\tcellClass = \"flatpickr-day\";\n\t\t\t}\n\t\t\tif (\n\t\t\t\tself.selectedDates.length !== 1 ||\n\t\t\t\t(elem &&\n\t\t\t\t\t(!elem.classList.contains(cellClass) ||\n\t\t\t\t\t\telem.classList.contains(\"flatpickr-disabled\")))\n\t\t\t)\n\t\t\t\treturn;\n\t\t\tvar hoverDate = elem\n\t\t\t\t\t? elem.dateObj.getTime()\n\t\t\t\t\t: self.days.firstElementChild.dateObj.getTime(),\n\t\t\t\tinitialDate = self\n\t\t\t\t\t.parseDate(self.selectedDates[0], undefined, true)\n\t\t\t\t\t.getTime(),\n\t\t\t\trangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()),\n\t\t\t\trangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());\n\t\t\tvar containsDisabled = false;\n\t\t\tvar minRange = 0,\n\t\t\t\tmaxRange = 0;\n\t\t\tfor (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {\n\t\t\t\tif (!isEnabled(new Date(t), true)) {\n\t\t\t\t\tcontainsDisabled =\n\t\t\t\t\t\tcontainsDisabled || (t > rangeStartDate && t < rangeEndDate);\n\t\t\t\t\tif (t < initialDate && (!minRange || t > minRange)) minRange = t;\n\t\t\t\t\telse if (t > initialDate && (!maxRange || t < maxRange)) maxRange = t;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar hoverableCells = Array.from(\n\t\t\t\tself.rContainer.querySelectorAll(\n\t\t\t\t\t\"*:nth-child(-n+\" + self.config.showMonths + \") > .\" + cellClass\n\t\t\t\t)\n\t\t\t);\n\t\t\thoverableCells.forEach(function (dayElem) {\n\t\t\t\tvar date = dayElem.dateObj;\n\t\t\t\tvar timestamp = date.getTime();\n\t\t\t\tvar outOfRange =\n\t\t\t\t\t(minRange > 0 && timestamp < minRange) ||\n\t\t\t\t\t(maxRange > 0 && timestamp > maxRange);\n\t\t\t\tif (outOfRange) {\n\t\t\t\t\tdayElem.classList.add(\"notAllowed\");\n\t\t\t\t\t[\"inRange\", \"startRange\", \"endRange\"].forEach(function (c) {\n\t\t\t\t\t\tdayElem.classList.remove(c);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t} else if (containsDisabled && !outOfRange) return;\n\t\t\t\t[\"startRange\", \"inRange\", \"endRange\", \"notAllowed\"].forEach(function (\n\t\t\t\t\tc\n\t\t\t\t) {\n\t\t\t\t\tdayElem.classList.remove(c);\n\t\t\t\t});\n\t\t\t\tif (elem !== undefined) {\n\t\t\t\t\telem.classList.add(\n\t\t\t\t\t\thoverDate <= self.selectedDates[0].getTime()\n\t\t\t\t\t\t\t? \"startRange\"\n\t\t\t\t\t\t\t: \"endRange\"\n\t\t\t\t\t);\n\t\t\t\t\tif (initialDate < hoverDate && timestamp === initialDate)\n\t\t\t\t\t\tdayElem.classList.add(\"startRange\");\n\t\t\t\t\telse if (initialDate > hoverDate && timestamp === initialDate)\n\t\t\t\t\t\tdayElem.classList.add(\"endRange\");\n\t\t\t\t\tif (\n\t\t\t\t\t\ttimestamp >= minRange &&\n\t\t\t\t\t\t(maxRange === 0 || timestamp <= maxRange) &&\n\t\t\t\t\t\tisBetween(timestamp, initialDate, hoverDate)\n\t\t\t\t\t)\n\t\t\t\t\t\tdayElem.classList.add(\"inRange\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tfunction onResize() {\n\t\t\tif (self.isOpen && !self.config.static && !self.config.inline)\n\t\t\t\tpositionCalendar();\n\t\t}\n\t\tfunction open(e, positionElement) {\n\t\t\tif (positionElement === void 0) {\n\t\t\t\tpositionElement = self._positionElement;\n\t\t\t}\n\t\t\tif (self.isMobile === true) {\n\t\t\t\tif (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar eventTarget = getEventTarget(e);\n\t\t\t\t\tif (eventTarget) {\n\t\t\t\t\t\teventTarget.blur();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (self.mobileInput !== undefined) {\n\t\t\t\t\tself.mobileInput.focus();\n\t\t\t\t\tself.mobileInput.click();\n\t\t\t\t}\n\t\t\t\ttriggerEvent(\"onOpen\");\n\t\t\t\treturn;\n\t\t\t} else if (self._input.disabled || self.config.inline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar wasOpen = self.isOpen;\n\t\t\tself.isOpen = true;\n\t\t\tif (!wasOpen) {\n\t\t\t\tself.calendarContainer.classList.add(\"open\");\n\t\t\t\tself._input.classList.add(\"active\");\n\t\t\t\ttriggerEvent(\"onOpen\");\n\t\t\t\tpositionCalendar(positionElement);\n\t\t\t}\n\t\t\tif (self.config.enableTime === true && self.config.noCalendar === true) {\n\t\t\t\tif (\n\t\t\t\t\tself.config.allowInput === false &&\n\t\t\t\t\t(e === undefined || !self.timeContainer.contains(e.relatedTarget))\n\t\t\t\t) {\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\treturn self.hourElement.select();\n\t\t\t\t\t}, 50);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfunction minMaxDateSetter(type) {\n\t\t\treturn function (date) {\n\t\t\t\tvar dateObj = (self.config[\"_\" + type + \"Date\"] = self.parseDate(\n\t\t\t\t\tdate,\n\t\t\t\t\tself.config.dateFormat\n\t\t\t\t));\n\t\t\t\tvar inverseDateObj =\n\t\t\t\t\tself.config[\"_\" + (type === \"min\" ? \"max\" : \"min\") + \"Date\"];\n\t\t\t\tif (dateObj !== undefined) {\n\t\t\t\t\tself[type === \"min\" ? \"minDateHasTime\" : \"maxDateHasTime\"] =\n\t\t\t\t\t\tdateObj.getHours() > 0 ||\n\t\t\t\t\t\tdateObj.getMinutes() > 0 ||\n\t\t\t\t\t\tdateObj.getSeconds() > 0;\n\t\t\t\t}\n\t\t\t\tif (self.selectedDates) {\n\t\t\t\t\tself.selectedDates = self.selectedDates.filter(function (d) {\n\t\t\t\t\t\treturn isEnabled(d);\n\t\t\t\t\t});\n\t\t\t\t\tif (!self.selectedDates.length && type === \"min\")\n\t\t\t\t\t\tsetHoursFromDate(dateObj);\n\t\t\t\t\tupdateValue();\n\t\t\t\t}\n\t\t\t\tif (self.daysContainer) {\n\t\t\t\t\tredraw();\n\t\t\t\t\tif (dateObj !== undefined)\n\t\t\t\t\t\tself.currentYearElement[type] = dateObj.getFullYear().toString();\n\t\t\t\t\telse self.currentYearElement.removeAttribute(type);\n\t\t\t\t\tself.currentYearElement.disabled =\n\t\t\t\t\t\t!!inverseDateObj &&\n\t\t\t\t\t\tdateObj !== undefined &&\n\t\t\t\t\t\tinverseDateObj.getFullYear() === dateObj.getFullYear();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tfunction parseConfig() {\n\t\t\tvar boolOpts = [\n\t\t\t\t\"wrap\",\n\t\t\t\t\"weekNumbers\",\n\t\t\t\t\"allowInput\",\n\t\t\t\t\"allowInvalidPreload\",\n\t\t\t\t\"clickOpens\",\n\t\t\t\t\"time_24hr\",\n\t\t\t\t\"enableTime\",\n\t\t\t\t\"noCalendar\",\n\t\t\t\t\"altInput\",\n\t\t\t\t\"shorthandCurrentMonth\",\n\t\t\t\t\"inline\",\n\t\t\t\t\"static\",\n\t\t\t\t\"enableSeconds\",\n\t\t\t\t\"disableMobile\",\n\t\t\t];\n\t\t\tvar userConfig = __assign(\n\t\t\t\t__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))),\n\t\t\t\tinstanceConfig\n\t\t\t);\n\t\t\tvar formats = {};\n\t\t\tself.config.parseDate = userConfig.parseDate;\n\t\t\tself.config.formatDate = userConfig.formatDate;\n\t\t\tObject.defineProperty(self.config, \"enable\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._enable;\n\t\t\t\t},\n\t\t\t\tset: function (dates) {\n\t\t\t\t\tself.config._enable = parseDateRules(dates);\n\t\t\t\t},\n\t\t\t});\n\t\t\tObject.defineProperty(self.config, \"disable\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._disable;\n\t\t\t\t},\n\t\t\t\tset: function (dates) {\n\t\t\t\t\tself.config._disable = parseDateRules(dates);\n\t\t\t\t},\n\t\t\t});\n\t\t\tvar timeMode = userConfig.mode === \"time\";\n\t\t\tif (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {\n\t\t\t\tvar defaultDateFormat =\n\t\t\t\t\tflatpickr.defaultConfig.dateFormat || defaults.dateFormat;\n\t\t\t\tformats.dateFormat =\n\t\t\t\t\tuserConfig.noCalendar || timeMode\n\t\t\t\t\t\t? \"H:i\" + (userConfig.enableSeconds ? \":S\" : \"\")\n\t\t\t\t\t\t: defaultDateFormat +\n\t\t\t\t\t\t  \" H:i\" +\n\t\t\t\t\t\t  (userConfig.enableSeconds ? \":S\" : \"\");\n\t\t\t}\n\t\t\tif (\n\t\t\t\tuserConfig.altInput &&\n\t\t\t\t(userConfig.enableTime || timeMode) &&\n\t\t\t\t!userConfig.altFormat\n\t\t\t) {\n\t\t\t\tvar defaultAltFormat =\n\t\t\t\t\tflatpickr.defaultConfig.altFormat || defaults.altFormat;\n\t\t\t\tformats.altFormat =\n\t\t\t\t\tuserConfig.noCalendar || timeMode\n\t\t\t\t\t\t? \"h:i\" + (userConfig.enableSeconds ? \":S K\" : \" K\")\n\t\t\t\t\t\t: defaultAltFormat +\n\t\t\t\t\t\t  (\" h:i\" + (userConfig.enableSeconds ? \":S\" : \"\") + \" K\");\n\t\t\t}\n\t\t\tObject.defineProperty(self.config, \"minDate\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._minDate;\n\t\t\t\t},\n\t\t\t\tset: minMaxDateSetter(\"min\"),\n\t\t\t});\n\t\t\tObject.defineProperty(self.config, \"maxDate\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._maxDate;\n\t\t\t\t},\n\t\t\t\tset: minMaxDateSetter(\"max\"),\n\t\t\t});\n\t\t\tvar minMaxTimeSetter = function (type) {\n\t\t\t\treturn function (val) {\n\t\t\t\t\tself.config[type === \"min\" ? \"_minTime\" : \"_maxTime\"] =\n\t\t\t\t\t\tself.parseDate(val, \"H:i:S\");\n\t\t\t\t};\n\t\t\t};\n\t\t\tObject.defineProperty(self.config, \"minTime\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._minTime;\n\t\t\t\t},\n\t\t\t\tset: minMaxTimeSetter(\"min\"),\n\t\t\t});\n\t\t\tObject.defineProperty(self.config, \"maxTime\", {\n\t\t\t\tget: function () {\n\t\t\t\t\treturn self.config._maxTime;\n\t\t\t\t},\n\t\t\t\tset: minMaxTimeSetter(\"max\"),\n\t\t\t});\n\t\t\tif (userConfig.mode === \"time\") {\n\t\t\t\tself.config.noCalendar = true;\n\t\t\t\tself.config.enableTime = true;\n\t\t\t}\n\t\t\tObject.assign(self.config, formats, userConfig);\n\t\t\tfor (var i = 0; i < boolOpts.length; i++)\n\t\t\t\t// https://github.com/microsoft/TypeScript/issues/31663\n\t\t\t\tself.config[boolOpts[i]] =\n\t\t\t\t\tself.config[boolOpts[i]] === true ||\n\t\t\t\t\tself.config[boolOpts[i]] === \"true\";\n\t\t\tHOOKS.filter(function (hook) {\n\t\t\t\treturn self.config[hook] !== undefined;\n\t\t\t}).forEach(function (hook) {\n\t\t\t\tself.config[hook] = arrayify(self.config[hook] || []).map(\n\t\t\t\t\tbindToInstance\n\t\t\t\t);\n\t\t\t});\n\t\t\tself.isMobile =\n\t\t\t\t!self.config.disableMobile &&\n\t\t\t\t!self.config.inline &&\n\t\t\t\tself.config.mode === \"single\" &&\n\t\t\t\t!self.config.disable.length &&\n\t\t\t\t!self.config.enable &&\n\t\t\t\t!self.config.weekNumbers &&\n\t\t\t\t/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n\t\t\t\t\tnavigator.userAgent\n\t\t\t\t);\n\t\t\tfor (var i = 0; i < self.config.plugins.length; i++) {\n\t\t\t\tvar pluginConf = self.config.plugins[i](self) || {};\n\t\t\t\tfor (var key in pluginConf) {\n\t\t\t\t\tif (HOOKS.indexOf(key) > -1) {\n\t\t\t\t\t\tself.config[key] = arrayify(pluginConf[key])\n\t\t\t\t\t\t\t.map(bindToInstance)\n\t\t\t\t\t\t\t.concat(self.config[key]);\n\t\t\t\t\t} else if (typeof userConfig[key] === \"undefined\")\n\t\t\t\t\t\tself.config[key] = pluginConf[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!userConfig.altInputClass) {\n\t\t\t\tself.config.altInputClass =\n\t\t\t\t\tgetInputElem().className + \" \" + self.config.altInputClass;\n\t\t\t}\n\t\t\ttriggerEvent(\"onParseConfig\");\n\t\t}\n\t\tfunction getInputElem() {\n\t\t\treturn self.config.wrap ? element.querySelector(\"[data-input]\") : element;\n\t\t}\n\t\tfunction setupLocale() {\n\t\t\tif (\n\t\t\t\ttypeof self.config.locale !== \"object\" &&\n\t\t\t\ttypeof flatpickr.l10ns[self.config.locale] === \"undefined\"\n\t\t\t)\n\t\t\t\tself.config.errorHandler(\n\t\t\t\t\tnew Error(\"flatpickr: invalid locale \" + self.config.locale)\n\t\t\t\t);\n\t\t\tself.l10n = __assign(\n\t\t\t\t__assign({}, flatpickr.l10ns.default),\n\t\t\t\ttypeof self.config.locale === \"object\"\n\t\t\t\t\t? self.config.locale\n\t\t\t\t\t: self.config.locale !== \"default\"\n\t\t\t\t\t? flatpickr.l10ns[self.config.locale]\n\t\t\t\t\t: undefined\n\t\t\t);\n\t\t\ttokenRegex.D = \"(\" + self.l10n.weekdays.shorthand.join(\"|\") + \")\";\n\t\t\ttokenRegex.l = \"(\" + self.l10n.weekdays.longhand.join(\"|\") + \")\";\n\t\t\ttokenRegex.M = \"(\" + self.l10n.months.shorthand.join(\"|\") + \")\";\n\t\t\ttokenRegex.F = \"(\" + self.l10n.months.longhand.join(\"|\") + \")\";\n\t\t\ttokenRegex.K =\n\t\t\t\t\"(\" +\n\t\t\t\tself.l10n.amPM[0] +\n\t\t\t\t\"|\" +\n\t\t\t\tself.l10n.amPM[1] +\n\t\t\t\t\"|\" +\n\t\t\t\tself.l10n.amPM[0].toLowerCase() +\n\t\t\t\t\"|\" +\n\t\t\t\tself.l10n.amPM[1].toLowerCase() +\n\t\t\t\t\")\";\n\t\t\tvar userConfig = __assign(\n\t\t\t\t__assign({}, instanceConfig),\n\t\t\t\tJSON.parse(JSON.stringify(element.dataset || {}))\n\t\t\t);\n\t\t\tif (\n\t\t\t\tuserConfig.time_24hr === undefined &&\n\t\t\t\tflatpickr.defaultConfig.time_24hr === undefined\n\t\t\t) {\n\t\t\t\tself.config.time_24hr = self.l10n.time_24hr;\n\t\t\t}\n\t\t\tself.formatDate = createDateFormatter(self);\n\t\t\tself.parseDate = createDateParser({\n\t\t\t\tconfig: self.config,\n\t\t\t\tl10n: self.l10n,\n\t\t\t});\n\t\t}\n\t\tfunction positionCalendar(customPositionElement) {\n\t\t\tif (typeof self.config.position === \"function\") {\n\t\t\t\treturn void self.config.position(self, customPositionElement);\n\t\t\t}\n\t\t\tif (self.calendarContainer === undefined) return;\n\t\t\ttriggerEvent(\"onPreCalendarPosition\");\n\t\t\tvar positionElement = customPositionElement || self._positionElement;\n\t\t\tvar calendarHeight = Array.prototype.reduce.call(\n\t\t\t\t\tself.calendarContainer.children,\n\t\t\t\t\tfunction (acc, child) {\n\t\t\t\t\t\treturn acc + child.offsetHeight;\n\t\t\t\t\t},\n\t\t\t\t\t0\n\t\t\t\t),\n\t\t\t\tcalendarWidth = self.calendarContainer.offsetWidth,\n\t\t\t\tconfigPos = self.config.position.split(\" \"),\n\t\t\t\tconfigPosVertical = configPos[0],\n\t\t\t\tconfigPosHorizontal = configPos.length > 1 ? configPos[1] : null,\n\t\t\t\tinputBounds = positionElement.getBoundingClientRect(),\n\t\t\t\tdistanceFromBottom = window.innerHeight - inputBounds.bottom,\n\t\t\t\tshowOnTop =\n\t\t\t\t\tconfigPosVertical === \"above\" ||\n\t\t\t\t\t(configPosVertical !== \"below\" &&\n\t\t\t\t\t\tdistanceFromBottom < calendarHeight &&\n\t\t\t\t\t\tinputBounds.top > calendarHeight);\n\t\t\tvar top =\n\t\t\t\twindow.pageYOffset +\n\t\t\t\tinputBounds.top +\n\t\t\t\t(!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);\n\t\t\ttoggleClass(self.calendarContainer, \"arrowTop\", !showOnTop);\n\t\t\ttoggleClass(self.calendarContainer, \"arrowBottom\", showOnTop);\n\t\t\tif (self.config.inline) return;\n\t\t\tvar left = window.pageXOffset + inputBounds.left;\n\t\t\tvar isCenter = false;\n\t\t\tvar isRight = false;\n\t\t\tif (configPosHorizontal === \"center\") {\n\t\t\t\tleft -= (calendarWidth - inputBounds.width) / 2;\n\t\t\t\tisCenter = true;\n\t\t\t} else if (configPosHorizontal === \"right\") {\n\t\t\t\tleft -= calendarWidth - inputBounds.width;\n\t\t\t\tisRight = true;\n\t\t\t}\n\t\t\ttoggleClass(self.calendarContainer, \"arrowLeft\", !isCenter && !isRight);\n\t\t\ttoggleClass(self.calendarContainer, \"arrowCenter\", isCenter);\n\t\t\ttoggleClass(self.calendarContainer, \"arrowRight\", isRight);\n\t\t\tvar right =\n\t\t\t\twindow.document.body.offsetWidth -\n\t\t\t\t(window.pageXOffset + inputBounds.right);\n\t\t\tvar rightMost = left + calendarWidth > window.document.body.offsetWidth;\n\t\t\tvar centerMost = right + calendarWidth > window.document.body.offsetWidth;\n\t\t\ttoggleClass(self.calendarContainer, \"rightMost\", rightMost);\n\t\t\tif (self.config.static) return;\n\t\t\tself.calendarContainer.style.top = top + \"px\";\n\t\t\tif (!rightMost) {\n\t\t\t\tself.calendarContainer.style.left = left + \"px\";\n\t\t\t\tself.calendarContainer.style.right = \"auto\";\n\t\t\t} else if (!centerMost) {\n\t\t\t\tself.calendarContainer.style.left = \"auto\";\n\t\t\t\tself.calendarContainer.style.right = right + \"px\";\n\t\t\t} else {\n\t\t\t\tvar doc = getDocumentStyleSheet();\n\t\t\t\t// some testing environments don't have css support\n\t\t\t\tif (doc === undefined) return;\n\t\t\t\tvar bodyWidth = window.document.body.offsetWidth;\n\t\t\t\tvar centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);\n\t\t\t\tvar centerBefore = \".flatpickr-calendar.centerMost:before\";\n\t\t\t\tvar centerAfter = \".flatpickr-calendar.centerMost:after\";\n\t\t\t\tvar centerIndex = doc.cssRules.length;\n\t\t\t\tvar centerStyle = \"{left:\" + inputBounds.left + \"px;right:auto;}\";\n\t\t\t\ttoggleClass(self.calendarContainer, \"rightMost\", false);\n\t\t\t\ttoggleClass(self.calendarContainer, \"centerMost\", true);\n\t\t\t\tdoc.insertRule(\n\t\t\t\t\tcenterBefore + \",\" + centerAfter + centerStyle,\n\t\t\t\t\tcenterIndex\n\t\t\t\t);\n\t\t\t\tself.calendarContainer.style.left = centerLeft + \"px\";\n\t\t\t\tself.calendarContainer.style.right = \"auto\";\n\t\t\t}\n\t\t}\n\t\tfunction getDocumentStyleSheet() {\n\t\t\tvar editableSheet = null;\n\t\t\tfor (var i = 0; i < document.styleSheets.length; i++) {\n\t\t\t\tvar sheet = document.styleSheets[i];\n\t\t\t\tif (!sheet.cssRules) continue;\n\t\t\t\ttry {\n\t\t\t\t\tsheet.cssRules;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\teditableSheet = sheet;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn editableSheet != null ? editableSheet : createStyleSheet();\n\t\t}\n\t\tfunction createStyleSheet() {\n\t\t\tvar style = document.createElement(\"style\");\n\t\t\tdocument.head.appendChild(style);\n\t\t\treturn style.sheet;\n\t\t}\n\t\tfunction redraw() {\n\t\t\tif (self.config.noCalendar || self.isMobile) return;\n\t\t\tbuildMonthSwitch();\n\t\t\tupdateNavigationCurrentMonth();\n\t\t\tbuildDays();\n\t\t}\n\t\tfunction focusAndClose() {\n\t\t\tself._input.focus();\n\t\t\tif (\n\t\t\t\twindow.navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\n\t\t\t\tnavigator.msMaxTouchPoints !== undefined\n\t\t\t) {\n\t\t\t\t// hack - bugs in the way IE handles focus keeps the calendar open\n\t\t\t\tsetTimeout(self.close, 0);\n\t\t\t} else {\n\t\t\t\tself.close();\n\t\t\t}\n\t\t}\n\t\tfunction selectDate(e) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\tvar isSelectable = function (day) {\n\t\t\t\treturn (\n\t\t\t\t\tday.classList &&\n\t\t\t\t\tday.classList.contains(\"flatpickr-day\") &&\n\t\t\t\t\t!day.classList.contains(\"flatpickr-disabled\") &&\n\t\t\t\t\t!day.classList.contains(\"notAllowed\")\n\t\t\t\t);\n\t\t\t};\n\t\t\tvar t = findParent(getEventTarget(e), isSelectable);\n\t\t\tif (t === undefined) return;\n\t\t\tvar target = t;\n\t\t\tvar selectedDate = (self.latestSelectedDateObj = new Date(\n\t\t\t\ttarget.dateObj.getTime()\n\t\t\t));\n\t\t\tvar shouldChangeMonth =\n\t\t\t\t(selectedDate.getMonth() < self.currentMonth ||\n\t\t\t\t\tselectedDate.getMonth() >\n\t\t\t\t\t\tself.currentMonth + self.config.showMonths - 1) &&\n\t\t\t\tself.config.mode !== \"range\";\n\t\t\tself.selectedDateElem = target;\n\t\t\tif (self.config.mode === \"single\") self.selectedDates = [selectedDate];\n\t\t\telse if (self.config.mode === \"multiple\") {\n\t\t\t\tvar selectedIndex = isDateSelected(selectedDate);\n\t\t\t\tif (selectedIndex)\n\t\t\t\t\tself.selectedDates.splice(parseInt(selectedIndex), 1);\n\t\t\t\telse self.selectedDates.push(selectedDate);\n\t\t\t} else if (self.config.mode === \"range\") {\n\t\t\t\tif (self.selectedDates.length === 2) {\n\t\t\t\t\tself.clear(false, false);\n\t\t\t\t}\n\t\t\t\tself.latestSelectedDateObj = selectedDate;\n\t\t\t\tself.selectedDates.push(selectedDate);\n\t\t\t\t// unless selecting same date twice, sort ascendingly\n\t\t\t\tif (compareDates(selectedDate, self.selectedDates[0], true) !== 0)\n\t\t\t\t\tself.selectedDates.sort(function (a, b) {\n\t\t\t\t\t\treturn a.getTime() - b.getTime();\n\t\t\t\t\t});\n\t\t\t}\n\t\t\tsetHoursFromInputs();\n\t\t\tif (shouldChangeMonth) {\n\t\t\t\tvar isNewYear = self.currentYear !== selectedDate.getFullYear();\n\t\t\t\tself.currentYear = selectedDate.getFullYear();\n\t\t\t\tself.currentMonth = selectedDate.getMonth();\n\t\t\t\tif (isNewYear) {\n\t\t\t\t\ttriggerEvent(\"onYearChange\");\n\t\t\t\t\tbuildMonthSwitch();\n\t\t\t\t}\n\t\t\t\ttriggerEvent(\"onMonthChange\");\n\t\t\t}\n\t\t\tupdateNavigationCurrentMonth();\n\t\t\tbuildDays();\n\t\t\tupdateValue();\n\t\t\t// maintain focus\n\t\t\tif (\n\t\t\t\t!shouldChangeMonth &&\n\t\t\t\tself.config.mode !== \"range\" &&\n\t\t\t\tself.config.showMonths === 1\n\t\t\t)\n\t\t\t\tfocusOnDayElem(target);\n\t\t\telse if (\n\t\t\t\tself.selectedDateElem !== undefined &&\n\t\t\t\tself.hourElement === undefined\n\t\t\t) {\n\t\t\t\tself.selectedDateElem && self.selectedDateElem.focus();\n\t\t\t}\n\t\t\tif (self.hourElement !== undefined)\n\t\t\t\tself.hourElement !== undefined && self.hourElement.focus();\n\t\t\tif (self.config.closeOnSelect) {\n\t\t\t\tvar single = self.config.mode === \"single\" && !self.config.enableTime;\n\t\t\t\tvar range =\n\t\t\t\t\tself.config.mode === \"range\" &&\n\t\t\t\t\tself.selectedDates.length === 2 &&\n\t\t\t\t\t!self.config.enableTime;\n\t\t\t\tif (single || range) {\n\t\t\t\t\tfocusAndClose();\n\t\t\t\t}\n\t\t\t}\n\t\t\ttriggerChange();\n\t\t}\n\t\tvar CALLBACKS = {\n\t\t\tlocale: [setupLocale, updateWeekdays],\n\t\t\tshowMonths: [buildMonths, setCalendarWidth, buildWeekdays],\n\t\t\tminDate: [jumpToDate],\n\t\t\tmaxDate: [jumpToDate],\n\t\t\tpositionElement: [updatePositionElement],\n\t\t\tclickOpens: [\n\t\t\t\tfunction () {\n\t\t\t\t\tif (self.config.clickOpens === true) {\n\t\t\t\t\t\tbind(self._input, \"focus\", self.open);\n\t\t\t\t\t\tbind(self._input, \"click\", self.open);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself._input.removeEventListener(\"focus\", self.open);\n\t\t\t\t\t\tself._input.removeEventListener(\"click\", self.open);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t\tfunction set(option, value) {\n\t\t\tif (option !== null && typeof option === \"object\") {\n\t\t\t\tObject.assign(self.config, option);\n\t\t\t\tfor (var key in option) {\n\t\t\t\t\tif (CALLBACKS[key] !== undefined)\n\t\t\t\t\t\tCALLBACKS[key].forEach(function (x) {\n\t\t\t\t\t\t\treturn x();\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tself.config[option] = value;\n\t\t\t\tif (CALLBACKS[option] !== undefined)\n\t\t\t\t\tCALLBACKS[option].forEach(function (x) {\n\t\t\t\t\t\treturn x();\n\t\t\t\t\t});\n\t\t\t\telse if (HOOKS.indexOf(option) > -1)\n\t\t\t\t\tself.config[option] = arrayify(value);\n\t\t\t}\n\t\t\tself.redraw();\n\t\t\tupdateValue(true);\n\t\t}\n\t\tfunction setSelectedDate(inputDate, format) {\n\t\t\tvar dates = [];\n\t\t\tif (inputDate instanceof Array)\n\t\t\t\tdates = inputDate.map(function (d) {\n\t\t\t\t\treturn self.parseDate(d, format);\n\t\t\t\t});\n\t\t\telse if (inputDate instanceof Date || typeof inputDate === \"number\")\n\t\t\t\tdates = [self.parseDate(inputDate, format)];\n\t\t\telse if (typeof inputDate === \"string\") {\n\t\t\t\tswitch (self.config.mode) {\n\t\t\t\t\tcase \"single\":\n\t\t\t\t\tcase \"time\":\n\t\t\t\t\t\tdates = [self.parseDate(inputDate, format)];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"multiple\":\n\t\t\t\t\t\tdates = inputDate\n\t\t\t\t\t\t\t.split(self.config.conjunction)\n\t\t\t\t\t\t\t.map(function (date) {\n\t\t\t\t\t\t\t\treturn self.parseDate(date, format);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"range\":\n\t\t\t\t\t\tdates = inputDate\n\t\t\t\t\t\t\t.split(self.l10n.rangeSeparator)\n\t\t\t\t\t\t\t.map(function (date) {\n\t\t\t\t\t\t\t\treturn self.parseDate(date, format);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else\n\t\t\t\tself.config.errorHandler(\n\t\t\t\t\tnew Error(\"Invalid date supplied: \" + JSON.stringify(inputDate))\n\t\t\t\t);\n\t\t\tself.selectedDates = self.config.allowInvalidPreload\n\t\t\t\t? dates\n\t\t\t\t: dates.filter(function (d) {\n\t\t\t\t\t\treturn d instanceof Date && isEnabled(d, false);\n\t\t\t\t  });\n\t\t\tif (self.config.mode === \"range\")\n\t\t\t\tself.selectedDates.sort(function (a, b) {\n\t\t\t\t\treturn a.getTime() - b.getTime();\n\t\t\t\t});\n\t\t}\n\t\tfunction setDate(date, triggerChange, format) {\n\t\t\tif (triggerChange === void 0) {\n\t\t\t\ttriggerChange = false;\n\t\t\t}\n\t\t\tif (format === void 0) {\n\t\t\t\tformat = self.config.dateFormat;\n\t\t\t}\n\t\t\tif ((date !== 0 && !date) || (date instanceof Array && date.length === 0))\n\t\t\t\treturn self.clear(triggerChange);\n\t\t\tsetSelectedDate(date, format);\n\t\t\tself.latestSelectedDateObj =\n\t\t\t\tself.selectedDates[self.selectedDates.length - 1];\n\t\t\tself.redraw();\n\t\t\tjumpToDate(undefined, triggerChange);\n\t\t\tsetHoursFromDate();\n\t\t\tif (self.selectedDates.length === 0) {\n\t\t\t\tself.clear(false);\n\t\t\t}\n\t\t\tupdateValue(triggerChange);\n\t\t\tif (triggerChange) triggerEvent(\"onChange\");\n\t\t}\n\t\tfunction parseDateRules(arr) {\n\t\t\treturn arr\n\t\t\t\t.slice()\n\t\t\t\t.map(function (rule) {\n\t\t\t\t\tif (\n\t\t\t\t\t\ttypeof rule === \"string\" ||\n\t\t\t\t\t\ttypeof rule === \"number\" ||\n\t\t\t\t\t\trule instanceof Date\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn self.parseDate(rule, undefined, true);\n\t\t\t\t\t} else if (rule && typeof rule === \"object\" && rule.from && rule.to)\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tfrom: self.parseDate(rule.from, undefined),\n\t\t\t\t\t\t\tto: self.parseDate(rule.to, undefined),\n\t\t\t\t\t\t};\n\t\t\t\t\treturn rule;\n\t\t\t\t})\n\t\t\t\t.filter(function (x) {\n\t\t\t\t\treturn x;\n\t\t\t\t}); // remove falsy values\n\t\t}\n\t\tfunction setupDates() {\n\t\t\tself.selectedDates = [];\n\t\t\tself.now = self.parseDate(self.config.now) || new Date();\n\t\t\t// Workaround IE11 setting placeholder as the input's value\n\t\t\tvar preloadedDate =\n\t\t\t\tself.config.defaultDate ||\n\t\t\t\t((self.input.nodeName === \"INPUT\" ||\n\t\t\t\t\tself.input.nodeName === \"TEXTAREA\") &&\n\t\t\t\tself.input.placeholder &&\n\t\t\t\tself.input.value === self.input.placeholder\n\t\t\t\t\t? null\n\t\t\t\t\t: self.input.value);\n\t\t\tif (preloadedDate) setSelectedDate(preloadedDate, self.config.dateFormat);\n\t\t\tself._initialDate =\n\t\t\t\tself.selectedDates.length > 0\n\t\t\t\t\t? self.selectedDates[0]\n\t\t\t\t\t: self.config.minDate &&\n\t\t\t\t\t  self.config.minDate.getTime() > self.now.getTime()\n\t\t\t\t\t? self.config.minDate\n\t\t\t\t\t: self.config.maxDate &&\n\t\t\t\t\t  self.config.maxDate.getTime() < self.now.getTime()\n\t\t\t\t\t? self.config.maxDate\n\t\t\t\t\t: self.now;\n\t\t\tself.currentYear = self._initialDate.getFullYear();\n\t\t\tself.currentMonth = self._initialDate.getMonth();\n\t\t\tif (self.selectedDates.length > 0)\n\t\t\t\tself.latestSelectedDateObj = self.selectedDates[0];\n\t\t\tif (self.config.minTime !== undefined)\n\t\t\t\tself.config.minTime = self.parseDate(self.config.minTime, \"H:i\");\n\t\t\tif (self.config.maxTime !== undefined)\n\t\t\t\tself.config.maxTime = self.parseDate(self.config.maxTime, \"H:i\");\n\t\t\tself.minDateHasTime =\n\t\t\t\t!!self.config.minDate &&\n\t\t\t\t(self.config.minDate.getHours() > 0 ||\n\t\t\t\t\tself.config.minDate.getMinutes() > 0 ||\n\t\t\t\t\tself.config.minDate.getSeconds() > 0);\n\t\t\tself.maxDateHasTime =\n\t\t\t\t!!self.config.maxDate &&\n\t\t\t\t(self.config.maxDate.getHours() > 0 ||\n\t\t\t\t\tself.config.maxDate.getMinutes() > 0 ||\n\t\t\t\t\tself.config.maxDate.getSeconds() > 0);\n\t\t}\n\t\tfunction setupInputs() {\n\t\t\tself.input = getInputElem();\n\t\t\t/* istanbul ignore next */\n\t\t\tif (!self.input) {\n\t\t\t\tself.config.errorHandler(new Error(\"Invalid input element specified\"));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// hack: store previous type to restore it after destroy()\n\t\t\tself.input._type = self.input.type;\n\t\t\tself.input.type = \"text\";\n\t\t\tself.input.classList.add(\"flatpickr-input\");\n\t\t\tself._input = self.input;\n\t\t\tif (self.config.altInput) {\n\t\t\t\t// replicate self.element\n\t\t\t\tself.altInput = createElement(\n\t\t\t\t\tself.input.nodeName,\n\t\t\t\t\tself.config.altInputClass\n\t\t\t\t);\n\t\t\t\tself._input = self.altInput;\n\t\t\t\tself.altInput.placeholder = self.input.placeholder;\n\t\t\t\tself.altInput.disabled = self.input.disabled;\n\t\t\t\tself.altInput.required = self.input.required;\n\t\t\t\tself.altInput.tabIndex = self.input.tabIndex;\n\t\t\t\tself.altInput.type = \"text\";\n\t\t\t\tself.input.setAttribute(\"type\", \"hidden\");\n\t\t\t\tif (!self.config.static && self.input.parentNode)\n\t\t\t\t\tself.input.parentNode.insertBefore(\n\t\t\t\t\t\tself.altInput,\n\t\t\t\t\t\tself.input.nextSibling\n\t\t\t\t\t);\n\t\t\t}\n\t\t\tif (!self.config.allowInput)\n\t\t\t\tself._input.setAttribute(\"readonly\", \"readonly\");\n\t\t\tupdatePositionElement();\n\t\t}\n\t\tfunction updatePositionElement() {\n\t\t\tself._positionElement = self.config.positionElement || self._input;\n\t\t}\n\t\tfunction setupMobile() {\n\t\t\tvar inputType = self.config.enableTime\n\t\t\t\t? self.config.noCalendar\n\t\t\t\t\t? \"time\"\n\t\t\t\t\t: \"datetime-local\"\n\t\t\t\t: \"date\";\n\t\t\tself.mobileInput = createElement(\n\t\t\t\t\"input\",\n\t\t\t\tself.input.className + \" flatpickr-mobile\"\n\t\t\t);\n\t\t\tself.mobileInput.tabIndex = 1;\n\t\t\tself.mobileInput.type = inputType;\n\t\t\tself.mobileInput.disabled = self.input.disabled;\n\t\t\tself.mobileInput.required = self.input.required;\n\t\t\tself.mobileInput.placeholder = self.input.placeholder;\n\t\t\tself.mobileFormatStr =\n\t\t\t\tinputType === \"datetime-local\"\n\t\t\t\t\t? \"Y-m-d\\\\TH:i:S\"\n\t\t\t\t\t: inputType === \"date\"\n\t\t\t\t\t? \"Y-m-d\"\n\t\t\t\t\t: \"H:i:S\";\n\t\t\tif (self.selectedDates.length > 0) {\n\t\t\t\tself.mobileInput.defaultValue = self.mobileInput.value =\n\t\t\t\t\tself.formatDate(self.selectedDates[0], self.mobileFormatStr);\n\t\t\t}\n\t\t\tif (self.config.minDate)\n\t\t\t\tself.mobileInput.min = self.formatDate(self.config.minDate, \"Y-m-d\");\n\t\t\tif (self.config.maxDate)\n\t\t\t\tself.mobileInput.max = self.formatDate(self.config.maxDate, \"Y-m-d\");\n\t\t\tif (self.input.getAttribute(\"step\"))\n\t\t\t\tself.mobileInput.step = String(self.input.getAttribute(\"step\"));\n\t\t\tself.input.type = \"hidden\";\n\t\t\tif (self.altInput !== undefined) self.altInput.type = \"hidden\";\n\t\t\ttry {\n\t\t\t\tif (self.input.parentNode)\n\t\t\t\t\tself.input.parentNode.insertBefore(\n\t\t\t\t\t\tself.mobileInput,\n\t\t\t\t\t\tself.input.nextSibling\n\t\t\t\t\t);\n\t\t\t} catch (_a) {}\n\t\t\tbind(self.mobileInput, \"change\", function (e) {\n\t\t\t\tself.setDate(getEventTarget(e).value, false, self.mobileFormatStr);\n\t\t\t\ttriggerEvent(\"onChange\");\n\t\t\t\ttriggerEvent(\"onClose\");\n\t\t\t});\n\t\t}\n\t\tfunction toggle(e) {\n\t\t\tif (self.isOpen === true) return self.close();\n\t\t\tself.open(e);\n\t\t}\n\t\tfunction triggerEvent(event, data) {\n\t\t\t// If the instance has been destroyed already, all hooks have been removed\n\t\t\tif (self.config === undefined) return;\n\t\t\tvar hooks = self.config[event];\n\t\t\tif (hooks !== undefined && hooks.length > 0) {\n\t\t\t\tfor (var i = 0; hooks[i] && i < hooks.length; i++)\n\t\t\t\t\thooks[i](self.selectedDates, self.input.value, self, data);\n\t\t\t}\n\t\t\tif (event === \"onChange\") {\n\t\t\t\tself.input.dispatchEvent(createEvent(\"change\"));\n\t\t\t\t// many front-end frameworks bind to the input event\n\t\t\t\tself.input.dispatchEvent(createEvent(\"input\"));\n\t\t\t}\n\t\t}\n\t\tfunction createEvent(name) {\n\t\t\tvar e = document.createEvent(\"Event\");\n\t\t\te.initEvent(name, true, true);\n\t\t\treturn e;\n\t\t}\n\t\tfunction isDateSelected(date) {\n\t\t\tfor (var i = 0; i < self.selectedDates.length; i++) {\n\t\t\t\tvar selectedDate = self.selectedDates[i];\n\t\t\t\tif (\n\t\t\t\t\tselectedDate instanceof Date &&\n\t\t\t\t\tcompareDates(selectedDate, date) === 0\n\t\t\t\t)\n\t\t\t\t\treturn \"\" + i;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\tfunction isDateInRange(date) {\n\t\t\tif (self.config.mode !== \"range\" || self.selectedDates.length < 2)\n\t\t\t\treturn false;\n\t\t\treturn (\n\t\t\t\tcompareDates(date, self.selectedDates[0]) >= 0 &&\n\t\t\t\tcompareDates(date, self.selectedDates[1]) <= 0\n\t\t\t);\n\t\t}\n\t\tfunction updateNavigationCurrentMonth() {\n\t\t\tif (self.config.noCalendar || self.isMobile || !self.monthNav) return;\n\t\t\tself.yearElements.forEach(function (yearElement, i) {\n\t\t\t\tvar d = new Date(self.currentYear, self.currentMonth, 1);\n\t\t\t\td.setMonth(self.currentMonth + i);\n\t\t\t\tif (\n\t\t\t\t\tself.config.showMonths > 1 ||\n\t\t\t\t\tself.config.monthSelectorType === \"static\"\n\t\t\t\t) {\n\t\t\t\t\tself.monthElements[i].textContent =\n\t\t\t\t\t\tmonthToStr(\n\t\t\t\t\t\t\td.getMonth(),\n\t\t\t\t\t\t\tself.config.shorthandCurrentMonth,\n\t\t\t\t\t\t\tself.l10n\n\t\t\t\t\t\t) + \" \";\n\t\t\t\t} else {\n\t\t\t\t\tself.monthsDropdownContainer.value = d.getMonth().toString();\n\t\t\t\t}\n\t\t\t\tyearElement.value = d.getFullYear().toString();\n\t\t\t});\n\t\t\tself._hidePrevMonthArrow =\n\t\t\t\tself.config.minDate !== undefined &&\n\t\t\t\t(self.currentYear === self.config.minDate.getFullYear()\n\t\t\t\t\t? self.currentMonth <= self.config.minDate.getMonth()\n\t\t\t\t\t: self.currentYear < self.config.minDate.getFullYear());\n\t\t\tself._hideNextMonthArrow =\n\t\t\t\tself.config.maxDate !== undefined &&\n\t\t\t\t(self.currentYear === self.config.maxDate.getFullYear()\n\t\t\t\t\t? self.currentMonth + 1 > self.config.maxDate.getMonth()\n\t\t\t\t\t: self.currentYear > self.config.maxDate.getFullYear());\n\t\t}\n\t\tfunction getDateStr(specificFormat) {\n\t\t\tvar format =\n\t\t\t\tspecificFormat ||\n\t\t\t\t(self.config.altInput ? self.config.altFormat : self.config.dateFormat);\n\t\t\treturn self.selectedDates\n\t\t\t\t.map(function (dObj) {\n\t\t\t\t\treturn self.formatDate(dObj, format);\n\t\t\t\t})\n\t\t\t\t.filter(function (d, i, arr) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tself.config.mode !== \"range\" ||\n\t\t\t\t\t\tself.config.enableTime ||\n\t\t\t\t\t\tarr.indexOf(d) === i\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t\t.join(\n\t\t\t\t\tself.config.mode !== \"range\"\n\t\t\t\t\t\t? self.config.conjunction\n\t\t\t\t\t\t: self.l10n.rangeSeparator\n\t\t\t\t);\n\t\t}\n\t\t/**\n\t\t * Updates the values of inputs associated with the calendar\n\t\t */\n\t\tfunction updateValue(triggerChange) {\n\t\t\tif (triggerChange === void 0) {\n\t\t\t\ttriggerChange = true;\n\t\t\t}\n\t\t\tif (self.mobileInput !== undefined && self.mobileFormatStr) {\n\t\t\t\tself.mobileInput.value =\n\t\t\t\t\tself.latestSelectedDateObj !== undefined\n\t\t\t\t\t\t? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr)\n\t\t\t\t\t\t: \"\";\n\t\t\t}\n\t\t\tself.input.value = getDateStr(self.config.dateFormat);\n\t\t\tif (self.altInput !== undefined) {\n\t\t\t\tself.altInput.value = getDateStr(self.config.altFormat);\n\t\t\t}\n\t\t\tif (triggerChange !== false) triggerEvent(\"onValueUpdate\");\n\t\t}\n\t\tfunction onMonthNavClick(e) {\n\t\t\tvar eventTarget = getEventTarget(e);\n\t\t\tvar isPrevMonth = self.prevMonthNav.contains(eventTarget);\n\t\t\tvar isNextMonth = self.nextMonthNav.contains(eventTarget);\n\t\t\tif (isPrevMonth || isNextMonth) {\n\t\t\t\tchangeMonth(isPrevMonth ? -1 : 1);\n\t\t\t} else if (self.yearElements.indexOf(eventTarget) >= 0) {\n\t\t\t\teventTarget.select();\n\t\t\t} else if (eventTarget.classList.contains(\"arrowUp\")) {\n\t\t\t\tself.changeYear(self.currentYear + 1);\n\t\t\t} else if (eventTarget.classList.contains(\"arrowDown\")) {\n\t\t\t\tself.changeYear(self.currentYear - 1);\n\t\t\t}\n\t\t}\n\t\tfunction timeWrapper(e) {\n\t\t\te.preventDefault();\n\t\t\tvar isKeyDown = e.type === \"keydown\",\n\t\t\t\teventTarget = getEventTarget(e),\n\t\t\t\tinput = eventTarget;\n\t\t\tif (self.amPM !== undefined && eventTarget === self.amPM) {\n\t\t\t\tself.amPM.textContent =\n\t\t\t\t\tself.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n\t\t\t}\n\t\t\tvar min = parseFloat(input.getAttribute(\"min\")),\n\t\t\t\tmax = parseFloat(input.getAttribute(\"max\")),\n\t\t\t\tstep = parseFloat(input.getAttribute(\"step\")),\n\t\t\t\tcurValue = parseInt(input.value, 10),\n\t\t\t\tdelta = e.delta || (isKeyDown ? (e.which === 38 ? 1 : -1) : 0);\n\t\t\tvar newValue = curValue + step * delta;\n\t\t\tif (typeof input.value !== \"undefined\" && input.value.length === 2) {\n\t\t\t\tvar isHourElem = input === self.hourElement,\n\t\t\t\t\tisMinuteElem = input === self.minuteElement;\n\t\t\t\tif (newValue < min) {\n\t\t\t\t\tnewValue =\n\t\t\t\t\t\tmax +\n\t\t\t\t\t\tnewValue +\n\t\t\t\t\t\tint(!isHourElem) +\n\t\t\t\t\t\t(int(isHourElem) && int(!self.amPM));\n\t\t\t\t\tif (isMinuteElem) incrementNumInput(undefined, -1, self.hourElement);\n\t\t\t\t} else if (newValue > max) {\n\t\t\t\t\tnewValue =\n\t\t\t\t\t\tinput === self.hourElement ? newValue - max - int(!self.amPM) : min;\n\t\t\t\t\tif (isMinuteElem) incrementNumInput(undefined, 1, self.hourElement);\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tself.amPM &&\n\t\t\t\t\tisHourElem &&\n\t\t\t\t\t(step === 1\n\t\t\t\t\t\t? newValue + curValue === 23\n\t\t\t\t\t\t: Math.abs(newValue - curValue) > step)\n\t\t\t\t) {\n\t\t\t\t\tself.amPM.textContent =\n\t\t\t\t\t\tself.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n\t\t\t\t}\n\t\t\t\tinput.value = pad(newValue);\n\t\t\t}\n\t\t}\n\t\tinit();\n\t\treturn self;\n\t}\n\t/* istanbul ignore next */\n\tfunction _flatpickr(nodeList, config) {\n\t\t// static list\n\t\tvar nodes = Array.prototype.slice.call(nodeList).filter(function (x) {\n\t\t\treturn x instanceof HTMLElement;\n\t\t});\n\t\tvar instances = [];\n\t\tfor (var i = 0; i < nodes.length; i++) {\n\t\t\tvar node = nodes[i];\n\t\t\ttry {\n\t\t\t\tif (node.getAttribute(\"data-fp-omit\") !== null) continue;\n\t\t\t\tif (node._flatpickr !== undefined) {\n\t\t\t\t\tnode._flatpickr.destroy();\n\t\t\t\t\tnode._flatpickr = undefined;\n\t\t\t\t}\n\t\t\t\tnode._flatpickr = FlatpickrInstance(node, config || {});\n\t\t\t\tinstances.push(node._flatpickr);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t\treturn instances.length === 1 ? instances[0] : instances;\n\t}\n\t/* istanbul ignore next */\n\tif (\n\t\ttypeof HTMLElement !== \"undefined\" &&\n\t\ttypeof HTMLCollection !== \"undefined\" &&\n\t\ttypeof NodeList !== \"undefined\"\n\t) {\n\t\t// browser env\n\t\tHTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr =\n\t\t\tfunction (config) {\n\t\t\t\treturn _flatpickr(this, config);\n\t\t\t};\n\t\tHTMLElement.prototype.flatpickr = function (config) {\n\t\t\treturn _flatpickr([this], config);\n\t\t};\n\t}\n\t/* istanbul ignore next */\n\tvar flatpickr = function (selector, config) {\n\t\tif (typeof selector === \"string\") {\n\t\t\treturn _flatpickr(window.document.querySelectorAll(selector), config);\n\t\t} else if (selector instanceof Node) {\n\t\t\treturn _flatpickr([selector], config);\n\t\t} else {\n\t\t\treturn _flatpickr(selector, config);\n\t\t}\n\t};\n\t/* istanbul ignore next */\n\tflatpickr.defaultConfig = {};\n\tflatpickr.l10ns = {\n\t\ten: __assign({}, english),\n\t\tdefault: __assign({}, english),\n\t};\n\tflatpickr.localize = function (l10n) {\n\t\tflatpickr.l10ns.default = __assign(\n\t\t\t__assign({}, flatpickr.l10ns.default),\n\t\t\tl10n\n\t\t);\n\t};\n\tflatpickr.setDefaults = function (config) {\n\t\tflatpickr.defaultConfig = __assign(\n\t\t\t__assign({}, flatpickr.defaultConfig),\n\t\t\tconfig\n\t\t);\n\t};\n\tflatpickr.parseDate = createDateParser({});\n\tflatpickr.formatDate = createDateFormatter({});\n\tflatpickr.compareDates = compareDates;\n\t/* istanbul ignore next */\n\tif (typeof jQuery !== \"undefined\" && typeof jQuery.fn !== \"undefined\") {\n\t\tjQuery.fn.flatpickr = function (config) {\n\t\t\treturn _flatpickr(this, config);\n\t\t};\n\t}\n\tDate.prototype.fp_incr = function (days) {\n\t\treturn new Date(\n\t\t\tthis.getFullYear(),\n\t\t\tthis.getMonth(),\n\t\t\tthis.getDate() + (typeof days === \"string\" ? parseInt(days, 10) : days)\n\t\t);\n\t};\n\tif (typeof window !== \"undefined\") {\n\t\twindow.flatpickr = flatpickr;\n\t}\n\n\treturn flatpickr;\n}.call(this);\n\nexport default flatpickr;\n","export const flatpickrFrench = {\n\tfirstDayOfWeek: 1,\n\tweekdays: {\n\t\tshorthand: [\"dim\", \"lun\", \"mar\", \"mer\", \"jeu\", \"ven\", \"sam\"],\n\t\tlonghand: [\n\t\t\t\"dimanche\",\n\t\t\t\"lundi\",\n\t\t\t\"mardi\",\n\t\t\t\"mercredi\",\n\t\t\t\"jeudi\",\n\t\t\t\"vendredi\",\n\t\t\t\"samedi\",\n\t\t],\n\t},\n\tmonths: {\n\t\tshorthand: [\n\t\t\t\"janv\",\n\t\t\t\"févr\",\n\t\t\t\"mars\",\n\t\t\t\"avr\",\n\t\t\t\"mai\",\n\t\t\t\"juin\",\n\t\t\t\"juil\",\n\t\t\t\"août\",\n\t\t\t\"sept\",\n\t\t\t\"oct\",\n\t\t\t\"nov\",\n\t\t\t\"déc\",\n\t\t],\n\t\tlonghand: [\n\t\t\t\"janvier\",\n\t\t\t\"février\",\n\t\t\t\"mars\",\n\t\t\t\"avril\",\n\t\t\t\"mai\",\n\t\t\t\"juin\",\n\t\t\t\"juillet\",\n\t\t\t\"août\",\n\t\t\t\"septembre\",\n\t\t\t\"octobre\",\n\t\t\t\"novembre\",\n\t\t\t\"décembre\",\n\t\t],\n\t},\n\tordinal: function (nth) {\n\t\tif (nth > 1) return \"\";\n\t\treturn \"er\";\n\t},\n\trangeSeparator: \" au \",\n\tweekAbbreviation: \"Sem\",\n\tscrollTitle: \"Défiler pour augmenter la valeur\",\n\ttoggleTitle: \"Cliquer pour basculer\",\n\ttime_24hr: true,\n};\n","export const flatpickrItalian = {\n\tweekdays: {\n\t\tshorthand: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"],\n\t\tlonghand: [\n\t\t\t\"Domenica\",\n\t\t\t\"Lunedì\",\n\t\t\t\"Martedì\",\n\t\t\t\"Mercoledì\",\n\t\t\t\"Giovedì\",\n\t\t\t\"Venerdì\",\n\t\t\t\"Sabato\",\n\t\t],\n\t},\n\tmonths: {\n\t\tshorthand: [\n\t\t\t\"Gen\",\n\t\t\t\"Feb\",\n\t\t\t\"Mar\",\n\t\t\t\"Apr\",\n\t\t\t\"Mag\",\n\t\t\t\"Giu\",\n\t\t\t\"Lug\",\n\t\t\t\"Ago\",\n\t\t\t\"Set\",\n\t\t\t\"Ott\",\n\t\t\t\"Nov\",\n\t\t\t\"Dic\",\n\t\t],\n\t\tlonghand: [\n\t\t\t\"Gennaio\",\n\t\t\t\"Febbraio\",\n\t\t\t\"Marzo\",\n\t\t\t\"Aprile\",\n\t\t\t\"Maggio\",\n\t\t\t\"Giugno\",\n\t\t\t\"Luglio\",\n\t\t\t\"Agosto\",\n\t\t\t\"Settembre\",\n\t\t\t\"Ottobre\",\n\t\t\t\"Novembre\",\n\t\t\t\"Dicembre\",\n\t\t],\n\t},\n\tfirstDayOfWeek: 1,\n\tordinal: function () {\n\t\treturn \"°\";\n\t},\n\trangeSeparator: \" al \",\n\tweekAbbreviation: \"Se\",\n\tscrollTitle: \"Scorri per aumentare\",\n\ttoggleTitle: \"Clicca per cambiare\",\n\ttime_24hr: true,\n};\n","export const flatpickrOccitan = {\n\tfirstDayOfWeek: 1,\n\tweekdays: {\n\t\tshorthand: [\"dim\", \"dl\", \"dma\", \"dme\", \"dj\", \"dv\", \"ds\"],\n\t\tlonghand: [\n\t\t\t\"dimenge\",\n\t\t\t\"diluns\",\n\t\t\t\"dimars\",\n\t\t\t\"dimècres\",\n\t\t\t\"dijòus\",\n\t\t\t\"divendres\",\n\t\t\t\"dissabte\",\n\t\t],\n\t},\n\tmonths: {\n\t\tshorthand: [\n\t\t\t\"gen\",\n\t\t\t\"febr\",\n\t\t\t\"març\",\n\t\t\t\"abr\",\n\t\t\t\"mai\",\n\t\t\t\"jun\",\n\t\t\t\"jul\",\n\t\t\t\"ag\",\n\t\t\t\"set\",\n\t\t\t\"oct\",\n\t\t\t\"nov\",\n\t\t\t\"dec\",\n\t\t],\n\t\tlonghand: [\n\t\t\t\"genièr\",\n\t\t\t\"febrièr\",\n\t\t\t\"març\",\n\t\t\t\"abril\",\n\t\t\t\"mai\",\n\t\t\t\"junh\",\n\t\t\t\"julhet\",\n\t\t\t\"agost\",\n\t\t\t\"setembre\",\n\t\t\t\"octobre\",\n\t\t\t\"novembre\",\n\t\t\t\"decembre\",\n\t\t],\n\t},\n\tordinal: function (nth) {\n\t\tif (nth > 1) return \"\";\n\t\treturn \"èr\";\n\t},\n\trangeSeparator: \" a \",\n\tweekAbbreviation: \"Sem\",\n\tscrollTitle: \"Desfilar per aumentar\",\n\ttoggleTitle: \"Clicar per bascular\",\n\ttime_24hr: true,\n};\n","import { config } from \"../config.mjs\";\nimport {\n\tcheckboxAjouterDate,\n\tcheckboxMajDateAuto,\n\tcheckboxSoulignerDate,\n\tchoixCouleurEntete,\n\tdivEntete,\n\ttexte_principal,\n} from \"../utils/dom.mjs\";\nimport { stocke } from \"../settings/read-write.mjs\";\nimport { adapteCouleurBordureChoixCouleur } from \"../ui/display/ui-colors.mjs\";\nimport { jours, nomJours } from \"../../_locales/date-days.mjs\";\nimport { nomMois } from \"../../_locales/date-months.mjs\";\nimport flatpickr from \"../../lib/flatpickr.mjs\";\nimport { flatpickrFrench } from \"../../_locales/flatpickr-fr.mjs\";\nimport { flatpickrItalian } from \"../../_locales/flatpickr-it.mjs\";\nimport { flatpickrOccitan } from \"../../_locales/flatpickr-oc.mjs\";\n\nexport function calculeDate(format = \"complet\", date = null) {\n\t// helper pour convertir/valider en Date\n\tconst normalize = (d) => {\n\t\tlet dt = d ? (d instanceof Date ? d : new Date(d)) : new Date();\n\t\tif (!(dt instanceof Date) || isNaN(dt.getTime())) {\n\t\t\tdt = new Date();\n\t\t}\n\t\treturn dt;\n\t};\n\n\tlet options;\n\n\tswitch (format) {\n\t\tcase \"complet\":\n\t\t\toptions = {\n\t\t\t\tweekday: \"long\",\n\t\t\t\tyear: \"numeric\",\n\t\t\t\tmonth: \"long\",\n\t\t\t\tday: \"numeric\",\n\t\t\t};\n\t\t\tbreak;\n\t\tcase \"sansJour\":\n\t\t\toptions = { year: \"numeric\", month: \"long\", day: \"numeric\" };\n\t\t\tbreak;\n\t\tcase \"sansAnnee\":\n\t\t\toptions = { weekday: \"long\", month: \"long\", day: \"numeric\" };\n\t\t\tbreak;\n\t\tcase \"court\": {\n\t\t\tconst dateObj = normalize(date);\n\t\t\tconst dateCourt = `${dateObj.getDate().toString().padStart(2, \"0\")}/${(\n\t\t\t\tdateObj.getMonth() + 1\n\t\t\t)\n\t\t\t\t.toString()\n\t\t\t\t.padStart(2, \"0\")}/${dateObj.getFullYear()}`;\n\n\t\t\treturn dateCourt;\n\t\t}\n\t\tdefault:\n\t\t\toptions = {\n\t\t\t\tweekday: \"long\",\n\t\t\t\tyear: \"numeric\",\n\t\t\t\tmonth: \"long\",\n\t\t\t\tday: \"numeric\",\n\t\t\t};\n\t}\n\n\tconst dateObj = normalize(date);\n\n\tlet dateDuJour = dateObj.toLocaleDateString(config.langue, options);\n\n\tdateDuJour = dateDuJour.replace(/\\b1\\b/, '1<span class=\"exposant\">er</span>');\n\n\tlet date_formatee = dateDuJour.charAt(0).toUpperCase() + dateDuJour.slice(1);\n\n\tif (config.langue === \"oc\") {\n\t\tdate_formatee = traduireDateEnOccitan(date_formatee);\n\t}\n\n\treturn date_formatee;\n}\n\nexport function traduireDateEnOccitan(dateStr) {\n\tfor (let jour of nomJours) {\n\t\tconst regexJour = new RegExp(`\\\\b${jour.fr}\\\\b`, \"g\");\n\t\tdateStr = dateStr.replace(regexJour, jour.oc);\n\t}\n\tfor (let mois of nomMois) {\n\t\tconst regexMois = new RegExp(`\\\\b${mois.fr}\\\\b`, \"g\");\n\t\tdateStr = dateStr.replace(regexMois, mois.oc);\n\t}\n\treturn dateStr;\n}\n\nexport function creeDate() {\n\tconst nouveauSpan = document.createElement(\"span\");\n\tnouveauSpan.innerHTML = calculeDate();\n\tconst divDate = document.createElement(\"div\");\n\tdivDate.id = \"divDate\";\n\tdivDate.appendChild(nouveauSpan);\n\tif (config.soulignerLaDate) {\n\t\tnouveauSpan.style.textDecoration = \"underline red\";\n\t}\n\ttexte_principal.prepend(divDate);\n\tconst br2 = document.createElement(\"br\");\n\ttexte_principal.insertBefore(br2, divDate.nextSibling);\n}\n\nlet calendarInstance = null;\n\nlet flatpickrLocalization = \"\";\n\nexport async function ouvreSelecteurDate() {\n\tconst datepickerDiv = document.getElementById(\"datepicker\");\n\tconst inputDate = document.getElementById(\"date-input\");\n\tif (!datepickerDiv || !inputDate) return;\n\tconst rect = document.getElementById(\"date\").getBoundingClientRect();\n\tlet positionLeft = rect.left;\n\tdatepickerDiv.classList.remove(\"hide\");\n\tconst flatpickrCalendar = document.querySelector(\".flatpickr-calendar\");\n\tif (flatpickrCalendar) {\n\t\tflatpickrCalendar.style.left = positionLeft + \"px\";\n\t\tflatpickrCalendar.classList.remove(\"hide\");\n\t}\n\tinputDate.focus();\n\tif (!calendarInstance) {\n\t\t// on charge le CSS de flatpickr pour la première fois\n\t\tconst link = document.createElement(\"link\");\n\t\tlink.rel = \"stylesheet\";\n\t\tlink.href = \"./js/lib/flatpickr.min.css\";\n\t\tdocument.head.appendChild(link);\n\t\t// On attend que le CSS soit chargé\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tlink.onload = resolve;\n\t\t\tlink.onerror = reject;\n\t\t});\n\t}\n\tif (!calendarInstance || flatpickrLocalization !== config.langue) {\n\t\tflatpickrLocalization = config.langue;\n\t\tlet flatpickrLocales;\n\t\t// localization de flatpickr\n\t\tswitch (config.langue) {\n\t\t\tcase \"fr\":\n\t\t\t\tflatpickrLocales = flatpickrFrench;\n\t\t\t\tbreak;\n\t\t\tcase \"it\":\n\t\t\t\tflatpickrLocales = flatpickrItalian;\n\t\t\t\tbreak;\n\t\t\tcase \"oc\":\n\t\t\t\tflatpickrLocales = flatpickrOccitan;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\tcalendarInstance = flatpickr(inputDate, {\n\t\t\tinline: true,\n\t\t\tdateFormat: \"Y-m-d\",\n\t\t\tlocale: flatpickrLocales,\n\t\t\tonChange: function (selectedDates) {\n\t\t\t\tchangeDate && changeDate(selectedDates[0]);\n\t\t\t\tdatepickerDiv.classList.add(\"hide\");\n\t\t\t\tconst flatpickrCalendar = document.querySelector(\".flatpickr-calendar\");\n\t\t\t\tif (flatpickrCalendar) flatpickrCalendar.classList.add(\"hide\");\n\t\t\t},\n\t\t});\n\n\t\tconst flatpickrCalendar2 = document.querySelector(\".flatpickr-calendar\");\n\t\tif (flatpickrCalendar2) {\n\t\t\tflatpickrCalendar2.style.left = positionLeft + \"px\";\n\t\t\tflatpickrCalendar2.classList.remove(\"hide\");\n\t\t}\n\t}\n}\n\nexport function changeDate(date = null) {\n\tlet dateAutiliser = null;\n\tif (date) {\n\t\tdateAutiliser = calculeDate(\"complet\", date);\n\t} else {\n\t\tdateAutiliser = calculeDate();\n\t}\n\tconst divDate = document.getElementById(\"divDate\");\n\tif (!divDate) {\n\t\tcreeDate();\n\t\treturn;\n\t}\n\tconst nouveauSpan = document.createElement(\"span\");\n\tnouveauSpan.innerHTML = dateAutiliser;\n\tif (config.soulignerLaDate) {\n\t\tnouveauSpan.style.textDecoration = \"underline red\";\n\t}\n\tconfig.dateDuDoc = dateAutiliser;\n\tdivDate.innerHTML = \"\";\n\tdivDate.appendChild(nouveauSpan);\n}\n\nexport function changeJour(jour) {\n\t// Récupérer la couleur du jour depuis l'objet jours\n\tlet couleur = jours[jour];\n\n\t// Appliquer la couleur en arrière-plan de divEntete\n\tdivEntete.style.backgroundColor = couleur;\n\tchoixCouleurEntete.value = choixCouleurEntete.style.backgroundColor = couleur;\n\tadapteCouleurBordureChoixCouleur();\n}\n\nexport function changeModeDate() {\n\tconfig.ajouterLaDate = checkboxAjouterDate.checked;\n\tconfig.soulignerLaDate = checkboxSoulignerDate.checked;\n\tstocke(\"ajouter-date\", config.ajouterLaDate);\n\tstocke(\"souligner-date\", config.soulignerLaDate);\n\tconst divDate = document.getElementById(\"divDate\");\n\tif (divDate) {\n\t\tif (config.soulignerLaDate) {\n\t\t\tdivDate.querySelector(\"span\").style.textDecoration = \"underline red\";\n\t\t} else {\n\t\t\tdivDate.querySelector(\"span\").style.textDecoration = null;\n\t\t}\n\t}\n}\n\nexport function toogleMajDateAuto() {\n\tconfig.majDateAuto = checkboxMajDateAuto.checked;\n\tstocke(\"maj-date-auto\", config.majDateAuto);\n\tif (config.majDateAuto) changeDate();\n}\n","export function ouvreBoutonsCouleurs(event) {\n\tif (event) event.stopPropagation();\n\tconst rect = document.getElementById(\"couleur-texte\")\n\t\t? document.getElementById(\"couleur-texte\").getBoundingClientRect()\n\t\t: null;\n\tif (!rect) return;\n\tlet positionLeft = rect.left;\n\tconst el = document.getElementById(\"boutons-couleur-texte\");\n\tif (!el) return;\n\tel.style.left = positionLeft + \"px\";\n\tel.classList.toggle(\"hide\");\n}\n","export function ouvreOptions() {\n\tconst divPanneauOptions = document.getElementById(\"panneauOptions\");\n\tif (!divPanneauOptions) return;\n\tdivPanneauOptions.classList.toggle(\"hide\");\n}\n\nexport function opacite(valeur) {\n\tconst inputOpacite = document.getElementById(\"inputOpacite\");\n\tconst voile_page = document.getElementById(\"voile_page\");\n\tconst voile_marge = document.getElementById(\"voile_marge\");\n\tconst voile_marge2 = document.getElementById(\"voile_marge2\");\n\tif (typeof valeur === \"string\") valeur = parseFloat(valeur);\n\tif (inputOpacite) inputOpacite.value = valeur;\n\tif (voile_page)\n\t\tvoile_page.style.backgroundColor =\n\t\t\t\"rgba(255,255,255,\" + (+1 - valeur) + \")\";\n\tif (voile_marge)\n\t\tvoile_marge.style.backgroundColor =\n\t\t\t\"rgba(255,255,255,\" + (+1 - valeur) + \")\";\n\tif (voile_marge2)\n\t\tvoile_marge2.style.backgroundColor =\n\t\t\t\"rgba(255,255,255,\" + (+1 - valeur) + \")\";\n\ttry {\n\t\tlocalStorage.setItem(\"opacite-lignes\", valeur);\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n}\n","// ========================================\n// FONCTION CENTRALE : Normaliser les spans\n// ========================================\nexport function normaliserSpans(container) {\n\tif (!container) return;\n\n\tif (container.nodeType === Node.TEXT_NODE) {\n\t\tcontainer = container.parentElement;\n\t}\n\n\tlet editableParent = container;\n\twhile (\n\t\teditableParent &&\n\t\teditableParent.nodeType === Node.ELEMENT_NODE &&\n\t\t!editableParent.hasAttribute(\"contenteditable\")\n\t) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\tif (!editableParent) {\n\t\teditableParent = container;\n\t}\n\n\tconst spans = Array.from(editableParent.querySelectorAll(\"span\"));\n\n\tspans.forEach((span) => {\n\t\t// Ne pas découper les spans .entoure\n\t\tif (span.classList.contains(\"entoure\")) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (span.textContent.length > 1) {\n\t\t\tconst classes = Array.from(span.classList);\n\t\t\tconst parent = span.parentNode;\n\t\t\tconst fragment = document.createDocumentFragment();\n\n\t\t\tfor (let i = 0; i < span.textContent.length; i++) {\n\t\t\t\tconst nouveauSpan = document.createElement(\"span\");\n\t\t\t\tnouveauSpan.textContent = span.textContent[i];\n\t\t\t\tclasses.forEach((cls) => nouveauSpan.classList.add(cls));\n\t\t\t\tfragment.appendChild(nouveauSpan);\n\t\t\t}\n\n\t\t\tparent.insertBefore(fragment, span);\n\t\t\tspan.remove();\n\t\t}\n\t});\n}\n\n// ========================================\n// NETTOYAGE (optionnel)\n// ========================================\n// ========================================\n// NETTOYAGE (corrigé) - Respecte l'adjacence réelle\n// ========================================\nexport function nettoyerSpans(container) {\n\tif (!container) return;\n\tif (container.nodeType === Node.TEXT_NODE) {\n\t\tcontainer = container.parentElement;\n\t}\n\tlet editableParent = container;\n\twhile (\n\t\teditableParent &&\n\t\teditableParent.nodeType === Node.ELEMENT_NODE &&\n\t\t!editableParent.hasAttribute(\"contenteditable\")\n\t) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\tif (!editableParent) return;\n\n\tlet modifie = true;\n\twhile (modifie) {\n\t\tmodifie = false;\n\t\tconst spans = editableParent.querySelectorAll(\"span\");\n\n\t\tfor (let i = 0; i < spans.length; i++) {\n\t\t\tconst current = spans[i];\n\n\t\t\t// Vérifier si le nœud suivant est vraiment un span (pas de texte entre les deux)\n\t\t\tconst next = current.nextSibling;\n\n\t\t\tif (next && next.tagName === \"SPAN\") {\n\t\t\t\tconst currentClasses = Array.from(current.classList).sort().join(\",\");\n\t\t\t\tconst nextClasses = Array.from(next.classList).sort().join(\",\");\n\n\t\t\t\tif (currentClasses === nextClasses) {\n\t\t\t\t\tcurrent.textContent += next.textContent;\n\t\t\t\t\tnext.remove();\n\t\t\t\t\tmodifie = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\teditableParent.querySelectorAll(\"span\").forEach((span) => {\n\t\tif (span.textContent === \"\") {\n\t\t\tspan.remove();\n\t\t}\n\t});\n}\n\n// ========================================\n// FONCTION UTILITAIRE : Extraire caractères avec styles\n// ========================================\nexport function extraireCaracteresAvecStyles(fragment) {\n\tconst caracteres = [];\n\n\tfunction parcourirNoeud(noeud, classesParent = []) {\n\t\tif (noeud.nodeType === Node.TEXT_NODE) {\n\t\t\tconst texte = noeud.textContent;\n\t\t\tfor (let i = 0; i < texte.length; i++) {\n\t\t\t\tcaracteres.push({\n\t\t\t\t\ttexte: texte[i],\n\t\t\t\t\tclasses: [...classesParent],\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (noeud.nodeType === Node.ELEMENT_NODE) {\n\t\t\t// Ne pas découper les spans .entoure\n\t\t\tif (noeud.classList && noeud.classList.contains(\"entoure\")) {\n\t\t\t\tcaracteres.push({\n\t\t\t\t\ttexte: null,\n\t\t\t\t\tnoeud: noeud.cloneNode(true),\n\t\t\t\t\tisEntoure: true,\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst classes = noeud.classList ? Array.from(noeud.classList) : [];\n\t\t\tconst nouvellesClasses = [...classesParent, ...classes];\n\n\t\t\tnoeud.childNodes.forEach((enfant) => {\n\t\t\t\tparcourirNoeud(enfant, nouvellesClasses);\n\t\t\t});\n\t\t}\n\t}\n\n\tfragment.childNodes.forEach((noeud) => parcourirNoeud(noeud));\n\treturn caracteres;\n}\n","// ========================================\n// SOULIGNEMENT COLORÉ (lettre par lettre)\n\nimport {\n\textraireCaracteresAvecStyles,\n\tnettoyerSpans,\n\tnormaliserSpans,\n} from \"./helpers.mjs\";\n\n// ========================================\nexport function souligne(couleur) {\n\tconst sel = window.getSelection();\n\tif (!sel.rangeCount) return;\n\n\tconst range = sel.getRangeAt(0);\n\tif (range.collapsed) return;\n\n\tlet editableParent = range.commonAncestorContainer;\n\tif (editableParent.nodeType === Node.TEXT_NODE) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\twhile (\n\t\teditableParent &&\n\t\teditableParent.nodeType === Node.ELEMENT_NODE &&\n\t\t!editableParent.hasAttribute(\"contenteditable\")\n\t) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\n\t// Sauvegarder la position\n\tconst texteAvantSelection = range.cloneRange();\n\ttexteAvantSelection.selectNodeContents(editableParent);\n\ttexteAvantSelection.setEnd(range.startContainer, range.startOffset);\n\tconst startOffset = texteAvantSelection.toString().length;\n\tconst endOffset = startOffset + range.toString().length;\n\n\t// Normaliser les spans\n\tnormaliserSpans(editableParent);\n\n\t// Recréer la sélection\n\tlet currentOffset = 0;\n\tlet startNode = null;\n\tlet startPos = 0;\n\tlet endNode = null;\n\tlet endPos = 0;\n\n\tconst walker = document.createTreeWalker(\n\t\teditableParent,\n\t\tNodeFilter.SHOW_TEXT,\n\t\tnull,\n\t\tfalse\n\t);\n\n\tlet node;\n\twhile ((node = walker.nextNode())) {\n\t\tconst nodeLength = node.textContent.length;\n\n\t\tif (!startNode && currentOffset + nodeLength > startOffset) {\n\t\t\tstartNode = node;\n\t\t\tstartPos = startOffset - currentOffset;\n\t\t}\n\n\t\tif (!endNode && currentOffset + nodeLength >= endOffset) {\n\t\t\tendNode = node;\n\t\t\tendPos = endOffset - currentOffset;\n\t\t\tbreak;\n\t\t}\n\n\t\tcurrentOffset += nodeLength;\n\t}\n\n\tif (startNode && endNode) {\n\t\ttry {\n\t\t\tconst newRange = document.createRange();\n\t\t\tnewRange.setStart(startNode, startPos);\n\t\t\tnewRange.setEnd(endNode, endPos);\n\t\t\tsel.removeAllRanges();\n\t\t\tsel.addRange(newRange);\n\t\t} catch (e) {\n\t\t\tconsole.warn(\"Impossible de restaurer la sélection\", e);\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\treturn;\n\t}\n\n\t// Appliquer le soulignement\n\tconst finalRange = sel.getRangeAt(0);\n\tconst startNodeFinal = finalRange.startContainer;\n\tconst endNodeFinal = finalRange.endContainer;\n\n\t// Cas particulier : un seul span sélectionné entièrement\n\tif (\n\t\tstartNodeFinal === endNodeFinal &&\n\t\tstartNodeFinal.nodeType === Node.TEXT_NODE &&\n\t\tstartNodeFinal.parentElement &&\n\t\tstartNodeFinal.parentElement.tagName === \"SPAN\" &&\n\t\tfinalRange.startOffset === 0 &&\n\t\tfinalRange.endOffset === startNodeFinal.textContent.length\n\t) {\n\t\tconst spanParent = startNodeFinal.parentElement;\n\t\tconst classesASupprimer = [\n\t\t\t\"souligne-red\",\n\t\t\t\"souligne-blue\",\n\t\t\t\"souligne-green\",\n\t\t\t\"souligne-yellow\",\n\t\t\t\"souligne-pink\",\n\t\t\t\"souligne-black\",\n\t\t\t\"souligne-purple\",\n\t\t\t\"souligne-orange\",\n\t\t];\n\n\t\tclassesASupprimer.forEach((cls) => spanParent.classList.remove(cls));\n\n\t\tif (couleur !== \"transparent\" && couleur !== \"white\") {\n\t\t\tspanParent.classList.add(`souligne-${couleur}`);\n\t\t}\n\n\t\treturn;\n\t}\n\n\t// Cas normal : extraire caractères avec leurs styles\n\tconst fragment = finalRange.cloneContents();\n\tconst caracteres = extraireCaracteresAvecStyles(fragment);\n\n\tif (caracteres.length === 0) return;\n\n\tconst nouveauFragment = document.createDocumentFragment();\n\tconst classesASupprimer = [\n\t\t\"souligne-red\",\n\t\t\"souligne-blue\",\n\t\t\"souligne-green\",\n\t\t\"souligne-yellow\",\n\t\t\"souligne-pink\",\n\t\t\"souligne-black\",\n\t\t\"souligne-purple\",\n\t\t\"souligne-orange\",\n\t];\n\n\tcaracteres.forEach((car) => {\n\t\t// Si c'est un span .entoure, le garder tel quel\n\t\tif (car.isEntoure) {\n\t\t\tnouveauFragment.appendChild(car.noeud);\n\t\t\treturn;\n\t\t}\n\n\t\tconst span = document.createElement(\"span\");\n\t\tspan.textContent = car.texte;\n\n\t\t// Copier les classes existantes (sauf les soulignements précédents)\n\t\tcar.classes.forEach((cls) => {\n\t\t\tif (!classesASupprimer.includes(cls)) {\n\t\t\t\tspan.classList.add(cls);\n\t\t\t}\n\t\t});\n\n\t\t// Appliquer le nouveau soulignement\n\t\tif (couleur !== \"transparent\" && couleur !== \"white\") {\n\t\t\tspan.classList.add(`souligne-${couleur}`);\n\t\t}\n\n\t\tnouveauFragment.appendChild(span);\n\t});\n\n\tfinalRange.deleteContents();\n\tfinalRange.insertNode(nouveauFragment);\n\n\tfinalRange.collapse(false);\n\tsel.removeAllRanges();\n\tsel.addRange(finalRange);\n\n\t// Boutons\n\tdocument.getElementById(\"souligne\").style.textDecorationColor = couleur;\n\tdocument.getElementById(\"souligne\").value = couleur;\n\n\t// Optimiser les spans après l'opération\n\tnettoyerSpans(editableParent);\n}\n\nexport function update_souligne(distance_soulignage) {\n\tconst texte_principal = document.getElementById(\"texte_principal\");\n\tconst texte_marge = document.getElementById(\"texte_marge\");\n\tconst texte_marge_complementaire = document.getElementById(\n\t\t\"texte_marge_complementaire\"\n\t);\n\tif (texte_principal)\n\t\ttexte_principal.style.textUnderlineOffset = distance_soulignage + \"em\";\n\tif (texte_marge)\n\t\ttexte_marge.style.textUnderlineOffset = distance_soulignage + \"em\";\n\tif (texte_marge_complementaire)\n\t\ttexte_marge_complementaire.style.textUnderlineOffset =\n\t\t\tdistance_soulignage + \"em\";\n}\n","import { souligne } from \"../../text-format/underline.mjs\";\n\nfunction handleSousLigneClick() {\n\tdocument\n\t\t.querySelectorAll(\n\t\t\t\"#boutons_soulignement .deroule-souligne, .deroule-souligne\"\n\t\t)\n\t\t.forEach((btn) => {\n\t\t\tbtn.addEventListener(\"click\", (e) => {\n\t\t\t\tsouligne(e.currentTarget.value);\n\t\t\t});\n\t\t});\n}\n\nlet firstTimeSouligne = true;\n\nexport function ouvreBoutonsSouligne(event) {\n\tif (firstTimeSouligne) {\n\t\thandleSousLigneClick();\n\t\tfirstTimeSouligne = false;\n\t}\n\tif (event) event.stopPropagation();\n\tconst rect = document.getElementById(\"souligne\")\n\t\t? document.getElementById(\"souligne\").getBoundingClientRect()\n\t\t: null;\n\tif (!rect) return;\n\tlet positionLeft = rect.left;\n\tconst el = document.getElementById(\"boutons_soulignement\");\n\tif (!el) return;\n\tel.style.left = positionLeft + \"px\";\n\tel.classList.toggle(\"hide\");\n}\n","import { config } from \"../../config.mjs\";\nimport { texte_principal, inputNombreDeCarreaux } from \"../../utils/dom.mjs\";\n\nexport function calculeNombreDeCarreaux() {\n\t// Largeur de page\n\tconst largeurPage = calculerLargeurTextePrincipal();\n\n\t// Calculer le nombre de carreaux\n\tconfig.nombreDeCarreaux = Math.round(largeurPage / config.largeur_carreau);\n\n\t// Mettre à jour l'inpur\n\tinputNombreDeCarreaux.value = config.nombreDeCarreaux;\n}\n\nexport function calculerLargeurTextePrincipal() {\n\t// Obtenir la largeur totale de l'élément, y compris le padding et les bordures\n\tconst offsetWidth = texte_principal.offsetWidth;\n\n\t// Récupérer les styles calculés de l'élément\n\tconst styles = getComputedStyle(texte_principal);\n\tconst marginLeft = parseFloat(styles.marginLeft);\n\tconst marginRight = parseFloat(styles.marginRight);\n\n\t// Calculer la largeur totale en incluant les marges\n\tconst totalWidth = offsetWidth + marginLeft + marginRight;\n\n\treturn totalWidth;\n}\n","// Objet qui contient les propriétés pour chaque police\nexport const typesPolices = {\n\tArial: {\n\t\tfacteur_taille_police: 0.6,\n\t\tepaisseur_police: \"normal\",\n\t\tcoef_marge: 0.28,\n\t\tcoef_marge_windows: 0.25,\n\t\tdistance_soulignage: 0.3,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\t\"AA Cursive\": {\n\t\tfacteur_taille_police: 0.75,\n\t\tepaisseur_police: \"normal\",\n\t\tcoef_marge: 0.35,\n\t\tcoef_marge_windows: 0.3125,\n\t\tdistance_soulignage: 0.3,\n\t\tligatures: [0, 1],\n\t\tbouton_ligatures_display: null,\n\t},\n\t\"Open Dyslexic\": {\n\t\tfacteur_taille_police: 0.45,\n\t\tepaisseur_police: \"normal\",\n\t\tcoef_marge: 0.35,\n\t\tcoef_marge_windows: 0.35,\n\t\tdistance_soulignage: 0.5,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\t\"Belle Allure CE\": {\n\t\tfacteur_taille_police: 0.6,\n\t\tepaisseur_police: \"bold\",\n\t\tcoef_marge: 0.375,\n\t\tcoef_marge_windows: 0.334821429,\n\t\tdistance_soulignage: 0.38,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\t\"Belle Allure CM\": {\n\t\tfacteur_taille_police: 0.6,\n\t\tepaisseur_police: \"bold\",\n\t\tcoef_marge: 0.375,\n\t\tcoef_marge_windows: 0.334821429,\n\t\tdistance_soulignage: 0.38,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\t\"Belle Allure GS\": {\n\t\tfacteur_taille_police: 0.6,\n\t\tepaisseur_police: \"bold\",\n\t\tcoef_marge: 0.375,\n\t\tcoef_marge_windows: 0.334821429,\n\t\tdistance_soulignage: 0.38,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\t\"Belle Allure script\": {\n\t\tfacteur_taille_police: 0.6,\n\t\tepaisseur_police: \"bold\",\n\t\tcoef_marge: 0.375,\n\t\tcoef_marge_windows: 0.334821429,\n\t\tdistance_soulignage: 0.38,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\tAcceseditionscursive: {\n\t\tfacteur_taille_police: 0.674,\n\t\tepaisseur_police: \"normal\",\n\t\tcoef_marge: 0.272,\n\t\tcoef_marge_windows: 0.242857143,\n\t\tdistance_soulignage: 0.379,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\tLuciole: {\n\t\tfacteur_taille_police: 0.65,\n\t\tepaisseur_police: \"normal\",\n\t\tcoef_marge: 0.29,\n\t\tcoef_marge_windows: 0.258928572,\n\t\tdistance_soulignage: 0.379,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n\tRomain: {\n\t\tfacteur_taille_police: 0.8,\n\t\tepaisseur_police: \"bold\",\n\t\tcoef_marge: 0.3,\n\t\tcoef_marge_windows: 0.334821429,\n\t\tdistance_soulignage: 0.38,\n\t\tligatures: [1, 0],\n\t\tbouton_ligatures_display: \"none\",\n\t},\n};\n","import { config } from \"../../config.mjs\";\nimport { divMarge, margeSecondaire, page } from \"../../utils/dom.mjs\";\n\nexport function imprimer() {\n\twindow.print();\n}\n\nexport function majDimensionsPrint() {\n\tconfig.largeur_page = page.offsetWidth;\n\tconfig.largeur_marge = divMarge.offsetWidth;\n\tconfig.largeur_marge_secondaire = margeSecondaire.offsetWidth;\n\tconfig.largeur_page_impression =\n\t\t(config.largeur_page / config.largeur_carreau) *\n\t\tconfig.largeurImpression *\n\t\t4;\n\tconfig.largeur_marge_impression =\n\t\t(config.largeur_marge / config.largeur_carreau) *\n\t\tconfig.largeurImpression *\n\t\t4;\n\tconfig.largeur_marge_secondaire_impression =\n\t\t(config.largeur_marge_secondaire / config.largeur_carreau) *\n\t\tconfig.largeurImpression *\n\t\t4;\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-page-impression\",\n\t\tconfig.largeur_page_impression + \"mm\"\n\t);\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge-impression\",\n\t\tconfig.largeur_marge_impression + \"mm\"\n\t);\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge2-impression\",\n\t\tconfig.largeur_margesecondaire_impression + \"mm\"\n\t);\n}\n","import { calculeNombreDeCarreaux } from \"../layout/getSize.mjs\";\nimport { config } from \"../../config.mjs\";\nimport {\n\tgraphismes,\n\tmarge,\n\tmargeSecondaire,\n\tpage,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../../utils/dom.mjs\";\nimport { typesPolices } from \"../../text-format/fonts/font-params.mjs\";\nimport { stocke } from \"../../settings/read-write.mjs\";\nimport { majDimensionsPrint } from \"../display/print.mjs\";\nimport { ajusterScroll } from \"./adjustScroll.mjs\";\n\nlet calc_marge;\n\nexport function zoom(coef, largeur, police) {\n\t// Mise à jour de la largeur et de la taille de police\n\tconfig.largeur_carreau_old = config.largeur_carreau;\n\n\tif (coef) {\n\t\tconfig.largeur_carreau = config.largeur_carreau + coef;\n\t} else if (largeur) {\n\t\tconfig.largeur_carreau = largeur;\n\t}\n\n\tlet coefAgrandissement = config.largeur_carreau / config.largeur_carreau_old;\n\n\t// Ajuster le scroll\n\tif (coef) {\n\t\tajusterScroll(coefAgrandissement);\n\t}\n\n\t// Calculs supplémentaires pour la police et les marges\n\tlet largeur_carreau_impression = config.largeurImpression * 4;\n\tconfig.taille_police = config.largeur_carreau * config.facteur_taille_police;\n\tlet taille_police_impression =\n\t\tlargeur_carreau_impression * config.facteur_taille_police;\n\n\ttexte_principal.style.fontWeight = config.epaisseur_police;\n\ttexte_marge.style.fontWeight = config.epaisseur_police;\n\ttexte_marge_complementaire.style.fontWeight = config.epaisseur_police;\n\n\tlet calc_marge_impression;\n\tif (config.isWindows) {\n\t\tcalc_marge = config.largeur_carreau * config.coef_marge_windows;\n\t\tcalc_marge_impression =\n\t\t\tlargeur_carreau_impression * config.coef_marge_windows;\n\t} else {\n\t\tcalc_marge = config.largeur_carreau * config.coef_marge;\n\t\tcalc_marge_impression = largeur_carreau_impression * config.coef_marge;\n\t}\n\n\tif (police === \"Open Dyslexic\") {\n\t\tcalc_marge = calc_marge * 0.9;\n\t}\n\n\tpage.style.backgroundSize = config.largeur_carreau + \"px\";\n\tmarge.style.backgroundSize = config.largeur_carreau + \"px\";\n\tmargeSecondaire.style.backgroundSize = config.largeur_carreau + \"px\";\n\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-carreau-impression\",\n\t\t`${largeur_carreau_impression}mm`\n\t);\n\ttexte_principal.style.fontSize = config.taille_police + \"px\";\n\tdocument.documentElement.style.setProperty(\n\t\t\"--taille-police-impression\",\n\t\t`${taille_police_impression}mm`\n\t);\n\ttexte_principal.style.marginLeft = config.largeur_carreau / 5 + \"px\";\n\ttexte_principal.style.marginRight = config.largeur_carreau / 5 + \"px\";\n\ttexte_marge.style.fontSize = texte_marge_complementaire.style.fontSize =\n\t\tconfig.taille_police + \"px\";\n\ttexte_marge.style.marginTop = texte_marge_complementaire.style.marginTop =\n\t\tcalc_marge + \"px\";\n\ttexte_marge.style.marginLeft = texte_marge_complementaire.style.marginLeft =\n\t\tconfig.largeur_carreau / 5 + \"px\";\n\ttexte_marge.style.marginRight = texte_marge_complementaire.style.marginRight =\n\t\tconfig.largeur_carreau / 5 + \"px\";\n\tdocument.documentElement.style.setProperty(\n\t\t\"--marge-impression\",\n\t\t`${largeur_carreau_impression / 5}mm`\n\t);\n\n\t// Ajustement de l'interligne et des marges\n\tif (\n\t\tconfig.typeCarreaux === \"terre\" ||\n\t\tconfig.typeCarreaux === \"bleuviolet\" ||\n\t\tconfig.typeCarreaux === \"trois_couleurs\" ||\n\t\tconfig.typeCarreaux === \"quatre_couleurs\" ||\n\t\tconfig.interligneDouble\n\t) {\n\t\ttexte_marge.style.lineHeight = 2 * config.largeur_carreau + \"px\";\n\t\ttexte_principal.style.lineHeight = 2 * config.largeur_carreau + \"px\";\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--hauteur-ligne-impression\",\n\t\t\t`${2 * largeur_carreau_impression}mm`\n\t\t);\n\t\ttexte_principal.style.marginTop = -(calc_marge / 3) + \"px\";\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--marge-top-impression\",\n\t\t\t`${-calc_marge_impression / 3}mm`\n\t\t);\n\t} else {\n\t\ttexte_marge_complementaire.style.lineHeight = texte_marge.style.lineHeight =\n\t\t\tconfig.largeur_carreau + \"px\";\n\t\ttexte_principal.style.lineHeight = config.largeur_carreau + \"px\";\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--hauteur-ligne-impression\",\n\t\t\t`${largeur_carreau_impression}mm`\n\t\t);\n\t\ttexte_principal.style.marginTop = calc_marge + \"px\";\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--marge-top-impression\",\n\t\t\t`${calc_marge_impression}mm`\n\t\t);\n\t}\n\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge-secondaire\",\n\t\tconfig.largeur_carreau * 2.7 + \"px\"\n\t);\n\n\t// Mise à jour des éléments de texte personnalisés\n\tconst tousLesSpanCustomFont = document.querySelectorAll(\".customfont\");\n\ttousLesSpanCustomFont.forEach((span) => {\n\t\t// Utilisation de getComputedStyle pour récupérer la propriété fontFamily réelle\n\t\tlet policeCustom = getComputedStyle(span).fontFamily.trim(); // trim() pour éviter les espaces indésirables\n\t\tlet facteurCustom = typesPolices[policeCustom]\n\t\t\t? typesPolices[policeCustom].facteur_taille_police\n\t\t\t: null; // Utilisation de la clé policeCustom dans l'objet typesPolices\n\n\t\tif (facteurCustom) {\n\t\t\tspan.style.fontSize = span.style.lineHeight =\n\t\t\t\tconfig.largeur_carreau * facteurCustom + \"px\";\n\t\t} else {\n\t\t\tconsole.warn(\n\t\t\t\t`La police ${policeCustom} n'a pas été trouvée dans l'objet typesPolices.`\n\t\t\t);\n\t\t}\n\t});\n\n\t// Adaptation des graphismes\n\tconst tousLesGraphismes = graphismes.querySelectorAll(\".trait\");\n\ttousLesGraphismes.forEach((graphisme) => {\n\t\tgraphisme.style.transition = \"none \";\n\n\t\tlet computedStyle = window.getComputedStyle(graphisme);\n\n\t\tlet positionX = parseInt(\n\t\t\tparseFloat(computedStyle.getPropertyValue(\"left\")) /\n\t\t\t\tconfig.largeur_carreau_old\n\t\t);\n\t\tlet positionY = parseInt(\n\t\t\tparseFloat(computedStyle.getPropertyValue(\"top\")) /\n\t\t\t\tconfig.largeur_carreau_old\n\t\t);\n\t\tlet width = parseInt(\n\t\t\tparseFloat(computedStyle.getPropertyValue(\"width\")) /\n\t\t\t\tconfig.largeur_carreau_old\n\t\t);\n\t\tlet height = parseInt(\n\t\t\tparseFloat(computedStyle.getPropertyValue(\"height\")) /\n\t\t\t\tconfig.largeur_carreau_old\n\t\t);\n\n\t\t// Vérifie que les valeurs ne sont pas NaN\n\t\tif (isNaN(positionX)) positionX = 0;\n\t\tif (isNaN(positionY)) positionY = 0;\n\t\tif (isNaN(width)) width = 0;\n\t\tif (isNaN(height)) height = 0;\n\n\t\t// Ajustement de 'left' et 'top' en fonction de la proportion unique\n\t\tlet newPositionX = positionX * config.largeur_carreau;\n\t\tlet newPositionY = positionY * config.largeur_carreau;\n\n\t\t// Applique les nouvelles valeurs de 'left' et 'top' à l'élément\n\t\tgraphisme.style.left = `${newPositionX}px`;\n\t\tgraphisme.style.top = `${newPositionY}px`;\n\n\t\t// Ajustement de la largeur et hauteur des éléments graphiques\n\t\tif (graphisme.classList.contains(\"horizontal\")) {\n\t\t\tlet newWidth =\n\t\t\t\twidth * config.largeur_carreau + config.largeur_carreau * 0.02117171;\n\t\t\tgraphisme.style.width = `${newWidth}px`;\n\t\t}\n\n\t\tif (graphisme.classList.contains(\"vertical\")) {\n\t\t\tlet newHeight =\n\t\t\t\theight * config.largeur_carreau + config.largeur_carreau * 0.02117171;\n\t\t\tgraphisme.style.height = `${newHeight}px`;\n\t\t}\n\n\t\tgraphisme.style.transition = \"\";\n\t});\n\n\tmajDimensionsPrint();\n\tupdateTransform();\n\tcalculeNombreDeCarreaux();\n\tstocke(\"largeur-carreau\", config.largeur_carreau);\n}\n\n// Fonction pour modifier la position\nfunction updateTransform() {\n\tdocument.documentElement.style.setProperty(\n\t\t\"--decalage-depart\",\n\t\t-config.largeur_carreau * 0.02117171 + \"px\"\n\t);\n\tdocument.documentElement.style.setProperty(\n\t\t\"--decalage-position\",\n\t\t-2 - config.largeur_carreau * 0.02117171 + \"px\"\n\t);\n}\n","import { divContenu, texte_principal } from \"../../utils/dom.mjs\";\n\nexport function ajusterScroll(coefAgrandissement) {\n\t// Hauteur du texte avant zoom\n\tlet hauteurTexte = texte_principal.scrollHeight;\n\tlet hauteurPage = divContenu.clientHeight;\n\tlet scrollDebut = divContenu.scrollTop;\n\n\t// Si tout le texte tient dans l'écran, on remet le scroll en haut.\n\tif (hauteurTexte * coefAgrandissement <= hauteurPage) {\n\t\tdivContenu.scrollTop = 0;\n\t\treturn;\n\t}\n\n\t// Calcul de la position relative du centre de l'écran dans le texte (entre 0 et 1)\n\tlet positionRelative = (scrollDebut + hauteurPage / 2) / hauteurTexte;\n\n\t// Nouvelle hauteur du texte après zoom\n\tlet hauteurTexteApresZoom = hauteurTexte * coefAgrandissement;\n\n\t// Nouvelle position après zoom (toujours centrée au même endroit)\n\tlet nouveauScroll =\n\t\tpositionRelative * hauteurTexteApresZoom - hauteurPage / 2;\n\n\t// Correction progressive pour éviter l'effet d'écrasement en bas\n\tlet correctif = Math.pow(coefAgrandissement, 1.2); // Ajustement plus progressif en bas\n\n\tnouveauScroll *= correctif;\n\n\t// Sécurité : on s'assure que le scroll reste dans les limites valides\n\tnouveauScroll = Math.max(\n\t\t0,\n\t\tMath.min(nouveauScroll, hauteurTexteApresZoom - hauteurPage)\n\t);\n\n\t// Application du scroll\n\tdivContenu.scrollTop = nouveauScroll;\n}\n","import { config } from \"../../config.mjs\";\nimport {\n\tcase2,\n\tcase3,\n\tdivMarge,\n\tdivMargeEntete,\n\tpage,\n} from \"../../utils/dom.mjs\";\nimport { stocke } from \"../../settings/read-write.mjs\";\nimport { majDimensionsPrint } from \"../display/print.mjs\";\n\nexport function adapteMargeCahierDeTexte(valeur = 0) {\n\tconfig.largeur_marge = config.largeur_carreau * valeur;\n\tpage.style.width = case3.style.width =\n\t\t\"calc(100% - \" + config.largeur_marge + \"px)\";\n\tdivMarge.style.width = config.largeur_marge - 3 + \"px\";\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge-impression\",\n\t\tconfig.largeur_marge - 3 + \"mm\"\n\t);\n\n\tdivMargeEntete.style.width = config.largeur_marge + \"px\";\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge-secondaire\",\n\t\tconfig.largeur_carreau * 2.7 + \"px\"\n\t);\n\tdocument.documentElement.style.setProperty(\n\t\t\"--largeur-marge2-impression\",\n\t\tconfig.largeur_carreau * 2.7 + \"mm\"\n\t);\n}\n\n// Règle la largeur de la marge principale\nexport function regleMarge(largeur) {\n\tconfig.largeur_marge = largeur;\n\tpage.style.width = case3.style.width = `calc(100% - ${largeur}px)`;\n\tdivMarge.style.width = `${largeur - 3}px`;\n\tdivMargeEntete.style.width = `${largeur}px`;\n\tstocke(\"largeur-marge\", config.largeur_marge);\n\tmajDimensionsPrint();\n}\n\n// Règle la largeur de la marge secondaire\nexport function regleMargeSecondaire(largeur) {\n\tif (largeur >= 3) {\n\t\tconfig.largeur_marge_secondaire = largeur;\n\t\tconfig.margeSecondaire.style.width = case2.style.width = `${largeur - 3}px`;\n\t\tstocke(\"largeur-marge-secondaire\", config.largeur_marge_secondaire);\n\t\tmajDimensionsPrint();\n\t}\n}\n","import { config } from \"../../config.mjs\";\nimport { zoom } from \"../zoom/zoom.mjs\";\nimport { stocke } from \"../../settings/read-write.mjs\";\nimport {\n\tdivEntete,\n\tpage,\n\tdivMarge,\n\tmarge,\n\tmargeSecondaire,\n} from \"../../utils/dom.mjs\";\nimport { adapteMargeCahierDeTexte } from \"../layout/margin-manager.mjs\";\n\nexport function changeCarreaux(type) {\n\tlet ancienTypeCareaux = config.typeCarreaux;\n\n\tconfig.typeCarreaux = type;\n\tif (config.typeCarreaux) {\n\t\tmarge.style.backgroundImage =\n\t\t\t\"url('./images/carreau_marge_\" + config.typeCarreaux + \".svg\";\n\t\tmargeSecondaire.style.backgroundImage =\n\t\t\t\"url('./images/carreau_marge_\" + config.typeCarreaux + \".svg\";\n\n\t\tpage.style.backgroundImage =\n\t\t\t\"url('./images/carreau_\" + config.typeCarreaux + \".svg\";\n\t\tdocument.getElementById(\n\t\t\t\"carreaux\"\n\t\t).style.backgroundImage = `url(./images/carreau_${type}.svg`;\n\t}\n\tif (type === \"terre\") {\n\t\tpage.style.borderLeft = \"none\";\n\t} else {\n\t\tpage.style.borderLeft = null;\n\t}\n\tif (type === \"cahier_de_textes\") {\n\t\tmargeSecondaire.style.display = \"block\";\n\t\tadapteMargeCahierDeTexte(7);\n\t\tdivMarge.style.borderRightColor = \"#000000\";\n\t\tdivEntete.style.display = \"flex\";\n\t} else {\n\t\tmargeSecondaire.style.display = null;\n\t\tdivEntete.style.display = \"none\";\n\t\tif (ancienTypeCareaux === \"cahier_de_textes\") {\n\t\t\tadapteMargeCahierDeTexte(4);\n\t\t}\n\t\tdivMarge.style.borderRightColor = null;\n\t}\n\tzoom(0, false, config.police_active);\n\tstocke(\"type-carreaux\", config.typeCarreaux);\n}\n","import { get } from \"../../utils/dom.mjs\";\nimport { changeCarreaux } from \"../../ui/layout/background.mjs\";\n\nfunction ajouterBackgroundImages() {\n\t// Sélectionner tous les boutons dans la div boutons_soulignement\n\tconst boutons = document.querySelectorAll(\"#boutons_soulignement button\");\n\n\t// Parcourir chaque bouton\n\tboutons.forEach((bouton) => {\n\t\t// Récupérer l'ID du bouton\n\t\tconst boutonId = bouton.id;\n\n\t\t// Construire l'URL de l'image en fonction de l'ID du bouton\n\t\tconst imageUrl = `./images/${boutonId}.svg`;\n\n\t\t// Appliquer le background-image au bouton\n\t\tbouton.style.backgroundImage = `url('${imageUrl}')`;\n\t});\n\n\t// Sélectionner tous les boutons dans la div boutons_soulignement\n\tconst boutonsCarreau = document.querySelectorAll(\n\t\t\"#boutons_carreaux button:not(.bouton-fermer)\"\n\t);\n\n\t// Parcourir chaque bouton\n\tboutonsCarreau.forEach((bouton) => {\n\t\t// Récupérer l'ID du bouton\n\t\tconst boutonId = bouton.id;\n\n\t\t// Construire l'URL de l'image en fonction de l'ID du bouton\n\t\tlet imageUrl = `./images/${boutonId}.svg`;\n\t\t// Appliquer le background-image au bouton\n\t\tif (imageUrl === \"./images/carreau_cahier_de_textes.svg\") {\n\t\t\timageUrl = \"./images/cahier_de_textes.svg\";\n\t\t}\n\t\tbouton.style.backgroundImage = `url('${imageUrl}')`;\n\t});\n}\n\nfunction initChooseTilesPanel() {\n\tajouterBackgroundImages();\n\n\tconst carreauMap = {\n\t\tcarreau_seyes: \"seyes\",\n\t\tcarreau_seyes_noir: \"seyes_noir\",\n\t\tcarreau_seyes_gris: \"seyes_gris\",\n\t\tcarreau_ligne_base: \"ligne_base\",\n\t\tcarreau_simple_ligne: \"simple_ligne\",\n\t\tcarreau_double_ligne: \"double_ligne\",\n\t\tcarreau_petit: \"petit\",\n\t\tcarreau_terre: \"terre\",\n\t\tcarreau_trois_couleurs: \"trois_couleurs\",\n\t\tcarreau_quatre_couleurs: \"quatre_couleurs\",\n\t\tcarreau_bleuviolet: \"bleuviolet\",\n\t\tcarreau_cahier_de_textes: \"cahier_de_textes\",\n\t};\n\tObject.keys(carreauMap).forEach((id) => {\n\t\tconst b = get(id);\n\t\tif (b)\n\t\t\tb.addEventListener(\"click\", () => {\n\t\t\t\tchangeCarreaux(carreauMap[id]);\n\t\t\t});\n\t});\n\n\tconst closeCarreaux = document.querySelector(\n\t\t\"#boutons_carreaux .bouton-fermer\"\n\t);\n\tif (closeCarreaux)\n\t\tcloseCarreaux.addEventListener(\"click\", () => {\n\t\t\tconst el = document.getElementById(\"boutons_carreaux\");\n\t\t\tif (el) el.classList.add(\"hide\");\n\t\t});\n}\n\nlet firstTime = true;\n\nexport function ouvreBoutonsCarreau() {\n\tif (firstTime) {\n\t\tinitChooseTilesPanel();\n\t\tfirstTime = false;\n\t}\n\tconst rect = document.getElementById(\"carreaux\").getBoundingClientRect();\n\tlet positionLeft = rect.left;\n\tdocument.getElementById(\"boutons_carreaux\").style.left = positionLeft + \"px\";\n\tdocument.getElementById(\"boutons_carreaux\").classList;\n\tdocument.getElementById(\"boutons_carreaux\").classList.toggle(\"hide\");\n}\n","import { divContenu, images } from \"../../utils/dom.mjs\";\n\nexport function reaffecteEventsImages() {\n\tconst images = document.getElementById(\"images\");\n\tif (!images) return;\n\tlet imagesATraiter = images.querySelectorAll(\".conteneur-image\");\n\n\timagesATraiter.forEach((conteneurImage) => {\n\t\tlet boutonSupprimer = conteneurImage.querySelector(\n\t\t\t\".bouton-supprimer-image\"\n\t\t);\n\t\tlet boutonCadre = conteneurImage.querySelector(\".bouton-cadre-image\");\n\n\t\tconteneurImage.addEventListener(\"click\", function () {\n\t\t\tconteneurImage.classList.add(\"selectionne\");\n\t\t});\n\n\t\tif (boutonSupprimer)\n\t\t\tboutonSupprimer.addEventListener(\"click\", function () {\n\t\t\t\tconteneurImage.remove();\n\t\t\t});\n\n\t\tif (boutonCadre)\n\t\t\tboutonCadre.addEventListener(\"click\", function () {\n\t\t\t\tconteneurImage.classList.toggle(\"encadre\");\n\t\t\t});\n\t});\n}\n\nexport function cree_image(event) {\n\tlet input = event.target;\n\tlet nouvelle_image = new Image();\n\n\tif (input.files && input.files[0]) {\n\t\tvar reader = new FileReader();\n\n\t\treader.onload = function (e) {\n\t\t\tnouvelle_image.onload = function () {\n\t\t\t\tlet ratio = nouvelle_image.naturalWidth / nouvelle_image.naturalHeight;\n\n\t\t\t\tif (ratio > 1) {\n\t\t\t\t\t// Image plus large que haute : on fixe la largeur à 400px\n\t\t\t\t\tnouvelle_image.style.width = \"400px\";\n\t\t\t\t} else {\n\t\t\t\t\t// Image plus haute que large : on fixe la hauteur à 400px\n\t\t\t\t\tnouvelle_image.style.height = \"400px\";\n\t\t\t\t}\n\t\t\t};\n\t\t\tnouvelle_image.src = e.target.result;\n\t\t};\n\n\t\treader.readAsDataURL(input.files[0]);\n\t}\n\n\tlet nouveauConteneurImage = document.createElement(\"div\");\n\tnouveauConteneurImage.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.classList.add(\"selectionne\");\n\t});\n\tnouveauConteneurImage.style.top = `${\n\t\tdivContenu.scrollTop + document.body.clientHeight / 2\n\t}px`;\n\tnouveauConteneurImage.classList.add(\"draggable\", \"conteneur-image\");\n\tnouvelle_image.classList.add(\"image\");\n\tnouveauConteneurImage.appendChild(nouvelle_image);\n\n\tlet boutonSupprimer = document.createElement(\"button\");\n\tboutonSupprimer.title = \"Supprimer\";\n\tboutonSupprimer.classList.add(\"bouton-supprimer-image\");\n\tboutonSupprimer.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.remove();\n\t});\n\n\tnouveauConteneurImage.appendChild(boutonSupprimer);\n\n\tlet boutonCadre = document.createElement(\"button\");\n\tboutonCadre.title = \"Bordure\";\n\tboutonCadre.classList.add(\"bouton-cadre-image\");\n\tboutonCadre.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.classList.toggle(\"encadre\");\n\t});\n\n\tnouveauConteneurImage.appendChild(boutonCadre);\n\n\tlet poigneeNO = document.createElement(\"div\");\n\tpoigneeNO.classList.add(\"poignee\", \"nw\");\n\n\tlet poigneeNE = document.createElement(\"div\");\n\tpoigneeNE.classList.add(\"poignee\", \"ne\");\n\n\tlet poigneeSO = document.createElement(\"div\");\n\tpoigneeSO.classList.add(\"poignee\", \"sw\");\n\n\tlet poigneeSE = document.createElement(\"div\");\n\tpoigneeSE.classList.add(\"poignee\", \"se\");\n\n\tnouveauConteneurImage.appendChild(poigneeNO);\n\tnouveauConteneurImage.appendChild(poigneeNE);\n\tnouveauConteneurImage.appendChild(poigneeSO);\n\tnouveauConteneurImage.appendChild(poigneeSE);\n\n\timages.appendChild(nouveauConteneurImage);\n}\n","export function cree_timer() {\n\tconst images = document.getElementById(\"images\");\n\tconst divContenu = document.getElementById(\"contenu\");\n\tconst body = document.body;\n\tlet timer = document.createElement(\"iframe\");\n\ttimer.src = \"https://educajou.forge.apps.education.fr/tuxtimer/\";\n\n\tlet nouveauConteneurImage = document.createElement(\"div\");\n\tnouveauConteneurImage.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.classList.add(\"selectionne\");\n\t});\n\tnouveauConteneurImage.style.top = `${\n\t\tdivContenu.scrollTop + body.clientHeight / 2\n\t}px`;\n\tnouveauConteneurImage.classList.add(\"draggable\", \"conteneur-image\");\n\ttimer.classList.add(\"timer\");\n\tnouveauConteneurImage.appendChild(timer);\n\n\tlet boutonSupprimer = document.createElement(\"button\");\n\tboutonSupprimer.title = \"Supprimer\";\n\tboutonSupprimer.classList.add(\"bouton-supprimer-image\");\n\tboutonSupprimer.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.remove();\n\t});\n\n\tnouveauConteneurImage.appendChild(boutonSupprimer);\n\n\tlet boutonCadre = document.createElement(\"button\");\n\tboutonCadre.title = \"Bordure\";\n\tboutonCadre.classList.add(\"bouton-cadre-image\");\n\tboutonCadre.addEventListener(\"click\", function () {\n\t\tnouveauConteneurImage.classList.toggle(\"encadre\");\n\t});\n\n\tnouveauConteneurImage.appendChild(boutonCadre);\n\n\t[\"nw\", \"ne\", \"sw\", \"se\"].forEach((pos) => {\n\t\tlet poignee = document.createElement(\"div\");\n\t\tpoignee.classList.add(\"poignee\", pos);\n\t\tnouveauConteneurImage.appendChild(poignee);\n\t});\n\n\tif (images) images.appendChild(nouveauConteneurImage);\n}\n","import { config } from \"../../config.mjs\";\nimport { page, barre } from \"../../utils/dom.mjs\";\n\nexport function activeRegle() {\n\tconfig.regleActive = !config.regleActive;\n\tpage.classList.toggle(\"trace\");\n\tbarre.classList.toggle(\"trace\");\n\tdocument.getElementById(\"regle\").classList.toggle(\"trace\");\n\n\tif (!config.regleActive) {\n\t\tpage.style.cursor = null;\n\t}\n}\n\nexport function changeCouleurTrait(couleur) {\n\tif (config.selected) {\n\t\tconfig.selected.style.backgroundColor = couleur;\n\t\tconfig.selected.classList.remove(\"select\");\n\t\tconfig.selected = null;\n\t} else {\n\t\talert(\"Aucun trait n'est sélectionné.\");\n\t}\n}\n","// ========================================\n// DICTIONNAIRE DE COMPRESSION\n// ========================================\nconst COMPRESSION_MAP = {\n\t// Soulignements\n\t\"souligne-red\": \"§r\",\n\t\"souligne-blue\": \"§b\",\n\t\"souligne-green\": \"§g\",\n\t\"souligne-yellow\": \"§y\",\n\t\"souligne-pink\": \"§p\",\n\t\"souligne-black\": \"§k\",\n\t\"souligne-purple\": \"§u\",\n\t\"souligne-orange\": \"§o\",\n\n\t// Couleurs\n\t\"couleur-red\": \"¤r\",\n\t\"couleur-coral\": \"¤cr\",\n\t\"couleur-salmon\": \"¤s\",\n\t\"couleur-orange\": \"¤o\",\n\t\"couleur-gold\": \"¤gd\",\n\t\"couleur-yellow\": \"¤y\",\n\t\"couleur-lime\": \"¤l\",\n\t\"couleur-green\": \"¤g\",\n\t\"couleur-olive\": \"¤ol\",\n\t\"couleur-teal\": \"¤t\",\n\t\"couleur-cyan\": \"¤c\",\n\t\"couleur-blue\": \"¤b\",\n\t\"couleur-navy\": \"¤n\",\n\t\"couleur-indigo\": \"¤i\",\n\t\"couleur-purple\": \"¤p\",\n\t\"couleur-magenta\": \"¤m\",\n\t\"couleur-pink\": \"¤pk\",\n\t\"couleur-beige\": \"¤be\",\n\t\"couleur-brown\": \"¤br\",\n\t\"couleur-gray\": \"¤gr\",\n\t\"couleur-silver\": \"¤sv\",\n\t\"couleur-black\": \"¤bk\",\n\t\"couleur-white\": \"¤w\",\n\n\t// Autres\n\tentoure: \"◆\",\n};\n\n// Reverse map pour décompression\nconst DECOMPRESSION_MAP = Object.fromEntries(\n\tObject.entries(COMPRESSION_MAP).map(([k, v]) => [v, k])\n);\n\n// ========================================\n// COMPRESSION : HTML → SHORTCODES\n// ========================================\nexport function compresserHTML(html) {\n\tlet resultat = html;\n\n\t// Remplacer les spans avec classes par des shortcodes\n\t// Format: <span class=\"classe1 classe2\">texte</span> → $classe1!classe2!texte$\n\n\tresultat = resultat.replace(\n\t\t/<span class=\"([^\"]*)\">([^<]*)<\\/span>/g,\n\t\t(match, classes, texte) => {\n\t\t\tconst classList = classes.split(\" \").filter((c) => c);\n\t\t\tconst classesComprimees = classList\n\t\t\t\t.map((c) => COMPRESSION_MAP[c] || c)\n\t\t\t\t.join(\"!\");\n\n\t\t\treturn `$${classesComprimees}!${texte}$`;\n\t\t}\n\t);\n\n\t// Remplacer les spans .entoure (qui peuvent contenir d'autres spans)\n\tresultat = resultat.replace(\n\t\t/<span class=\"entoure\">([^]*?)<\\/span>/g,\n\t\t(match, contenu) => {\n\t\t\tconst contenuComprime = compresserHTML(contenu);\n\t\t\treturn `◆${contenuComprime}◆`;\n\t\t}\n\t);\n\n\treturn resultat;\n}\n\n// ========================================\n// DÉCOMPRESSION : SHORTCODES → HTML\n// ========================================\nexport function decompresserHTML(comprime) {\n\tlet resultat = comprime;\n\n\t// Décompresser les shortcodes en spans\n\t// Format: $classe1!classe2!texte$ → <span class=\"classe1 classe2\">texte</span>\n\n\tresultat = resultat.replace(/\\$([^$]*)\\$/g, (match, contenu) => {\n\t\tconst parties = contenu.split(\"!\");\n\t\tconst texte = parties[parties.length - 1];\n\t\tconst shortcodes = parties.slice(0, -1);\n\n\t\tconst classes = shortcodes\n\t\t\t.map((code) => DECOMPRESSION_MAP[code] || code)\n\t\t\t.filter((c) => c)\n\t\t\t.join(\" \");\n\n\t\tif (classes) {\n\t\t\treturn `<span class=\"${classes}\">${texte}</span>`;\n\t\t}\n\t\treturn texte;\n\t});\n\n\t// Décompresser les spans .entoure\n\tresultat = resultat.replace(/◆([^]*?)◆/g, (match, contenu) => {\n\t\tconst contenuDecomprime = decompresserHTML(contenu);\n\t\treturn `<span class=\"entoure\">${contenuDecomprime}</span>`;\n\t});\n\n\treturn resultat;\n}\n","import { config } from \"../config.mjs\";\nimport { compresserHTML } from \"./compression.mjs\";\nimport {\n\tferme,\n\tdarkbox,\n\tdivContenu,\n\tgraphismes,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n\tzone_lien,\n\tzone_menu_copie_lien,\n} from \"../utils/dom.mjs\";\nimport { nettoyerSpans } from \"../text-format/helpers.mjs\";\n\nfunction initCloseCopyLinkMenu() {\n\tconst fermeCopie = document.getElementById(\"ferme_menu_copie_lien\");\n\tif (fermeCopie)\n\t\tfermeCopie.addEventListener(\"click\", () => {\n\t\t\tif (zone_menu_copie_lien) ferme(zone_menu_copie_lien);\n\t\t\telse {\n\t\t\t\tconst el = document.getElementById(\"zone_menu_copie_lien\");\n\t\t\t\tif (el) el.classList.add(\"hide\");\n\t\t\t}\n\t\t});\n}\n\nlet firstTimeCopierLien = true;\n\nexport function menu_copier_lien() {\n\tif (firstTimeCopierLien) {\n\t\tinitCloseCopyLinkMenu();\n\t\tfirstTimeCopierLien = false;\n\t}\n\tmajLien();\n\tzone_menu_copie_lien.classList.toggle(\"hide\");\n\tif (!zone_menu_copie_lien.classList.contains(\"hide\")) {\n\t\tdarkbox.classList.remove(\"hide\");\n\t}\n}\n\nfunction majLien() {\n\t// Base URL (tu peux la modifier selon tes besoins)\n\tlet baseURL =\n\t\twindow.location.protocol +\n\t\t\"//\" +\n\t\twindow.location.host +\n\t\twindow.location.pathname +\n\t\t\"?\";\n\tif (window.widget) {\n\t\tbaseURL = \"https://educajou.forge.apps.education.fr/seyes?\";\n\t}\n\n\t// Construction des paramètres de l'URL en encodant les contenus des textes et les variables globales\n\tconst params = new URLSearchParams({\n\t\tmarge: texte_marge ? texte_marge.innerHTML : \"\",\n\t\t\"marge-secondaire\": texte_marge_complementaire\n\t\t\t? texte_marge_complementaire.innerHTML\n\t\t\t: \"\",\n\t\tpolice: config.police_active || \"\",\n\t\t\"largeur-carreau\": config.largeur_carreau || \"\",\n\t\t\"type-carreaux\": config.typeCarreaux || \"\",\n\t\t\"opacite-lignes\": config.opaciteLignes || \"\",\n\t\t\"largeur-marge\": config.largeur_marge || 0,\n\t\t\"largeur-marge-secondaire\": config.largeur_marge_secondaire || 0,\n\t\t\"interligne-double\": config.interligneDouble || \"\",\n\t\t\"verifier-orthographe\": config.verifierOrthographe || false,\n\t\t\"ecrire-a-cheval\": config.ecrireAChevalSurLaMarge || false,\n\t\tlang: config.langueChoix,\n\t\t\"maj-date-auto\": config.majDateAuto,\n\t});\n\n\tnettoyerSpans(texte_principal);\n\n\t// Encodage du texte principal et des graphismes dans un seul hash, séparés par \"|_|\"\n\tconst hash =\n\t\tencodeURIComponent(compresserHTML(texte_principal.innerHTML)) +\n\t\t\"|_|\" +\n\t\tencodeURIComponent(compresserHTML(graphismes.innerHTML));\n\n\t// Construction du lien final avec le hash pour le texte principal\n\tconst lienFinal = baseURL + params.toString() + \"#\" + hash;\n\n\tzone_lien.innerText = lienFinal;\n}\n\n// Fonction pour copier le lien et afficher un popup\nexport function copier() {\n\t// Récupération du contenu de la zone de lien\n\tconst zoneLien = document.getElementById(\"zone_lien\");\n\tconst texteLien = zoneLien.innerText;\n\n\t// Copie du texte dans le presse-papiers\n\tnavigator.clipboard\n\t\t.writeText(texteLien)\n\t\t.then(() => {\n\t\t\t// Création du popup \"Lien copié\"\n\t\t\tconst popup = document.createElement(\"div\");\n\t\t\tpopup.innerHTML = \"Lien copié\";\n\t\t\tpopup.style.position = \"fixed\";\n\t\t\tpopup.style.backgroundColor = \"black\";\n\t\t\tpopup.style.color = \"white\";\n\t\t\tpopup.style.fontSize = \"12px\";\n\t\t\tpopup.style.padding = \"5px 10px\";\n\t\t\tpopup.style.borderRadius = \"5px\";\n\t\t\tpopup.style.zIndex = \"2000\";\n\t\t\tpopup.style.opacity = \"0\";\n\t\t\tpopup.style.transition = \"opacity 0.3s\";\n\n\t\t\t// Position du popup près du bouton \"copier\"\n\t\t\tconst bouton = document.getElementById(\"copier\");\n\t\t\tconst rect = bouton.getBoundingClientRect();\n\t\t\tpopup.style.left = rect.left + window.scrollX + \"px\";\n\t\t\tpopup.style.top = rect.top + window.scrollY - 30 + \"px\"; // 30px au-dessus du bouton\n\n\t\t\t// Ajout du popup au document\n\t\t\tdivContenu.appendChild(popup);\n\n\t\t\t// Faire apparaître le popup\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup.style.opacity = \"1\";\n\t\t\t}, 10);\n\n\t\t\t// Faire disparaître le popup après 2 secondes\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup.style.opacity = \"0\";\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdivContenu.removeChild(popup);\n\t\t\t\t}, 300); // Retire le popup du DOM après la transition\n\t\t\t}, 2000);\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.error(\"Erreur lors de la copie : \", err);\n\t\t});\n}\n","import { fullscreen, site } from \"../../utils/dom.mjs\";\n\nlet pleinecran_on = false;\n\nexport function pleinecran() {\n\tif (pleinecran_on) {\n\t\tfullscreen.style.backgroundPosition = null;\n\t\tpleinecran_sortir();\n\t} else {\n\t\tfullscreen.style.backgroundPosition = \"0% 0%\";\n\t\tpleinecran_ouvrir();\n\t}\n\tpleinecran_on = !pleinecran_on;\n}\n\nfunction pleinecran_ouvrir() {\n\t// Demande le mode plein écran pour l'élément\n\tif (site.requestFullscreen) {\n\t\tsite.requestFullscreen();\n\t} else if (site.mozRequestFullScreen) {\n\t\t// Pour Firefox\n\t\tsite.mozRequestFullScreen();\n\t} else if (site.webkitRequestFullscreen) {\n\t\t// Pour Chrome, Safari et Opera\n\t\tsite.webkitRequestFullscreen();\n\t} else if (site.msRequestFullscreen) {\n\t\t// Pour Internet Explorer et Edge\n\t\tsite.msRequestFullscreen();\n\t}\n}\n\nfunction pleinecran_sortir() {\n\t// Pour sortir du mode plein écran\n\tif (document.exitFullscreen) {\n\t\tdocument.exitFullscreen();\n\t} else if (document.mozCancelFullScreen) {\n\t\t// Pour Firefox\n\t\tdocument.mozCancelFullScreen();\n\t} else if (document.webkitExitFullscreen) {\n\t\t// Pour Chrome, Safari et Opera\n\t\tdocument.webkitExitFullscreen();\n\t} else if (document.msExitFullscreen) {\n\t\t// Pour Internet Explorer et Edge\n\t\tdocument.msExitFullscreen();\n\t}\n}\n","export function align(cote) {\n\t// Récupérer la sélection de l'utilisateur\n\tconst selection = document.getSelection();\n\n\t// Vérifier qu'il y a bien une sélection\n\tif (selection.rangeCount > 0) {\n\t\t// Récupérer le premier élément du range sélectionné\n\t\tlet element = selection.anchorNode;\n\n\t\t// Remonter jusqu'à trouver le premier parent de type DIV\n\t\twhile (element && element.tagName !== \"DIV\") {\n\t\t\telement = element.parentNode;\n\t\t}\n\n\t\t// S'assurer qu'on est bien sur un DIV avant d'appliquer l'alignement\n\t\tif (element) {\n\t\t\telement.style.textAlign = cote;\n\t\t} else {\n\t\t\tconsole.warn(\"Aucun élément de type DIV trouvé\");\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Aucune sélection trouvée\");\n\t}\n}\n","// ========================================\n// ENTOURAGE / SURBRILLANCE (intelligent)\n// ========================================\nexport function entoure() {\n\tconst sel = window.getSelection();\n\tif (!sel.rangeCount) return;\n\n\tconst range = sel.getRangeAt(0);\n\tif (range.collapsed) return;\n\n\tconst selectedText = range.toString();\n\n\t// Trouver le parent contenteditable\n\tlet editableParent = range.commonAncestorContainer;\n\tif (editableParent.nodeType === Node.TEXT_NODE) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\twhile (\n\t\teditableParent &&\n\t\teditableParent.nodeType === Node.ELEMENT_NODE &&\n\t\t!editableParent.hasAttribute(\"contenteditable\")\n\t) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\n\t// Sauvegarder les positions\n\tconst texteAvantSelection = range.cloneRange();\n\ttexteAvantSelection.selectNodeContents(editableParent);\n\ttexteAvantSelection.setEnd(range.startContainer, range.startOffset);\n\tconst startOffset = texteAvantSelection.toString().length;\n\tconst endOffset = startOffset + selectedText.length;\n\n\t// Cloner la range pour vérifier le contenu\n\tconst testRange = range.cloneRange();\n\tconst fragment = testRange.cloneContents();\n\n\t// Vérifier s'il y a des spans .entoure dans la sélection\n\tconst tempDiv = document.createElement(\"div\");\n\ttempDiv.appendChild(fragment);\n\tconst entouresInSelection = tempDiv.querySelectorAll(\".entoure\");\n\n\t// Cas 1 : La sélection est ENTIÈREMENT dans un seul span .entoure\n\tif (\n\t\tentouresInSelection.length === 1 &&\n\t\tentouresInSelection[0].textContent === selectedText\n\t) {\n\t\tconst tousLesEntoures = Array.from(\n\t\t\teditableParent.querySelectorAll(\".entoure\")\n\t\t);\n\t\tconst entoureSpanVrai = tousLesEntoures.find(\n\t\t\t(e) =>\n\t\t\t\te.textContent === selectedText &&\n\t\t\t\trange.intersectsNode(e) &&\n\t\t\t\te.textContent.trim() === selectedText.trim()\n\t\t);\n\n\t\tif (entoureSpanVrai) {\n\t\t\t// Unwrap : supprimer le span mais garder le contenu\n\t\t\tconst parent = entoureSpanVrai.parentNode;\n\t\t\twhile (entoureSpanVrai.firstChild) {\n\t\t\t\tparent.insertBefore(entoureSpanVrai.firstChild, entoureSpanVrai);\n\t\t\t}\n\t\t\tentoureSpanVrai.remove();\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// Cas 2 & 3 : Détecter tous les spans .entoure qui chevauchent\n\tconst tousLesEntoures = Array.from(\n\t\teditableParent.querySelectorAll(\".entoure\")\n\t);\n\tconst entouresAUnwrap = [];\n\n\ttousLesEntoures.forEach((entoureSpan) => {\n\t\tif (range.intersectsNode(entoureSpan)) {\n\t\t\tentouresAUnwrap.push(entoureSpan);\n\t\t}\n\t});\n\n\t// Unwrap tous les spans .entoure qui chevauchent\n\tentouresAUnwrap.forEach((entoureSpan) => {\n\t\tconst parent = entoureSpan.parentNode;\n\t\twhile (entoureSpan.firstChild) {\n\t\t\tparent.insertBefore(entoureSpan.firstChild, entoureSpan);\n\t\t}\n\t\tentoureSpan.remove();\n\t});\n\n\t// Recréer la range après unwrap\n\tlet currentOffset = 0;\n\tlet startNode = null;\n\tlet startPos = 0;\n\tlet endNode = null;\n\tlet endPos = 0;\n\n\tconst walker = document.createTreeWalker(\n\t\teditableParent,\n\t\tNodeFilter.SHOW_TEXT,\n\t\tnull,\n\t\tfalse\n\t);\n\n\tlet node;\n\twhile ((node = walker.nextNode())) {\n\t\tconst nodeLength = node.textContent.length;\n\n\t\tif (!startNode && currentOffset + nodeLength > startOffset) {\n\t\t\tstartNode = node;\n\t\t\tstartPos = startOffset - currentOffset;\n\t\t}\n\n\t\tif (!endNode && currentOffset + nodeLength >= endOffset) {\n\t\t\tendNode = node;\n\t\t\tendPos = endOffset - currentOffset;\n\t\t\tbreak;\n\t\t}\n\n\t\tcurrentOffset += nodeLength;\n\t}\n\n\tif (!startNode || !endNode) {\n\t\tconsole.warn(\"Impossible de recréer la sélection\");\n\t\treturn;\n\t}\n\n\t// Créer la nouvelle range\n\tconst newRange = document.createRange();\n\ttry {\n\t\tnewRange.setStart(startNode, startPos);\n\t\tnewRange.setEnd(endNode, endPos);\n\t} catch (e) {\n\t\tconsole.warn(\"Erreur setStart/setEnd:\", e);\n\t\treturn;\n\t}\n\n\t// Appliquer l'entourage\n\tconst entoureSpan = document.createElement(\"span\");\n\tentoureSpan.classList.add(\"entoure\");\n\n\ttry {\n\t\tconst contentFragment = newRange.extractContents();\n\t\tentoureSpan.appendChild(contentFragment);\n\t\tnewRange.insertNode(entoureSpan);\n\n\t\tnewRange.collapse(false);\n\t\tsel.removeAllRanges();\n\t\tsel.addRange(newRange);\n\t} catch (e) {\n\t\tconsole.warn(\"Erreur lors de la création du span entoure:\", e);\n\t}\n}\n","import {\n\textraireCaracteresAvecStyles,\n\tnettoyerSpans,\n\tnormaliserSpans,\n} from \"./helpers.mjs\";\n\n// ========================================\n// COULEUR DE TEXTE (lettre par lettre)\n// ===================================\n\n// =====\nexport function couleurTexte(couleur) {\n\tconst sel = window.getSelection();\n\tif (!sel.rangeCount) return;\n\n\tconst range = sel.getRangeAt(0);\n\tif (range.collapsed) return;\n\n\tlet editableParent = range.commonAncestorContainer;\n\tif (editableParent.nodeType === Node.TEXT_NODE) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\twhile (\n\t\teditableParent &&\n\t\teditableParent.nodeType === Node.ELEMENT_NODE &&\n\t\t!editableParent.hasAttribute(\"contenteditable\")\n\t) {\n\t\teditableParent = editableParent.parentElement;\n\t}\n\n\t// Sauvegarder la position\n\tconst texteAvantSelection = range.cloneRange();\n\ttexteAvantSelection.selectNodeContents(editableParent);\n\ttexteAvantSelection.setEnd(range.startContainer, range.startOffset);\n\tconst startOffset = texteAvantSelection.toString().length;\n\tconst endOffset = startOffset + range.toString().length;\n\n\t// Normaliser les spans\n\tnormaliserSpans(editableParent);\n\n\t// Recréer la sélection\n\tlet currentOffset = 0;\n\tlet startNode = null;\n\tlet startPos = 0;\n\tlet endNode = null;\n\tlet endPos = 0;\n\n\tconst walker = document.createTreeWalker(\n\t\teditableParent,\n\t\tNodeFilter.SHOW_TEXT,\n\t\tnull,\n\t\tfalse\n\t);\n\n\tlet node;\n\twhile ((node = walker.nextNode())) {\n\t\tconst nodeLength = node.textContent.length;\n\n\t\tif (!startNode && currentOffset + nodeLength > startOffset) {\n\t\t\tstartNode = node;\n\t\t\tstartPos = startOffset - currentOffset;\n\t\t}\n\n\t\tif (!endNode && currentOffset + nodeLength >= endOffset) {\n\t\t\tendNode = node;\n\t\t\tendPos = endOffset - currentOffset;\n\t\t\tbreak;\n\t\t}\n\n\t\tcurrentOffset += nodeLength;\n\t}\n\n\tif (startNode && endNode) {\n\t\ttry {\n\t\t\tconst newRange = document.createRange();\n\t\t\tnewRange.setStart(startNode, startPos);\n\t\t\tnewRange.setEnd(endNode, endPos);\n\t\t\tsel.removeAllRanges();\n\t\t\tsel.addRange(newRange);\n\t\t} catch (e) {\n\t\t\tconsole.warn(\"Impossible de restaurer la sélection\", e);\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\treturn;\n\t}\n\n\t// Appliquer la couleur\n\tconst finalRange = sel.getRangeAt(0);\n\tconst startNodeFinal = finalRange.startContainer;\n\tconst endNodeFinal = finalRange.endContainer;\n\n\t// Cas particulier : un seul span sélectionné entièrement\n\tif (\n\t\tstartNodeFinal === endNodeFinal &&\n\t\tstartNodeFinal.nodeType === Node.TEXT_NODE &&\n\t\tstartNodeFinal.parentElement &&\n\t\tstartNodeFinal.parentElement.tagName === \"SPAN\" &&\n\t\tfinalRange.startOffset === 0 &&\n\t\tfinalRange.endOffset === startNodeFinal.textContent.length\n\t) {\n\t\tconst spanParent = startNodeFinal.parentElement;\n\t\tconst couleurClasses = [\n\t\t\t\"couleur-red\",\n\t\t\t\"couleur-coral\",\n\t\t\t\"couleur-salmon\",\n\t\t\t\"couleur-orange\",\n\t\t\t\"couleur-gold\",\n\t\t\t\"couleur-yellow\",\n\t\t\t\"couleur-lime\",\n\t\t\t\"couleur-green\",\n\t\t\t\"couleur-olive\",\n\t\t\t\"couleur-teal\",\n\t\t\t\"couleur-cyan\",\n\t\t\t\"couleur-blue\",\n\t\t\t\"couleur-navy\",\n\t\t\t\"couleur-indigo\",\n\t\t\t\"couleur-purple\",\n\t\t\t\"couleur-magenta\",\n\t\t\t\"couleur-pink\",\n\t\t\t\"couleur-beige\",\n\t\t\t\"couleur-brown\",\n\t\t\t\"couleur-gray\",\n\t\t\t\"couleur-silver\",\n\t\t\t\"couleur-black\",\n\t\t\t\"couleur-white\",\n\t\t];\n\n\t\tcouleurClasses.forEach((cls) => spanParent.classList.remove(cls));\n\n\t\tspanParent.classList.add(`couleur-${couleur}`);\n\n\t\treturn;\n\t}\n\n\t// Cas normal : extraire caractères avec leurs styles\n\tconst fragment = finalRange.cloneContents();\n\tconst caracteres = extraireCaracteresAvecStyles(fragment);\n\n\tif (caracteres.length === 0) return;\n\n\tconst nouveauFragment = document.createDocumentFragment();\n\tconst couleurClasses = [\n\t\t\"couleur-red\",\n\t\t\"couleur-coral\",\n\t\t\"couleur-salmon\",\n\t\t\"couleur-orange\",\n\t\t\"couleur-gold\",\n\t\t\"couleur-yellow\",\n\t\t\"couleur-lime\",\n\t\t\"couleur-green\",\n\t\t\"couleur-olive\",\n\t\t\"couleur-teal\",\n\t\t\"couleur-cyan\",\n\t\t\"couleur-blue\",\n\t\t\"couleur-navy\",\n\t\t\"couleur-indigo\",\n\t\t\"couleur-purple\",\n\t\t\"couleur-magenta\",\n\t\t\"couleur-pink\",\n\t\t\"couleur-beige\",\n\t\t\"couleur-brown\",\n\t\t\"couleur-gray\",\n\t\t\"couleur-silver\",\n\t\t\"couleur-black\",\n\t\t\"couleur-white\",\n\t\t\"couleur-transparent\",\n\t];\n\n\tcaracteres.forEach((car) => {\n\t\t// Si c'est un span .entoure, le garder tel quel\n\t\tif (car.isEntoure) {\n\t\t\tnouveauFragment.appendChild(car.noeud);\n\t\t\treturn;\n\t\t}\n\n\t\tconst span = document.createElement(\"span\");\n\t\tspan.textContent = car.texte;\n\n\t\t// Copier les classes existantes (sauf les couleurs précédentes)\n\t\tcar.classes.forEach((cls) => {\n\t\t\tif (!couleurClasses.includes(cls)) {\n\t\t\t\tspan.classList.add(cls);\n\t\t\t}\n\t\t});\n\n\t\t// Appliquer la nouvelle couleur\n\t\tspan.classList.add(`couleur-${couleur}`);\n\n\t\tnouveauFragment.appendChild(span);\n\t});\n\n\tfinalRange.deleteContents();\n\tfinalRange.insertNode(nouveauFragment);\n\n\tfinalRange.collapse(false);\n\tsel.removeAllRanges();\n\tsel.addRange(finalRange);\n\n\tdocument.getElementById(\"couleur-texte\").style.color = couleur;\n\tdocument.getElementById(\"couleur-texte\").value = couleur;\n\n\tif (couleur === \"white\" || couleur === \"transparent\") {\n\t\tdocument.getElementById(\"couleur-texte\").style.webkitTextStroke =\n\t\t\t\"1px #000000\";\n\t} else {\n\t\tdocument.getElementById(\"couleur-texte\").style.webkitTextStroke = \"0px\";\n\t}\n\n\t// Optimiser les spans après l'opération\n\tnettoyerSpans(editableParent);\n}\n","import { zoom } from \"../ui/zoom/zoom.mjs\";\nimport { config } from \"../config.mjs\";\nimport {\n\tcheckboxInterligneDouble,\n\tcheckboxVerifierOrthographe,\n\tdivMarge,\n\tinputEcrireACheval,\n\tinputLargeurImpression,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../utils/dom.mjs\";\nimport { stocke } from \"../settings/read-write.mjs\";\n\nexport function changeEcrireACheval() {\n\tconfig.ecrireAChevalSurLaMarge = inputEcrireACheval.checked;\n\n\tif (config.ecrireAChevalSurLaMarge) {\n\t\tdivMarge.style.whiteSpace = \"nowrap\";\n\t} else {\n\t\tdivMarge.style.whiteSpace = null;\n\t}\n\n\tstocke(\"ecrire-a-cheval\", config.ecrireAChevalSurLaMarge);\n}\n\nexport function changeVerifieOrthographe() {\n\tconfig.verifierOrthographe = checkboxVerifierOrthographe.checked;\n\tstocke(\"verifier-orthographe\", config.verifierOrthographe);\n\t[texte_marge, texte_marge_complementaire, texte_principal].forEach(\n\t\t(texte) => {\n\t\t\ttexte.spellcheck = config.verifierOrthographe;\n\t\t\ttexte.focus();\n\t\t}\n\t);\n}\n\nexport function changeInterligneDouble() {\n\tconfig.interligneDouble = checkboxInterligneDouble.checked;\n\tstocke(\"double-interligne\", config.interligneDouble);\n\tzoom();\n}\n\nexport function changeLargeurImpression() {\n\tlet valeurEntree = inputLargeurImpression.value;\n\n\tconfig.largeurImpression = parseFloat(valeurEntree);\n\n\tstocke(\"largeur-impression\", config.largeurImpression);\n\tzoom();\n}\n\nexport function changeEspacementLettres(valeur) {\n\tconfig.espacementLettres = parseFloat(valeur);\n\tstocke(\"espacement-lettres\", config.espacementLettres);\n\n\ttexte_principal.style.letterSpacing = valeur / 100 + \"em\";\n\n\tif (config.espacementLettres === 0) {\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--ligatures\",\n\t\t\t'\"calt\" 1',\n\t\t\t\"important\"\n\t\t);\n\t} else {\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--ligatures\",\n\t\t\t'\"calt\" 0',\n\t\t\t\"important\"\n\t\t);\n\t}\n}\n\nexport function changeEspacementMots(valeur) {\n\tconfig.espacementMots = parseFloat(valeur);\n\tstocke(\"espacement-mots\", config.espacementMots);\n\n\tif (config.espacementMots === 0) {\n\t\ttexte_principal.style.wordSpacing = \"normal\";\n\t\ttexte_marge.style.wordSpacing = \"normal\";\n\t\ttexte_marge_complementaire.style.wordSpacing = \"normal\";\n\t} else {\n\t\ttexte_principal.style.wordSpacing = valeur + \"em\";\n\t\ttexte_marge.style.wordSpacing = valeur + \"em\";\n\t\ttexte_marge_complementaire.style.wordSpacing = valeur + \"em\";\n\t}\n}\n","import { zoom } from \"../../ui/zoom/zoom.mjs\";\nimport { config } from \"../../config.mjs\";\nimport {\n\tbouton_ligatures,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../../utils/dom.mjs\";\nimport { update_souligne } from \"../underline.mjs\";\nimport { typesPolices } from \"./font-params.mjs\";\n\nlet sens = window.sens || [1, 0];\n\nexport function ligatures(mode, sens_force) {\n\tif (config.ligatures_on) {\n\t\tif (mode != \"auto\") {\n\t\t\tbouton_ligatures.style.backgroundPosition = null;\n\t\t\tconfig.ligatures_on = false;\n\t\t\ttexte_principal.spellcheck = true;\n\t\t\ttexte_marge.spellcheck = true;\n\t\t\ttexte_marge_complementaire.spellcheck = true;\n\t\t}\n\t\tsens = [1, 0];\n\t} else {\n\t\tif (mode != \"auto\") {\n\t\t\tbouton_ligatures.style.backgroundPosition = \"0% 0%\";\n\t\t\tconfig.ligatures_on = true;\n\t\t\ttexte_principal.spellcheck = false;\n\t\t\ttexte_marge.spellcheck = false;\n\t\t\ttexte_marge_complementaire.spellcheck = false;\n\t\t}\n\t\tsens = [0, 1];\n\t}\n\tif (sens_force) {\n\t\tsens = sens_force;\n\t}\n\tlet texte = texte_principal.innerHTML;\n\tfor (let i = 0; i < config.substitutions.length; i++) {\n\t\tlet recherche = config.substitutions[i][sens[0]];\n\t\tlet subsitution = config.substitutions[i][sens[1]];\n\t\ttexte = texte.replace(new RegExp(recherche, \"g\"), subsitution);\n\t}\n\ttexte_principal.innerHTML = texte;\n\ttexte = texte_marge.innerHTML;\n\tfor (let i = 0; i < config.substitutions.length; i++) {\n\t\tlet recherche = config.substitutions[i][sens[0]];\n\t\tlet subsitution = config.substitutions[i][sens[1]];\n\t\ttexte = texte.replace(new RegExp(recherche, \"g\"), subsitution);\n\t}\n\ttexte_marge.innerHTML = texte;\n}\n\n// Fonction pour changer la police\nexport function change_police(police) {\n\t// Récupérer le texte sélectionné\n\n\t// Désactivation\n\tlet texteSelectionne = false;\n\t//let texteSelectionne = window.getSelection().toString();\n\n\tif (texteSelectionne) {\n\t\tchangePoliceSelection(police);\n\t} else {\n\t\ttexte_principal.style.fontFamily = police;\n\t\ttexte_marge.style.fontFamily = police;\n\t\ttexte_marge_complementaire.style.fontFamily = police;\n\t\tconfig.police_active = police;\n\n\t\tif (!window.widget) {\n\t\t\tlocalStorage.setItem(\"seyes-police\", police);\n\t\t}\n\n\t\t// Si la police existe dans notre objet typesPolices\n\t\tif (typesPolices[police]) {\n\t\t\tlet newConfig = typesPolices[police];\n\t\t\tconfig.coef_marge = newConfig.coef_marge;\n\t\t\tconfig.coef_marge_windows = newConfig.coef_marge_windows;\n\t\t\tconfig.facteur_taille_police = newConfig.facteur_taille_police;\n\t\t\tconfig.epaisseur_police = newConfig.epaisseur_police;\n\t\t\tconfig.distance_soulignage = newConfig.distance_soulignage;\n\t\t\tbouton_ligatures.style.display = newConfig.bouton_ligatures_display;\n\t\t\tligatures(\"auto\", newConfig.ligatures);\n\t\t}\n\t\tzoom(0, false, config.police_active);\n\t\tupdate_souligne(config.distance_soulignage);\n\n\t\tdocument.documentElement.style.setProperty(\n\t\t\t\"--distance-soulignement-exposant\",\n\t\t\tconfig.distance_soulignage * 6 + \"em\"\n\t\t);\n\t}\n}\n\nexport function changePoliceSelection(police, element = null) {\n\t// Si un élément est passé, on applique la police à cet élément\n\tif (element) {\n\t\tlet config = typesPolices[police];\n\n\t\tif (config) {\n\t\t\tlet style = `\n\t\t\t\t\t font-family: ${police};\n\t\t\t\t\t font-size: ${config.facteur_taille_police * config.largeur_carreau}px;\n\t\t\t\t\t font-weight: ${config.epaisseur_police};\n\t\t\t\t\t line-height: ${config.facteur_taille_police * config.largeur_carreau}px;\n\t\t\t\t`;\n\n\t\t\telement.style.cssText = style; // Appliquer le style à l'élément\n\t\t}\n\t} else {\n\t\t// Sinon, on applique la police sur la sélection actuelle\n\t\tlet selection = window.getSelection();\n\t\tlet range = selection.rangeCount > 0 ? selection.getRangeAt(0) : null;\n\t\tlet texteSelectionne = selection.toString();\n\n\t\tif (texteSelectionne && range && typesPolices[police]) {\n\t\t\tlet config = typesPolices[police];\n\n\t\t\tlet style = `\n\t\t\t\t\t font-family: ${police};\n\t\t\t\t\t font-size: ${config.facteur_taille_police * config.largeur_carreau}px;\n\t\t\t\t\t font-weight: ${config.epaisseur_police};\n\t\t\t\t\t line-height: ${config.facteur_taille_police * config.largeur_carreau}px;\n\t\t\t\t`;\n\n\t\t\tlet startContainer = range.startContainer;\n\t\t\tlet endContainer = range.endContainer;\n\n\t\t\tif (startContainer !== endContainer) {\n\t\t\t\tlet fragment = range.cloneContents();\n\t\t\t\tlet elements = fragment.querySelectorAll(\"*\");\n\n\t\t\t\telements.forEach((el) => {\n\t\t\t\t\tif (el.textContent.trim() !== \"\") {\n\t\t\t\t\t\tlet spanStyled = document.createElement(\"span\");\n\t\t\t\t\t\tspanStyled.className = \"customfont\";\n\t\t\t\t\t\tspanStyled.style.cssText = style;\n\t\t\t\t\t\tspanStyled.innerHTML = el.innerHTML;\n\t\t\t\t\t\tel.innerHTML = \"\";\n\t\t\t\t\t\tel.appendChild(spanStyled);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trange.deleteContents();\n\t\t\t\trange.insertNode(fragment);\n\t\t\t} else {\n\t\t\t\tlet spanStyled = document.createElement(\"span\");\n\t\t\t\tspanStyled.className = \"customfont\";\n\t\t\t\tspanStyled.style.cssText = style;\n\t\t\t\tspanStyled.textContent = texteSelectionne;\n\n\t\t\t\trange.deleteContents();\n\t\t\t\trange.insertNode(spanStyled);\n\n\t\t\t\tselection.removeAllRanges();\n\t\t\t\tlet newRange = document.createRange();\n\t\t\t\tnewRange.setStart(spanStyled.firstChild, 0);\n\t\t\t\tnewRange.setEnd(spanStyled.firstChild, spanStyled.firstChild.length);\n\t\t\t\tselection.addRange(newRange);\n\t\t\t}\n\t\t}\n\t}\n}\n","import { config } from \"../config.mjs\";\nimport { changeDate } from \"../date/date.mjs\";\nimport { stocke } from \"../settings/read-write.mjs\";\n\nlet firstLoad = true;\n\nlet translations = {};\nexport function T(key, defaultText = null) {\n\t// This translation function will not work\n\t// if the language file has not been loaded yet.\n\t// Impossible to load it synchronously for now.\n\tif (Object.keys(translations).length == 0) {\n\t\tconsole.log(\"Translations not loaded yet!\");\n\t}\n\tif (key == \"\") return \"\";\n\tif (translations[key]) {\n\t\treturn translations[key];\n\t} else {\n\t\tconsole.log(`Missing translation for key: ${key}`);\n\t\treturn defaultText || key;\n\t}\n}\n\nexport async function loadLanguage(lang) {\n\tif (lang !== \"fr\" || !firstLoad) {\n\t\tfirstLoad = false;\n\t\tconst response = await fetch(`./js/_locales/${lang}.json`);\n\t\ttranslations = await response.json();\n\n\t\tconst elementsTitle = document.querySelectorAll(\"[i18_title]\");\n\t\telementsTitle.forEach((element) => {\n\t\t\tconst key = element.getAttribute(\"i18_title\");\n\t\t\telement.title = translations[key] || element.title;\n\t\t});\n\n\t\tconst elementsContent = document.querySelectorAll(\"[i18_content]\");\n\t\telementsContent.forEach((element) => {\n\t\t\tconst key = element.getAttribute(\"i18_content\");\n\t\t\telement.textContent = translations[key] || element.textContent;\n\t\t});\n\t}\n}\n\nexport function getLang() {\n\tlet url = window.location.search;\n\tlet urlParams = new URLSearchParams(url);\n\tlet langueUrl = urlParams.get(\"lang\");\n\treturn langueUrl || \"fr\";\n}\n\nexport function changeLangue(entree) {\n\tconst langueChoix = entree;\n\n\tif (entree === \"auto\") {\n\t\tconst userLanguage = navigator.language || navigator.userLanguage;\n\t\tconfig.langue = userLanguage.split(\"-\")[0];\n\t} else {\n\t\tconfig.langue = entree;\n\t}\n\n\tloadLanguage(config.langue);\n\n\tdocument.lang = config.langue;\n\n\tstocke(\"lang\", langueChoix);\n\n\tconst divDate = document.getElementById(\"divDate\");\n\n\tif (divDate != null) {\n\t\tchangeDate();\n\t}\n}\n","import { config } from \"../config.mjs\";\nimport { changeCarreaux } from \"../ui/layout/background.mjs\";\nimport { opacite } from \"../menu/buttons/options-panel.mjs\";\nimport {\n\tboutonCodi,\n\tcheckboxSoulignerDate,\n\tchoix_police,\n\tdivContenu,\n\tlienCodi,\n\tresultatCodi,\n\tsuiteCodi,\n\ttexte_principal,\n} from \"../utils/dom.mjs\";\nimport { change_police } from \"../text-format/fonts/fonts.mjs\";\nimport { changeDate } from \"../date/date.mjs\";\nimport { getLang, loadLanguage } from \"../ui/language.mjs\";\nimport { decompresserHTML } from \"./compression.mjs\";\nimport { normaliseCouleur } from \"../utils/colors.mjs\";\n\nlet lienHashCodi;\n\nexport async function traiteInputCodi(entree) {\n\tif (entree.length != 0) {\n\t\tlet lang = getLang();\n\n\t\tconst response = await fetch(`./js/_locales/${lang}.json`);\n\t\tconst translations = await response.json();\n\t\tconst textOK =\n\t\t\ttranslations[\"codiOK_content\"] || \"Texte correctement récupéré\";\n\t\tconst textPasOK =\n\t\t\ttranslations[\"codiPasOK_content\"] || \"Erreur. Lien invalide ?\";\n\n\t\tconst texteValide = await getTexte(\"#\" + entree);\n\t\tsuiteCodi.classList.add(\"hide\");\n\t\tif (texteValide) {\n\t\t\tresultatCodi.classList.add(\"correct\");\n\t\t\tresultatCodi.classList.remove(\"incorrect\");\n\t\t\tresultatCodi.innerHTML = textOK;\n\n\t\t\tlienCodi.innerHTML = lienHashCodi = window.location.origin + \"#\" + entree;\n\t\t\tsuiteCodi.classList.remove(\"hide\");\n\t\t} else {\n\t\t\tresultatCodi.classList.add(\"incorrect\");\n\t\t\tresultatCodi.classList.remove(\"correct\");\n\t\t\tresultatCodi.innerHTML = textPasOK;\n\t\t}\n\t}\n}\n\nexport function copieLienCodi() {\n\t// Copie du texte dans le presse-papiers\n\tnavigator.clipboard\n\t\t.writeText(lienHashCodi)\n\t\t.then(() => {\n\t\t\t// Création du popup \"Lien copié\"\n\t\t\tconst popup = document.createElement(\"div\");\n\t\t\tpopup.innerHTML = \"Lien copié\";\n\t\t\tpopup.style.position = \"fixed\";\n\t\t\tpopup.style.backgroundColor = \"black\";\n\t\t\tpopup.style.color = \"white\";\n\t\t\tpopup.style.fontSize = \"12px\";\n\t\t\tpopup.style.padding = \"5px 10px\";\n\t\t\tpopup.style.borderRadius = \"5px\";\n\t\t\tpopup.style.zIndex = \"10000\";\n\t\t\tpopup.style.opacity = \"0\";\n\t\t\tpopup.style.transition = \"opacity 0.3s\";\n\n\t\t\t// Position du popup près du bouton \"copier\"\n\t\t\tconst rect = boutonCodi.getBoundingClientRect();\n\t\t\tpopup.style.left = rect.left + window.scrollX + \"px\";\n\t\t\tpopup.style.top = rect.top + window.scrollY - 30 + \"px\"; // 30px au-dessus du bouton\n\n\t\t\t// Ajout du popup au DOM\n\n\t\t\tdivContenu.appendChild(popup);\n\n\t\t\t// Faire apparaître le popup\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup.style.opacity = \"1\";\n\t\t\t}, 10);\n\n\t\t\t// Faire disparaître le popup après 2 secondes\n\t\t\tsetTimeout(() => {\n\t\t\t\tpopup.style.opacity = \"0\";\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdivContenu.removeChild(popup);\n\t\t\t\t}, 300); // Retire le popup du DOM après la transition\n\t\t\t}, 2000);\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.error(\"Erreur lors de la copie : \", err);\n\t\t});\n}\n\nexport async function getTexte(hash) {\n\tlet chaine_a_examiner = hash.substring(1);\n\tlet url = handleURL(chaine_a_examiner);\n\n\ttry {\n\t\tlet texte = await fetchTextFromURL(url);\n\t\tafficheTexteDistant(texte);\n\t\treturn true;\n\t} catch (err) {\n\t\tconsole.error(\"Erreur lors de la récupération du texte:\", err);\n\t\treturn false;\n\t}\n}\n\nfunction handleURL(url) {\n\tif (url !== \"\") {\n\t\t// Gestion des fichiers hébergés sur github\n\t\tif (url.startsWith(\"https://github.com\")) {\n\t\t\turl = url.replace(\n\t\t\t\t\"https://github.com\",\n\t\t\t\t\"https://raw.githubusercontent.com\"\n\t\t\t);\n\t\t\turl = url.replace(\"/blob/\", \"/\");\n\t\t}\n\t\t// gestion des fichiers hébergés sur codiMD / hedgedoc / digipage\n\t\tif (\n\t\t\turl.startsWith(\"https://codimd\") ||\n\t\t\turl.includes(\"hedgedoc\") ||\n\t\t\turl.includes(\"digipage\")\n\t\t) {\n\t\t\turl = url\n\t\t\t\t.replace(\"?edit\", \"\")\n\t\t\t\t.replace(\"?both\", \"\")\n\t\t\t\t.replace(\"?view\", \"\")\n\t\t\t\t.replace(/#$/, \"\")\n\t\t\t\t.replace(/\\/$/, \"\");\n\t\t\turl = url.indexOf(\"download\") === -1 ? url + \"/download\" : url;\n\t\t}\n\t\t// gestion des fichiers hébergés sur framapad\n\t\tif (url.includes(\"framapad\") && !url.endsWith(\"/export/txt\")) {\n\t\t\turl = url.replace(/\\?.*/, \"\") + \"/export/txt\";\n\t\t}\n\t}\n\treturn url;\n}\n\nasync function fetchTextFromURL(url) {\n\ttry {\n\t\tlet response = await fetch(url);\n\t\tif (!response.ok) {\n\t\t\tthrow new Error(\"Network response was not ok \" + response.statusText);\n\t\t}\n\t\tlet texte = await response.text();\n\t\treturn texte;\n\t} catch (error) {\n\t\tconsole.error(\"There has been a problem with your fetch operation:\", error);\n\t\tthrow error;\n\t}\n}\n\n// Fonction pour afficher le texte\nfunction afficheTexteDistant(texte) {\n\t// Identifier l'en-tête et le contenu en se basant sur `---`\n\tconst sections = texte.split(\"---\");\n\tlet entete = \"\";\n\tlet contenu = \"\";\n\n\tif (sections.length >= 3) {\n\t\tentete = sections[1].trim(); // L'en-tête est entre les deux `---`\n\n\t\t// Traiter les retours à la ligne après les `---` pour éviter les lignes vides\n\t\tcontenu = sections\n\t\t\t.slice(2)\n\t\t\t.join(\"---\")\n\t\t\t.replace(/^\\s*\\n/, \"\")\n\t\t\t.trim(); // Ignorer le premier saut de ligne après les `---`\n\t} else {\n\t\tcontenu = texte.trim(); // Si pas de délimiteurs `---`, afficher tout le texte\n\t}\n\n\t// Extraire les paramètres depuis l'en-tête\n\tconst lignesEntete = entete.split(\"\\n\");\n\tlet police = \"\";\n\tlet lignage = \"\";\n\tlet autodate = false;\n\tlet opaciteCodim;\n\tlet couleur;\n\n\t// Helper compatible ES2018 pour récupérer la valeur après le ':' (ou undefined)\n\tfunction valueAfterColon(ligne) {\n\t\tconst parts = ligne.split(\":\");\n\t\tif (parts.length < 2) return undefined;\n\t\t// Rejoindre au cas où la valeur contient des ':' et retourner trimée\n\t\tconst val = parts.slice(1).join(\":\").trim();\n\t\treturn val === \"\" ? undefined : val;\n\t}\n\n\tlignesEntete.forEach((ligne) => {\n\t\tif (ligne.startsWith(\"police:\")) {\n\t\t\tpolice = valueAfterColon(ligne);\n\t\t} else if (ligne.startsWith(\"lang:\") || ligne.startsWith(\"langue:\")) {\n\t\t\tconst langVal = valueAfterColon(ligne);\n\t\t\tif (langVal) {\n\t\t\t\tconfig.langue = langVal.toLowerCase().replace(/\\s+/g, \"_\"); // Normalisation\n\t\t\t\tloadLanguage(config.langue);\n\t\t\t\tmajUrl(\"lang\", config.langue);\n\t\t\t}\n\t\t} else if (ligne.startsWith(\"lignage:\")) {\n\t\t\tconst lignageVal = valueAfterColon(ligne);\n\t\t\tif (lignageVal) {\n\t\t\t\tlignage = lignageVal.toLowerCase().replace(/\\s+/g, \"_\"); // Normalisation\n\t\t\t}\n\t\t} else if (ligne.startsWith(\"autodate:\")) {\n\t\t\tconst autodateVal = valueAfterColon(ligne);\n\t\t\tautodate = autodateVal && autodateVal.toLowerCase() === \"true\";\n\t\t} else if (ligne.startsWith(\"souligner-date:\")) {\n\t\t\tconst soulignerVal = valueAfterColon(ligne);\n\t\t\tconfig.soulignerLaDate =\n\t\t\t\tsoulignerVal && soulignerVal.toLowerCase() === \"true\";\n\t\t\tcheckboxSoulignerDate.checked = config.soulignerLaDate;\n\t\t} else if (ligne.startsWith(\"couleur:\")) {\n\t\t\tconst couleurVal = valueAfterColon(ligne);\n\t\t\tif (couleurVal) couleur = couleurVal.toLowerCase();\n\t\t} else if (ligne.startsWith(\"opacite-lignage:\")) {\n\t\t\t// Récupérer la valeur après 'opacite:' et la nettoyer (enlever les espaces)\n\t\t\tlet opaciteVal = valueAfterColon(ligne);\n\n\t\t\tif (opaciteVal && opaciteVal.includes(\"%\")) {\n\t\t\t\topaciteVal = opaciteVal.replace(\"%\", \"\").trim();\n\t\t\t\topaciteVal = parseFloat(opaciteVal) / 100;\n\t\t\t} else if (opaciteVal) {\n\t\t\t\topaciteVal = opaciteVal.replace(\",\", \".\").trim();\n\t\t\t\topaciteVal = parseFloat(opaciteVal);\n\t\t\t}\n\n\t\t\tif (!isNaN(opaciteVal) && opaciteVal >= 0 && opaciteVal <= 1) {\n\t\t\t\topaciteCodim = opaciteVal;\n\t\t\t} else if (opaciteVal !== undefined) {\n\t\t\t\tconsole.warn(\n\t\t\t\t\t\"La valeur de l'opacité est invalide. Elle doit être entre 0 et 1.\"\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Appliquer les paramètres extraits\n\tif (opaciteCodim) {\n\t\topacite(opaciteCodim);\n\t}\n\n\tif (police) {\n\t\tchange_police(police);\n\t\tchoix_police.value = police; // Mise à jour de l'élément sélectionné (choix_police)\n\t}\n\tif (lignage) {\n\t\tchangeCarreaux(lignage);\n\t}\n\tif (couleur) {\n\t\tcouleur = normaliseCouleur(couleur);\n\t\tdocument.documentElement.style.setProperty(\"--couleur-texte\", couleur);\n\t}\n\n\t// Remplacer les retours à la ligne dans le contenu par des <div>\n\tconst contenuHtml = contenu\n\t\t.split(\"\\n\") // Diviser le contenu en lignes\n\t\t.map((ligne) => {\n\t\t\tconst trimmedLigne = ligne.trim(); // Supprimer les espaces avant et après la ligne\n\t\t\t// Si la ligne est vide après trim, ajouter un <br> à l'intérieur de la <div>\n\t\t\treturn `<div>${trimmedLigne || \"<br>\"}</div>`;\n\t\t})\n\t\t.join(\"\"); // Joindre les div ensemble\n\n\t// Afficher le contenu dans le DOM\n\tif (texte_principal)\n\t\ttexte_principal.innerHTML = decompresserHTML(contenuHtml);\n\n\t// Ajouter la date automatiquement si autodate est activé\n\tif (autodate) {\n\t\tchangeDate();\n\t}\n}\n\nfunction majUrl(cle, valeur) {\n\t// Récupère l'URL actuelle\n\tconst url = new URL(window.location);\n\n\t// Met à jour ou ajoute le paramètre\n\turl.searchParams.set(cle, valeur);\n\n\t// Modifie l'URL sans recharger la page\n\twindow.history.replaceState({}, \"\", url);\n}\n","export function normaliseCouleur(couleur) {\n\t// Dictionnaire français vers noms de couleurs HTML/CSS standards\n\tconst couleurs = {\n\t\t// Couleurs de base\n\t\tnoir: \"Black\",\n\t\tbleu: \"Blue\",\n\t\tmarron: \"Brown\",\n\t\tcyan: \"Cyan\",\n\t\tgris: \"Gray\",\n\t\tvert: \"Green\",\n\t\tmagenta: \"Magenta\",\n\t\tbordeaux: \"Maroon\",\n\t\tmarine: \"Navy\",\n\t\tolive: \"Olive\",\n\t\tviolet: \"Purple\",\n\t\trouge: \"Red\",\n\t\targent: \"Silver\",\n\t\tsarcelle: \"Teal\",\n\t\tblanc: \"White\",\n\t\tjaune: \"Yellow\",\n\n\t\t// Couleurs composées préconstruites\n\t\tvertolive: \"OliveDrab\",\n\t\tbleuciel: \"SkyBlue\",\n\t\tbleuroi: \"RoyalBlue\",\n\t\tbleumarine: \"Navy\",\n\t\tvertforet: \"ForestGreen\",\n\t\tvertcitron: \"LimeGreen\",\n\t\tvertmer: \"SeaGreen\",\n\t\trosefonce: \"DeepPink\",\n\t\tbleunuit: \"MidnightBlue\",\n\n\t\t// Combinaisons courantes\n\t\t\"vert olive\": \"OliveDrab\",\n\t\t\"vert-olive\": \"OliveDrab\",\n\t\t\"bleu ciel\": \"SkyBlue\",\n\t\t\"bleu-ciel\": \"SkyBlue\",\n\t\t\"bleu roi\": \"RoyalBlue\",\n\t\t\"bleu-roi\": \"RoyalBlue\",\n\t\t\"bleu marine\": \"Navy\",\n\t\t\"bleu-marine\": \"Navy\",\n\t\t\"vert foret\": \"ForestGreen\",\n\t\t\"vert-foret\": \"ForestGreen\",\n\t\t\"vert citron\": \"LimeGreen\",\n\t\t\"vert-citron\": \"LimeGreen\",\n\t\t\"vert mer\": \"SeaGreen\",\n\t\t\"vert-mer\": \"SeaGreen\",\n\t\t\"rose fonce\": \"DeepPink\",\n\t\t\"rose-fonce\": \"DeepPink\",\n\t\t\"bleu nuit\": \"MidnightBlue\",\n\t\t\"bleu-nuit\": \"MidnightBlue\",\n\t};\n\n\t// Fonction pour vérifier si une chaîne est un code hexadécimal valide\n\tfunction estCodeHexadecimal(str) {\n\t\treturn /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(str);\n\t}\n\n\t// Nettoyer l'entrée : convertir en minuscules et supprimer les espaces superflus\n\tcouleur = couleur.toLowerCase().trim();\n\n\t// Si c'est déjà un code hexadécimal, le retourner tel quel\n\tif (estCodeHexadecimal(couleur)) {\n\t\treturn couleur;\n\t}\n\n\t// Vérifier d'abord la couleur exacte dans le dictionnaire\n\tif (couleurs[couleur]) {\n\t\treturn couleurs[couleur];\n\t}\n\n\t// Essayer différentes variantes de formatage\n\t// 1. Supprimer tous les espaces\n\tconst sansEspaces = couleur.replace(/\\s+/g, \"\");\n\tif (couleurs[sansEspaces]) {\n\t\treturn couleurs[sansEspaces];\n\t}\n\n\t// 2. Remplacer les tirets par des espaces\n\tconst avecEspaces = couleur.replace(/-/g, \" \");\n\tif (couleurs[avecEspaces]) {\n\t\treturn couleurs[avecEspaces];\n\t}\n\n\t// 3. Gérer les modificateurs génériques (clair/foncé)\n\tconst patterns = [\n\t\t/^(.*?)\\s+clair$/, // \"bleu clair\"\n\t\t/^(.*?)-clair$/, // \"bleu-clair\"\n\t\t/^(.*?)\\s+fonce$/, // \"bleu fonce\"\n\t\t/^(.*?)-fonce$/, // \"bleu-fonce\"\n\t\t/^(.*?)\\s+foncé$/, // \"bleu foncé\"\n\t\t/^(.*?)-foncé$/, // \"bleu-foncé\"\n\t];\n\n\tfor (let pattern of patterns) {\n\t\tconst match = couleur.match(pattern);\n\t\tif (match) {\n\t\t\tconst baseCouleur = match[1];\n\t\t\tconst baseAnglais = couleurs[baseCouleur];\n\n\t\t\tif (baseAnglais) {\n\t\t\t\tif (pattern.source.includes(\"clair\")) {\n\t\t\t\t\treturn `Light${baseAnglais}`;\n\t\t\t\t} else {\n\t\t\t\t\treturn `Dark${baseAnglais}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Si aucune correspondance n'est trouvée, retourner la couleur d'origine\n\treturn couleur;\n}\n","import { config } from \"../../config.mjs\";\nimport { creeDate } from \"../../date/date.mjs\";\nimport {\n\tgraphismes,\n\timages,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../../utils/dom.mjs\";\n\nexport function resetContent() {\n\t// Réinitialiser le contenu HTML de divers éléments\n\ttexte_principal.innerHTML = \"\";\n\tgraphismes.innerHTML = \"\";\n\timages.innerHTML = \"\";\n\ttexte_marge.innerHTML = texte_marge_complementaire.innerHTML = \"\";\n\n\tif (config.ajouterLaDate) {\n\t\tcreeDate();\n\t}\n\n\t// Mettre le focus sur l'élément texte_principal\n\ttexte_principal.focus();\n\n\t// Créer un objet Range pour manipuler la position du curseur\n\tconst range = document.createRange();\n\tconst selection = window.getSelection();\n\n\t// Trouver la dernière balise <br> et positionner le curseur juste après\n\tconst brElements = texte_principal.getElementsByTagName(\"br\");\n\tif (brElements.length > 0) {\n\t\tconst lastBr = brElements[brElements.length - 1];\n\t\trange.setStartAfter(lastBr); // Place le curseur après le dernier <br>\n\t\trange.collapse(true); // Fusionne le point de début et de fin pour positionner le curseur\n\t\tselection.removeAllRanges(); // Vide la sélection actuelle\n\t\tselection.addRange(range); // Ajoute la nouvelle plage\n\t}\n}\n","import { jours, joursRef } from \"../../_locales/date-days.mjs\";\nimport { config } from \"../config.mjs\";\nimport { changeDate, changeModeDate } from \"../date/date.mjs\";\nimport {\n\tferme,\n\tcheckboxMessage,\n\tdivMessage,\n\tchoixCouleurEntete,\n\tdivEntete,\n\ttexte_principal,\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\tgraphismes,\n\timages,\n\tselectLangue,\n\tinputEspacement,\n\tinputEspacementMots,\n\tinputLargeurImpression,\n\tinputEcrireACheval,\n\tcheckboxMajDateAuto,\n\tchoix_police,\n\tcheckboxVerifierOrthographe,\n} from \"../utils/dom.mjs\";\nimport { reaffecteEventsImages } from \"../menu/buttons/insert-image.mjs\";\nimport { opacite } from \"../menu/buttons/options-panel.mjs\";\nimport { decompresserHTML } from \"../save-load/compression.mjs\";\nimport { checkHash } from \"../save-load/importFromHash.mjs\";\nimport {\n\tchangeEcrireACheval,\n\tchangeEspacementLettres,\n\tchangeEspacementMots,\n\tchangeInterligneDouble,\n\tchangeLargeurImpression,\n\tchangeVerifieOrthographe,\n} from \"../text-format/change-display.mjs\";\nimport { adapteCouleurBordureChoixCouleur } from \"../ui/display/ui-colors.mjs\";\nimport { change_police } from \"../text-format/fonts/fonts.mjs\";\nimport { changeCarreaux } from \"../ui/layout/background.mjs\";\nimport { calculeNombreDeCarreaux } from \"../ui/layout/getSize.mjs\";\nimport { changeLangue, loadLanguage } from \"../ui/language.mjs\";\nimport {\n\tregleMarge,\n\tregleMargeSecondaire,\n} from \"../ui/layout/margin-manager.mjs\";\nimport { resetContent } from \"../ui/content/resetContent.mjs\";\nimport { zoom } from \"../ui/zoom/zoom.mjs\";\n\nexport function applySettings() {\n\tcheckboxMessage.checked = config.afficherMessage;\n\tif (!config.afficherMessage) {\n\t\tferme(divMessage);\n\t} else {\n\t\tdivMessage.style.opacity = \"1\";\n\t}\n\n\tif (config.couleursJours) {\n\t\ttry {\n\t\t\tfor (let key in JSON.parse(config.couleursJours)) {\n\t\t\t\tjours[key] = JSON.parse(config.couleursJours)[key];\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Valeur non parsable :\", e);\n\t\t\tfor (let key in joursRef) {\n\t\t\t\tjours[key] = joursRef[key];\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (let key in joursRef) {\n\t\t\tjours[key] = joursRef[key];\n\t\t}\n\t}\n\n\tconst jourActif = document.getElementById(\"select-jours\").value;\n\tdivEntete.style.backgroundColor = jours[jourActif];\n\tchoixCouleurEntete.value = choixCouleurEntete.style.backgroundColor =\n\t\tjours[jourActif];\n\n\tinputEspacement.value = config.espacementLettres;\n\tinputEspacementMots.value = config.espacementMots;\n\tinputEcrireACheval.checked = config.ecrireAChevalSurLaMarge;\n\tcheckboxMajDateAuto.checked = config.majDateAuto;\n\n\tchangeEcrireACheval();\n\tadapteCouleurBordureChoixCouleur();\n\n\tregleMarge(config.largeur_marge);\n\tregleMargeSecondaire(config.largeur_marge_secondaire);\n\n\tchoix_police.value = config.police_active;\n\tchange_police(config.police_active);\n\tchangeCarreaux(config.typeCarreaux);\n\topacite(config.opaciteLignes);\n\tzoom(false, config.largeur_carreau, config.police_active);\n\tchangeModeDate();\n\tresetContent();\n\n\tconst contentFromHash = checkHash(\n\t\tconfig.contenuTextePrincipal,\n\t\tconfig.contenuGraphismes\n\t);\n\n\tconfig.contenuTextePrincipal = contentFromHash.contenuTextePrincipal;\n\tconfig.contenuGraphismes = contentFromHash.contenuGraphismes;\n\n\tchangeEspacementLettres(config.espacementLettres);\n\tchangeEspacementMots(config.espacementMots);\n\topacite(config.opaciteLignes);\n\n\tcheckboxVerifierOrthographe.checked = config.verifierOrthographe;\n\tchangeVerifieOrthographe();\n\tchangeInterligneDouble();\n\n\tinputLargeurImpression.value = config.largeurImpression;\n\tchangeLargeurImpression();\n\n\tif (\n\t\tconfig.contenuTextePrincipal != '\"\"' &&\n\t\tconfig.contenuTextePrincipal != null\n\t) {\n\t\ttexte_principal.innerHTML = decompresserHTML(config.contenuTextePrincipal);\n\t}\n\tif (config.contenuTexteMarge != '\"\"') {\n\t\ttexte_marge.innerHTML = decompresserHTML(config.contenuTexteMarge);\n\t}\n\tif (config.contenuTexteMargeComplementaire != '\"\"') {\n\t\ttexte_marge_complementaire.innerHTML =\n\t\t\tconfig.contenuTexteMargeComplementaire;\n\t}\n\tif (config.contenuGraphismes != '\"\"') {\n\t\tgraphismes.innerHTML = config.contenuGraphismes;\n\t}\n\tif (config.contenuImages != '\"\"') {\n\t\timages.innerHTML = config.contenuImages;\n\t}\n\treaffecteEventsImages();\n\tcalculeNombreDeCarreaux();\n\n\tselectLangue.value = config.langueChoix;\n\tif (config.langue !== \"fr\") {\n\t\tchangeLangue(config.langueChoix);\n\t}\n\n\tif (config.majDateAuto) changeDate();\n\n\tloadLanguage(config.langue);\n}\n","import { getTexte } from \"./import-from-markdown.mjs\";\n\nexport function checkHash(contenuTextePrincipal, contenuGraphismes) {\n\t// Récupération de l'URL et des paramètres\n\tlet url = window.location.search;\n\n\t// Remplacer les occurrences de '&amp;' par '&' uniquement dans les paramètres de l'URL\n\tif (url.includes(\"&amp;\")) {\n\t\turl = url.replace(/&amp;/g, \"&\");\n\t}\n\n\tif (window.location.hash) {\n\t\tif (window.location.hash.startsWith(\"#http\")) {\n\t\t\tgetTexte(window.location.hash);\n\t\t} else {\n\t\t\t// Enlève le '#' initial et décode le hash\n\t\t\tconst hashValues = decodeURIComponent(\n\t\t\t\twindow.location.hash.substring(1)\n\t\t\t).split(\"|_|\");\n\n\t\t\t// Vérifie que les deux parties sont bien présentes dans le hash\n\t\t\tif (hashValues.length === 2) {\n\t\t\t\tlet textePrincipalRecupere = hashValues[0];\n\t\t\t\tlet graphismesRecupere = hashValues[1];\n\n\t\t\t\t// Met à jour le contenu des éléments avec les valeurs récupérées\n\t\t\t\tcontenuTextePrincipal = textePrincipalRecupere;\n\t\t\t\tcontenuGraphismes = graphismesRecupere;\n\t\t\t} else {\n\t\t\t\t// Si seulement une partie est présente (par exemple si le hash n'a pas \"|_|\"), gère cela\n\t\t\t\tcontenuTextePrincipal = hashValues[0];\n\t\t\t}\n\n\t\t\t// Nettoyage de l'URL après traitement des paramètres\n\t\t\tconst baseUrl =\n\t\t\t\twindow.location.protocol +\n\t\t\t\t\"//\" +\n\t\t\t\twindow.location.host +\n\t\t\t\twindow.location.pathname;\n\n\t\t\t// Remplace l'URL actuelle avec l'URL de base (sans les paramètres et sans hash) sans recharger la page\n\t\t\twindow.history.replaceState({}, document.title, baseUrl);\n\t\t}\n\t}\n\treturn { contenuTextePrincipal, contenuGraphismes };\n}\n","import { config } from \"../config.mjs\";\nimport { defaultContent } from \"../ui/content/defaultContent.mjs\";\nimport { litDepuisStockage, getValueFromUrlOrStorage } from \"./read-write.mjs\";\n\nexport async function loadSettings() {\n\tconst url = window.location.search;\n\tconst urlParams = new URLSearchParams(url);\n\n\tconst isOffline = !url.startsWith(\"http\") ? true : false;\n\n\t// DEV\n\tif (window.location.href.includes(\"seyes-dev\")) {\n\t\tdocument.body.classList.add(\"dev\");\n\t}\n\n\t// Message d'accueil\n\tlet valeur = await litDepuisStockage(\n\t\t`afficher-message${config.numeroMessage}`,\n\t\t(v) => v,\n\t);\n\t// Convertir la valeur stockée en booléen\n\tif (valeur === \"true\") {\n\t\tconfig.afficherMessage = true;\n\t} else if (valeur === \"false\") {\n\t\tconfig.afficherMessage = false;\n\t}\n\n\t// Primtux\n\tconst primtux = urlParams.get(\"primtuxmenu\");\n\tif (primtux) {\n\t\tdocument.body.classList.add(\"primtux\");\n\t\tconfig.afficherMessage = false;\n\t}\n\n\tconfig.langueChoix =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"lang\")) || \"auto\";\n\n\tconfig.couleursJours = await getValueFromUrlOrStorage(\n\t\turlParams,\n\t\t\"couleurs-jours\",\n\t);\n\n\tconfig.police_active =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"police\")) ||\n\t\tconfig.police_active;\n\n\tconfig.largeur_marge =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"largeur-marge\")) ||\n\t\tconfig.largeur_marge;\n\n\tconfig.largeur_marge_secondaire =\n\t\t(await parseFloat(\n\t\t\tgetValueFromUrlOrStorage(urlParams, \"largeur-marge-secondaire\"),\n\t\t)) || config.largeur_marge_secondaire;\n\n\tconfig.contenuGraphismes =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"graphismes\")) || \"\";\n\n\tconfig.contenuImages =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"images\")) || \"\";\n\n\tconst contenuPrincipalStorage =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"texte-principal\")) || \"\";\n\n\tif (\n\t\tcontenuPrincipalStorage != \"\" &&\n\t\tcontenuPrincipalStorage != \"undefined\" &&\n\t\tcontenuPrincipalStorage != null\n\t) {\n\t\tconfig.contenuTextePrincipal = contenuPrincipalStorage;\n\t} else {\n\t\tconfig.contenuTextePrincipal = await defaultContent(isOffline);\n\t}\n\n\tconfig.contenuTexteMarge =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"texte-marge\")) || \"\";\n\n\tconfig.contenuTexteMargeComplementaire =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"texte-marge-complementaire\")) ||\n\t\t\"\";\n\n\tconfig.typeCarreaux =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"type-carreaux\")) ||\n\t\tconfig.typeCarreaux;\n\n\tconfig.opaciteLignes =\n\t\tparseFloat(await getValueFromUrlOrStorage(urlParams, \"opacite-lignes\")) ||\n\t\t1;\n\n\tconfig.largeur_carreau =\n\t\tparseInt(await getValueFromUrlOrStorage(urlParams, \"largeur-carreau\")) ||\n\t\tconfig.largeur_carreau;\n\n\tconfig.espacementLettres =\n\t\tparseInt(await getValueFromUrlOrStorage(urlParams, \"espacement-lettres\")) ||\n\t\tconfig.espacementLettres;\n\n\tconfig.espacementMots =\n\t\tparseInt(await getValueFromUrlOrStorage(urlParams, \"espacement-mots\")) ||\n\t\tconfig.espacementMots;\n\n\tconfig.ajouterLaDate =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"ajouter-date\")) === \"true\" ||\n\t\tconfig.ajouterLaDate;\n\n\tconfig.soulignerLaDate =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"souligner-date\")) === \"true\" ||\n\t\tconfig.soulignerLaDate;\n\n\tconfig.verifierOrthographe =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"verifier-orthographe\")) ===\n\t\t\t\"true\" || config.verifierOrthographe;\n\n\tconfig.interligneDouble =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"double-interligne\")) ===\n\t\t\t\"true\" || config.interligneDouble;\n\n\tconfig.ecrireAChevalSurLaMarge =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"ecrire-a-cheval\")) === \"true\" ||\n\t\tconfig.ecrireAChevalSurLaMarge;\n\n\tconfig.largeurImpression =\n\t\tparseInt(await getValueFromUrlOrStorage(urlParams, \"largeur-impression\")) ||\n\t\tconfig.largeurImpression;\n\n\tconfig.majDateAuto =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"maj-date-auto\")) === \"true\" ||\n\t\tconfig.majDateAuto;\n\n\tconfig.sharedURL =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"shared-url\")) ||\n\t\tconfig.sharedURL;\n\n\tconfig.sharedUDI =\n\t\t(await getValueFromUrlOrStorage(urlParams, \"shared-udi\")) ||\n\t\tconfig.sharedUDI;\n}\n","import { calculeDate } from \"../../date/date.mjs\";\nimport { getLang } from \"../language.mjs\";\n\nexport async function defaultContent(isOffline) {\n\tlet date = calculeDate();\n\tlet lang = getLang();\n\tlet text;\n\n\tif (isOffline || lang === \"fr\" || !lang) {\n\t\ttext = \"Modifiez-moi\";\n\t} else {\n\t\tconst response = await fetch(`./js/_locales/${lang}.json`);\n\t\tconst translations = await response.json();\n\t\ttext = translations[\"modifiezMoi_content\"] || \"Modifiez-moi...\";\n\t}\n\n\treturn `\n\t\t  <div id=\"divDate\"><span>${date}</span></div>\n\t\t  <br>\n\t\t  ${text}    \n\t `;\n}\n","import { config } from \"../config.mjs\";\nimport { texte_principal } from \"../utils/dom.mjs\";\nimport {\n\treadDocxFile,\n\treadOdtFile,\n\treadFileAsText,\n} from \"./import-from-docx-odt.mjs\";\nimport { applySettings } from \"../settings/applySettings.mjs\";\nimport { loadSettings } from \"../settings/loadSettings.mjs\";\nimport { save_texte } from \"../settings/read-write.mjs\";\nimport { resetContent } from \"../ui/content/resetContent.mjs\";\n\nexport function ouvrir() {\n\t// Crée un élément input de type file\n\tconst input = document.createElement(\"input\");\n\tinput.type = \"file\"; // Spécifie que c'est un champ de fichier\n\tinput.accept = \".json, .sey, .txt, .doc, .docx\";\n\n\t// Ajoute un écouteur d'événements pour l'ouverture du fichier\n\tinput.addEventListener(\"change\", handleFileSelect);\n\n\t// Simule un clic sur l'élément input pour ouvrir la boîte de dialogue de fichier\n\tinput.click();\n}\n\nasync function handleFileSelect(event) {\n\tconst file = event.target.files[0];\n\n\tif (!file) {\n\t\talert(\"Aucun fichier sélectionné.\");\n\t\treturn;\n\t}\n\n\tconst validExtensions = [\".json\", \".sey\", \".odt\", \".doc\", \".docx\", \".txt\"];\n\tif (!validExtensions.some((ext) => file.name.endsWith(ext))) {\n\t\talert(\n\t\t\t\"Erreur : fichier non valide. Extensions acceptées : \" +\n\t\t\t\tvalidExtensions.join(\", \"),\n\t\t);\n\t\treturn;\n\t}\n\n\ttry {\n\t\tif (\n\t\t\tfile.name.endsWith(\".doc\") ||\n\t\t\tfile.name.endsWith(\".docx\") ||\n\t\t\tfile.name.endsWith(\".odt\")\n\t\t) {\n\t\t\t// On charge la librairie mammoth.js pour pouvoir traiter les fichiers .docx, .doc et .odt\n\t\t\tif (typeof window.mammoth === \"undefined\") {\n\t\t\t\tconst script = document.createElement(\"script\");\n\t\t\t\tscript.src = \"./js/lib/mammoth.browser.min.js\";\n\t\t\t\tdocument.head.appendChild(script);\n\t\t\t\t// on attend que le script soit chargé\n\t\t\t\tawait new Promise((resolve, reject) => {\n\t\t\t\t\tscript.onload = resolve;\n\t\t\t\t\tscript.onerror = reject;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (file.name.endsWith(\".doc\") || file.name.endsWith(\".docx\")) {\n\t\t\tconst content = await readDocxFile(file);\n\t\t\tinsereContenu(content);\n\t\t} else if (file.name.endsWith(\".odt\")) {\n\t\t\tconst content = await readOdtFile(file);\n\t\t\tinsereContenu(content);\n\t\t} else {\n\t\t\tconfig.nomDuFichierOuvert =\n\t\t\t\tfile.name.split(\".\").slice(0, -1).join(\".\") || file.name;\n\n\t\t\tconst content = await readFileAsText(file);\n\t\t\tif (file.name.endsWith(\".json\") || file.name.endsWith(\".sey\")) {\n\t\t\t\thandleJSONFile(content);\n\t\t\t} else {\n\t\t\t\tinsereContenu(content);\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\talert(\"Erreur lors du traitement du fichier : \" + error.message);\n\t\tconsole.error(error);\n\t}\n}\n\n// Gestion des fichiers JSON ou SEY\nexport async function handleJSONFile(content) {\n\ttry {\n\t\tconst data = JSON.parse(content);\n\n\t\t// Stockage des données dans localStorage\n\t\tfor (const [key, value] of Object.entries(data)) {\n\t\t\t// On stringify uniquement si c'est un objet\n\t\t\tconst storedValue =\n\t\t\t\ttypeof value === \"object\" ? JSON.stringify(value) : value;\n\t\t\tlocalStorage.setItem(key, storedValue);\n\t\t}\n\n\t\t// Appeler loadSettings et applySettings\n\t\tawait loadSettings();\n\t\tapplySettings();\n\t} catch (error) {\n\t\talert(\"Erreur : le contenu du fichier JSON est invalide.\");\n\t\tconsole.error(error);\n\t}\n}\n\nfunction insereContenu(content) {\n\tresetContent();\n\ttexte_principal.innerHTML = content;\n}\n\nexport async function prepareEnregistrement() {\n\tawait save_texte();\n\tlet nomDuFichier = \"texte\";\n\tif (config.dateDuDoc) {\n\t\tnomDuFichier = `${nomDuFichier}-${config.dateDuDoc}`;\n\t}\n\tif (config.nomDuFichierOuvert) {\n\t\tnomDuFichier = config.nomDuFichierOuvert;\n\t}\n\tif (window.showSaveFilePicker) {\n\t\tenregistrerFichierAvecDialogue(`${nomDuFichier}.sey`);\n\t} else {\n\t\tenregistrer(`${nomDuFichier}.sey`);\n\t}\n}\n\n/* On a vraiment besoin d'une 3e fonction pour récupérer le contenu à sauvegarder ?\n * On pourrait factoriser avec enregistrer et enregistrerFichierAvecDialogue\n */\nexport function getContentForSaving(prefixeAppli) {\n\tlet data = {};\n\n\t// Parcourir toutes les clés dans le localStorage\n\tfor (let i = 0; i < localStorage.length; i++) {\n\t\tconst key = localStorage.key(i);\n\n\t\t// Vérifie si la clé commence par le préfixe spécifié\n\t\tif (key.startsWith(prefixeAppli + \"-\")) {\n\t\t\t// Récupère la valeur de la clé\n\t\t\tconst value = localStorage.getItem(key);\n\n\t\t\t// Si la clé contient \"texte-principal\", on ne la transforme pas en JSON (on conserve la chaîne telle quelle)\n\t\t\tif (key === \"seyes-texte-principal\") {\n\t\t\t\tdata[key] = value;\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\t// Essaie de parser la valeur comme JSON\n\t\t\t\t\tdata[key] = JSON.parse(value);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Si ce n'est pas du JSON, conserve la valeur sous forme de chaîne\n\t\t\t\t\t// console.error(e);\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t`Key ${key} with value ${value} is not JSON, saving as string.`,\n\t\t\t\t\t);\n\t\t\t\t\tdata[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn data;\n}\n\nfunction enregistrer(nomDeFichier) {\n\tconst data = getContentForSaving(config.prefixeAppli);\n\t/*\n\tconst data = {};\n\n\t// Parcourir toutes les clés dans le localStorage\n\tfor (let i = 0; i < localStorage.length; i++) {\n\t\tconst key = localStorage.key(i);\n\n\t\t// Vérifie si la clé commence par le préfixe spécifié\n\t\tif (key.startsWith(config.prefixeAppli + \"-\")) {\n\t\t\t// Récupère la valeur de la clé\n\t\t\tconst value = localStorage.getItem(key);\n\n\t\t\t// Si la clé contient \"texte-principal\", on ne la transforme pas en JSON (on conserve la chaîne telle quelle)\n\t\t\tif (key === \"seyes-texte-principal\") {\n\t\t\t\tdata[key] = value;\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\t// Essaie de parser la valeur comme JSON\n\t\t\t\t\tdata[key] = JSON.parse(value);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Si ce n'est pas du JSON, conserve la valeur sous forme de chaîne\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tdata[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t*/\n\t// Convertit les données en JSON\n\tconst jsonData = JSON.stringify(data, null, 2);\n\n\t// Crée un Blob contenant les données JSON\n\tconst blob = new Blob([jsonData], { type: \"application/json\" });\n\n\t// Crée un lien pour télécharger le fichier\n\tconst link = document.createElement(\"a\");\n\tlink.href = URL.createObjectURL(blob);\n\tlink.download = nomDeFichier; // Nom du fichier à télécharger\n\tlink.click(); // Lance le téléchargement\n}\n\nasync function enregistrerFichierAvecDialogue(\n\tnomParDefaut,\n\tprefixeAppli = \"seyes\",\n) {\n\tconst data = {};\n\n\t// Parcourir le localStorage et récupérer les données\n\tfor (let i = 0; i < localStorage.length; i++) {\n\t\tconst key = localStorage.key(i);\n\n\t\tif (key.startsWith(prefixeAppli + \"-\")) {\n\t\t\tconst value = localStorage.getItem(key);\n\t\t\tif (key === \"seyes-texte-principal\") {\n\t\t\t\tdata[key] = value;\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tdata[key] = JSON.parse(value);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t\tdata[key] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst jsonData = JSON.stringify(data, null, 2);\n\n\ttry {\n\t\t// Affiche la boîte \"Enregistrer sous…\"\n\t\tconst handle = await window.showSaveFilePicker({\n\t\t\tsuggestedName: nomParDefaut,\n\t\t\ttypes: [\n\t\t\t\t{\n\t\t\t\t\tdescription: \"Fichier JSON\",\n\t\t\t\t\taccept: { \"application/json\": [\".json\"] },\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tconst writable = await handle.createWritable();\n\t\tawait writable.write(jsonData);\n\t\tawait writable.close();\n\n\t\talert(\"Fichier enregistré avec succès !\");\n\t} catch (err) {\n\t\tif (err.name !== \"AbortError\") {\n\t\t\tconsole.error(\"Erreur lors de l'enregistrement :\", err);\n\t\t\talert(\"Une erreur est survenue lors de l'enregistrement.\");\n\t\t}\n\t}\n}\n","export async function readDocxFile(file) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst reader = new FileReader();\n\t\treader.onload = (event) => {\n\t\t\tconst arrayBuffer = event.target.result;\n\t\t\tif (window.mammoth) {\n\t\t\t\twindow.mammoth\n\t\t\t\t\t.convertToHtml({ arrayBuffer: arrayBuffer })\n\t\t\t\t\t.then((result) => resolve(result.value))\n\t\t\t\t\t.catch((err) => reject(err));\n\t\t\t} else {\n\t\t\t\treject(new Error(\"mammoth.js is not loaded\"));\n\t\t\t}\n\t\t};\n\t\treader.onerror = () =>\n\t\t\treject(new Error(\"Impossible de lire le fichier DOC/DOCX.\"));\n\t\treader.readAsArrayBuffer(file);\n\t});\n}\n\nexport async function readOdtFile(file) {\n\treturn new Promise((resolve, reject) => {\n\t\tif (typeof window.ODF === \"undefined\") {\n\t\t\treject(new Error(\"La bibliothèque odf.js n'est pas chargée.\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst reader = new FileReader();\n\t\treader.onload = async (event) => {\n\t\t\ttry {\n\t\t\t\tconst arrayBuffer = event.target.result;\n\t\t\t\tconst uint8Array = new Uint8Array(arrayBuffer);\n\n\t\t\t\tconst odfDocument = await window.ODF.load(uint8Array);\n\t\t\t\tconst textContent = await odfDocument.getText();\n\t\t\t\tresolve(textContent);\n\t\t\t} catch (error) {\n\t\t\t\treject(\n\t\t\t\t\tnew Error(\"Impossible de lire le fichier ODT : \" + error.message)\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\n\t\treader.onerror = () =>\n\t\t\treject(new Error(\"Erreur lors de la lecture du fichier ODT.\"));\n\t\treader.readAsArrayBuffer(file);\n\t});\n}\n\nexport function readFileAsText(file) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst reader = new FileReader();\n\t\treader.onload = (e) => resolve(e.target.result);\n\t\treader.onerror = () => reject(new Error(\"Échec de la lecture du fichier.\"));\n\t\treader.readAsText(file);\n\t});\n}\n","import { config } from \"../../config.mjs\";\nimport { inputNombreDeCarreaux } from \"../../utils/dom.mjs\";\nimport { calculerLargeurTextePrincipal } from \"../layout/getSize.mjs\";\nimport { zoom } from \"./zoom.mjs\";\n\nexport function zoomAutoCarreaux() {\n\t// Vérification de l'input\n\tlet entree = parseInt(inputNombreDeCarreaux.value);\n\tif (isNaN(entree) || entree === 0) {\n\t\tentree = 5;\n\t}\n\n\t// Mise à jour du nombre de carreaux\n\tconfig.nombreDeCarreaux = entree;\n\tinputNombreDeCarreaux.value = config.nombreDeCarreaux;\n\n\t// Largeur de page\n\tconst largeurPage = calculerLargeurTextePrincipal();\n\n\t// Largeur de carreau à atteindre\n\tlet largeurDeCarreauAAtteindre = largeurPage / config.nombreDeCarreaux;\n\n\t// Application\n\tzoom(false, largeurDeCarreauAAtteindre, config.police_active);\n}\n","import { divConfirmationNouveau, ouvre } from \"../../utils/dom.mjs\";\n\nexport function nouveauTexte() {\n\touvre(divConfirmationNouveau);\n}\n","import { ferme, ouvre, boutonCodi, divCodi } from \"../../utils/dom.mjs\";\nimport { copieLienCodi } from \"../../save-load/import-from-markdown.mjs\";\n\nfunction initImportMarkdownButtons() {\n\tconst boutonFermeCodi = document.getElementById(\"boutonFermeCodi\");\n\tif (boutonCodi)\n\t\tboutonCodi.addEventListener(\"click\", () => {\n\t\t\tcopieLienCodi();\n\t\t});\n\tif (boutonFermeCodi)\n\t\tboutonFermeCodi.addEventListener(\"click\", () => {\n\t\t\tif (divCodi) ferme(divCodi);\n\t\t\telse {\n\t\t\t\tif (divCodi) divCodi.classList.add(\"hide\");\n\t\t\t}\n\t\t});\n}\n\nlet firstTimeImportMarkdown = true;\n\nexport function importMarkdownButton() {\n\tif (firstTimeImportMarkdown) {\n\t\tinitImportMarkdownButtons();\n\t\tfirstTimeImportMarkdown = false;\n\t}\n\tconst target = divCodi;\n\tif (target) ouvre(target);\n\tconst ic = document.getElementById(\"inputCodi\");\n\tif (ic) ic.focus();\n}\n","import { divConfirmationNouveau, ferme } from \"../../utils/dom.mjs\";\nimport { resetContent } from \"../../ui/content/resetContent.mjs\";\n\nexport function handleYesButton() {\n\ttry {\n\t\tferme(divConfirmationNouveau);\n\t\tresetContent();\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n}\n\nexport function handleNoButton() {\n\ttry {\n\t\tferme(divConfirmationNouveau);\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n}\n","import { ouvre, divApropos } from \"../../utils/dom.mjs\";\n\nconst aboutText = `<ul>\n          <span i18_content=\"apropos_message_part1\">Seyes est une application sous licence libre GNU GPL, de la </span>\n          <a class=\"cartouche\" style=\"background-image: url(./images/educajou.png);\" href=\"https://educajou.forge.apps.education.fr/\" i18_content=\"apropos_message_link\">suite Éducajou</a>\n          <span i18_content=\"apropos_message_part2\">, écrite par Arnaud Champollion.</span>\n        </ul>\n        <br>\n        <h2>Documentation</h2>\n        <br>\n        <span id=\"spanCeditNum40\">Illustration explicative réalisée par <a target=\"_blank\" href=\"https://blogacabdx.ac-bordeaux.fr/numerique40/2023/11/22/application-seyes-deducajou/\">l'Équipe numérique 40</a> sous licence Creative Commons BY SA</span>\n        <br><br>\n        <h2 i18_content=\"apropos_polices_title\">Polices utilisées</h2>\n        <br>\n        <span i18_content=\"apropos_police_aa_cursive\">AA Cursive, par A. Renaudin, sous licence libre OFL.</span>\n        <br>\n        <span i18_content=\"apropos_police_open_dyslexic\">Open Dyslexic, par Abelardo Gonzalez, sous licence libre.</span>\n        <br>\n        <span i18_content=\"apropos_police_luciole\">Luciole par Laurent Bourcellier & Jonathan Perez, sous licence libre Creative Commons BY.</span>\n        <br>\n        <span i18_content=\"apropos_police_belle_allure\">Belle Allure par Jean Boyault, avec son aimable autorisation.</span>\n        <br>\n        <span i18_content=\"apropos_police_arial_acces\">Arial & Acces ne sont pas présentes sur cette application, néanmoins si elles sont installées sur votre ordinateur, Seyes pourra les utiliser.</span>\n        <br><br>\n        <h2 i18_content=\"apropos_bibliotheques_title\">Bibliothèques</h2>\n        <span i18_content=\"apropos_bibliotheque_flatpickr_part1\">La fonction de calendrier s'appuie sur la bibliothèque </span>\n        <a target=\"_blank\" href=\"https://github.com/flatpickr/flatpickr\" i18_content=\"apropos_bibliotheque_flatpickr_link\">flatpickr</a>\n        <span i18_content=\"apropos_bibliotheque_flatpickr_part2\"> sous licence MIT.</span>\n        <br>\n        <span i18_content=\"apropos_bibliotheque_mammoth_part1\">La fonction d'import de fichier docx s'appuie sur </span>\n        <a target=\"_blank\" href=\"https://github.com/mwilliamson/mammoth.js\" i18_content=\"apropos_bibliotheque_mammoth_link\">Mammoth</a>\n        <span i18_content=\"apropos_bibliotheque_mammoth_part2\"> sous licence BSD.</span>\n        <br><br>\n        <h2 i18_content=\"apropos_utiliser_hors_ligne_title\">Utiliser hors-ligne</h2>\n        <br>\n        <ul>\n          <span i18_content=\"apropos_utiliser_hors_ligne_message_part1\">Télécharger l'application </span>\n          <a class=\"cartouche\" style=\"background-image: url(./images/zip.png);\" href=\"https://forge.apps.education.fr/educajou/seyes/-/archive/main/seyes-main.zip?path=web\" i18_content=\"apropos_utiliser_hors_ligne_message_link\">seyes-main.zip</a>\n        </ul>\n        <ul i18_content=\"apropos_extraire_zip_message\">Extraire le ZIP</ul>\n        <ul i18_content=\"apropos_ouvrir_fichier_message\">Ouvrir le fichier index.html</ul>\n        <br>\n        <h2 i18_content=\"apropos_en_savoir_plus_title\">En savoir plus et accéder aux sources</h2>\n        <br>\n        <ul>\n          <span i18_content=\"apropos_en_savoir_plus_message_part1\">Voir </span>\n          <a class=\"cartouche\" style=\"background-image: url(./images/forge.png);\" href=\"https://forge.apps.education.fr/educajou/seyes\" i18_content=\"apropos_en_savoir_plus_message_link\">la page du projet</a>\n          <span i18_content=\"apropos_en_savoir_plus_message_part2\"> sur la Forge des Communs Numériques Éducatifs.</span>\n        </ul>\n        <br>\n        <h2 i18_content=\"apropos_contact_title\">Contactez-moi</h2>\n        <br>\n        <p>\n          <span i18_content=\"apropos_contact_message_part1\">Vous pouvez </span>\n          <a target=\"_blank\" href=\"https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=bug\" i18_content=\"apropos_contact_message_link1\">signaler un bug</a>\n          <span i18_content=\"apropos_contact_message_part2\"> ou </span>\n          <a target=\"_blank\" href=\"https://forge.apps.education.fr/educajou/seyes/-/issues/new?issuable_template=suggestion\" i18_content=\"apropos_contact_message_link2\">suggérer une fonctionnalité</a>\n        </p>\n        <p i18_content=\"apropos_contact_message_2\">Il vous sera demandé de vous connecter avec votre compte Apps Éducation. Vous recevrez les notifications de réponses sur votre boîte email académique.</p>`;\n\nlet aboutInitialized = false;\n\nexport function openAbout() {\n\tif (!aboutInitialized) {\n\t\tconst aboutContent = divApropos.querySelector(\".contenu-lightbox\");\n\t\taboutContent.innerHTML = aboutText;\n\t\taboutInitialized = true;\n\t}\n\touvre(divApropos);\n}\n","import { ouvre, ferme, get } from \"../../utils/dom.mjs\";\nimport { getContentForSaving, handleJSONFile } from \"../../save-load/files.mjs\";\nimport { config } from \"../../config.mjs\";\nimport { stocke } from \"../../settings/read-write.mjs\";\nimport { T } from \"../../ui/language.mjs\";\n\nexport function initCloudLoadHandlers() {\n\tconst cloudLoadBtn = get(\"cloud_load\");\n\tconst cancelBtn = get(\"cancelCloudLoad\");\n\tconst confirmationLoad = get(\"confirmation_load\");\n\tconst inputId = get(\"inputCloudLoadId\");\n\tconst okBtn = get(\"okCloudLoad\");\n\t// Open dialog when button clicked\n\tcloudLoadBtn.addEventListener(\"click\", () => {\n\t\topenCloudLoadDialog();\n\t});\n\t// Cancel button closes the dialog\n\tcancelBtn.addEventListener(\"click\", () => {\n\t\tferme(confirmationLoad);\n\t});\n\t// OK button start the load process\n\tokBtn.addEventListener(\"click\", () => {\n\t\tlet udi = (inputId.value || \"\").trim();\n\t\tif (udi.length === 0) {\n\t\t\tget(\"cloud_load_status\").textContent = T(\n\t\t\t\t\"cloud_load_bad_udi\",\n\t\t\t\t\"Veuillez entrer un UDI valide.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\tloadContentFromCloud(udi);\n\t});\n}\nexport function initCloudSaveHandlers() {\n\tconst cloudSaveBtn = get(\"cloud_save\");\n\tconst confirmationSave = get(\"confirmation_save\"); // lightbox dialog\n\tconst okBtn = get(\"okCloudSave\");\n\tconst cancelBtn = get(\"cancelCloudSave\");\n\tconst inputId = get(\"inputCloudSaveId\");\n\tconst cloudSaveDoneBtn = get(\"okCloudSaveDone\");\n\tconst cloudConfirmationSaveSuccess = get(\"confirmation_save_success\"); // lightbox dialog\n\n\t// Open dialog when button clicked\n\tcloudSaveBtn.addEventListener(\"click\", () => {\n\t\topenCloudSaveDialog();\n\t});\n\n\t// Cancel button closes the dialog\n\tcancelBtn.addEventListener(\"click\", () => {\n\t\tferme(confirmationSave);\n\t});\n\n\t// OK button start the saving process\n\tokBtn.addEventListener(\"click\", () => {\n\t\tlet udi = (inputId.value || \"\").trim();\n\t\tudi = saveContentToCloud(udi);\n\t\t//ferme(confirmationSave);\n\t\t//inputId.value = \"\"; // Clear input for next use\n\t});\n\n\t// Done button closes the success dialog\n\tcloudSaveDoneBtn.addEventListener(\"click\", () => {\n\t\tferme(cloudConfirmationSaveSuccess);\n\t});\n\n\t// click on the input field select the radio button\n\tinputId.addEventListener(\"click\", () => {\n\t\tget(\"cloud_save_existing\").checked = true;\n\t});\n}\n\nexport function openCloudLoadDialog() {\n\touvre(get(\"confirmation_load\"));\n\tget(\"inputCloudLoadId\").value = config.sharedUDI || \"\";\n\tget(\"okCloudLoad\").disabled = false; // The button should be active only when there is an UDI, but I dont know how to do this\n\tget(\"cloud_load_status\").textContent = \"\";\n}\nexport function openCloudSaveDialog() {\n\tget(\"okCloudSave\").disabled = false;\n\tget(\"cloud_status_ok\").textContent = \"\";\n\tget(\"cloud_status_ko\").textContent = \"\";\n\tget(\"inputCloudSaveId\").value = config.sharedUDI || \"\"; // ou litDepuisStockage ?\n\tferme(get(\"confirmation_save\"));\n\touvre(get(\"confirmation_save\"));\n}\n\nfunction loadContentFromCloud(udi) {\n\tudi = udi.toUpperCase();\n\tconsole.log(`Loading document from cloud with UDI: ${udi}`);\n\tget(\"cloud_load_status\").textContent = \"...⌛...\";\n\tget(\"okCloudLoad\").disabled = true;\n\tgetDocumentFromCloud(udi);\n}\nfunction saveContentToCloud(udi) {\n\tlet newUdi;\n\tudi = udi.toUpperCase();\n\tconsole.log(`Saving document to cloud with UDI: ${udi}`);\n\tget(\"cloud_status_ok\").textContent = \"...⌛...\";\n\tget(\"cloud_status_ko\").textContent = \"\";\n\tget(\"okCloudSave\").disabled = true;\n\tconst cloud_save_option = get(\"cloud_save_new\").checked ? \"new\" : \"update\";\n\tconst content = getContentForSaving(config.prefixeAppli);\n\tconst jsonData = JSON.stringify(content);\n\tconsole.log(\"Document content:\", content);\n\tif (cloud_save_option === \"new\") {\n\t\tnewUdi = saveNewDocumentToCloud(jsonData);\n\t} else if (cloud_save_option === \"update\") {\n\t\tif (!udi || udi.length === 0) {\n\t\t\talert(\"Please provide a valid UDI to update an existing document.\");\n\t\t\treturn false;\n\t\t}\n\t\tnewUdi = updateDocumentInCloud(udi, jsonData);\n\t}\n\treturn newUdi;\n}\n\nfunction documentUpdatedFromCloud(udi) {\n\tget(\"cloud_load_status\").textContent = \"\";\n\tferme(get(\"confirmation_load\"));\n\tget(\"okCloudLoad\").disabled = false;\n}\nfunction documentUpdatedInCloud(udi) {\n\tferme(get(\"confirmation_save\"));\n\touvre(get(\"confirmation_save_success\"));\n\tget(\"cloud_status_ok\").textContent = T(\n\t\t\"cloud_save_done\",\n\t\t\"Document sauvegardé.\",\n\t);\n\t// reinit dialog UI\n\tget(\"okCloudSave\").disabled = false;\n\tget(\"inputCloudSaveId\").value = udi;\n\tget(\"inputCloudSaveNewId\").value = udi;\n\tget(\"inputCloudSaveNewId\").focus();\n\tget(\"inputCloudSaveNewId\").select();\n\tget(\"cloud_save_new\").checked = false;\n\tget(\"cloud_save_existing\").checked = true; // By defaut, to prevent user misclick, we preselect the update more than the save new\n\tstocke(\"shared-udi\", udi);\n\tconfig.sharedUDI = udi;\n}\n\nfunction getDocumentFromCloud(udi) {\n\tconst url = new URL(config.sharedURL);\n\turl.searchParams.set(\"udi\", udi);\n\tconsole.log(\"Getting document from URL:\", url.toString());\n\tfetch(url.toString(), {\n\t\tmethod: \"GET\",\n\t})\n\t\t.then((response) => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response.text();\n\t\t\t} else {\n\t\t\t\treturn response.text().then((text) => {\n\t\t\t\t\tthrow new Error(response.status + \": \" + text);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.then((data) => {\n\t\t\tconsole.log(\"GET data:\\n\", data);\n\t\t\thandleJSONFile(data);\n\t\t\tdocumentUpdatedFromCloud(udi);\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconsole.log(\"GET error:\\n\", error);\n\t\t\tget(\"cloud_load_status\").innerHTML = error.message;\n\t\t\tget(\"okCloudLoad\").disabled = false;\n\t\t});\n}\nfunction updateDocumentInCloud(udi, content) {\n\tconst url = new URL(config.sharedURL);\n\turl.searchParams.set(\"udi\", udi);\n\tconsole.log(\"Updating document at URL:\", url.toString());\n\tfetch(url.toString(), {\n\t\tmethod: \"POST\",\n\t\tbody: content,\n\t})\n\t\t.then((response) => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response.text();\n\t\t\t} else {\n\t\t\t\treturn response.text().then((text) => {\n\t\t\t\t\tthrow new Error(response.status + \": \" + text);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.then((responseData) => {\n\t\t\tconsole.log(\"PUT data:\\n\", responseData);\n\t\t\t// Extract UDI from \"OK:UDI\" response\n\t\t\tconst match = responseData.match(/^OK:(.+)/);\n\t\t\t//setError(responseData);\n\t\t\tif (match) {\n\t\t\t\tlet udi = match[1].trim();\n\t\t\t\tconsole.log(\"UDI:\", udi);\n\t\t\t\tdocumentUpdatedInCloud(udi);\n\t\t\t\treturn udi;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"UDI not returned?\");\n\t\t\t\tget(\"cloud_status_ko\").textContent =\n\t\t\t\t\t\"Echec de la sauvegarde, UDI non retourné.\";\n\t\t\t\treturn false;\n\t\t\t}\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconst inputId = get(\"inputCloudSaveId\");\n\t\t\tconsole.log(\"POST error:\\n\", error);\n\t\t\tget(\"cloud_status_ko\").innerHTML = error.message;\n\t\t\tget(\"cloud_status_ok\").textContent = \"\";\n\t\t\t//setError(error.message);\n\t\t\tget(\"okCloudSave\").disabled = false;\n\n\t\t\treturn false;\n\t\t});\n}\nfunction saveNewDocumentToCloud(content) {\n\tconst sharedURL = config.sharedURL;\n\t// Do a PUT request to send the document to the cloud\n\tfetch(sharedURL, {\n\t\tmethod: \"PUT\",\n\t\tbody: content,\n\t})\n\t\t.then((response) => {\n\t\t\tif (response.ok) {\n\t\t\t\treturn response.text();\n\t\t\t} else {\n\t\t\t\treturn response.text().then((text) => {\n\t\t\t\t\tthrow new Error(response.status + \": \" + text);\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.then((responseData) => {\n\t\t\tconsole.log(\"PUT data:\\n\", responseData);\n\t\t\t// Extract UDI from \"OK:UDI\" response\n\t\t\tconst match = responseData.match(/^OK:(.+)/);\n\t\t\t//setError(responseData);\n\t\t\tif (match) {\n\t\t\t\tlet udi = match[1].trim();\n\t\t\t\tconsole.log(\"UDI:\", udi);\n\t\t\t\tdocumentUpdatedInCloud(udi);\n\t\t\t\treturn udi;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"UDI not returned?\");\n\t\t\t\tget(\"cloud_status_ko\").textContent =\n\t\t\t\t\t\"Echec de la sauvegarde, UDI non retourné.\";\n\t\t\t\treturn false;\n\t\t\t}\n\t\t})\n\t\t.catch((error) => {\n\t\t\tconst inputId = get(\"inputCloudSaveId\");\n\t\t\tconsole.log(\"PUT error:\\n\", error);\n\t\t\t//setError(error.message);\n\t\t\tget(\"cloud_status_ko\").textContent = error.message;\n\t\t\tget(\"cloud_status_ok\").textContent = \"\";\n\t\t\tget(\"okCloudSave\").disabled = false;\n\t\t\treturn false;\n\t\t});\n}\n","import { config } from \"../../config.mjs\";\nimport {\n\tcase2,\n\tcase3,\n\tdivMarge,\n\tdivMargeEntete,\n\tgraphismes,\n\timages,\n\tmargeSecondaire,\n\tpage,\n} from \"../../utils/dom.mjs\";\nimport { activeRegle } from \"../../menu/buttons/ruler.mjs\";\nimport { save_texte, stocke } from \"../../settings/read-write.mjs\";\nimport { majDimensionsPrint } from \"../display/print.mjs\";\nimport { calculeNombreDeCarreaux } from \"../layout/getSize.mjs\";\n\nlet dragged = null;\n\n// Mouse / drag position helpers\nlet posX = 0;\nlet posY = 0;\nlet posXDepartSouris = 0;\nlet posYDepartSouris = 0;\nlet posXSouris = 0;\nlet posYSouris = 0;\nlet diffsourisx = 0;\nlet diffsourisy = 0;\nlet diffX = 0;\nlet diffY = 0;\nlet redim = false;\nlet startX, startY; // Position de départ du trait\nlet lineDiv = null; // La div représentant le trait\n\nlet imageRedim = false;\nlet imageRedimDimension = null;\nlet imageRedimTaille = null;\n\nlet sensRedimImageEnCours =\n\t(imageRedimDimension =\n\timageRedim =\n\timageRedimTaille =\n\t\tfalse);\n\n// Fonction pour ajuster la position de la souris au quadrillage\nfunction snapToGrid(value, gridSize = config.largeur_carreau) {\n\treturn Math.round(value / gridSize) * gridSize;\n}\n\nfunction touchClientX(event) {\n\treturn (\n\t\tevent &&\n\t\tevent.targetTouches &&\n\t\tevent.targetTouches[0] &&\n\t\tevent.targetTouches[0].clientX\n\t);\n}\nfunction touchClientY(event) {\n\treturn (\n\t\tevent &&\n\t\tevent.targetTouches &&\n\t\tevent.targetTouches[0] &&\n\t\tevent.targetTouches[0].clientY\n\t);\n}\nfunction clientX(event) {\n\treturn touchClientX(event) || (event && event.clientX);\n}\nfunction clientY(event) {\n\treturn touchClientY(event) || (event && event.clientY);\n}\n// --- fin helpers ---\n\n// Fonction pour changer le curseur lors du survol des points d'accroche\nfunction moveCursor(event) {\n\tconst rect = page.getBoundingClientRect();\n\tconst mouseX = clientX(event) - rect.left;\n\tconst mouseY = clientY(event) - rect.top;\n\n\tif (config.regleActive) {\n\t\tconst snappedX = snapToGrid(mouseX);\n\t\tconst snappedY = snapToGrid(mouseY);\n\n\t\tif (\n\t\t\tMath.abs(mouseX - snappedX) < config.largeur_carreau / 8 &&\n\t\t\tMath.abs(mouseY - snappedY) < config.largeur_carreau / 8\n\t\t) {\n\t\t\tpage.style.cursor = \"url(./images/crayonrouge.png) 0 30, auto\";\n\t\t} else if (!config.isDrawing) {\n\t\t\tpage.style.cursor = \"url(./images/crayon.png) 0 30, auto \";\n\t\t}\n\t}\n}\n\nfunction clic(event) {\n\tsave_texte();\n\n\tif (event.target.classList.contains(\"gestion-texte\")) {\n\t\tevent.preventDefault();\n\t}\n\n\t// DÉSELCTION DES CONTENEURS IMAGES SÉLECTIONNES\n\n\tif (!event.target.closest(\".selectionne\")) {\n\t\tconst imagesSelectionnees = images.querySelectorAll(\".selectionne\");\n\t\timagesSelectionnees.forEach((conteneurImage) => {\n\t\t\tconteneurImage.classList.remove(\"selectionne\");\n\t\t});\n\t}\n\n\t// FERMETURE AUTO DES MENUS\n\tconst menuSoulignement = document.getElementById(\"boutons_soulignement\");\n\tconst menuCarreaux = document.getElementById(\"boutons_carreaux\");\n\tconst menuCouleurTexte = document.getElementById(\"boutons-couleur-texte\");\n\tconst datepickerDiv = document.getElementById(\"datepicker\");\n\tconst flatpickrCalendar = document.querySelector(\".flatpickr-calendar\");\n\n\tconst clicSurEnfantdeCalendar = objetOuEnfantDe(\n\t\tevent.target,\n\t\tflatpickrCalendar\n\t);\n\n\t// Si le clic n'a pas été fait sur un des menus déroulants ou le calendrier, fermer les menus\n\tif (\n\t\t!clicSurEnfantdeCalendar &&\n\t\t!event.target.classList.contains(\"deroule-couleur\") &&\n\t\t!event.target.classList.contains(\"deroule-souligne\") &&\n\t\t!event.target.classList.contains(\"deroule_carreaux\") &&\n\t\t!event.target.classList.contains(\"flatpickr-calendar\")\n\t) {\n\t\t// Ferme tous les menus\n\t\tmenuSoulignement.classList.add(\"hide\");\n\t\tmenuCarreaux.classList.add(\"hide\");\n\t\tmenuCouleurTexte.classList.add(\"hide\");\n\t\tdatepickerDiv.classList.add(\"hide\"); // Cache le calendrier après sélection\n\n\t\tif (flatpickrCalendar) {\n\t\t\tflatpickrCalendar.classList.add(\"hide\"); // Cache le calendrier\n\t\t}\n\t}\n\t// FIN DE LA FERMETURE AUTO DES MENUS\n\n\tif (\n\t\tevent.target.classList.contains(\"bouton-supprimer-trait\") &&\n\t\t!config.regleActive &&\n\t\tconfig.selected\n\t) {\n\t\tconfig.selected.remove();\n\t\tconfig.selected = null;\n\t}\n\n\tif (\n\t\tevent.target.classList.contains(\"bouton-couleur-trait\") &&\n\t\t!config.regleActive &&\n\t\tconfig.selected\n\t) {\n\t\tdocument.getElementById(\"inputCouleurTrait\").click();\n\t}\n\n\tif (event.target.classList.contains(\"trait\") && !config.regleActive) {\n\t\tif (config.selected) {\n\t\t\tconfig.selected.classList.remove(\"select\");\n\t\t}\n\t\tevent.target.classList.add(\"select\");\n\t\tconfig.selected = event.target;\n\t} else if (\n\t\tconfig.selected &&\n\t\t!event.target.classList.contains(\"bouton-couleur-trait\")\n\t) {\n\t\tconfig.selected.classList.remove(\"select\");\n\t\tconfig.selected = null;\n\t}\n\n\tconst borderWidth = 10; // Largeur de la bordure (en pixels)\n\tconst rect = page.getBoundingClientRect(); // Récupère les dimensions et la position de la div \"page\"\n\tconst rect2 = margeSecondaire.getBoundingClientRect(); // Récupère les dimensions et la position de la div \"page\"\n\tposX = clientX(event);\n\tposY = clientY(event);\n\tconst mouseX = posX - rect.left; // Position de la souris horizontalement par rapport à la div \"page\"\n\tconst mouseY = posY - rect.top;\n\tconst mouseXmarge = posX - rect2.left; // Position de la souris horizontalement par rapport à la div \"page\"\n\n\tlet draggable_item = false;\n\tif (event.target.classList.contains(\"draggable_item\")) {\n\t\tdraggable_item = true;\n\t}\n\n\tif (event.target.classList.contains(\"poignee\")) {\n\t\tsensRedimImageEnCours = event.target.classList[1];\n\t\tdocument.body.style.cursor = sensRedimImageEnCours + \"-resize\";\n\n\t\tposXDepartSouris = posX;\n\t\tposYDepartSouris = posY;\n\n\t\tlet conteneurImage = event.target.closest(\".conteneur-image\");\n\t\tlet image =\n\t\t\tconteneurImage.querySelector(\".image\") ||\n\t\t\tconteneurImage.querySelector(\".timer\");\n\t\timageRedim = image;\n\t\tlet imageRedimWidth = image.clientWidth;\n\t\tlet imageRedimHeight = image.clientHeight;\n\t\timageRedimDimension =\n\t\t\timageRedimHeight > imageRedimWidth ? \"height\" : \"width\";\n\t\timageRedimTaille = Math.max(imageRedimWidth, imageRedimHeight);\n\t} else if (event.target.classList.contains(\"draggable\") || draggable_item) {\n\t\tevent.preventDefault();\n\t\tif (draggable_item) {\n\t\t\tdragged = event.target.parentNode;\n\t\t} else {\n\t\t\tdragged = event.target;\n\t\t}\n\t\tdiffsourisx = posX - dragged.offsetLeft;\n\t\tdiffsourisy = posY - dragged.offsetTop;\n\t\tdragged.classList.add(\"dragged\");\n\t} else if (mouseX <= borderWidth && mouseX > -borderWidth) {\n\t\t// Vérifie si le clic est dans une zone de 5px de la bordure gauche\n\t\tredim = page;\n\t\tdocument.body.style.cursor = \"ew-resize\";\n\t\tposXDepartSouris = posX;\n\t\tconfig.largeur_page = page.offsetWidth;\n\t\tconfig.largeur_marge = divMarge.offsetWidth;\n\t} else if (mouseXmarge <= borderWidth && mouseXmarge > -borderWidth) {\n\t\t// Vérifie si le clic est dans une zone de 5px de la bordure gauche\n\t\tredim = margeSecondaire;\n\t\tdocument.body.style.cursor = \"ew-resize\";\n\t\tposXDepartSouris = posX;\n\t\tconfig.largeur_marge_secondaire = margeSecondaire.offsetWidth;\n\t} else if (config.regleActive) {\n\t\t// Gérer le traçage des lignes si regleActive est vrai\n\t\tconst snappedX = snapToGrid(mouseX);\n\t\tconst snappedY = snapToGrid(mouseY);\n\t\tif (\n\t\t\tMath.abs(mouseX - snappedX) < config.largeur_carreau / 8 &&\n\t\t\tMath.abs(mouseY - snappedY) < config.largeur_carreau / 8\n\t\t) {\n\t\t\tconfig.isDrawing = true;\n\t\t\tstartX = snappedX;\n\t\t\tstartY = snappedY;\n\n\t\t\t// Créer une div pour représenter le trait\n\t\t\tlineDiv = document.createElement(\"div\");\n\t\t\tlineDiv.classList.add(\"trait\");\n\t\t\tlineDiv.classList.add(\"horizontal\");\n\t\t\tlineDiv.classList.add(\"draggable\");\n\n\t\t\tlineDiv.style.position = \"absolute\";\n\t\t\tlineDiv.style.backgroundColor = \"red\";\n\t\t\tlineDiv.style.width = \"6px\"; // Par défaut, un trait vertical\n\t\t\tlineDiv.style.height = \"6px\"; // Minimum taille\n\t\t\tlineDiv.style.left = startX + \"px\";\n\t\t\tlineDiv.style.top = startY + \"px\";\n\n\t\t\tlet boutonSupprimer = document.createElement(\"button\");\n\t\t\tboutonSupprimer.classList.add(\"bouton-supprimer-trait\");\n\t\t\tlineDiv.appendChild(boutonSupprimer);\n\n\t\t\tlet boutonCouleur = document.createElement(\"button\");\n\t\t\tboutonCouleur.classList.add(\"bouton-couleur-trait\");\n\t\t\tlineDiv.appendChild(boutonCouleur);\n\n\t\t\tgraphismes.appendChild(lineDiv);\n\t\t}\n\t}\n}\n\nfunction move(event) {\n\tposXSouris = clientX(event);\n\tposYSouris = clientY(event);\n\tconst rect = page.getBoundingClientRect();\n\tconst mouseX = posXSouris - rect.left;\n\tconst mouseY = posYSouris - rect.top;\n\n\tif (sensRedimImageEnCours) {\n\t\tdiffX = posXSouris - posXDepartSouris;\n\t\tdiffY = posYSouris - posYDepartSouris;\n\n\t\tif (sensRedimImageEnCours.includes(\"w\")) {\n\t\t\tdiffX = -diffX;\n\t\t}\n\t\tif (sensRedimImageEnCours.includes(\"n\")) {\n\t\t\tdiffY = -diffY;\n\t\t}\n\n\t\tlet diff = diffX + diffY;\n\n\t\tif (imageRedim.classList.contains(\"timer\")) {\n\t\t\timageRedim.style.width = imageRedim.style.height = `${\n\t\t\t\timageRedimTaille + diff\n\t\t\t}px`;\n\t\t} else {\n\t\t\timageRedim.style[imageRedimDimension] = `${imageRedimTaille + diff}px`;\n\t\t}\n\t} else if (redim === page) {\n\t\tdiffX = posXSouris - posXDepartSouris;\n\t\tif (config.largeur_marge + diffX >= 60) {\n\t\t\tpage.style.width = case3.style.width = config.largeur_page - diffX + \"px\";\n\t\t\tdivMarge.style.width = config.largeur_marge + diffX - 3 + \"px\";\n\n\t\t\tdivMargeEntete.style.width = config.largeur_marge + diffX + \"px\";\n\t\t} else {\n\t\t\tpage.style.width = case3.style.width = \"calc(100% - 60px)\";\n\t\t\tdivMarge.style.width = divMargeEntete.style.width = \"57px\";\n\t\t\tdivMargeEntete.style.width = divMargeEntete.style.width = \"60px\";\n\t\t}\n\t\tcalculeNombreDeCarreaux();\n\t} else if (redim === margeSecondaire) {\n\t\tdiffX = posXSouris - posXDepartSouris;\n\t\tif (\n\t\t\tconfig.largeur_marge_secondaire - diffX >=\n\t\t\tconfig.largeur_carreau * 2.7\n\t\t) {\n\t\t\tmargeSecondaire.style.width =\n\t\t\t\tconfig.largeur_marge_secondaire - diffX + \"px\";\n\t\t\tcase2.style.width = config.largeur_marge_secondaire - diffX + \"px\";\n\t\t} else {\n\t\t\tmargeSecondaire.style.width = config.largeur_carreau * 2.7 + \"px\";\n\t\t\tcase2.style.width = config.largeur_carreau * 2.7 + \"px\";\n\t\t}\n\t\tcalculeNombreDeCarreaux();\n\t}\n\n\tif (dragged) {\n\t\tdragged.style.right = null;\n\t\tdragged.style.bottom = null;\n\t\tevent.preventDefault();\n\t\tconst pageX = clientX(event) || 0;\n\t\tconst pageY = clientY(event) || 0;\n\t\tdragged.style.left = pageX - diffsourisx + \"px\";\n\t\tdragged.style.top = pageY - diffsourisy + \"px\";\n\t} else if (config.isDrawing && lineDiv) {\n\t\t// Gérer le traçage de la ligne\n\t\tconst snappedX = snapToGrid(mouseX);\n\t\tconst snappedY = snapToGrid(mouseY);\n\n\t\t// Calculer la direction du trait (horizontal ou vertical)\n\t\tconst diffX = snappedX - startX;\n\t\tconst diffY = snappedY - startY;\n\n\t\tif (Math.abs(diffX) > Math.abs(diffY)) {\n\t\t\t// Traçage horizontal\n\t\t\tlet longueur = Math.abs(diffX);\n\t\t\tlineDiv.style.width =\n\t\t\t\tlongueur + config.largeur_carreau * 0.02117171 + \"px\";\n\t\t\tlineDiv.style.height = \"6px\";\n\t\t\tlineDiv.style.top = startY + \"px\";\n\t\t\tlineDiv.style.left = startX + \"px\";\n\t\t\tlineDiv.classList.remove(\"vertical\");\n\t\t\tlineDiv.classList.add(\"horizontal\");\n\n\t\t\tif (diffX < 0) {\n\t\t\t\tlineDiv.style.left = snappedX + \"px\"; // Ajuster la position si on dessine vers la gauche\n\t\t\t}\n\t\t} else {\n\t\t\t// Traçage vertical\n\t\t\tlineDiv.style.height =\n\t\t\t\tMath.abs(diffY) + config.largeur_carreau * 0.02117171 + \"px\";\n\t\t\tlineDiv.style.width = \"6px\";\n\t\t\tlineDiv.classList.remove(\"horizontal\");\n\t\t\tlineDiv.classList.add(\"vertical\");\n\t\t\tif (diffY < 0) {\n\t\t\t\tlineDiv.style.top = snappedY + \"px\"; // Ajuster la position si on dessine vers le haut\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction release() {\n\tredim = false;\n\tdocument.body.style.cursor = null;\n\tconfig.largeur_page = page.offsetWidth;\n\tconfig.largeur_marge = divMarge.offsetWidth;\n\tconfig.largeur_marge_secondaire = margeSecondaire.offsetWidth;\n\tmajDimensionsPrint();\n\n\tstocke(\"largeur-marge\", config.largeur_marge);\n\tstocke(\"largeur-marge-secondaire\", config.largeur_marge_secondaire);\n\tstocke(\"graphismes\", graphismes.innerHTML);\n\tstocke(\"images\", images.innerHTML);\n\n\tif (sensRedimImageEnCours) {\n\t\tsensRedimImageEnCours = false;\n\t}\n\n\t// Fin du déplacement d'élément\n\tif (dragged) {\n\t\tdragged.classList.remove(\"dragged\");\n\n\t\tif (dragged.classList.contains(\"trait\")) {\n\t\t\t// On récupère la position actuelle de l'élément dragged (position absolute)\n\t\t\tlet currentLeft = parseInt(dragged.style.left, 10);\n\t\t\tlet currentTop = parseInt(dragged.style.top, 10);\n\n\t\t\t// Calculer les nouvelles coordonnées alignées sur la grille\n\t\t\tlet newLeft =\n\t\t\t\tMath.round(currentLeft / config.largeur_carreau) *\n\t\t\t\tconfig.largeur_carreau;\n\t\t\tlet newTop =\n\t\t\t\tMath.round(currentTop / config.largeur_carreau) *\n\t\t\t\tconfig.largeur_carreau;\n\n\t\t\t// Repositionner dragged sur la grille invisible\n\t\t\tdragged.style.left = `${newLeft}px`;\n\t\t\tdragged.style.top = `${newTop}px`;\n\t\t}\n\n\t\tdragged = null;\n\t}\n\n\t// Fin du traçage de la ligne\n\tif (config.isDrawing) {\n\t\tconfig.isDrawing = false;\n\t\tlineDiv = null;\n\t\tactiveRegle();\n\t}\n}\n\nexport function handleMouseMove() {\n\tdocument.addEventListener(\"mousemove\", moveCursor);\n\n\t// Écouteurs de souris\n\tdocument.addEventListener(\"touchstart\", clic);\n\tdocument.addEventListener(\"touchmove\", move);\n\tdocument.addEventListener(\"touchend\", release);\n\t// Pour le tactile\n\tdocument.addEventListener(\"mousedown\", clic);\n\tdocument.addEventListener(\"mousemove\", move);\n\tdocument.addEventListener(\"mouseup\", release);\n}\n\nfunction objetOuEnfantDe(cible, objet) {\n\tif (cible === objet) return true;\n\tlet parent = cible.parentNode;\n\twhile (parent) {\n\t\tif (parent === objet) return true;\n\t\tparent = parent.parentNode;\n\t}\n\treturn false;\n}\n","import { config } from \"../config.mjs\";\nimport { jours } from \"../../_locales/date-days.mjs\";\nimport {\n\tbouton_ligatures,\n\tchoix_police,\n\tchoixCouleurEntete,\n\tdivEntete,\n} from \"../utils/dom.mjs\";\nimport { adapteCouleurBordureChoixCouleur } from \"../ui/display/ui-colors.mjs\";\nimport { loadSettings } from \"./loadSettings.mjs\";\nimport { applySettings } from \"./applySettings.mjs\";\nimport { handleInitialWarningMessage } from \"./initialWarningMessage.mjs\";\n\nexport async function initSettings() {\n\thandleInitialWarningMessage();\n\tbouton_ligatures.style.display = \"none\";\n\tconst jourActifDepart = document.getElementById(\"select-jours\").value;\n\tconst couleurDepart = jours[jourActifDepart];\n\tchoixCouleurEntete.value = couleurDepart;\n\tdivEntete.style.backgroundColor = couleurDepart;\n\tchoixCouleurEntete.style.backgroundColor = couleurDepart;\n\tadapteCouleurBordureChoixCouleur();\n\tchoix_police.value = config.police_active;\n\tawait loadSettings();\n\tapplySettings();\n}\n","import { config } from \"../config.mjs\";\nimport { stocke } from \"./read-write.mjs\";\n\nexport function handleInitialWarningMessage() {\n\tdocument.querySelectorAll(\"#show-warning-next-time\").forEach((cb) => {\n\t\tcb.addEventListener(\"change\", (e) => {\n\t\t\tstocke(\n\t\t\t\t`afficher-message${config.numeroMessage}`,\n\t\t\t\te.currentTarget.checked\n\t\t\t);\n\t\t});\n\t});\n}\n","// Seyes est un logiciel libre\n// sous licence GNU GPL\n// écrit par Arnaud Champollion\n// Il fait partie de la suite Éducajou\n\nimport \"../css/styles.css\";\nimport { initMenu } from \"./core/menu/menu.mjs\";\nimport { initSettings } from \"./core/settings/initSettings.mjs\";\nimport { initEvents } from \"./core/ui/events/init-events.mjs\";\n\ninitSettings();\ninitMenu();\ninitEvents();\n","import {\n\tchangeDate,\n\tchangeJour,\n\touvreSelecteurDate,\n\tchangeModeDate,\n\ttoogleMajDateAuto,\n} from \"../date/date.mjs\";\nimport { ouvreBoutonsCouleurs } from \"./buttons/choose-text-color.mjs\";\nimport { opacite, ouvreOptions } from \"./buttons/options-panel.mjs\";\nimport { ouvreBoutonsSouligne } from \"./buttons/underline.mjs\";\nimport { ouvreBoutonsCarreau } from \"./buttons/tiles.mjs\";\nimport { cree_image } from \"./buttons/insert-image.mjs\";\nimport { cree_timer } from \"./buttons/insert-timer.mjs\";\nimport { activeRegle, changeCouleurTrait } from \"./buttons/ruler.mjs\";\nimport { menu_copier_lien, copier } from \"../save-load/copyLink.mjs\";\nimport { pleinecran } from \"../ui/display/fullScreen.mjs\";\nimport { align } from \"../text-format/align.mjs\";\nimport { entoure } from \"../text-format/highlight.mjs\";\nimport { souligne } from \"../text-format/underline.mjs\";\nimport { couleurTexte } from \"../text-format/text-color.mjs\";\nimport { changeCouleurEntete } from \"../ui/display/ui-colors.mjs\";\nimport {\n\tchangeEcrireACheval,\n\tchangeEspacementLettres,\n\tchangeEspacementMots,\n\tchangeInterligneDouble,\n\tchangeLargeurImpression,\n\tchangeVerifieOrthographe,\n} from \"../text-format/change-display.mjs\";\nimport { traiteInputCodi } from \"../save-load/import-from-markdown.mjs\";\nimport { ligatures, change_police } from \"../text-format/fonts/fonts.mjs\";\nimport { ouvrir, prepareEnregistrement } from \"../save-load/files.mjs\";\nimport { changeLangue } from \"../ui/language.mjs\";\nimport { ouvre, get, divIllustration } from \"../utils/dom.mjs\";\nimport { zoom } from \"../ui/zoom/zoom.mjs\";\nimport { zoomAutoCarreaux } from \"../ui/zoom/zoomTiles.mjs\";\nimport { imprimer } from \"../ui/display/print.mjs\";\nimport { nouveauTexte } from \"./buttons/newDocument.mjs\";\nimport { importMarkdownButton } from \"./buttons/importMarkdown.mjs\";\nimport { handleNoButton, handleYesButton } from \"./buttons/yes-no-buttons.mjs\";\nimport { handleCloseButtons } from \"./buttons/close-buttons.mjs\";\nimport { openAbout } from \"./buttons/about.mjs\";\nimport { handleColorButtons } from \"./buttons/color-buttons.mjs\";\nimport {\n\tinitCloudSaveHandlers,\n\tinitCloudLoadHandlers,\n} from \"./buttons/cloud-loadsave.mjs\";\n\nexport function initMenu() {\n\t// Gestion des clics sur les boutons du menu\n\tconst mapClicks = {\n\t\tnouveau: nouveauTexte,\n\t\tenregistrer: prepareEnregistrement,\n\t\touvrir: ouvrir,\n\t\timprimer: imprimer,\n\t\tcodi: importMarkdownButton,\n\t\tcopielien: menu_copier_lien,\n\t\tcopier: copier,\n\t\tdate: changeDate,\n\t\tbouton_deroule_date: ouvreSelecteurDate,\n\t\tzoom_out: () => {\n\t\t\tzoom(-10);\n\t\t},\n\t\tzoom_in: () => {\n\t\t\tzoom(10);\n\t\t},\n\t\tcarreaux: ouvreBoutonsCarreau,\n\t\tbouton_ligatures: ligatures,\n\t\tleft: () => {\n\t\t\talign(\"left\");\n\t\t},\n\t\tcenter: () => {\n\t\t\talign(\"center\");\n\t\t},\n\t\tright: () => {\n\t\t\talign(\"right\");\n\t\t},\n\t\t\"couleur-texte\": (e) => {\n\t\t\tcouleurTexte(e.currentTarget.value);\n\t\t},\n\t\tbouton_deroule_couleurs: ouvreBoutonsCouleurs,\n\t\tsouligne: (e) => {\n\t\t\tsouligne(e.currentTarget.value);\n\t\t},\n\t\tbouton_deroule_souligne: ouvreBoutonsSouligne,\n\t\tbouton_entoure: entoure,\n\t\tregle: activeRegle,\n\t\ta_propos: openAbout,\n\t\taide: () => {\n\t\t\touvre(divIllustration);\n\t\t},\n\t\tfullscreen: pleinecran,\n\t\ttimer: cree_timer,\n\t\toptions: ouvreOptions,\n\t\tpanneauOptions_close_button: ouvreOptions,\n\t\toui: handleYesButton,\n\t\tnon: handleNoButton,\n\t};\n\n\tObject.keys(mapClicks).forEach((id) => {\n\t\tconst el = get(id);\n\t\tif (el) el.addEventListener(\"click\", mapClicks[id]);\n\t});\n\n\t// Gestion des événements \"change\" dans les éléments du menu\n\tconst mapChanges = {\n\t\tchoix_police: change_police,\n\t\tinputEcrireACheval: changeEcrireACheval,\n\t\tinputOpacite: opacite,\n\t\tcheckboxInterligneDouble: changeInterligneDouble,\n\t\tcheckboxAjouterDate: changeModeDate,\n\t\tcheckboxMajDateAuto: toogleMajDateAuto,\n\t\tcheckboxSoulignerDate: changeModeDate,\n\t\tcheckboxVerifierOrthographe: changeVerifieOrthographe,\n\t\tinputLargeurImpression: changeLargeurImpression,\n\t\tselectLangue: changeLangue,\n\t\tinputNombreDeCarreaux: zoomAutoCarreaux,\n\t};\n\n\tObject.keys(mapChanges).forEach((id) => {\n\t\tconst el = get(id);\n\t\tif (el)\n\t\t\tel.addEventListener(\"change\", (e) => {\n\t\t\t\tmapChanges[id](e.currentTarget.value);\n\t\t\t});\n\t});\n\n\t// Gestion des événements \"input\" dans les éléments du menu\n\tconst mapInputs = {\n\t\tinputEspacement: changeEspacementLettres,\n\t\tinputEspacementMots: changeEspacementMots,\n\t\tinputOpacite: opacite,\n\t\tinputCodi: traiteInputCodi,\n\t\tinputCouleurTrait: changeCouleurTrait,\n\t\t\"choix-couleur-entete\": changeCouleurEntete,\n\t\tselectJours: changeJour,\n\t\tinputFichier: cree_image,\n\t};\n\n\tObject.keys(mapInputs).forEach((id) => {\n\t\tconst el = get(id);\n\t\tif (el)\n\t\t\tel.addEventListener(\"input\", (e) => {\n\t\t\t\tif (id == \"inputFichier\") {\n\t\t\t\t\tmapInputs[id](e);\n\t\t\t\t} else {\n\t\t\t\t\tmapInputs[id](e.currentTarget.value);\n\t\t\t\t}\n\t\t\t});\n\t});\n\n\thandleCloseButtons();\n\thandleColorButtons();\n\tinitCloudSaveHandlers();\n\tinitCloudLoadHandlers();\n}\n","export function handleCloseButtons() {\n\tdocument.querySelectorAll(\".bouton-fermer\").forEach((btn) => {\n\t\tbtn.addEventListener(\"click\", (e) => {\n\t\t\tconst lb = e.currentTarget.closest(\".lightbox\");\n\t\t\tif (lb) lb.classList.add(\"hide\");\n\t\t\tconst db = document.getElementById(\"darkbox\");\n\t\t\tif (db) db.classList.add(\"hide\");\n\t\t});\n\t});\n}\n","import { couleurTexte } from \"../../text-format/text-color.mjs\";\n\nexport function handleColorButtons() {\n\tdocument\n\t\t.querySelectorAll(\n\t\t\t\"#boutons-couleur-texte .bouton-couleur, #boutons_couleur-texte .bouton-couleur, #boutons-couleur-texte .deroule-couleur, .deroule-couleur.bouton-couleur\"\n\t\t)\n\t\t.forEach((btn) => {\n\t\t\tbtn.addEventListener(\"click\", (e) => {\n\t\t\t\tcouleurTexte(e.currentTarget.value);\n\t\t\t});\n\t\t});\n}\n","export function handlePasteEvent() {\n\tdocument.addEventListener(\"paste\", function (e) {\n\t\te.preventDefault(); // Empêcher le comportement par défaut\n\n\t\tlet clipboardData = e.clipboardData || e.originalEvent.clipboardData;\n\n\t\t// Gestion du texte\n\t\tlet text = clipboardData.getData(\"text/plain\");\n\t\tif (text) {\n\t\t\ttext = text.replace(/<[^>]*>/g, \"\"); // Supprime les balises HTML\n\t\t\tdocument.execCommand(\"insertText\", false, text);\n\t\t}\n\n\t\t// Gestion des images\n\t\tlet items = clipboardData.items;\n\t\tfor (let item of items) {\n\t\t\tif (item.type.indexOf(\"image\") !== -1) {\n\t\t\t\tlet file = item.getAsFile();\n\t\t\t\tlet reader = new FileReader();\n\n\t\t\t\treader.onload = function (event) {\n\t\t\t\t\tlet img = document.createElement(\"img\");\n\t\t\t\t\timg.src = event.target.result;\n\t\t\t\t\timg.style.maxWidth = \"100%\"; // Ajustement du style si nécessaire\n\t\t\t\t\tdocument.execCommand(\"insertHTML\", false, img.outerHTML);\n\t\t\t\t};\n\n\t\t\t\treader.readAsDataURL(file);\n\t\t\t}\n\t\t}\n\t});\n}\n","import { majDimensionsPrint } from \"../display/print.mjs\";\nimport { calculeNombreDeCarreaux } from \"../layout/getSize.mjs\";\n\nexport function handleResize() {\n\twindow.addEventListener(\"resize\", () => {\n\t\tcalculeNombreDeCarreaux();\n\t\tmajDimensionsPrint();\n\t});\n}\n","import {\n\ttexte_marge,\n\ttexte_marge_complementaire,\n\ttexte_principal,\n} from \"../../utils/dom.mjs\";\nimport { save_texte } from \"../../settings/read-write.mjs\";\n\nexport function handleFocus() {\n\ttexte_principal.addEventListener(\"focusout\", save_texte);\n\ttexte_marge.addEventListener(\"focusout\", save_texte);\n\ttexte_marge_complementaire.addEventListener(\"focusout\", save_texte);\n}\n","import { config } from \"../../config.mjs\";\n\nexport function handleKeyboard() {\n\twindow.addEventListener(\"keydown\", function (event) {\n\t\t// Vérifie si la touche \"Suppr\" (Delete) est appuyée\n\t\tif (event.key === \"Delete\") {\n\t\t\t// Si un élément est sélectionné, le supprimer\n\t\t\tif (config.selected) {\n\t\t\t\tconfig.selected.remove(); // Supprime l'élément du DOM\n\t\t\t\tconfig.selected = false; // Réinitialise la variable\n\t\t\t}\n\t\t}\n\t});\n}\n","import { images, texte_principal } from \"../../utils/dom.mjs\";\n\nexport function handleClickOnDocument() {\n\timages.addEventListener(\"click\", () => {\n\t\ttexte_principal.focus();\n\t\t// On déplace le curseur à la fin du texte\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents(texte_principal);\n\t\trange.collapse(false);\n\t\tconst sel = window.getSelection();\n\t\tsel.removeAllRanges();\n\t\tsel.addRange(range);\n\t});\n}\n"],"names":["hasWindow","window","openboard","Boolean","widget","sankore","document","body","classList","add","isSmallScreen","matchMedia","matches","largeur_carreau","config","prefixeAppli","largeur_marge_secondaire","largeur_page","largeur_page_impression","largeur_marge_impression","largeur_margesecondaire_impression","largeur_carreau_old","largeur_marge","facteur_taille_police","taille_police","epaisseur_police","ligatures_on","coef_marge","coef_marge_windows","distance_soulignage","police_active","typeCarreaux","regleActive","isDrawing","espacementLettres","espacementMots","ajouterLaDate","soulignerLaDate","verifierOrthographe","interligneDouble","largeurImpression","nombreDeCarreaux","ecrireAChevalSurLaMarge","langue","langueChoix","majDateAuto","isWindows","test","navigator","userAgent","substitutions","selected","dateDuDoc","afficherMessage","opaciteLignes","contenuTexteMarge","contenuTexteMargeComplementaire","contenuGraphismes","contenuImages","contenuTextePrincipal","couleursJours","numeroMessage","sharedURL","sharedUDI","get","id","getElementById","ouvre","div","querySelectorAll","remove","darkbox","ferme","divApropos","divEntete","divMargeEntete","case2","case3","divContenu","divMarge","marge","texte_marge","margeSecondaire","texte_marge_complementaire","page","graphismes","images","texte_principal","divMessage","checkboxMessage","resultatCodi","lienCodi","suiteCodi","boutonCodi","bouton_ligatures","choix_police","choixCouleurEntete","inputEspacement","inputEspacementMots","checkboxAjouterDate","checkboxSoulignerDate","checkboxVerifierOrthographe","checkboxInterligneDouble","inputLargeurImpression","inputNombreDeCarreaux","checkboxMajDateAuto","inputEcrireACheval","divConfirmationNouveau","divCodi","divIllustration","zone_menu_copie_lien","zone_lien","fullscreen","barre","site","documentElement","selectLangue","save_texte","stocke","innerHTML","cle","valeur","setPreference","localStorage","setItem","async","litDepuisStockage","valeurAretourner","preference","error","console","getItem","getValueFromUrlOrStorage","urlParams","key","nomJours","fr","oc","joursRef","lundi","mardi","mercredi","jeudi","vendredi","samedi","jours","changeCouleurEntete","couleur","jourActif","value","style","backgroundColor","adapteCouleurBordureChoixCouleur","JSON","stringify","lumi","rgb","luminosite","hex","r","g","b","length","parseInt","hexToRgb","borderColor","nomMois","flatpickr","__assign","Object","assign","t","s","i","n","arguments","p","prototype","hasOwnProperty","call","apply","this","__spreadArrays","il","Array","k","a","j","jl","HOOKS","defaults","_disable","allowInput","allowInvalidPreload","altFormat","altInput","altInputClass","animate","indexOf","ariaDateFormat","autoFillDefaultTime","clickOpens","closeOnSelect","conjunction","dateFormat","defaultHour","defaultMinute","defaultSeconds","disable","disableMobile","enableSeconds","enableTime","errorHandler","err","warn","getWeek","givenDate","date","Date","getTime","setHours","setDate","getDate","getDay","week1","getFullYear","Math","round","hourIncrement","ignoredFocusElements","inline","locale","minuteIncrement","mode","monthSelectorType","nextArrow","noCalendar","now","onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition","plugins","position","positionElement","undefined","prevArrow","shorthandCurrentMonth","showMonths","static","time_24hr","weekNumbers","wrap","english","weekdays","shorthand","longhand","months","daysInMonth","firstDayOfWeek","ordinal","nth","rangeSeparator","weekAbbreviation","scrollTitle","toggleTitle","amPM","yearAriaLabel","monthAriaLabel","hourAriaLabel","minuteAriaLabel","pad","number","slice","int","bool","debounce","fn","wait","_this","args","clearTimeout","setTimeout","arrayify","obj","toggleClass","elem","className","createElement","tag","content","e","textContent","clearNode","node","firstChild","removeChild","findParent","condition","parentNode","createNumberInput","inputClassName","opts","wrapper","numInput","arrowUp","arrowDown","type","pattern","setAttribute","appendChild","getEventTarget","event","composedPath","target","doNothing","monthToStr","monthNumber","revFormat","D","F","dateObj","monthName","setMonth","G","hour","getHours","parseFloat","H","J","day","K","RegExp","M","shortMonth","S","seconds","setSeconds","U","_","unixSeconds","W","weekNum","weekNumber","Y","year","setFullYear","Z","ISODate","d","h","minutes","setMinutes","l","m","month","u","unixMillSeconds","w","y","tokenRegex","formats","toISOString","options","getMonth","getSeconds","getMinutes","String","substring","createDateFormatter","_a","_b","_c","l10n","_d","isMobile","frmt","overrideLocale","formatDate","split","map","c","arr","join","createDateParser","givenFormat","timeless","customLocale","parsedDate","dateOrig","toFixed","format","datestr","trim","parseDate","matched","ops","matchIndex","regexStr","token_1","isBackSlash","escaped","match","exec","val","forEach","isNaN","Error","compareDates","date1","date2","calculateSecondsSinceMidnight","hours","duration","getDefaultHours","minDate","minHour","minMinutes","minSeconds","maxDate","maxHr","maxMinutes","min","FlatpickrInstance","element","instanceConfig","self","defaultConfig","getClosestActiveElement","calendarContainer","getRootNode","activeElement","bindToInstance","bind","setCalendarWidth","requestAnimationFrame","visibility","display","daysContainer","daysWidth","days","offsetWidth","width","weekWrapper","removeProperty","updateTime","selectedDates","defaultDate","getMilliseconds","latestSelectedDateObj","preventDefault","isKeyDown","eventTarget","input","getAttribute","max","step","curValue","delta","which","newValue","isHourElem","hourElement","isMinuteElem","minuteElement","incrementNumInput","abs","timeWrapper","prevValue","_input","setHoursFromInputs","updateValue","_debouncedChange","secondElement","limitMinHours","minTime","minDateHasTime","limitMaxHours","maxTime","maxDateHasTime","minBound","maxBound","currentTime","result","secondsSinceMidnight","floor","parseSeconds","setHoursFromDate","onYearInput","toString","changeYear","handler","ev","el","addEventListener","_handlers","push","removeEventListener","triggerChange","triggerEvent","jumpToDate","jumpDate","jumpTo","oldYear","currentYear","oldMonth","currentMonth","message","buildMonthSwitch","redraw","timeIncrement","contains","inputElem","createEvent","dispatchEvent","createDay","_dayNumber","dateIsEnabled","isEnabled","dayElement","$i","todayDateElem","tabIndex","isDateSelected","selectedDateElem","isDateInRange","insertAdjacentHTML","focusOnDayElem","targetNode","focus","onMouseOver","getFirstAvailableDay","startMonth","endMonth","children","startIndex","endIndex","focusOnDay","current","offset","dayFocused","isInView","startElem","givenMonth","loopDelta","numMonthDays","changeMonth","getNextAvailableDay","buildMonthDays","firstOfMonth","prevMonthDays","utils","getDaysInMonth","createDocumentFragment","isMultiMonth","prevMonthDayClass","nextMonthDayClass","dayNumber","dayIndex","dayNum","dayContainer","buildDays","frag","shouldBuildMonth","monthsDropdownContainer","buildMonth","monthElement","container","monthNavFragment","selectedMonth","yearInput","tabindex","yearElement","getElementsByTagName","disabled","buildMonths","monthNav","prevMonthNav","yearElements","monthElements","nextMonthNav","buildWeekdays","weekdayContainer","updateWeekdays","splice","isOffset","_hidePrevMonthArrow","_hideNextMonthArrow","updateNavigationCurrentMonth","isCalendarElem","documentClick","isOpen","eventTarget_1","isCalendarElement","lostFocus","path","relatedTarget","isIgnored","some","timeContainer","close","clear","newYear","newYearNum","isNewYear","dateToCheck","enable","array","parsed","from","to","onBlur","isInput","valueChanged","trimEnd","getDateStr","allowKeydown","allowInlineKeydown","keyCode","blur","open","isTimeObj","focusAndClose","selectDate","delta_1","ctrlKey","stopPropagation","currentYearElement","elems","concat","pluginElements","filter","x","shiftKey","charAt","toLowerCase","cellClass","hoverDate","firstElementChild","initialDate","rangeStartDate","rangeEndDate","containsDisabled","minRange","maxRange","rContainer","dayElem","ts","ts1","ts2","timestamp","outOfRange","onResize","positionCalendar","minMaxDateSetter","inverseDateObj","removeAttribute","getInputElem","querySelector","setupLocale","l10ns","default","parse","dataset","customPositionElement","_positionElement","calendarHeight","reduce","acc","child","offsetHeight","calendarWidth","configPos","configPosVertical","configPosHorizontal","inputBounds","getBoundingClientRect","distanceFromBottom","innerHeight","bottom","showOnTop","top","pageYOffset","left","pageXOffset","isCenter","isRight","right","rightMost","centerMost","doc","editableSheet","styleSheets","sheet","cssRules","head","getDocumentStyleSheet","bodyWidth","centerLeft","centerIndex","centerStyle","insertRule","centerBefore","msMaxTouchPoints","selectedDate","shouldChangeMonth","selectedIndex","sort","single","range","loadedPlugins","_bind","_setHoursFromDate","_positionCalendar","triggerChangeEvent","toInitial","mobileInput","_initialDate","_createElement","destroy","lastChild","insertBefore","_type","click","wasOpen","select","set","option","CALLBACKS","setSelectedDate","toggle","updatePositionElement","inputDate","dates","parseDateRules","rule","data","hooks","name","initEvent","specificFormat","dObj","mobileFormatStr","onMonthNavClick","isPrevMonth","isNextMonth","boolOpts","userConfig","defineProperty","_enable","timeMode","defaultDateFormat","defaultAltFormat","_minDate","_maxDate","minMaxTimeSetter","_minTime","_maxTime","hook","pluginConf","parseConfig","nodeName","placeholder","required","nextSibling","setupInputs","preloadedDate","setupDates","yr","fragment","__hidePrevMonthArrow","__hideNextMonthArrow","innerContainer","buildWeeks","separator","hourInput","minuteInput","military2ampm","secondInput","title","buildTime","customAppend","appendTo","nodeType","build","evt","inputType","defaultValue","setupMobile","debouncedResize","ontouchstart","capture","selText","bindEvents","isSafari","init","_flatpickr","nodeList","nodes","HTMLElement","instances","HTMLCollection","NodeList","selector","Node","en","localize","setDefaults","jQuery","fp_incr","flatpickrFrench","flatpickrItalian","flatpickrOccitan","calculeDate","normalize","dt","weekday","padStart","dateDuJour","toLocaleDateString","replace","date_formatee","toUpperCase","dateStr","jour","regexJour","mois","regexMois","traduireDateEnOccitan","creeDate","nouveauSpan","divDate","textDecoration","prepend","br2","calendarInstance","flatpickrLocalization","ouvreSelecteurDate","datepickerDiv","positionLeft","flatpickrCalendar","link","rel","href","Promise","resolve","reject","onload","onerror","flatpickrLocales","changeDate","flatpickrCalendar2","dateAutiliser","changeJour","changeModeDate","checked","toogleMajDateAuto","ouvreBoutonsCouleurs","rect","ouvreOptions","divPanneauOptions","opacite","inputOpacite","voile_page","voile_marge","voile_marge2","normaliserSpans","TEXT_NODE","parentElement","editableParent","ELEMENT_NODE","hasAttribute","span","classes","parent","cls","nettoyerSpans","modifie","spans","next","tagName","extraireCaracteresAvecStyles","caracteres","parcourirNoeud","noeud","classesParent","texte","cloneNode","isEntoure","nouvellesClasses","childNodes","enfant","souligne","sel","getSelection","rangeCount","getRangeAt","collapsed","commonAncestorContainer","texteAvantSelection","cloneRange","selectNodeContents","setEnd","startContainer","startOffset","endOffset","currentOffset","startNode","startPos","endNode","endPos","walker","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","nodeLength","newRange","createRange","setStart","removeAllRanges","addRange","finalRange","startNodeFinal","endContainer","spanParent","cloneContents","nouveauFragment","classesASupprimer","car","includes","deleteContents","insertNode","collapse","textDecorationColor","firstTimeSouligne","ouvreBoutonsSouligne","btn","currentTarget","calculeNombreDeCarreaux","largeurPage","calculerLargeurTextePrincipal","styles","getComputedStyle","marginLeft","marginRight","typesPolices","Arial","ligatures","bouton_ligatures_display","Acceseditionscursive","Luciole","Romain","imprimer","print","majDimensionsPrint","largeur_marge_secondaire_impression","setProperty","calc_marge","zoom","coef","largeur","police","coefAgrandissement","hauteurTexte","scrollHeight","hauteurPage","clientHeight","scrollDebut","scrollTop","hauteurTexteApresZoom","nouveauScroll","pow","ajusterScroll","largeur_carreau_impression","calc_marge_impression","taille_police_impression","fontWeight","backgroundSize","fontSize","marginTop","lineHeight","policeCustom","fontFamily","facteurCustom","graphisme","transition","computedStyle","positionX","getPropertyValue","positionY","height","newPositionX","newPositionY","newWidth","newHeight","adapteMargeCahierDeTexte","changeCarreaux","ancienTypeCareaux","backgroundImage","borderLeft","borderRightColor","initChooseTilesPanel","bouton","imageUrl","carreauMap","carreau_seyes","carreau_seyes_noir","carreau_seyes_gris","carreau_ligne_base","carreau_simple_ligne","carreau_double_ligne","carreau_petit","carreau_terre","carreau_trois_couleurs","carreau_quatre_couleurs","carreau_bleuviolet","carreau_cahier_de_textes","keys","closeCarreaux","firstTime","ouvreBoutonsCarreau","cree_image","nouvelle_image","Image","files","reader","FileReader","naturalWidth","naturalHeight","src","readAsDataURL","nouveauConteneurImage","boutonSupprimer","boutonCadre","poigneeNO","poigneeNE","poigneeSO","poigneeSE","cree_timer","timer","pos","poignee","activeRegle","cursor","changeCouleurTrait","alert","COMPRESSION_MAP","entoure","DECOMPRESSION_MAP","fromEntries","entries","v","compresserHTML","html","resultat","contenu","decompresserHTML","comprime","parties","code","firstTimeCopierLien","menu_copier_lien","fermeCopie","initCloseCopyLinkMenu","baseURL","location","protocol","host","pathname","params","URLSearchParams","lang","hash","encodeURIComponent","lienFinal","innerText","majLien","copier","texteLien","clipboard","writeText","then","popup","color","padding","borderRadius","zIndex","opacity","scrollX","scrollY","catch","pleinecran_on","pleinecran","backgroundPosition","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","align","cote","selection","anchorNode","textAlign","selectedText","tempDiv","entouresInSelection","entoureSpanVrai","find","intersectsNode","tousLesEntoures","entouresAUnwrap","entoureSpan","contentFragment","extractContents","couleurTexte","couleurClasses","webkitTextStroke","changeEcrireACheval","whiteSpace","changeVerifieOrthographe","spellcheck","changeInterligneDouble","changeLargeurImpression","valeurEntree","changeEspacementLettres","letterSpacing","changeEspacementMots","wordSpacing","sens","sens_force","recherche","subsitution","change_police","newConfig","textUnderlineOffset","update_souligne","lienHashCodi","firstLoad","translations","T","defaultText","log","loadLanguage","response","fetch","json","getLang","url","search","changeLangue","entree","userLanguage","language","traiteInputCodi","textOK","textPasOK","texteValide","getTexte","origin","startsWith","endsWith","handleURL","ok","statusText","text","fetchTextFromURL","sections","entete","lignesEntete","opaciteCodim","lignage","autodate","valueAfterColon","ligne","parts","langVal","URL","searchParams","history","replaceState","majUrl","lignageVal","autodateVal","soulignerVal","couleurVal","opaciteVal","couleurs","noir","bleu","marron","cyan","gris","vert","magenta","bordeaux","marine","olive","violet","rouge","argent","sarcelle","blanc","jaune","vertolive","bleuciel","bleuroi","bleumarine","vertforet","vertcitron","vertmer","rosefonce","bleunuit","sansEspaces","avecEspaces","patterns","baseAnglais","source","normaliseCouleur","contenuHtml","afficheTexteDistant","resetContent","brElements","lastBr","setStartAfter","applySettings","regleMargeSecondaire","contentFromHash","hashValues","decodeURIComponent","baseUrl","checkHash","conteneurImage","reaffecteEventsImages","loadSettings","isOffline","contenuPrincipalStorage","defaultContent","ouvrir","accept","handleFileSelect","file","validExtensions","ext","mammoth","script","arrayBuffer","convertToHtml","readAsArrayBuffer","readDocxFile","insereContenu","ODF","uint8Array","Uint8Array","odfDocument","load","getText","readOdtFile","nomDuFichierOuvert","readAsText","readFileAsText","handleJSONFile","storedValue","prepareEnregistrement","nomDuFichier","showSaveFilePicker","nomParDefaut","jsonData","handle","suggestedName","types","description","writable","createWritable","write","enregistrerFichierAvecDialogue","nomDeFichier","getContentForSaving","blob","Blob","createObjectURL","download","enregistrer","zoomAutoCarreaux","nouveauTexte","initImportMarkdownButtons","boutonFermeCodi","firstTimeImportMarkdown","importMarkdownButton","ic","handleYesButton","handleNoButton","aboutInitialized","openAbout","initCloudLoadHandlers","cloudLoadBtn","cancelBtn","confirmationLoad","inputId","okBtn","udi","method","status","getDocumentFromCloud","loadContentFromCloud","initCloudSaveHandlers","cloudSaveBtn","confirmationSave","cloudSaveDoneBtn","cloudConfirmationSaveSuccess","newUdi","cloud_save_option","responseData","documentUpdatedInCloud","saveNewDocumentToCloud","updateDocumentInCloud","saveContentToCloud","startX","startY","dragged","posX","posY","posXDepartSouris","posYDepartSouris","posXSouris","posYSouris","diffsourisx","diffsourisy","diffX","diffY","redim","lineDiv","imageRedim","imageRedimDimension","imageRedimTaille","sensRedimImageEnCours","snapToGrid","gridSize","clientX","targetTouches","touchClientX","clientY","touchClientY","moveCursor","mouseX","mouseY","snappedX","snappedY","clic","closest","menuSoulignement","menuCarreaux","menuCouleurTexte","cible","objet","objetOuEnfantDe","rect2","mouseXmarge","draggable_item","image","imageRedimWidth","clientWidth","imageRedimHeight","offsetLeft","offsetTop","boutonCouleur","move","diff","pageX","pageY","longueur","release","currentLeft","currentTop","newLeft","newTop","cb","jourActifDepart","couleurDepart","initSettings","mapClicks","nouveau","codi","copielien","bouton_deroule_date","zoom_out","zoom_in","carreaux","center","bouton_deroule_couleurs","bouton_deroule_souligne","bouton_entoure","regle","a_propos","aide","panneauOptions_close_button","oui","non","mapChanges","mapInputs","inputCodi","inputCouleurTrait","selectJours","inputFichier","lb","db","initMenu","clipboardData","originalEvent","getData","execCommand","items","item","getAsFile","img","maxWidth","outerHTML"],"mappings":"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"}